{"code":"!function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\"a\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\"\",n(n.s=\"8E5r\")}({\"/ON0\":function(e,t,n){},\"2ryK\":function(e,t,n){\"use strict\";n.r(t),n.d(t,\"REGEX\",(function(){return d}));var i=n(\"TXEh\"),o=n(\"GcJT\"),a=n(\"UJXg\"),r=n.n(a),s=n(\"g+N3\"),l=n.n(s);const d=new RegExp(\"\\\\[([a-z_:]+]?)?$\",\"ig\");t.default=function(e,t){const n=new o.PluginKey(\"placeholders\");let a=new r.a(e);return new o.Plugin({key:n,view(){return{update:Object(i.debounce)(n=>{const{text:i,active:o,range:r}=this.key.getState(n.state);if(a.destroyInstance(),!i||!o)return;if(!n.editable)return;const s=i.slice(1);a.showList({view:n,component:{name:\"totara_notification_placeholder\",component:l.a,attrs:(e,t)=>({key:e,label:t}),props:{resolverClassName:t,contextId:e.identifier.contextId,pattern:s}},state:{text:s,active:o,range:r}})},250)}},state:{init:()=>({active:!1,range:{},text:null}),apply:(e,t)=>(d.lastIndex=0,a.apply(e,t,d))},props:{handleKeyDown(e,t){if(\"Escape\"===t.key||\"Esc\"===t.key){const{active:n}=this.getState(e.state);return!!n&&(a.destroyInstance(),e.focus(),t.stopPropagation(),!0)}}}})}},\"45xq\":function(e,t,n){\"use strict\";n.r(t);var i=n(\"tnXT\"),o=n.n(i),a=n(\"Ki6H\"),r={components:{Placeholder:n.n(a).a},extends:o.a,computed:{placeholderKey(){const e=this.attrs;return e.key?e.key:\"\"},displayName(){const e=this.attrs;return e.label?e.label:\"\"}}},s=n(\"KHd+\"),l=Object(s.a)(r,(function(){var e=this.$createElement;return(this._self._c||e)(\"Placeholder\",{attrs:{\"placeholder-key\":this.placeholderKey,\"display-name\":this.displayName}})}),[],!1,null,null,null);l.options.__hasBlocks={script:!0,template:!0};t.default=l.exports},\"4NLQ\":function(e,t,n){var i={\"./extension\":\"i58X\",\"./extension.js\":\"i58X\",\"./plugin\":\"2ryK\",\"./plugin.js\":\"2ryK\"};function o(e){var t=a(e);return n(t)}function a(e){if(!n.o(i,e)){var t=new Error(\"Cannot find module '\"+e+\"'\");throw t.code=\"MODULE_NOT_FOUND\",t}return i[e]}o.keys=function(){return Object.keys(i)},o.resolve=a,e.exports=o,o.id=\"4NLQ\"},\"8E5r\":function(e,t,n){!function(){\"use strict\";\"undefined\"!=typeof tui&&tui._bundle.isLoaded(\"weka_notification_placeholder\")?console.warn('[tui bundle] The bundle \"weka_notification_placeholder\" is already loaded, skipping initialisation.'):(tui._bundle.register(\"weka_notification_placeholder\"),tui._bundle.addModulesFromContext(\"weka_notification_placeholder\",n(\"4NLQ\")),tui._bundle.addModulesFromContext(\"weka_notification_placeholder/components\",n(\"IiAa\")))}()},GcJT:function(e,t){e.exports=tui.require(\"ext_prosemirror/state\")},IiAa:function(e,t,n){var i={\"./nodes/Placeholder\":\"45xq\",\"./nodes/Placeholder.vue\":\"45xq\",\"./suggestion/Placeholder\":\"bX1p\",\"./suggestion/Placeholder.vue\":\"bX1p\"};function o(e){var t=a(e);return n(t)}function a(e){if(!n.o(i,e)){var t=new Error(\"Cannot find module '\"+e+\"'\");throw t.code=\"MODULE_NOT_FOUND\",t}return i[e]}o.keys=function(){return Object.keys(i)},o.resolve=a,e.exports=o,o.id=\"IiAa\"},JXQf:function(e,t){e.exports=tui.require(\"tui/components/loading/Loader\")},KGcv:function(e,t){e.exports=tui.require(\"tui/components/dropdown/DropdownItem\")},\"KHd+\":function(e,t,n){\"use strict\";function i(e,t,n,i,o,a,r,s){var l,d=\"function\"==typeof e?e.options:e;if(t&&(d.render=t,d.staticRenderFns=n,d._compiled=!0),i&&(d.functional=!0),a&&(d._scopeId=\"data-v-\"+a),r?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||\"undefined\"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),o&&o.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(r)},d._ssrRegister=l):o&&(l=s?function(){o.call(this,(d.functional?this.parent:this).$root.$options.shadowRoot)}:o),l)if(d.functional){d._injectStyles=l;var u=d.render;d.render=function(e,t){return l.call(t),u(e,t)}}else{var c=d.beforeCreate;d.beforeCreate=c?[].concat(c,l):[l]}return{exports:e,options:d}}n.d(t,\"a\",(function(){return i}))},Ki6H:function(e,t){e.exports=tui.require(\"totara_notification/components/json_editor/nodes/Placeholder\")},P8Br:function(e,t,n){\"use strict\";var i=n(\"/ON0\");n.n(i).a},TXEh:function(e,t){e.exports=tui.require(\"tui/util\")},UJXg:function(e,t){e.exports=tui.require(\"editor_weka/helpers/suggestion\")},bX1p:function(e,t,n){\"use strict\";n.r(t);var i=n(\"gLvT\"),o=n.n(i),a=n(\"KGcv\"),r=n.n(a),s=n(\"JXQf\"),l=n.n(s),d={kind:\"Document\",definitions:[{kind:\"OperationDefinition\",operation:\"query\",name:{kind:\"Name\",value:\"weka_notification_placeholder_placeholders\"},variableDefinitions:[{kind:\"VariableDefinition\",variable:{kind:\"Variable\",name:{kind:\"Name\",value:\"context_id\"}},type:{kind:\"NonNullType\",type:{kind:\"NamedType\",name:{kind:\"Name\",value:\"param_integer\"}}},directives:[]},{kind:\"VariableDefinition\",variable:{kind:\"Variable\",name:{kind:\"Name\",value:\"pattern\"}},type:{kind:\"NonNullType\",type:{kind:\"NamedType\",name:{kind:\"Name\",value:\"param_text\"}}},directives:[]},{kind:\"VariableDefinition\",variable:{kind:\"Variable\",name:{kind:\"Name\",value:\"resolver_class_name\"}},type:{kind:\"NonNullType\",type:{kind:\"NamedType\",name:{kind:\"Name\",value:\"param_text\"}}},directives:[]}],directives:[],selectionSet:{kind:\"SelectionSet\",selections:[{kind:\"Field\",alias:{kind:\"Name\",value:\"placeholders\"},name:{kind:\"Name\",value:\"weka_notification_placeholder_placeholders\"},arguments:[{kind:\"Argument\",name:{kind:\"Name\",value:\"context_id\"},value:{kind:\"Variable\",name:{kind:\"Name\",value:\"context_id\"}}},{kind:\"Argument\",name:{kind:\"Name\",value:\"pattern\"},value:{kind:\"Variable\",name:{kind:\"Name\",value:\"pattern\"}}},{kind:\"Argument\",name:{kind:\"Name\",value:\"resolver_class_name\"},value:{kind:\"Variable\",name:{kind:\"Name\",value:\"resolver_class_name\"}}}],directives:[],selectionSet:{kind:\"SelectionSet\",selections:[{kind:\"Field\",name:{kind:\"Name\",value:\"__typename\"},arguments:[],directives:[]},{kind:\"Field\",name:{kind:\"Name\",value:\"label\"},arguments:[],directives:[]},{kind:\"Field\",name:{kind:\"Name\",value:\"key\"},arguments:[],directives:[]}]}}]}}]},u={components:{Dropdown:o.a,DropdownItem:r.a,Loader:l.a},props:{contextId:{type:[Number,String],required:!0},resolverClassName:{type:String,required:!0},location:{required:!0,type:Object},pattern:{required:!0,type:String}},apollo:{placeholders:{query:d,fetchPolicy:\"network-only\",variables(){return{pattern:this.pattern,context_id:this.contextId,resolver_class_name:this.resolverClassName}}}},data:()=>({placeholders:[]}),computed:{showSuggestions(){return this.$apollo.loading||this.placeholders.length>0},positionStyle(){return{left:this.location.x+\"px\",top:this.location.y+\"px\"}}},watch:{showSuggestions(e){e||this.$emit(\"dismiss\")}},methods:{pickPlaceholder({key:e,label:t}){this.$emit(\"item-selected\",{id:e,text:t})}}},c=(n(\"P8Br\"),n(\"KHd+\")),p=function(e){e.options.__langStrings={editor_weka:[\"matching_placeholders\"]}},f=Object(c.a)(u,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n(\"div\",{staticClass:\"tui-wekaPlaceholderSuggestion\",style:e.positionStyle},[n(\"Dropdown\",{attrs:{separator:!0,open:e.showSuggestions,\"inline-menu\":!0},on:{dismiss:function(t){return e.$emit(\"dismiss\")}}},[n(\"span\",{staticClass:\"sr-only\"},[e._v(\"\\n      \"+e._s(e.$str(\"matching_placeholders\",\"editor_weka\"))+\":\\n    \")]),e._v(\" \"),e.$apollo.loading?[n(\"DropdownItem\",{attrs:{disabled:!0}},[n(\"Loader\",{attrs:{loading:!0}})],1)]:e._e(),e._v(\" \"),e._l(e.placeholders,(function(t,i){return n(\"DropdownItem\",{key:i,attrs:{\"no-padding\":!0},on:{click:function(n){return e.pickPlaceholder(t)}}},[n(\"span\",{staticClass:\"tui-wekaPlaceholderSuggestion__label\"},[e._v(\"\\n        \"+e._s(t.label)+\"\\n      \")])])}))],2)],1)}),[],!1,null,null,null);\"function\"==typeof p&&p(f),f.options.__hasBlocks={script:!0,template:!0};t.default=f.exports},\"g+N3\":function(e,t){e.exports=tui.require(\"weka_notification_placeholder/components/suggestion/Placeholder\")},gAZ6:function(e,t){e.exports=tui.require(\"editor_weka/extensions/Base\")},gLvT:function(e,t){e.exports=tui.require(\"tui/components/dropdown/Dropdown\")},hstw:function(e,t){e.exports=tui.require(\"weka_notification_placeholder/components/nodes/Placeholder\")},i58X:function(e,t,n){\"use strict\";n.r(t);var i=n(\"hstw\"),o=n.n(i),a=n(\"gAZ6\"),r=n.n(a),s=n(\"2ryK\");class l extends r.a{nodes(){return{totara_notification_placeholder:{schema:{group:\"inline\",inline:!0,attrs:{key:{default:void 0},label:{default:void 0}},parseDOM:[{tag:\"span.tui-placeholder__text\",getAttrs(e){try{return{key:e.getAttribute(\"data-key\"),label:e.getAttribute(\"data-label\")}}catch(e){return{}}}}],toDOM:e=>[\"span\",{class:\"tui-placeholder__text\",\"data-key\":e.attrs.key,\"data-label\":e.attrs.label},\"[\"+e.attrs.label+\"]\"]},component:o.a}}}plugins(){return[Object(s.default)(this.editor,this.options.resolver_class_name)]}}t.default=e=>new l(e)},tnXT:function(e,t){e.exports=tui.require(\"editor_weka/components/nodes/BaseNode\")}});","extractedComments":[]}