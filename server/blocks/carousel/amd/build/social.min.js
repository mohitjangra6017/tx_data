define(["jquery","theme_roots/bootstrap"],function(a){return{init:function(b){var c=this;a('[data-toggle="dropdown"]').dropdown(),a(document).on("click",b+".block_carousel .carousel-like a",function(b){c.ajax_like_unlike(a(this)),b.preventDefault()}),a(document).on("submit",b+".block_carousel .dropdown-menu form",function(c){var d=a(this),e=a(b+".block_carousel"),f=d.parents("ul:first").siblings(".dropdown-toggle");c.preventDefault();var g=d.find(".btn-primary");g.prop("disabled",!0);var h=a('<img src="'+M.util.image_url("i/loading_small")+'" />');g.after(h),f.hasClass("send-message-btn")&&setTimeout(function(){h.remove(),g.prop("disabled",!1),d.find("textarea").val("")},500),a.post(d.prop("action"),d.serialize()+"&ajax=1",function(b){if(b=a.parseJSON(b),f.hasClass("follow-button")){var c=b.follow_id;b.followed?e.find(".followuser-"+c).addClass("event-feed-selected").html('<i class="fa fa-users fa-lg"></i> Unfollow'):e.find(".followuser-"+c).removeClass("event-feed-selected").html('<i class="fa fa-users fa-lg"></i> Follow');var g=d.parent();g.empty().append(b.formcontent);var h=e.find("#followingtab");h.addClass("stalled")}})})},ajax_like_unlike:function(b){a.ajax({url:b.attr("href"),dataType:"json"}).done(function(a){1==a.success&&b.parent(".carousel-like").toggleClass("liked")})}}});