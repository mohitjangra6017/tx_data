YUI.add("moodle-local_leaderboard-dropdown",function(e,t){function n(){n.superclass.constructor.apply(this,arguments)}var r={PLUGIN:"#id_plugin",EVENTNAME:"#id_eventname",OPTION:"option",CHOOSE:'option[value=""]',MOD_COMPLETIONS:"#id_mod_completions",COUNT:"#id_count",FREQUENCY:"#id_frequency",USE_GRADE:"#id_usegrade",SCORE:"#id_score"},i="core",s="\\core\\event\\course_module_completion_updated",o=["\\mod_quiz\\event\\attempt_submitted","\\mod_assign\\event\\submission_graded","\\mod_lesson\\event\\essay_assessed","\\mod_scorm\\event\\status_submitted"];e.extend(n,e.Base,{plugin:null,eventname:null,modCompletions:null,initializer:function(){this.plugin=e.one(r.PLUGIN),this.eventname=e.one(r.EVENTNAME),this.modCompletions=e.one(r.MOD_COMPLETIONS),this.awardCount=e.one(r.COUNT),this.awardFrequency=e.one(r.FREQUENCY),this.useGrade=e.one(r.USE_GRADE),this.score=e.one(r.SCORE);var t=this.eventname.get("value");this.eventname.get("value")===s&&(this.awardFrequency.set("disabled",!0),this.awardCount.set("value",""),this.awardCount.set("disabled",!0)),this.updateEventsList(),this.updateSelection(t,this.eventname),this.plugin.on("change",this.updateEventsList,this),this.eventname.on("change",this.handleEventSelected.bind(this)),this.useGrade.on("change",this.handleUseGradeUpdated.bind(this)),this.modCompletions!==null&&this.modCompletions.on("change",this.setModuleCompletionEvent.bind(this))},handleUseGradeUpdated:function(){this.useGrade.get("checked")===!0&&this.score.set("value","")},handleEventSelected:function(){this.eventname.get("value")===s?(this.awardCount.set("value",""),this.awardCount.set("disabled",!0),this.awardFrequency.set("disabled",!0)):(this.awardCount.set("disabled",!1),this.awardFrequency.set("disabled",!1)),o.includes(this.eventname.get("value"))?this.useGrade.set("disabled",!1):this.useGrade.set("disabled",!0)},setModuleCompletionEvent:function(){this.modCompletions.get("checked")===!0?(this.updateSelection(i,this.plugin),this.updateEventsList(this.eventname.get("value"),this.eventname),this.updateSelection(s,this.eventname),this.plugin.set("disabled",!0),this.eventname.set("disabled",!0),this.score.set("disabled",!1)):(this.plugin.set("disabled",!1),this.eventname.set("disabled",!1),this.awardCount.set("disabled",!1),this.awardFrequency.set("disabled",!1),this.updateSelection("",this.plugin),this.updateEventsList(this.eventname.get("value"),this.eventname))},updateEventsList:function(){var t,n,i,s=this.plugin.get("value"),o="\\"+s+"\\";this.eventname.all(r.OPTION).remove(!0),n=this.get("eventlist"),i=e.Node.create('<option value="">'+n[""]+"</option>"),i.set("selected","selected"),this.eventname.appendChild(i),e.Object.each(n,function(n,r){r.substring(0,o.length)===o&&(t=e.Node.create('<option value="'+r+'">'+n+"</option>"),this.eventname.appendChild(t))},this)},updateSelection:function(e,t){t.get("options").each(function(t){t.get("value")===e&&t.set("selected","selected")},this),t.simulate("change")}},{NAME:"dropDown",ATTRS:{eventlist:null,pluginlist:null}}),e.namespace("M.local_leaderboard.DropDown").init=function(e){return new n(e)}},"@VERSION@",{requires:["base","event","node","node-event-simulate"]});
