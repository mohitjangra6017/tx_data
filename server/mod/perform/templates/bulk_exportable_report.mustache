{{!
    This file is part of Totara Perform

    Copyright (C) 2020 onwards Totara Learning Solutions LTD

    This program is free software; you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation; either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See  the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.

    @author Simon Coggins <simon.coggins@totaralearning.com>
    @author Fabian Derschatta <fabian.derschatta@totaralearning.com>
    @package mod_perform
}}
{{!
    @template totara_mvc/report

    Modified version of the totara_mvc/report template specifically for reports that
    support bulk export via an action card.

    Classes required for JS:
    * none

    Data attributes required for JS:
    * none

    Context variables required for this template:
    * backto: HTML
    * heading: HTML
    * debughtml: HTML, if debug is active contains debug information
    * restrictions: HTML, restrictions part of the report
    * description: HTML, report description
    * savedsearch: HTML, report saved search options output
    * search: HTML, report filter output
    * showhide: HTML, report show/hide columns button
    * sidebar: HTML, report sidebar filters
    * reporthtml: HTML, report table
    * export: HTML, report export option

    Example context (json):
    {
        "backto": "",
        "heading": "",
        "debughtml": "",
        "restrictions": "",
        "description": "",
        "savedsearch": "",
        "search": "<input type=\"text\"/><button>Search</button>",
        "showhide": "<button>Show/Hide Columns</button>",
        "sidebar": "",
        "reporthtml": "<table><tr><td>There are no records in this report</td></tr></table>",
        "export": "<button>Export this report</button>"
    }
}}
<div>
    {{{backto}}}
    {{{heading}}}
    {{{debughtml}}}
    {{{restrictions}}}
    {{{description}}}
    {{{savedsearch}}}
    {{{search}}}
    <div>
        {{filtered_report_count_string}}
        <form method="get" action="export.php">
            <input type="hidden" name="action" value="bulk" />
            <input type="hidden" name="export" value="Export" />
            <input type="hidden" name="format" value="csv" />
            <input type="hidden" name="filtered_report_embedded_shortname" value="{{filtered_report_embedded_shortname}}" />
            <input type="hidden" name="filtered_report_filter_hash" value="{{filtered_report_filter_hash}}" />
            {{#extra_params}}
                <input type="hidden" name="{{name}}" value="{{value}}" />
            {{/extra_params}}
            <input type="submit"{{#export_disabled}} disabled="disabled"{{/export_disabled}} name="submit" value="{{#str}}export_all,mod_perform{{/str}}" />
        </form>
    </div>
    {{{sidebar}}}
    {{{reporthtml}}}
    {{{export}}}
</div>