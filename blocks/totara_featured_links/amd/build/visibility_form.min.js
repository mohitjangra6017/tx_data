define(["jquery"],function(a){var b=["audience_showing","preset_showing","tile_rules_showing"],c=function(c){var d=0;a.each(b,function(b,e){a("#tfiid_"+e+"_"+c).is(":checked")&&d++}),a("#tfiid_audience_showing_"+c).length||d++,d>=2?a('[data-element-id="tfiid_aggregation'+c+'"]').each(function(b,c){a(c).removeAttr("data-hidden")}):a('[data-element-id="tfiid_aggregation'+c+'"]').each(function(b,c){a(c).attr("data-hidden","")})},d=function(){a("[data-type=cohort_delete]").each(function(b,c){a(c).off("click"),a(c).click(function(b){a(b.target).closest("li").remove();var c=a(b.target).closest("a").attr("cohortid"),d=a('input[name="audiences_visible"]'),e=d.val().split(",");e.indexOf(c)!=-1&&e.splice(e.indexOf(c),1),d.val(e.join()),d.change()})})};return{init:function(e){a.each(b,function(b,d){a("#tfiid_"+d+"_"+e).on("change",function(){c(e)})}),a("#tfiid_visibility_"+e).on("change",function(){"2"!=a("input[name=visibility]:checked","#tfiid_visibility_"+e).val()?a('[data-element-id="tfiid_aggregation'+e+'"]').each(function(b,c){a(c).attr("data-hidden","")}):(c(e),d())}),d(),"2"!=a("input[name=visibility]:checked","#tfiid_visibility_"+e).val()?a('[data-element-id="tfiid_aggregation'+e+'"]').each(function(b,c){a(c).attr("data-hidden","")}):c(e)},add_audience_table_listeners:d,add_to_audience_id:function(b){if(0!==b.length){var c=a('input[name="audiences_visible"]');c.val(c.val()+(0===c.val().length?"":",")+b),c.change()}},add_to_audience_list:function(b){a("#audience_visible_table").append(b)},audience_list_contains:function(b){return a("#audience_visible_table").find('span[cohortid="'+b+'"]').length}}});