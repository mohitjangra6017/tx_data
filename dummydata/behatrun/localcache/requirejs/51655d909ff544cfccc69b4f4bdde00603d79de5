define('core/addblockmodal', ["jquery","core/modal_factory","core/templates","core/str","core/notification"],function(a,b,c,d,e){return{init:function(f){var g=a("[data-key=addblock]"),h=[];a.each(f.blocks,function(a,b){h[h.length]={key:"pluginname",component:"block_"+b}});var i=d.get_strings(h).then(function(a){return a.map(function(a,b){return{name:f.blocks[b],title:a}})}).then(function(a){return f.blocks=a,c.render("core/add_block_body",f)}).fail(e.exception),j=d.get_string("addblock").fail(e.exception);b.create({title:j,body:i,type:"CANCEL"},g)}}});
define('core/add_block_popover', ["jquery","core/templates","core/str","core/flex_icon"],function(a,b,c,d){function e(){if(!(this instanceof e))return new e}e.prototype={constructor:e,addToPage:function(e,f){var g=this;null!==document.querySelector('[data-addblock="'+f+'"]')&&(M.util.js_pending("core_add_block"),c.get_strings([{key:"closebuttontitle",component:"core"},{key:"search",component:"core"}]).then(function(b){return a.when(d.getIconData("delete","core",{alt:b[0]}),d.getIconData("search","core",{alt:b[1]}))}).then(function(a,c){var d={contenttemplate:"core/add_block_popover_content",contenttemplatecontext:{close_icon:a,has_focus:!0,item_list:e,placement_max_height:600,placement_max_width:600,search_icon:c},arrow_placement:"smartPosition",close_on_focus_out:!0,trigger:"click"};return b.render("core/popover",d)}).then(function(a,c){var d,e=document.querySelector('[data-addblock="'+f+'"]'),h=document.createRange(),i=e.parentNode;h.selectNode(e),d=h.createContextualFragment(a),e.appendChild(d),b.runTemplateJS(c),g.events(i,e),M.util.js_complete("core_add_block")}))},changeListItemFocus:function(a){var b=a.target.closest(".addBlockPopover--results_list_item"),c=a.target.closest(".addBlockPopover--results");if("38"==a.keyCode)for(;b.previousElementSibling&&(b=b.previousElementSibling,b.classList.contains("hide")););else if("40"==a.keyCode)for(;b.nextElementSibling&&(b=b.nextElementSibling,b.classList.contains("hide")););b.classList.contains("hide")||(b.querySelector("a").focus(),c.scrollTop=b.offsetTop)},closeAddBlockPopover:function(b){a(b).popover("hide")},events:function(b,c){var d=this;b.addEventListener("click",function(a){a.preventDefault(),a.target&&(a.target.closest("[data-addblockpopover-close]")&&d.closeAddBlockPopover(c),a.target.closest(".addBlockPopover--results_list_item")&&d.submitAddBlock(this,a.target.closest(".addBlockPopover--results_list_item")))}),b.addEventListener("keydown",function(a){a.target&&(!a.target.closest(".addBlockPopover--results_list_item")||"38"!=a.keyCode&&"40"!=a.keyCode?a.target.closest("#addBlockPopover--search_query")&&a.shiftKey&&9==a.keyCode&&d.closeAddBlockPopover(c):(a.preventDefault(),d.changeListItemFocus(a)))}),b.addEventListener("keyup",function(a){a.target&&("27"==a.keyCode&&d.closeAddBlockPopover(c),a.target.closest("#addBlockPopover--search_query")&&("13"==a.keyCode?d.searchListEnter(b):d.searchListItems(b,a)))}),b.addEventListener("focusout",function(a){a.target&&a.relatedTarget&&a.target.closest(".addBlockPopover--close")&&!a.relatedTarget.closest(".popover")&&d.closeAddBlockPopover(c)}),a(c).on("shown.bs.popover",function(){d.setFocusToInput(b)})},searchListEnter:function(a){var b=a.querySelectorAll(".popover .addBlockPopover--results_list_item:not(.hide)");1===b.length?this.submitAddBlock(a,b[0]):b.length>=2&&b[0].querySelector("a").focus()},searchListItems:function(a,b){for(var c=b.target.value.toLowerCase(),d=a.querySelectorAll(".popover .addBlockPopover--results_list_item"),e=0;e<d.length;e++){var f=d[e],g=f.getAttribute("data-addblockpopover-blocktitle");if(g.toLowerCase().indexOf(c)===-1)f.classList.add("hide");else{f.classList.remove("hide");var h=f.querySelector("a");h.innerHTML=g.replace(new RegExp(c,"i"),"<b>$&</b>")}}},setFocusToInput:function(a){a.querySelector(".popover #addBlockPopover--search_query").focus()},submitAddBlock:function(a,b){b.closest(".addBlockPopover").classList.add("addBlockPopover--overlay");var c=b.getAttribute("data-addblockpopover-blockname");a.querySelector("input[name=bui_addblock]").setAttribute("value",c),a.querySelector("form").submit()}};var f=function(a,b){var c=new e;c.addToPage(a,b)};return{init:f}});
define('core/ajax', ["jquery","core/config","core/log","core/notification"],function(a,b,c,d){var e=!1,f=function(a){var b,c,d=this,e=null,f=0;if(a.error)for(;f<d.length;f++)b=d[f],b.deferred.reject(a);else{for(f=0;f<d.length;f++){if(b=d[f],c=a[f],"undefined"==typeof c){e=new Error("missing response");break}if(c.error!==!1){e=c.exception;break}b.deferred.resolve(c.data)}if(null!==e)for(;f<d.length;f++)b=d[f],b.deferred.reject(e)}},g=function(a,b,d){var f=this,g=0;for(g=0;g<f.length;g++){var h=f[g];e?(c.error("Page unloaded."),c.error(d)):h.deferred.reject(d)}};return{call:function(c,d,h){a(window).bind("beforeunload",function(){e=!0});var i,j=[],k=[],l=[],m="";for("undefined"==typeof h&&(h=!0),"undefined"==typeof d&&(d=!0),i=0;i<c.length;i++){var n=c[i];j.push({index:i,methodname:n.methodname,args:n.args}),n.deferred=a.Deferred(),k.push(n.deferred.promise()),"undefined"!=typeof n.done&&n.deferred.done(n.done),"undefined"!=typeof n.fail&&n.deferred.fail(n.fail),n.index=i,l.push(n.methodname)}m=l.length<=5?l.sort().join():l.length+"-method-calls",j=JSON.stringify(j);var o={type:"POST",data:j,context:c,dataType:"json",processData:!1,async:d,contentType:"application/json",headers:{"x-totara-sesskey":b.sesskey}},p="service.php";h||(p="service-nologin.php");var q=b.wwwroot+"/lib/ajax/"+p+"?info="+m;return d?a.ajax(q,o).done(f).fail(g):(o.success=f,o.error=g,a.ajax(q,o)),k},getData:function(a){var b=a.methodname+"_requesting_data",c="",e=this;return a.callback&&(c=a.callback,delete a.callback),M.util.js_pending(b),new Promise(function(f,g){var h=e.call([a],!0,!0);h[0].done(function(a){f({results:a,callbacks:c}),M.util.js_complete(b)}).fail(function(a){d.exception(a),g(a),M.util.js_complete(b)})})},getDataUpdate:function(a){var b=this;return new Promise(function(d,e){for(var f,g=[],h=0;h<a.length;h++)f=a[h],g.push(b.getData(f));Promise.all(g).then(function(a){var b,f,g,h,i,j=[];for(i=0;i<a.length;i++)for(h=a[i].results,g=a[i].callbacks,b=0;b<g.length;b++)f=g[b],"function"!=typeof f?c.error("Callback is not a function"):j.push(f(h));Promise.all(j).then(function(){d()})["catch"](function(){e()})})})}}});
define('core/autoinitialise', ["core/log"],function(a){var b="data-core-autoinitialise",c="data-core-autoinitialise-amd",d="true",e="initialising",f="done",g="error",h=function(){var h=Array.prototype.slice.apply(document.querySelectorAll("["+b+"="+d+"]")),i=function(c,d){a.error(d),c.setAttribute(b,g)},j=function(a){var d=a.getAttribute(c);return null===d?(i(a,'AMD module cannot be autoinitialised because "'+c+'" attribute is missing'),null):d.match(/^[a-zA-Z0-9\/_-]+$/g)?(a.setAttribute(b,e),{amdModule:d,element:a}):(i(a,'AMD module cannot be autoinitialised because "'+c+'" attribute is invalid'),null)},k=function(a){return new Promise(function(b){return a?void require([a.amdModule],function(c){a.js=c,b(a)},function(){i(a.element,'Failed to load AMD module "'+a.amdModule+'"'),b()}):void b()})},l=function(a){return new Promise(function(c){if(!a)return void c();if("undefined"==typeof a.js.init)return i(a.element,'AMD module "'+a.amdModule+'" cannot be autoinitialised because init method is missing'),void c();try{var d=a.js.init(a.element);d&&"function"==typeof d.then?d.then(function(){a.element.setAttribute(b,f),c()})["catch"](function(b){i(a.element,b),c()}):(a.element.setAttribute(b,f),c())}catch(e){i(a.element,'AMD module "'+a.amdModule+'" failed to autoinitialise'),c()}})};return Promise.all(h.map(j).map(k)).then(function(a){return Promise.all(a.map(l))})};return{scan:h}});
define('core/auto_rows', ["jquery"],function(a){var b={ELEMENT:"[data-auto-rows]"},c={ROW_CHANGE:"autorows:rowchange"},d=function(a){var b=a.attr("rows"),c=a.attr("data-max-rows"),d=a.height(),e=a.innerHeight(),f=e-d;a.height("1px");var g=a[0].scrollHeight,h=Math.ceil((g-f)/(d/b));return a.css("height",""),c&&h>=c?c:h},e=function(e){a(e).on("input propertychange",b.ELEMENT,function(b){var f=a(b.target),g=f.attr("rows"),h=d(f);h!=g&&(f.attr("rows",h),a(e).trigger(c.ROW_CHANGE))})};return{init:e,events:c}});
define('core/backoff_timer', function(){var a=function(a,b){this.callback=a,this.backOffFunction=b};return a.prototype.callback=null,a.prototype.backOffFunction=null,a.prototype.time=null,a.prototype.timeout=null,a.prototype.generateNextTime=function(){var a=this.backOffFunction(this.time);return this.time=a,a},a.prototype.reset=function(){return this.time=null,this.stop(),this},a.prototype.stop=function(){return this.timeout&&(window.clearTimeout(this.timeout),this.timeout=null),this},a.prototype.start=function(){if(!this.timeout){var a=this.generateNextTime();this.timeout=window.setTimeout(function(){this.callback(),this.stop(),this.start()}.bind(this),a)}return this},a.prototype.restart=function(){return this.reset().start()},a.getIncrementalCallback=function(a,b,c,d){return function(e){return e?e+b>c?d:e+b:a}},a});
define('core/blocks', ["jquery","core/templates"],function(a,b){var c={init:function(c){function d(a){a.preventDefault();var b=!f.hasClass("hidden");M.util.set_user_preference(c.preference,b),b?(f.addClass("hidden"),f.find(".block-hider-show").focus()):(f.removeClass("hidden"),f.find(".block-hider-hide").focus())}function e(a){a.preventDefault(),13==a.keyCode&&d(this)}var f=a("#"+c.id),g=f.find(".title"),h=f.find(".block_action"),i=h.data("collapsible");g&&h&&i&&(b.renderIcon("block-hide",c.tooltipVisible).done(function(b){var f=a('<a href="#" title="'+c.tooltipVisible+'" class="block-hider-hide" role="button" aria-expanded="true">'+b+"</a>");f.click(d),f.keypress(e),h.append(f)}),b.renderIcon("block-show",c.tooltipHidden).done(function(b){var f=a('<a href="#" title="'+c.tooltipHidden+'" class="block-hider-show" role="button" aria-expanded="false">'+b+"</a>");f.click(d),f.keypress(e),h.append(f)}))}};return c});
define('core/chartjs-plugin-doughnutlabel', [],function(){function a(a){"use strict";function b(b,c){if(c&&c.labels&&c.labels.length>0){var d=b.ctx,g=f.options.resolve,h=[];c.labels.forEach(function(f){var i="function"==typeof f.text?f.text(b):f.text,j={text:i,font:e.parseFont(g([f.font,c.font,{}],d,0)),color:g([f.color,c.color,a.defaults.global.defaultFontColor],d,0)};h.push(j)});var i=e.textSize(d,h),j=Math.sqrt(Math.pow(i.width,2)+Math.pow(i.height,2)),k=2*b.innerRadius,l=k/j;l<1&&(h.forEach(function(a){a.font.size=Math.floor(a.font.size*l),a.font.lineHeight=void 0,a.font=e.parseFont(g([a.font,{}],d,0))}),i=e.textSize(d,h)),d.textAlign="center",d.textBaseline="middle";var m,n=(b.chartArea.left+b.chartArea.right)/2,o=(b.chartArea.top+b.chartArea.bottom)/2,p=o-i.height/2,q=h.length,r=0;for(m=0;m<q;++m){d.fillStyle=h[m].color,d.font=h[m].font.string;var s=p+h[m].font.lineHeight/2+r;r+=h[m].font.lineHeight,d.fillText(h[m].text,n,s)}}}a=a&&a.hasOwnProperty("default")?a["default"]:a;var c={font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null}},d=a.helpers,e={parseFont:function(b){var c=a.defaults.global,f=d.valueOrDefault(b.size,c.defaultFontSize),g={family:d.valueOrDefault(b.family,c.defaultFontFamily),lineHeight:d.options.toLineHeight(b.lineHeight,f),size:f,style:d.valueOrDefault(b.style,c.defaultFontStyle),weight:d.valueOrDefault(b.weight,null),string:""};return g.string=e.toFontString(g),g},toFontString:function(a){return!a||d.isNullOrUndef(a.size)||d.isNullOrUndef(a.family)?null:(a.style?a.style+" ":"")+(a.weight?a.weight+" ":"")+a.size+"px "+a.family},textSize:function(a,b){var c,d=[].concat(b),e=d.length,f=a.font,g=0,h=0;for(c=0;c<e;++c)a.font=d[c].font.string,g=Math.max(a.measureText(d[c].text).width,g),h+=d[c].font.lineHeight;a.font=f;var i={height:h,width:g};return i}},f=a.helpers;a.defaults.global.plugins.doughnutlabel=c,a.plugins.register({id:"doughnutlabel",beforeDatasetDraw:function(a,c,d){b(a,d)}})}return{register:a}});
define('core/chartjs', ["core/chartjs-lazy","core/chartjs-plugin-doughnutlabel"],function(a,b){return b.register(a),a});
define('core/chart_axis', [],function(){function a(){}return a.prototype.POS_DEFAULT=null,a.prototype.POS_BOTTOM="bottom",a.prototype.POS_LEFT="left",a.prototype.POS_RIGHT="right",a.prototype.POS_TOP="top",a.prototype._label=null,a.prototype._labels=null,a.prototype._max=null,a.prototype._min=null,a.prototype._position=null,a.prototype._stepSize=null,a.prototype.create=function(b){var c=new a;return c.setPosition(b.position),c.setLabel(b.label),c.setStepSize(b.stepSize),c.setMax(b.max),c.setMin(b.min),c.setLabels(b.labels),c},a.prototype.getLabel=function(){return this._label},a.prototype.getLabels=function(){return this._labels},a.prototype.getMax=function(){return this._max},a.prototype.getMin=function(){return this._min},a.prototype.getPosition=function(){return this._position},a.prototype.getStepSize=function(){return this._stepSize},a.prototype.setLabel=function(a){this._label=a||null},a.prototype.setLabels=function(a){this._labels=a||null,null===this._labels||null!==this._stepSize||null!==this._min&&0!==this._min||null!==this._max||(this.setStepSize(1),this.setMin(0),this.setMax(a.length-1))},a.prototype.setMax=function(a){this._max="undefined"!=typeof a?a:null},a.prototype.setMin=function(a){this._min="undefined"!=typeof a?a:null},a.prototype.setPosition=function(a){if(a!=this.POS_DEFAULT&&a!=this.POS_BOTTOM&&a!=this.POS_LEFT&&a!=this.POS_RIGHT&&a!=this.POS_TOP)throw new Error("Invalid axis position.");this._position=a},a.prototype.setStepSize=function(a){if("undefined"==typeof a||null===a)a=null;else{if(isNaN(Number(a)))throw new Error("Value for stepSize is not a number.");a=Number(a)}this._stepSize=a},a});
define('core/chart_bar', ["core/chart_base"],function(a){function b(){a.prototype.constructor.apply(this,arguments)}return b.prototype=Object.create(a.prototype),b.prototype._horizontal=!1,b.prototype._stacked=!1,b.prototype.TYPE="bar",b.prototype.create=function(b,c){var d=a.prototype.create.apply(this,arguments);return d.setHorizontal(c.horizontal),d.setStacked(c.stacked),d},b.prototype._setDefaults=function(){a.prototype._setDefaults.apply(this,arguments);var b=this.getYAxis(0,!0);b.setMin(0)},b.prototype.getHorizontal=function(){return this._horizontal},b.prototype.getStacked=function(){return this._stacked},b.prototype.setHorizontal=function(a){var b=this.getXAxis(0,!0);null===b.getMin()&&b.setMin(0),this._horizontal=Boolean(a)},b.prototype.setStacked=function(a){this._stacked=Boolean(a)},b});
define('core/chart_base', ["core/chart_series","core/chart_axis"],function(a,b){function c(){this._series=[],this._labels=[],this._xaxes=[],this._yaxes=[],this._setDefaults()}return c.prototype._series=null,c.prototype._labels=null,c.prototype._title=null,c.prototype._xaxes=null,c.prototype._yaxes=null,c.prototype.COLORSET=["#f3c300","#875692","#f38400","#a1caf1","#be0032","#c2b280","#7f180d","#008856","#e68fac","#0067a5"],c.prototype._configColorSet=null,c.prototype.TYPE=null,c.prototype.addSeries=function(a){if(this._validateSeries(a),this._series.push(a),null===a.getColor()){var b=this.getConfigColorSet()||c.prototype.COLORSET;a.setColor(b[this._series.length%b.length])}},c.prototype.create=function(c,d){var e=new c;return e.setConfigColorSet(d.config_colorset),e.setLabels(d.labels),e.setTitle(d.title),d.series.forEach(function(b){e.addSeries(a.prototype.create(b))}),d.axes.x.forEach(function(a,c){e.setXAxis(b.prototype.create(a),c)}),d.axes.y.forEach(function(a,c){e.setYAxis(b.prototype.create(a),c)}),e},c.prototype.__getAxis=function(a,c,d){var e,f="x"===a?this._xaxes:this._yaxes,g=("x"===a?this.setXAxis:this.setYAxis).bind(this);if(c="undefined"==typeof c?0:c,d="undefined"!=typeof d&&d,e=f[c],"undefined"==typeof e){if(!d)throw new Error("Unknown axis.");e=new b,g(e,c)}return e},c.prototype.getConfigColorSet=function(){return this._configColorSet},c.prototype.getLabels=function(){return this._labels},c.prototype.getSeries=function(){return this._series},c.prototype.getTitle=function(){return this._title},c.prototype.getType=function(){if(!this.TYPE)throw new Error("The TYPE property has not been set.");return this.TYPE},c.prototype.getXAxes=function(){return this._xaxes},c.prototype.getXAxis=function(a,b){return this.__getAxis("x",a,b)},c.prototype.getYAxes=function(){return this._yaxes},c.prototype.getYAxis=function(a,b){return this.__getAxis("y",a,b)},c.prototype.setConfigColorSet=function(a){this._configColorSet=a},c.prototype._setDefaults=function(){},c.prototype.setLabels=function(a){if(a.length&&this._series.length&&this._series[0].length!=a.length)throw new Error("Series must match label values.");this._labels=a},c.prototype.setTitle=function(a){this._title=a},c.prototype.setXAxis=function(a,b){b="undefined"==typeof b?0:b,this._validateAxis("x",a,b),this._xaxes[b]=a},c.prototype.setYAxis=function(a,b){b="undefined"==typeof b?0:b,this._validateAxis("y",a,b),this._yaxes[b]=a},c.prototype._validateAxis=function(a,b,c){if(c="undefined"==typeof c?0:c,c>0){var d="x"==a?this._xaxes:this._yaxes;if("undefined"==typeof d[c-1])throw new Error("Missing "+a+" axis at index lower than "+c)}},c.prototype._validateSeries=function(a){if(this._series.length&&this._series[0].getCount()!=a.getCount())throw new Error("Series do not have an equal number of values.");if(this._labels.length&&this._labels.length!=a.getCount())throw new Error("Series must match label values.")},c});
define('core/chart_builder', ["jquery"],function(a){var b={make:function(b){var c=a.Deferred();return require(["core/chart_"+b.type],function(a){var d=a.prototype.create(a,b);c.resolve(d)}),c.promise()}};return b});
define('core/chart_line', ["core/chart_base"],function(a){function b(){a.prototype.constructor.apply(this,arguments)}return b.prototype=Object.create(a.prototype),b.prototype.TYPE="line",b.prototype._smooth=!1,b.prototype.create=function(b,c){var d=a.prototype.create.apply(this,arguments);return d.setSmooth(c.smooth),d},b.prototype.getSmooth=function(){return this._smooth},b.prototype.setSmooth=function(a){this._smooth=Boolean(a)},b});
define('core/chart_output', ["core/chart_output_chartjs"],function(a){var b=a;return b});
define('core/chart_output_base', ["jquery"],function(a){function b(b,c){this._node=a(b),this._chart=c}return b.prototype.update=function(){throw new Error("Not supported.")},b});
define('core/chart_output_chartjs', ["jquery","core/chartjs","core/chart_axis","core/chart_bar","core/chart_output_base","core/chart_line","core/chart_pie","core/chart_series"],function(a,b,c,d,e,f,g,h){function i(){e.prototype.constructor.apply(this,arguments),this._canvas=this._node,"CANVAS"!=this._canvas.prop("tagName")&&(this._canvas=a("<canvas>"),this._node.append(this._canvas)),this._build()}var j=function(a,b){return"axis-"+a+"-"+b};return i.prototype=Object.create(e.prototype),i.prototype._config=null,i.prototype._chartjs=null,i.prototype._canvas=null,i.prototype._build=function(){this._config=this._makeConfig(),this._chartjs=new b(this._canvas[0],this._config)},i.prototype._cleanData=function(b){return b instanceof Array?b.map(function(b){return a("<span>").html(b).text()}):a("<span>").html(b).text()},i.prototype._getChartType=function(){var a=this._chart.getType();return this._chart.getType()===d.prototype.TYPE&&this._chart.getHorizontal()===!0?a="horizontalBar":this._chart.getType()===g.prototype.TYPE&&this._chart.getDoughnut()===!0&&(a="doughnut"),a},i.prototype._makeAxisConfig=function(a,b,d){var e={id:j(b,d)};return a.getPosition()!==c.prototype.POS_DEFAULT&&(e.position=a.getPosition()),null!==a.getLabel()&&(e.scaleLabel={display:!0,labelString:this._cleanData(a.getLabel())}),null!==a.getStepSize()&&(e.ticks=e.ticks||{},e.ticks.stepSize=a.getStepSize()),null!==a.getMax()&&(e.ticks=e.ticks||{},e.ticks.max=a.getMax()),null!==a.getMin()&&(e.ticks=e.ticks||{},e.ticks.min=a.getMin()),e},i.prototype._makeConfig=function(){var a={type:this._getChartType(),data:{labels:this._cleanData(this._chart.getLabels()),datasets:this._makeDatasetsConfig()},options:{title:{display:null!==this._chart.getTitle(),text:this._cleanData(this._chart.getTitle())}}};return this._chart.getXAxes().forEach(function(b,c){var d=b.getLabels();a.options.scales=a.options.scales||{},a.options.scales.xAxes=a.options.scales.xAxes||[],a.options.scales.xAxes[c]=this._makeAxisConfig(b,"x",c),null!==d&&(a.options.scales.xAxes[c].ticks.callback=function(a,b){return d[b]||""}),a.options.scales.xAxes[c].stacked=this._isStacked()}.bind(this)),this._chart.getYAxes().forEach(function(b,c){var d=b.getLabels();a.options.scales=a.options.scales||{},a.options.scales.yAxes=a.options.scales.yAxes||[],a.options.scales.yAxes[c]=this._makeAxisConfig(b,"y",c),null!==d&&(a.options.scales.yAxes[c].ticks.callback=function(a){return d[parseInt(a,10)]||""}),a.options.scales.yAxes[c].stacked=this._isStacked()}.bind(this)),a.options.tooltips={callbacks:{label:this._makeTooltip.bind(this)}},a},i.prototype._makeDatasetsConfig=function(){var a=this._chart.getSeries().map(function(a){var b=a.hasColoredValues()?a.getColors():a.getColor(),c={label:this._cleanData(a.getLabel()),data:a.getValues(),type:a.getType(),fill:!1,backgroundColor:b,borderColor:this._chart.getType()==g.prototype.TYPE?"#fff":b,lineTension:this._isSmooth(a)?.3:0};return null!==a.getXAxis()&&(c.xAxisID=j("x",a.getXAxis())),null!==a.getYAxis()&&(c.yAxisID=j("y",a.getYAxis())),c}.bind(this));return a},i.prototype._makeTooltip=function(a,b){var c=this._chart.getSeries()[a.datasetIndex],d=c.getLabel(),e=c.getLabels(),f=b.datasets[a.datasetIndex].data,g=f[a.index],h=[];if(""==a.xLabel&&""==a.yLabel){var i=this._cleanData(this._chart.getLabels());h.push(i[a.index])}return null!==e?h.push(this._cleanData(e[a.index])):h.push(this._cleanData(d)+": "+g),h},i.prototype._isSmooth=function(a){var b=!1;return this._chart.getType()===f.prototype.TYPE?(b=a.getSmooth(),null===b&&(b=this._chart.getSmooth())):a.getType()===h.prototype.TYPE_LINE&&(b=a.getSmooth()),b},i.prototype._isStacked=function(){var a=!1;return this._chart.getType()===d.prototype.TYPE&&(a=this._chart.getStacked()),a},i.prototype.update=function(){a.extend(!0,this._config,this._makeConfig()),this._chartjs.update()},i});
define('core/chart_output_htmltable', ["jquery","core/chart_output_base"],function(a,b){function c(){b.prototype.constructor.apply(this,arguments),this._build()}return c.prototype=Object.create(b.prototype),c.prototype._build=function(){this._node.empty(),this._node.append(this._makeTable())},c.prototype._makeTable=function(){var b,c,d,e=a("<table>"),f=this._chart,g=f.getLabels(),h=g.length>0,i=f.getSeries(),j=i[0].getCount();e.addClass("chart-output-htmltable generaltable"),null!==f.getTitle()&&e.append(a("<caption>").text(f.getTitle())),b=a("<tr>"),h&&b.append(a("<td>")),i.forEach(function(c){b.append(a("<th>").text(c.getLabel()).attr("scope","col"))}),e.append(b);for(var k=0;k<j;k++){b=a("<tr>"),g.length>0&&b.append(a("<th>").text(g[k]).attr("scope","row"));for(var l=0;l<i.length;l++)c=i[l].getValues()[k],d=i[l].getLabels(),null!==d&&(c=i[l].getLabels()[k]),b.append(a("<td>").text(c));e.append(b)}return e},c.prototype.update=function(){this._build()},c});
define('core/chart_pie', ["core/chart_base"],function(a){function b(){a.prototype.constructor.apply(this,arguments)}return b.prototype=Object.create(a.prototype),b.prototype.TYPE="pie",b.prototype._doughnut=null,b.prototype.create=function(b,c){var d=a.prototype.create.apply(this,arguments);return d.setDoughnut(c.doughnut),d},b.prototype.addSeries=function(b){if(null===b.getColor()){for(var c=[],d=this.getConfigColorSet()||a.prototype.COLORSET,e=0;e<b.getCount();e++)c.push(d[e%d.length]);b.setColors(c)}return a.prototype.addSeries.apply(this,arguments)},b.prototype.getDoughnut=function(){return this._doughnut},b.prototype.setDoughnut=function(a){this._doughnut=Boolean(a)},b.prototype._validateSeries=function(){if(this._series.length>=1)throw new Error("Pie charts only support one serie.");return a.prototype._validateSeries.apply(this,arguments)},b});
define('core/chart_series', [],function(){function a(a,b){if("string"!=typeof a)throw new Error("Invalid label for series.");if("object"!=typeof b)throw new Error("Values for a series must be an array.");if(b.length<1)throw new Error("Invalid values received for series.");this._colors=[],this._label=a,this._values=b}return a.prototype.TYPE_DEFAULT=null,a.prototype.TYPE_LINE="line",a.prototype._colors=null,a.prototype._label=null,a.prototype._labels=null,a.prototype._smooth=!1,a.prototype._type=a.prototype.TYPE_DEFAULT,a.prototype._values=null,a.prototype._xaxis=null,a.prototype._yaxis=null,a.prototype.create=function(b){var c=new a(b.label,b.values);return c.setType(b.type),c.setXAxis(b.axes.x),c.setYAxis(b.axes.y),c.setLabels(b.labels),b.colors&&b.colors.length>1?c.setColors(b.colors):c.setColor(b.colors[0]),c.setSmooth(b.smooth),c},a.prototype.getColor=function(){return this._colors[0]||null},a.prototype.getColors=function(){return this._colors},a.prototype.getCount=function(){return this._values.length},a.prototype.getLabel=function(){return this._label},a.prototype.getLabels=function(){return this._labels},a.prototype.getSmooth=function(){return this._smooth},a.prototype.getType=function(){return this._type},a.prototype.getValues=function(){return this._values},a.prototype.getXAxis=function(){return this._xaxis},a.prototype.getYAxis=function(){return this._yaxis},a.prototype.hasColoredValues=function(){return this._colors.length==this.getCount()},a.prototype.setColor=function(a){this._colors=[a]},a.prototype.setColors=function(a){if(a&&a.length!=this.getCount())throw new Error("When setting multiple colors there must be one per value.");this._colors=a||[]},a.prototype.setLabels=function(a){this._validateLabels(a),a="undefined"==typeof a?null:a,this._labels=a},a.prototype.setSmooth=function(a){a="undefined"==typeof a?null:a,this._smooth=a},a.prototype.setType=function(a){if(a!=this.TYPE_DEFAULT&&a!=this.TYPE_LINE)throw new Error("Invalid serie type.");this._type=a||null},a.prototype.setXAxis=function(a){this._xaxis=a||null},a.prototype.setYAxis=function(a){this._yaxis=a||null},a.prototype._validateLabels=function(a){if(a&&a.length>0&&a.length!=this.getCount())throw new Error("Series labels must match series values.")},a});
define('core/config', function(){return M.cfg});
define('core/custom_interaction_events', ["jquery","core/key_codes"],function(a,b){var c={activate:"cie:activate",keyboardActivate:"cie:keyboardactivate",escape:"cie:escape",down:"cie:down",up:"cie:up",home:"cie:home",end:"cie:end",next:"cie:next",previous:"cie:previous",asterix:"cie:asterix",scrollLock:"cie:scrollLock",scrollTop:"cie:scrollTop",scrollBottom:"cie:scrollBottom",ctrlPageUp:"cie:ctrlPageUp",ctrlPageDown:"cie:ctrlPageDown",enter:"cie:enter"},d=function(a,b){return b=b||[],!(!b.length||b.indexOf(a)===-1)},e=function(a){return a.shiftKey||a.metaKey||a.altKey||a.ctrlKey},f=function(b,c,d){b.off("keydown."+c).on("keydown."+c,function(b){if(!e(b)&&b.keyCode==d){a(b.target).trigger(c,[{originalEvent:b}]);var f=b.target.tagName.toLowerCase();"input"!==f&&"select"!==f&&"textarea"!==f&&"a"!==f&&b.preventDefault()}})},g=function(d){d.off("click.cie.activate").on("click.cie.activate",function(b){a(b.target).trigger(c.activate,[{originalEvent:b}])}),d.off("keydown.cie.activate").on("keydown.cie.activate",function(d){if(!e(d)&&(d.keyCode==b.enter||d.keyCode==b.space)){a(d.target).trigger(c.activate,[{originalEvent:d}]);var f=d.target.tagName.toLowerCase();"input"!==f&&"select"!==f&&"textarea"!==f&&"a"!==f&&d.preventDefault()}})},h=function(d){d.off("keydown.cie.keyboardactivate").on("keydown.cie.keyboardactivate",function(d){if(!e(d)&&(d.keyCode==b.enter||d.keyCode==b.space)){a(d.target).trigger(c.keyboardActivate,[{originalEvent:d}]);var f=d.target.tagName.toLowerCase();"input"!==f&&"select"!==f&&"textarea"!==f&&"a"!==f&&d.preventDefault()}})},i=function(a){f(a,c.escape,b.escape)},j=function(a){f(a,c.down,b.arrowDown)},k=function(a){f(a,c.up,b.arrowUp)},l=function(a){f(a,c.home,b.home)},m=function(a){f(a,c.end,b.end)},n=function(d){var e="rtl"==a("html").attr("dir")?b.arrowLeft:b.arrowRight;f(d,c.next,e)},o=function(d){var e="rtl"==a("html").attr("dir")?b.arrowRight:b.arrowLeft;f(d,c.previous,e)},p=function(a){f(a,c.asterix,b.asterix)},q=function(a){a.off("scroll.cie.scrollTop").on("scroll.cie.scrollTop",function(b){var d=a.scrollTop();0===d&&a.trigger(c.scrollTop,[{originalEvent:b}])})},r=function(a){a.off("scroll.cie.scrollBottom").on("scroll.cie.scrollBottom",function(b){var d=a.scrollTop(),e=a.innerHeight(),f=a[0].scrollHeight;d+e>=f&&a.trigger(c.scrollBottom,[{originalEvent:b}])})},s=function(a){a.off("DOMMouseScroll.cie.DOMMouseScrollLock mousewheel.cie.mousewheelLock").on("DOMMouseScroll.cie.DOMMouseScrollLock mousewheel.cie.mousewheelLock",function(b){var d=a.scrollTop(),e=a[0].scrollHeight,f=a.height(),g="DOMMouseScroll"==b.type?b.originalEvent.detail*-40:b.originalEvent.wheelDelta,h=g>0;return!h&&-g>e-f-d?(a.scrollTop(e),b.stopPropagation(),b.preventDefault(),b.returnValue=!1,a.trigger(c.scrollLock,[{originalEvent:b}]),!1):!(h&&g>d)||(a.scrollTop(0),b.stopPropagation(),b.preventDefault(),b.returnValue=!1,a.trigger(c.scrollLock,[{originalEvent:b}]),!1)})},t=function(d){d.off("keydown.cie.ctrlpageup").on("keydown.cie.ctrlpageup",function(d){d.ctrlKey&&d.keyCode==b.pageUp&&a(d.target).trigger(c.ctrlPageUp,[{originalEvent:d}])})},u=function(d){d.off("keydown.cie.ctrlpagedown").on("keydown.cie.ctrlpagedown",function(d){d.ctrlKey&&d.keyCode==b.pageDown&&a(d.target).trigger(c.ctrlPageDown,[{originalEvent:d}])})},v=function(a){f(a,c.enter,b.enter)},w=function(){var a={};return a[c.activate]=g,a[c.keyboardActivate]=h,a[c.escape]=i,a[c.down]=j,a[c.up]=k,a[c.home]=l,a[c.end]=m,a[c.next]=n,a[c.previous]=o,a[c.asterix]=p,a[c.scrollLock]=s,a[c.scrollTop]=q,a[c.scrollBottom]=r,a[c.ctrlPageUp]=t,a[c.ctrlPageDown]=u,a[c.enter]=v,a},x=function(b,c){b=a(b),c=c||[],b.length&&c.length&&a.each(w(),function(a,e){d(a,c)&&e(b)})};return{define:x,events:c}});
define('core/event', ["jquery","core/yui"],function(a,b){return{Events:{FORM_FIELD_VALIDATION:"core_form-field-validation"},getLegacyEvents:function(){var c=a.Deferred();return b.use("event","moodle-core-event",function(){c.resolve(window.M.core.event)}),c.promise()},notifyFilterContentUpdated:function(c){c=a(c),b.use("event","moodle-core-event",function(b){a(document).trigger(M.core.event.FILTER_CONTENT_UPDATED,[c]);var d=new b.NodeList(c.get());b.fire(M.core.event.FILTER_CONTENT_UPDATED,{nodes:d})})},notifyEditorContentRestored:function(){b.use("event","moodle-core-event",function(b){a(document).trigger(M.core.event.EDITOR_CONTENT_RESTORED),b.fire(M.core.event.EDITOR_CONTENT_RESTORED)})}}});
define('core/first', ["core/log"],function(a){a.debug("core/first amd module is obsolete, do not use it any more")});
define('core/flex_icon', ["jquery","core/config","core/localstorage","core/ajax"],function(a,b,c,d){var e=!1,f=!1,g=null,h=function(){var h="core_flex_icon/"+b.theme+"/cache",i=a.Deferred();e=!0,g=i.promise();var j=c.get(h);j?(f=JSON.parse(j),i.resolve()):a.when.apply(this,d.call([{methodname:"core_output_get_flex_icons",args:{themename:b.theme}}],!0,!1)).done(function(a){c.set(h,JSON.stringify(a)),f=a,i.resolve()})},i={getFlexTemplateData:function(b){var c=a.Deferred(),d=c.promise(),e=function(){var a=i.getFlexTemplateDataSync(b);return null===a?void c.reject():void c.resolve(a)};return g.done(e),d},getFlexTemplateDataSync:function(a){if(!f)throw new Error("Icon data has not yet been loaded. Call load() and wait for it to resolve before calling this function.");if(!f.icons.hasOwnProperty(a))return null;var b=f.icons[a],c={data:Object.assign({},f.datas[b[1]],{identifier:a}),template:f.templates[b[0]]};return c},getIconData:function(c,d,e){var f,g=a.Deferred(),h=g.promise(),i=this;"undefined"==typeof e&&(e={}),d&&"moodle"!==d&&"core"!==d?f=d+"|"+c:(f=c,d="core"),"undefined"==typeof e.title&&"undefined"!=typeof e.alt&&(e.title=e.alt);var j=function(a){a.data.customdata=e,g.resolve({context:a.data,template:a.template})},k=function(){var a=[],f="";for(var h in e)"class"===h&&e.hasOwnProperty(h)?f=e[h]:e.hasOwnProperty(h)&&a.push({name:h,value:e[h]});var i=b.wwwroot+"/theme/image.php";i+=b.themerev>0&&1==b.slasharguments?"/"+b.theme+"/"+d+"/"+b.themerev+"/"+c:"?theme="+b.theme+"&component="+d+"&rev="+b.themerev+"&image="+c,a.push({name:"src",value:i}),g.resolve({template:"core/pix_icon",context:{attributes:a,extraclasses:f}})};return this.getFlexTemplateData(f).then(j).fail(function(){f===d+"|"+c?k():(f=d+"|"+c,i.getFlexTemplateData(f).then(j).fail(k))}),h},load:function(){return Promise.resolve(g)}};return e||h(),i});
define('core/form-autocomplete', ["jquery","core/log","core/str","core/templates","core/notification"],function(a,b,c,d,e){var f={DOWN:40,ENTER:13,SPACE:32,ESCAPE:27,COMMA:44,UP:38},g={},h=0,h=Date.now(),i=function(b,c){var d=a(document.getElementById(c.selectionId)),e=d.children("[aria-selected=true]").length;for(b%=e;b<0;)b+=e;var f=a(d.children("[aria-selected=true]").get(b)),g=c.selectionId+"-"+b;d.children().attr("data-active-selection",!1).attr("id",""),f.attr("data-active-selection",!0).attr("id",g),d.attr("aria-activedescendant",g)},j=function(b,c,f){var g=[],h=a(document.getElementById(c.selectionId)),j=h.attr("aria-activedescendant"),k=!1;j&&(k=a(document.getElementById(j)).attr("data-value")),f.children("option").each(function(b,c){a(c).prop("selected")&&g.push({label:a(c).html(),value:a(c).attr("value")})});var l=a.extend({items:g},b,c);d.render("core/form_autocomplete_selection",l).done(function(b){h.empty().append(a(b).html()),k!==!1&&h.children("[aria-selected=true]").each(function(b,d){a(d).attr("data-value")===k&&i(b,c)})}).fail(e.exception)},k=function(a){"undefined"!=typeof M.core_formchangechecker&&M.core_formchangechecker.set_form_changed(),a.change()},l=function(b,c,d,e){var f=a(d).attr("data-value");b.multiple&&e.children("option").each(function(b,c){a(c).attr("value")==f&&(a(c).prop("selected",!1),a(c).attr("data-iscustom")&&a(c).remove())}),j(b,c,e),k(e)},m=function(b,c){var d=a(document.getElementById(c.inputId)),e=a(document.getElementById(c.suggestionsId)),f=e.children("[aria-hidden=false]").length;for(b%=f;b<0;)b+=f;var g=a(e.children("[aria-hidden=false]").get(b)),h=a(e.children("[role=option]")).index(g),i=c.suggestionsId+"-"+h;e.children().attr("aria-selected",!1).attr("id",""),g.attr("aria-selected",!0).attr("id",i),d.attr("aria-activedescendant",i);var j=g.offset().top-e.offset().top+e.scrollTop()-e.height()/2;e.animate({scrollTop:j},100)},n=function(b){var c=a(document.getElementById(b.suggestionsId)),d=c.children("[aria-selected=true]"),e=c.children("[aria-hidden=false]").index(d);m(e+1,b)},o=function(b){var c=a(document.getElementById(b.selectionId)),d=c.children("[data-active-selection=true]");if(!d)return void i(0,b);var e=c.children("[aria-selected=true]").index(d);i(e-1,b)},p=function(b){var c=a(document.getElementById(b.selectionId)),d=c.children("[data-active-selection=true]");if(!d)return void i(0,b);var e=c.children("[aria-selected=true]").index(d);i(e+1,b)},q=function(b){var c=a(document.getElementById(b.suggestionsId)),d=c.children("[aria-selected=true]"),e=c.children("[aria-hidden=false]").index(d);m(e-1,b)},r=function(b){var c=a(document.getElementById(b.inputId)),d=a(document.getElementById(b.suggestionsId));c.attr("aria-expanded",!1).attr("aria-activedescendant",b.selectionId),d.hide().attr("aria-hidden",!0)},s=function(b,f,g,h){var i=a(document.getElementById(f.inputId)),j=a(document.getElementById(f.suggestionsId)),k=!1,l=[];h.children("option").each(function(b,c){a(c).prop("selected")!==!0&&(l[l.length]={label:c.innerHTML,value:a(c).attr("value")})});var n=f.caseSensitive?g:g.toLocaleLowerCase(),o=a.extend({options:l},b,f);i.data("autocomplete-query",g),d.render("core/form_autocomplete_suggestions",o).done(function(d){i.data("autocomplete-query")===g&&(j.replaceWith(d),j=a(document.getElementById(f.suggestionsId)),j.show().attr("aria-hidden",!1),j.children().each(function(c,d){d=a(d),b.caseSensitive&&d.text().indexOf(n)>-1||!b.caseSensitive&&d.text().toLocaleLowerCase().indexOf(n)>-1?(d.show().attr("aria-hidden",!1),k=!0):d.hide().attr("aria-hidden",!0)}),i.attr("aria-expanded",!0),k?b.tags||m(0,f):c.get_string("nosuggestions","form").done(function(a){i.data("autocomplete-query")===g&&j.html(a)}))}).fail(e.exception)},t=function(b,c,d){var e=a(document.getElementById(c.inputId)),f=e.val(),g=f.split(","),h=!1;a.each(g,function(c,e){if(e=e.trim(),""!==e&&(b.multiple||d.children("option").prop("selected",!1),d.children("option").each(function(b,c){a(c).attr("value")==e&&(h=!0,a(c).prop("selected",!0))}),!h)){var f=a("<option>");f.append(document.createTextNode(e)),f.attr("value",e),d.append(f),f.prop("selected",!0),f.attr("data-iscustom",!0)}}),j(b,c,d),k(d),e.val(""),r(c)},u=function(b,c,d){var e=a(document.getElementById(c.inputId)),f=a(document.getElementById(c.suggestionsId)),g=f.children("[aria-selected=true]").attr("data-value");b.multiple||d.children("option").prop("selected",!1),d.children("option").each(function(b,c){a(c).attr("value")==g&&a(c).prop("selected",!0)}),j(b,c,d),k(d),e.val(""),r(c)},v=function(b,c,d,f,h){var i="form-autocomplete-updateajax";M.util.js_pending(i);var j=a(b.currentTarget).val();g[c.selector]=j,h.transport(c.selector,j,function(b){if(g[c.selector]===j){var e=h.processResults(c.selector,b),k=[];if(f.children("option").each(function(b,c){c=a(c),c.prop("selected")?k.push(String(c.attr("value"))):c.remove()}),!c.multiple&&0===f.children("option").length){var l=a("<option>");f.append(l)}a.each(e,function(b,c){if(k.indexOf(String(c.value))===-1){var d=a("<option>");d.append(c.label),d.attr("value",c.value),f.append(d)}}),s(c,d,"",f),M.util.js_complete(i)}},function(a){M.util.js_complete(i),e.exception(a)})},w=function(b,c,d){var e=a(document.getElementById(c.inputId));if(e.on("keydown",function(g){var h="form-autocomplete-addnav-"+c.inputId+"-"+g.keyCode;switch(M.util.js_pending(h),g.keyCode){case f.DOWN:return b.showSuggestions?("true"===e.attr("aria-expanded")?n(c):!e.val()&&b.ajax?require([b.ajax],function(a){v(g,b,c,d,a)}):s(b,c,e.val(),d),g.preventDefault(),M.util.js_complete(h),!1):(M.util.js_complete(h),!0);case f.UP:return q(c),g.preventDefault(),M.util.js_complete(h),!1;case f.ENTER:var i=a(document.getElementById(c.suggestionsId));return"true"===e.attr("aria-expanded")&&i.children("[aria-selected=true]").length>0?u(b,c,d):b.tags&&t(b,c,d),g.preventDefault(),M.util.js_complete(h),!1;case f.ESCAPE:return"true"===e.attr("aria-expanded")&&r(c),g.preventDefault(),M.util.js_complete(h),!1}return M.util.js_complete(h),!0}),e.on("keypress",function(a){var e="form-autocomplete-keypress-"+a.keyCode;return M.util.js_pending(e),a.keyCode===f.COMMA?(b.tags&&t(b,c,d),a.preventDefault(),M.util.js_complete(e),!1):(M.util.js_complete(e),!0)}),e.on("behat:set-value",function(){var f=a(document.getElementById(c.suggestionsId)),g="form-autocomplete-behat";M.util.js_pending(g),"true"===e.attr("aria-expanded")&&f.children("[aria-selected=true]").length>0?u(b,c,d):b.tags&&t(b,c,d),M.util.js_complete(g)}),e.on("blur",function(){var f="form-autocomplete-blur";M.util.js_pending(f),window.setTimeout(function(){var g=a(document.activeElement);g.attr("id")!=e.attr("id")&&(b.tags&&t(b,c,d),r(c)),M.util.js_complete(f)},500)}),b.showSuggestions){var g=a(document.getElementById(c.downArrowId));g.on("click",function(a){var f="form-autocomplete-show-suggestions";M.util.js_pending(f),e.focus(),!e.val()&&b.ajax?require([b.ajax],function(e){v(a,b,c,d,e)}):s(b,c,e.val(),d),M.util.js_complete(f)})}var h=a(document.getElementById(c.suggestionsId));h.parent().on("click","[role=option]",function(e){var f="form-autocomplete-parent";M.util.js_pending(f);var g=a(e.currentTarget).closest("[role=option]"),h=a(document.getElementById(c.suggestionsId)),i=h.children("[aria-hidden=false]").index(g);m(i,c),u(b,c,d),M.util.js_complete(f)});var i=a(document.getElementById(c.selectionId));i.on("click","[role=listitem]",function(e){var f="form-autocomplete-clicks";M.util.js_pending(f);var g=a(e.currentTarget);l(b,c,g,d),M.util.js_complete(f)}),i.on("keydown",function(e){var g="form-autocomplete-keydown-"+e.keyCode;switch(M.util.js_pending(g),e.keyCode){case f.DOWN:return p(c),e.preventDefault(),M.util.js_complete(g),!1;case f.UP:return o(c),e.preventDefault(),M.util.js_complete(g),!1;case f.SPACE:case f.ENTER:var h=a(document.getElementById(c.selectionId)).children("[data-active-selection=true]");return h&&(l(b,c,h,d),e.preventDefault()),M.util.js_complete(g),!1}return M.util.js_complete(g),!0}),b.showSuggestions&&(b.ajax?require([b.ajax],function(a){var f=null,g="autocomplete-throttledhandler",h=function(e){v(e,b,c,d,a),M.util.js_complete(g)},i=function(a){null!==f?(window.clearTimeout(f),f=null):M.util.js_pending(g),f=window.setTimeout(h.bind(this,a),300)};e.on("input",i)}):e.on("input",function(e){var f=a(e.currentTarget).val(),g=a(e.currentTarget).data("last-value");g!==f&&s(b,c,f,d),a(e.currentTarget).data("last-value",f)}))};return{enhance:function(f,g,i,k,l,m,n){var o={selector:f,tags:!1,ajax:!1,placeholder:k,caseSensitive:!1,showSuggestions:!0,noSelectionString:n},p="autocomplete-setup-"+f;M.util.js_pending(p),"undefined"!=typeof g&&(o.tags=g),"undefined"!=typeof i&&(o.ajax=i),"undefined"!=typeof l&&(o.caseSensitive=l),"undefined"!=typeof m&&(o.showSuggestions=m),"undefined"==typeof n&&c.get_string("noselection","form").done(function(a){o.noSelectionString=a}).fail(e.exception);var q=a(f);if(!q)return b.debug("Selector not found: "+f),void M.util.js_complete(p);q.hide().attr("aria-hidden",!0);var r={selectId:q.attr("id"),inputId:"form_autocomplete_input-"+h,suggestionsId:"form_autocomplete_suggestions-"+h,selectionId:"form_autocomplete_selection-"+h,downArrowId:"form_autocomplete_downarrow-"+h};h++,o.multiple=q.attr("multiple");var s=a("[for="+r.selectId+"]"),t=[];q.children("option").each(function(b,c){t[b]={label:c.innerHTML,value:a(c).attr("value")}});var u=a.extend({},o,r);u.options=t,u.items=[];var v=d.render("core/form_autocomplete_input",u),x=d.render("core/form_autocomplete_suggestions",u),y=d.render("core/form_autocomplete_selection",u);a.when(v,x,y).done(function(b,c,d){q.after(c),q.after(b),q.after(d),s.attr("for",r.inputId),w(o,r,q);var e=a(document.getElementById(r.suggestionsId));return e.hide().attr("aria-hidden",!0),j(o,r,q),M.util.js_complete(p),!0}).fail(function(a){M.util.js_complete(p),e.exception(a)})}}});
define('core/form-course-selector', ["core/ajax","jquery"],function(a,b){return{processResults:function(a,c){var d=[],e=0,f=String(b(a).data("exclude")).split(",");for(e=0;e<c.courses.length;e++)f.indexOf(String(c.courses[e].id))===-1&&d.push({value:c.courses[e].id,label:c.courses[e].displayname});return d},transport:function(c,d,e,f){var g=b(c),h=g.data("requiredcapabilities");h=""!==h.trim()?h.split(","):[];var i=g.data("limittoenrolled"),j=g.data("includefrontpage"),k=null;"undefined"==typeof d&&(d="");var l={criterianame:"search",criteriavalue:d,page:0,perpage:100,requiredcapabilities:h,limittoenrolled:i},m=[{methodname:"core_course_search_courses",args:l}];j&&m.push({methodname:"core_course_get_courses",args:{options:{ids:[j]}}}),k=a.call(m),b.when.apply(b.when,k).done(function(a,b){if(b&&1==b.length){var c=b.pop(),f=""===d||c.fullname.toUpperCase().indexOf(d.toUpperCase())>-1||c.shortname.toUpperCase().indexOf(d.toUpperCase())>-1;f&&a.courses.splice(0,0,c)}e(a)}).fail(f)}}});
define('core/form_duplicate_prevent', [],function(){function a(a){return b?void a.preventDefault():void(b=!0)}var b=!1;return{init:function(b){return b.addEventListener("submit",a),Promise.resolve()},reset:function(){b=!1}}});
define('core/fragment', ["jquery","core/ajax"],function(a,b){var c=function(a,c,d,e){var f=[];for(var g in e)f.push({name:g,value:e[g]});return b.call([{methodname:"core_get_fragment",args:{component:a,callback:c,contextid:d,args:f}}])[0]};return{loadFragment:function(b,d,e,f){var g=a.Deferred();return c(b,d,e,f).then(function(b){var c=a(b.javascript),d="";c.each(function(b,c){c=a(c);var e=c.prop("tagName");if(e&&"script"==e.toLowerCase())if(c.attr("src")){var f=!1;a("script").each(function(b,d){return a(d).attr("src")==c.attr("src")&&(f=!0),!f}),f||(d+=" { ",d+=' node = document.createElement("script"); ',d+=' node.type = "text/javascript"; ',d+=' node.src = decodeURI("'+encodeURI(c.attr("src"))+'"); ',d+=' document.getElementsByTagName("head")[0].appendChild(node); ',d+=" } ")}else d+=" "+c.text()}),g.resolve(b.html,d)}).fail(function(a){g.reject(a)}),g.promise()}}});
define('core/inplace_editable', ["jquery","core/ajax","core/templates","core/notification","core/str","core/config","core/flex_icon"],function(a,b,c,d,e,f,g){return a("body").on("click keypress","[data-inplaceeditable] [data-inplaceeditablelink]",function(h){if("keypress"!==h.type||13===h.keyCode){h.stopImmediatePropagation(),h.preventDefault();var i=a(this),j=i.closest("[data-inplaceeditable]"),k=function(b){b.addClass("updating");var d=b.find(".icon-spinner");d.length?d.show():(d=a('<span class="icon-spinner"/>'),e.get_string("loading","admin").then(function(a){return c.renderIcon("loading",{alt:a})}).then(function(a){d&&d.prepend(a)}),b.append(d))},l=function(a){a.removeClass("updating"),a.find(".icon-spinner").hide()},m=function(e,f){var h=[e.attr("data-itemid"),e.attr("data-component"),e.attr("data-itemtype")].join("-");M.util.js_pending(h),k(e),b.call([{methodname:"core_update_inplace_editable",args:{itemid:e.attr("data-itemid"),component:e.attr("data-component"),itemtype:e.attr("data-itemtype"),value:f},done:function(b){var d=e.attr("data-value");g.getIconData("t/editstring","core",{alt:b.edithint}).then(function(a){return b.icon=a,c.render("core/inplace_editable",b)}).then(function(f,g){var i=a(f);c.replaceNode(e,i,g),i.find("[data-inplaceeditablelink]").focus(),i.trigger({type:"updated",ajaxreturn:b,oldvalue:d}),M.util.js_complete(h)})},fail:function(b){var c=a.Event("updatefailed",{exception:b,newvalue:f});l(e),M.util.js_complete(h),e.trigger(c),c.isDefaultPrevented()||d.exception(b)}}],!0)},n=function(a){a.find("input").off(),a.find("select").off(),a.html(a.attr("data-oldcontent")),a.removeAttr("data-oldcontent"),a.removeClass("inplaceeditingon"),a.find("[data-inplaceeditablelink]").focus()},o=function(){a("span.inplaceeditable.inplaceeditingon").each(function(){n(a(this))})},p=function(b,c){var d,e=b;for(d=0;d<c;d++)e+=String(Math.floor(10*Math.random()));return 0===a("#"+e).length?e:p(b,c)},q=function(b){e.get_string("edittitleinstructions").done(function(c){var d=a('<span class="editinstructions">'+c+"</span>").attr("id",p("id_editinstructions_",20)),e=a('<input type="text"/>').attr("id",p("id_inplacevalue_",20)).attr("value",b.attr("data-value")).attr("aria-describedby",d.attr("id")).addClass("ignoredirty").addClass("form-control"),g=a('<label class="accesshide">'+j.attr("data-editlabel")+"</label>").attr("for",e.attr("id"));b.html("").append(d).append(g).append(e),e.focus(),e.select(),e.on("keyup keypress focusout",function(a){if(!f.behatsiterunning||"focusout"!==a.type){if("keypress"===a.type&&13===a.keyCode){var c=e.val();n(b),m(b,c)}("keyup"===a.type&&27===a.keyCode||"focusout"===a.type)&&n(b)}})})},r=function(a,b){n(a),m(a,b)},s=function(b,c){var d,e=a("<select></select>").attr("id",p("id_inplacevalue_",20)).addClass("custom-select"),g=a('<label class="accesshide">'+j.attr("data-editlabel")+"</label>").attr("for",e.attr("id"));for(d in c)e.append(a("<option>").attr("value",c[d].key).html(c[d].value));e.val(b.attr("data-value")),b.html("").append(g).append(e),e.focus(),e.select(),e.on("keyup change focusout",function(a){if(!f.behatsiterunning||"focusout"!==a.type){if("change"===a.type){var c=e.val();n(b),m(b,c)}("keyup"===a.type&&27===a.keyCode||"focusout"===a.type)&&n(b)}})},t=function(b){b.addClass("inplaceeditingon"),b.attr("data-oldcontent",b.html());var c=b.attr("data-type"),d=b.attr("data-options");"toggle"===c?r(b,d):"select"===c?s(b,a.parseJSON(d)):q(b)};o(),t(j)}}),{}});
define('core/jqueryajaxhandler', ["core/str"],function(a){var b={success:function(a){a.responseJSON&&a.responseJSON.error&&YUI().use("moodle-core-notification-ajaxexception",function(){return new M.core.ajaxException(a.responseJSON).show()})},error:function(b,c){if("abort"!==b.statusText&&(0!==b.status||0!==b.readyState||"error"!==b.statusText)){var d=[];d.push({key:"accessdenied",component:"admin"}),d.push({key:"resourcenotfound",component:"admin"}),d.push({key:"unknownerror",component:"core"}),a.get_strings(d).done(function(a){for(var e=[],f=0;f<d.length;f++)e[d[f].key]=a[f];var g={debugginginfo:"",error:"",reproductionlink:"",stacktrace:""};b.hasOwnProperty("status")&&403===b.status?g.error=e.accessdenied:b.hasOwnProperty("status")&&404===b.status?g.error=e.resourcenotfound:g.error=e.unknownerror,c.hasOwnProperty("url")&&"string"==typeof c.url&&(g.reproductionlink=c.url),b.hasOwnProperty("stacktrace")&&"string"==typeof b.stacktrace&&(g.stacktrace=c.stacktrace),YUI().use("moodle-core-notification-ajaxexception",function(){return new M.core.ajaxException(g).show()})})}}};return b});
define('core/key_codes', function(){return{tab:9,enter:13,escape:27,space:32,end:35,home:36,arrowLeft:37,arrowUp:38,arrowRight:39,arrowDown:40,8:56,asterix:106,pageUp:33,pageDown:34}});
define('core/localstorage', ["core/config","core/storagewrapper"],function(a,b){var c=new b(window.localStorage);return{get:function(a){return c.get(a)},set:function(a,b){return c.set(a,b)}}});
define('core/log', ["core/loglevel"],function(a){var b=a.methodFactory;return a.methodFactory=function(a,c){var d=b(a,c);return function(a,b){d(b?b+": "+a:a)}},a.setConfig=function(b){"undefined"!=typeof b.level&&a.setLevel(b.level)},a});
!function(a,b){"use strict";"function"==typeof define&&define.amd?define('core/loglevel', b):"object"==typeof module&&module.exports?module.exports=b():a.log=b()}(this,function(){"use strict";function a(a,b){var c=a[b];if("function"==typeof c.bind)return c.bind(a);try{return Function.prototype.bind.call(c,a)}catch(d){return function(){return Function.prototype.apply.apply(c,[a,arguments])}}}function b(b){return"debug"===b&&(b="log"),typeof console!==h&&(void 0!==console[b]?a(console,b):void 0!==console.log?a(console,"log"):g)}function c(a,b){for(var c=0;c<i.length;c++){var d=i[c];this[d]=c<a?g:this.methodFactory(d,a,b)}this.log=this.debug}function d(a,b,d){return function(){typeof console!==h&&(c.call(this,b,d),this[a].apply(this,arguments))}}function e(a,c,e){return b(a)||d.apply(this,arguments)}function f(a,b,d){function f(a){var b=(i[a]||"silent").toUpperCase();if(typeof window!==h){try{return void(window.localStorage[l]=b)}catch(c){}try{window.document.cookie=encodeURIComponent(l)+"="+b+";"}catch(c){}}}function g(){var a;if(typeof window!==h){try{a=window.localStorage[l]}catch(b){}if(typeof a===h)try{var c=window.document.cookie,d=c.indexOf(encodeURIComponent(l)+"=");d!==-1&&(a=/^([^;]+)/.exec(c.slice(d))[1])}catch(b){}return void 0===k.levels[a]&&(a=void 0),a}}var j,k=this,l="loglevel";a&&(l+=":"+a),k.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},k.methodFactory=d||e,k.getLevel=function(){return j},k.setLevel=function(b,d){if("string"==typeof b&&void 0!==k.levels[b.toUpperCase()]&&(b=k.levels[b.toUpperCase()]),!("number"==typeof b&&b>=0&&b<=k.levels.SILENT))throw"log.setLevel() called with invalid level: "+b;if(j=b,d!==!1&&f(b),c.call(k,b,a),typeof console===h&&b<k.levels.SILENT)return"No console available for logging"},k.setDefaultLevel=function(a){g()||k.setLevel(a,!1)},k.enableAll=function(a){k.setLevel(k.levels.TRACE,a)},k.disableAll=function(a){k.setLevel(k.levels.SILENT,a)};var m=g();null==m&&(m=null==b?"WARN":b),k.setLevel(m,!1)}var g=function(){},h="undefined",i=["trace","debug","info","warn","error"],j=new f,k={};j.getLogger=function(a){if("string"!=typeof a||""===a)throw new TypeError("You must supply a name when creating a logger.");var b=k[a];return b||(b=k[a]=new f(a,j.getLevel(),j.methodFactory)),b};var l=typeof window!==h?window.log:void 0;return j.noConflict=function(){return typeof window!==h&&window.log===j&&(window.log=l),j},j});
define('core/maintenance', ["jquery","core/str","core/templates"],function(a,b,c){var d=0,e=a(".maintenancewarning"),f=function(){d-=1;var f="",g={};d<=0?f="sitemaintenance":(g.sec=d%60,g.min=Math.floor(d/60)%60,g.hour=Math.floor(d/3600),f=g.hour>0?"maintenancemodeisscheduledlong":"maintenancemodeisscheduled"),b.get_string(f,"admin",g).then(function(a){var b="notification_warning";return d<30&&(b="notification_error"),c.render("core/"+b,{message:a,extraclasses:"maintenancewarning"})}).then(function(b){e=a(".maintenancewarning"),e.length>0&&(e.replaceWith(b),a(".maintenancewarning").attr("aria-live","polite"))})};return{init:function(a){e&&(d=a,e.attr("aria-live","polite"),setInterval(f,1e3))}}});
define('core/modal', ["jquery","core/templates","core/notification","core/key_codes","core/custom_interaction_events","core/modal_backdrop","core/modal_events"],function(a,b,c,d,e,f,g){var h,i={CONTAINER:'[data-region="modal-container"]',MODAL:'[data-region="modal"]',HEADER:'[data-region="header"]',TITLE:'[data-region="title"]',BODY:'[data-region="body"]',FOOTER:'[data-region="footer"]',HIDE:'[data-action="hide"]',DIALOG:"[role=dialog]",MENU_BAR:"[role=menubar]",HAS_Z_INDEX:".moodle-has-zindex",CAN_RECEIVE_FOCUS:'input:not([type="hidden"]), a[href], button, textarea, select, [tabindex]'},j={LOADING:"core/loading",BACKDROP:"core/modal_backdrop"},k=0,l=function(b){this.root=a(b),this.modal=this.root.find(i.MODAL),this.header=this.modal.find(i.HEADER),this.title=this.header.find(i.TITLE),this.body=this.modal.find(i.BODY),this.footer=this.modal.find(i.FOOTER),this.hiddenSiblings=[],this.isAttached=!1,this.bodyJS=null,this.footerJS=null,this.modalCount=k++,this.root.is(i.CONTAINER)||c.exception({message:"Element is not a modal container"}),this.modal.length||c.exception({message:"Container does not contain a modal"}),this.header.length||c.exception({message:"Modal is missing a header region"}),this.title.length||c.exception({message:"Modal header is missing a title region"}),this.body.length||c.exception({message:"Modal is missing a body region"}),this.footer.length||c.exception({message:"Modal is missing a footer region"}),this.registerEventListeners()};return l.prototype.attachToDOM=function(){this.isAttached||(a("body").append(this.root),this.bodyJS&&(b.runTemplateJS(this.bodyJS),this.bodyJS=null),this.footerJS&&(b.runTemplateJS(this.footerJS),this.footerJS=null),this.isAttached=!0)},l.prototype.countOtherVisibleModals=function(){var b=0;return a("body").find(i.CONTAINER).each(function(c,d){d=a(d),!this.root.is(d)&&d.hasClass("show")&&b++}.bind(this)),b},l.prototype.getBackdrop=function(){return h||(h=b.render(j.BACKDROP,{}).then(function(b){var c=a(b);return new f(c)}).fail(c.exception)),h},l.prototype.getRoot=function(){return this.root},l.prototype.getModal=function(){return this.modal},l.prototype.getTitle=function(){return this.title},l.prototype.getBody=function(){return this.body},l.prototype.getFooter=function(){return this.footer},l.prototype.getModalCount=function(){return this.modalCount},l.prototype.setTitle=function(a){var b=this.getTitle();"string"==typeof a?b.html(a):a.then(function(a){return b.html(a)})},l.prototype.setBody=function(d){var e=this.getBody();if("string"==typeof d)e.html(d);else{var f="amd-modal-js-pending-id-"+this.getModalCount();M.util.js_pending(f);var g=null;e.css("overflow","hidden"),"pending"==d.state()?(e.animate({height:"100px"},150),e.html(""),g=b.render(j.LOADING,{}).then(function(b){var c=a(b).hide();return e.html(c),c.fadeIn(150),a.when(c.promise(),d)}).then(function(a){return a.fadeOut(100).promise()}).then(function(){return d})):g=d,g.then(function(a,c){var d=null;if(this.isVisible()){e.css("opacity",0);var f=e.innerHeight();e.html(a),e.css("height","");var g=e.innerHeight();e.css("height",f+"px"),d=e.animate({height:g+"px",opacity:1},{duration:150,queue:!1}).promise()}else e.html(a);return c&&(this.isAttached?b.runTemplateJS(c):this.bodyJS=c),d}.bind(this)).fail(c.exception).always(function(){e.css("height",""),e.css("overflow",""),e.css("opacity",""),M.util.js_complete(f)}).fail(c.exception)}},l.prototype.setFooter=function(a){var c=this.getFooter();"string"==typeof a?c.html(a):b.render(j.LOADING,{}).done(function(d){c.html(d),a.done(function(a,d){c.html(a),d&&(this.isAttached?b.runTemplateJS(d):this.footerJS=d)}.bind(this))}.bind(this))},l.prototype.setLarge=function(){this.isLarge()||this.getRoot().addClass("large")},l.prototype.isLarge=function(){return this.getRoot().hasClass("large")},l.prototype.setSmall=function(){this.isSmall()||this.getRoot().removeClass("large")},l.prototype.isSmall=function(){return!this.getRoot().hasClass("large")},l.prototype.calculateZIndex=function(){var b=a(i.DIALOG+", "+i.MENU_BAR+", "+i.HAS_Z_INDEX),c=parseInt(this.root.css("z-index"));return b.each(function(b,d){d=a(d);var e=d.css("z-index")?parseInt(d.css("z-index")):0;e>c&&(c=e)}),c},l.prototype.isVisible=function(){return this.root.hasClass("show")},l.prototype.hasFocus=function(){var b=a(document.activeElement);return this.root.is(b)||this.root.has(b).length},l.prototype.hasTransitions=function(){return this.getRoot().hasClass("fade")},l.prototype.show=function(){this.isVisible()||(this.isAttached||this.attachToDOM(),this.getBackdrop().done(function(b){var c=this.calculateZIndex(),d=c+2,e=d-1;this.root.css("z-index",d),b.setZIndex(e),b.show(),this.root.removeClass("hide").addClass("show"),this.accessibilityShow(),this.getTitle().focus(),a("body").addClass("modal-open"),this.root.trigger(g.shown,this)}.bind(this)))},l.prototype.hide=function(){this.isVisible()&&this.getBackdrop().done(function(b){this.countOtherVisibleModals()||(b.hide(),a("body").removeClass("modal-open"));var c=parseInt(this.root.css("z-index"));this.root.css("z-index",""),b.setZIndex(c-3),this.accessibilityHide(),this.hasTransitions()?this.getRoot().one("transitionend webkitTransitionEnd oTransitionEnd",function(){this.getRoot().removeClass("show").addClass("hide")}.bind(this)):this.getRoot().removeClass("show").addClass("hide"),this.root.trigger(g.hidden,this)}.bind(this))},l.prototype.destroy=function(){this.root.remove(),this.root.trigger(g.destroyed,this)},l.prototype.accessibilityShow=function(){a("body").children().each(function(b,c){if(!this.root.is(c)){c=a(c);var d=c.attr("aria-hidden");"true"!==d&&(c.data("previous-aria-hidden",d),this.hiddenSiblings.push(c),c.attr("aria-hidden","true"))}}.bind(this)),this.root.attr("aria-hidden","false")},l.prototype.accessibilityHide=function(){this.root.attr("aria-hidden","true"),a.each(this.hiddenSiblings,function(b,c){c=a(c);var d=c.data("previous-aria-hidden");"undefined"==typeof d?c.removeAttr("aria-hidden"):c.attr("aria-hidden",d)}),this.hiddenSiblings=[]},l.prototype.handleTabLock=function(b){if(this.hasFocus()){var c=a(document.activeElement),d=this.modal.find(i.CAN_RECEIVE_FOCUS),e=d.first(),f=d.last();c.is(e)&&b.shiftKey?(f.focus(),b.preventDefault()):c.is(f)&&!b.shiftKey&&(e.focus(),b.preventDefault())}},l.prototype.registerEventListeners=function(){this.getRoot().on("keydown",function(a){this.isVisible()&&(a.keyCode==d.tab?this.handleTabLock(a):a.keyCode==d.escape&&this.hide())}.bind(this)),e.define(this.getModal(),[e.events.activate]),this.getModal().on(e.events.activate,i.HIDE,function(a,b){this.hide(),b.originalEvent.preventDefault()}.bind(this))},l});
define('core/modal_backdrop', ["jquery","core/templates","core/notification"],function(a,b,c){var d={ROOT:'[data-region="modal-backdrop"]'},e=function(b){this.root=a(b),this.isAttached=!1,this.root.is(d.ROOT)||c.exception({message:"Element is not a modal backdrop"})};return e.prototype.getRoot=function(){return this.root},e.prototype.attachToDOM=function(){this.isAttached||(a("body").append(this.root),this.isAttached=!0)},e.prototype.setZIndex=function(a){this.root.css("z-index",a)},e.prototype.isVisible=function(){return this.root.hasClass("show")},e.prototype.hasTransitions=function(){return this.getRoot().hasClass("fade")},e.prototype.show=function(){this.isVisible()||(this.isAttached||this.attachToDOM(),this.root.removeClass("hide").addClass("show"))},e.prototype.hide=function(){this.isVisible()&&(this.hasTransitions()?this.getRoot().one("transitionend webkitTransitionEnd oTransitionEnd",function(){this.getRoot().removeClass("show").addClass("hide")}.bind(this)):this.getRoot().removeClass("show").addClass("hide"))},e.prototype.destroy=function(){this.root.remove()},e});
define('core/modal_cancel', ["jquery","core/notification","core/custom_interaction_events","core/modal","core/modal_events"],function(a,b,c,d,e){var f={CANCEL_BUTTON:'[data-action="cancel"]'},g=function(a){d.call(this,a),this.getFooter().find(f.CANCEL_BUTTON).length||b.exception({message:"No cancel button found"})};return g.prototype=Object.create(d.prototype),g.prototype.constructor=g,g.prototype.setFooter=function(){b.exception({message:"Can not change the footer of a cancel modal"})},g.prototype.registerEventListeners=function(){d.prototype.registerEventListeners.call(this),this.getModal().on(c.events.activate,f.CANCEL_BUTTON,function(b,c){var d=a.Event(e.cancel);this.getRoot().trigger(d,this),d.isDefaultPrevented()||(this.hide(),c.originalEvent.preventDefault())}.bind(this))},g});
define('core/modal_confirm', ["jquery","core/notification","core/custom_interaction_events","core/modal","core/modal_events"],function(a,b,c,d,e){var f={YES_BUTTON:'[data-action="yes"]',NO_BUTTON:'[data-action="no"]'},g=function(a){d.call(this,a),this.getFooter().find(f.YES_BUTTON).length||b.exception({message:'No "yes" button found'}),this.getFooter().find(f.NO_BUTTON).length||b.exception({message:'No "no" button found'})};return g.prototype=Object.create(d.prototype),g.prototype.constructor=g,g.prototype.setFooter=function(){b.exception({message:"Can not change the footer of a confirm modal"})},g.prototype.registerEventListeners=function(){d.prototype.registerEventListeners.call(this),this.getModal().on(c.events.activate,f.YES_BUTTON,function(b,c){var d=a.Event(e.yes);this.getRoot().trigger(d,this),d.isDefaultPrevented()||(this.hide(),c.originalEvent.preventDefault())}.bind(this)),this.getModal().on(c.events.activate,f.NO_BUTTON,function(b,c){var d=a.Event(e.no);this.getRoot().trigger(d,this),d.isDefaultPrevented()||(this.hide(),c.originalEvent.preventDefault())}.bind(this))},g});
define('core/modal_events', [],function(){return{shown:"modal:shown",hidden:"modal:hidden",destroyed:"modal:destroyed",save:"modal-save-cancel:save",cancel:"modal-save-cancel:cancel",yes:"modal-confirm:yes",no:"modal-confirm:no"}});
define('core/modal_factory', ["jquery","core/modal_events","core/modal_registry","core/modal","core/modal_save_cancel","core/modal_confirm","core/modal_cancel","core/templates","core/notification","core/custom_interaction_events"],function(a,b,c,d,e,f,g,h,i,j){var k={DEFAULT:"core/modal",SAVE_CANCEL:"core/modal_save_cancel",CONFIRM:"core/modal_confirm",CANCEL:"core/modal_cancel"},l={DEFAULT:"DEFAULT",SAVE_CANCEL:"SAVE_CANCEL",CONFIRM:"CONFIRM",CANCEL:"CANCEL"};c.register(l.DEFAULT,d,k.DEFAULT),c.register(l.SAVE_CANCEL,e,k.SAVE_CANCEL),c.register(l.CONFIRM,f,k.CONFIRM),c.register(l.CANCEL,g,k.CANCEL);var m=function(a,c){if("undefined"!=typeof c){var d=null;j.define(c,[j.events.activate]),c.on(j.events.activate,function(b,c){d=b.currentTarget,a.then(function(a){return a.show(),a}),c.originalEvent.preventDefault()}),a.then(function(a){return a.getRoot().on(b.hidden,function(){null!==d&&d.focus()}),a})}},n=function(b,c){c=a(c);var d=b.module,e=new d(c);return e},o=function(b,c,d){var e=b.template,f=h.render(e,d).then(function(c){var d=a(c);return n(b,d)}).fail(i.exception);return m(f,c),f},p=function(a,b,d){var e=a.type||l.DEFAULT,f=!!a.large,g=null;return g=c.get(e),g||i.exception({message:"Unable to find modal of type: "+e}),o(g,b,d).then(function(b){return"undefined"!=typeof a.title&&b.setTitle(a.title),"undefined"!=typeof a.body&&b.setBody(a.body),"undefined"!=typeof a.footer&&b.setFooter(a.footer),f&&b.setLarge(),b})};return{create:p,types:l}});
define('core/modal_registry', ["core/notification"],function(a){var b={},c=function(a){return b[a]},d=function(d,e,f){c(d)&&a.exception({message:"Modal of  type '"+d+"' is already registered"}),e&&"function"==typeof e||a.exception({message:"You must provide a modal module"}),f||a.exception({message:"You must provide a modal template"}),b[d]={module:e,template:f}};return{register:d,get:c}});
define('core/modal_save_cancel', ["jquery","core/notification","core/custom_interaction_events","core/modal","core/modal_events"],function(a,b,c,d,e){var f={SAVE_BUTTON:'[data-action="save"]',CANCEL_BUTTON:'[data-action="cancel"]'},g=function(a){d.call(this,a),this.getFooter().find(f.SAVE_BUTTON).length||b.exception({message:"No save button found"}),this.getFooter().find(f.CANCEL_BUTTON).length||b.exception({message:"No cancel button found"})};return g.prototype=Object.create(d.prototype),g.prototype.constructor=g,g.prototype.setFooter=function(){b.exception({message:"Can not change the footer of a save cancel modal"})},g.prototype.disableSave=function(){this.getFooter().find(f.SAVE_BUTTON).prop("disabled",!0)},g.prototype.enableSave=function(){this.getFooter().find(f.SAVE_BUTTON).prop("disabled",!1)},g.prototype.registerEventListeners=function(){d.prototype.registerEventListeners.call(this),this.getModal().on(c.events.activate,f.SAVE_BUTTON,function(b,c){var d=a.Event(e.save);this.getRoot().trigger(d,this),d.isDefaultPrevented()||(this.hide(),c.originalEvent.preventDefault())}.bind(this)),this.getModal().on(c.events.activate,f.CANCEL_BUTTON,function(b,c){var d=a.Event(e.cancel);this.getRoot().trigger(d,this),d.isDefaultPrevented()||(this.hide(),c.originalEvent.preventDefault())}.bind(this))},g});
!function(a,b){"object"==typeof exports&&exports&&"string"!=typeof exports.nodeName?b(exports):"function"==typeof define&&define.amd?define('core/mustache', ["exports"],b):(a.Mustache={},b(a.Mustache))}(this,function(a){function b(a){return"function"==typeof a}function c(a){return p(a)?"array":typeof a}function d(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function e(a,b){return null!=a&&"object"==typeof a&&b in a}function f(a,b){return q.call(a,b)}function g(a){return!f(r,a)}function h(a){return String(a).replace(/[&<>"'`=\/]/g,function(a){return s[a]})}function i(b,c){function e(){if(r&&!s)for(;q.length;)delete o[q.pop()];else q=[];r=!1,s=!1}function f(a){if("string"==typeof a&&(a=a.split(u,2)),!p(a)||2!==a.length)throw new Error("Invalid tags: "+a);h=new RegExp(d(a[0])+"\\s*"),i=new RegExp("\\s*"+d(a[1])),m=new RegExp("\\s*"+d("}"+a[1]))}if(!b)return[];var h,i,m,n=[],o=[],q=[],r=!1,s=!1;f(c||a.tags);for(var y,z,A,B,C,D,E=new l(b);!E.eos();){if(y=E.pos,A=E.scanUntil(h))for(var F=0,G=A.length;F<G;++F)B=A.charAt(F),g(B)?q.push(o.length):s=!0,o.push(["text",B,y,y+1]),y+=1,"\n"===B&&e();if(!E.scan(h))break;if(r=!0,z=E.scan(x)||"name",E.scan(t),"="===z?(A=E.scanUntil(v),E.scan(v),E.scanUntil(i)):"{"===z?(A=E.scanUntil(m),E.scan(w),E.scanUntil(i),z="&"):A=E.scanUntil(i),!E.scan(i))throw new Error("Unclosed tag at "+E.pos);if(C=[z,A,y,E.pos],o.push(C),"#"===z||"^"===z||"$"===z||"<"===z)n.push(C);else if("/"===z){if(D=n.pop(),!D)throw new Error('Unopened section "'+A+'" at '+y);if(D[1]!==A)throw new Error('Unclosed section "'+D[1]+'" at '+y)}else"name"===z||"{"===z||"&"===z?s=!0:"="===z&&f(A)}if(D=n.pop())throw new Error('Unclosed section "'+D[1]+'" at '+E.pos);return k(j(o))}function j(a){for(var b,c,d=[],e=0,f=a.length;e<f;++e)b=a[e],b&&("text"===b[0]&&c&&"text"===c[0]?(c[1]+=b[1],c[3]=b[3]):(d.push(b),c=b));return d}function k(a){for(var b,c,d=[],e=d,f=[],g=0,h=a.length;g<h;++g)switch(b=a[g],b[0]){case"$":case"<":case"#":case"^":e.push(b),f.push(b),e=b[4]=[];break;case"/":c=f.pop(),c[5]=b[2],e=f.length>0?f[f.length-1][4]:d;break;default:e.push(b)}return d}function l(a){this.string=a,this.tail=a,this.pos=0}function m(a,b){this.view=a,this.blocks={},this.cache={".":this.view},this.parent=b}function n(){this.cache={}}var o=Object.prototype.toString,p=Array.isArray||function(a){return"[object Array]"===o.call(a)},q=RegExp.prototype.test,r=/\S/,s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},t=/\s*/,u=/\s+/,v=/\s*=/,w=/\s*\}/,x=/#|\^|\/|>|\{|&|=|!|\$|</;l.prototype.eos=function(){return""===this.tail},l.prototype.scan=function(a){var b=this.tail.match(a);if(!b||0!==b.index)return"";var c=b[0];return this.tail=this.tail.substring(c.length),this.pos+=c.length,c},l.prototype.scanUntil=function(a){var b,c=this.tail.search(a);switch(c){case-1:b=this.tail,this.tail="";break;case 0:b="";break;default:b=this.tail.substring(0,c),this.tail=this.tail.substring(c)}return this.pos+=b.length,b},m.prototype.push=function(a){return new m(a,this)},m.prototype.setBlockVar=function(a,b){var c=this.blocks;return c[a]=b,b},m.prototype.clearBlockVars=function(){this.blocks={}},m.prototype.getBlockVar=function(a){var b,c=this.blocks;return c.hasOwnProperty(a)?b=c[a]:this.parent&&(b=this.parent.getBlockVar(a)),b},m.prototype.lookup=function(a){var c,d=this.cache;if(d.hasOwnProperty(a))c=d[a];else{for(var f,g,h=this,i=!1;h;){if(a.indexOf(".")>0)for(c=h.view,f=a.split("."),g=0;null!=c&&g<f.length;)g===f.length-1&&(i=e(c,f[g])),c=c[f[g++]];else c=h.view[a],i=e(h.view,a);if(i)break;h=h.parent}d[a]=c}return b(c)&&(c=c.call(this.view)),c},n.prototype.clearCache=function(){this.cache={}},n.prototype.parse=function(a,b){var c=this.cache,d=c[a];return null==d&&(d=c[a]=i(a,b)),d},n.prototype.render=function(a,b,c){var d=this.parse(a),e=b instanceof m?b:new m(b);return this.renderTokens(d,e,c,a)},n.prototype.renderTokens=function(a,b,c,d){for(var e,f,g,h="",i=0,j=a.length;i<j;++i)g=void 0,e=a[i],f=e[0],"#"===f?g=this.renderSection(e,b,c,d):"^"===f?g=this.renderInverted(e,b,c,d):">"===f?g=this.renderPartial(e,b,c,d):"<"===f?g=this.renderBlock(e,b,c,d):"$"===f?g=this.renderBlockVariable(e,b,c,d):"&"===f?g=this.unescapedValue(e,b):"name"===f?g=this.escapedValue(e,b):"text"===f&&(g=this.rawValue(e)),void 0!==g&&(h+=g);return h},n.prototype.renderSection=function(a,c,d,e){function f(a){return g.render(a,c,d)}var g=this,h="",i=c.lookup(a[1]);if(i){if(p(i))for(var j=0,k=i.length;j<k;++j)h+=this.renderTokens(a[4],c.push(i[j]),d,e);else if("object"==typeof i||"string"==typeof i||"number"==typeof i)h+=this.renderTokens(a[4],c.push(i),d,e);else if(b(i)){if("string"!=typeof e)throw new Error("Cannot use higher-order sections without the original template");i=i.call(c.view,e.slice(a[3],a[5]),f),null!=i&&(h+=i)}else h+=this.renderTokens(a[4],c,d,e);return h}},n.prototype.renderInverted=function(a,b,c,d){var e=b.lookup(a[1]);if(!e||p(e)&&0===e.length)return this.renderTokens(a[4],b,c,d)},n.prototype.renderPartial=function(a,c,d){if(d){if(a[1].startsWith("&&"))var e=c.lookup(a[1].substr(2)),f=b(d)?d(e):d[e];else var f=b(d)?d(a[1]):d[a[1]];return null!=f?this.renderTokens(this.parse(f),c,d,f):void 0}},n.prototype.renderBlock=function(a,c,d,e){if(d){var f=b(d)?d(a[1]):d[a[1]];null!=f&&c.clearBlockVars(),this.renderTokens(a[4],c,d,e);var g=this.renderTokens(this.parse(f),c,d,f);return c.clearBlockVars(),g}},n.prototype.renderBlockVariable=function(a,b,c,d){var e=a[1],f=b.getBlockVar(e);return f?this.renderTokens(this.parse(f),b,c,f):(b.setBlockVar(e,d.slice(a[3],a[5])),this.renderTokens(a[4],b,c,d))},n.prototype.unescapedValue=function(a,b){var c=b.lookup(a[1]);if(null!=c)return c},n.prototype.escapedValue=function(b,c){var d=c.lookup(b[1]);if(null!=d)return a.escape(d)},n.prototype.rawValue=function(a){return a[1]},a.name="mustache.js",a.version="2.2.1",a.tags=["{{","}}"];var y=new n;a.clearCache=function(){return y.clearCache()},a.parse=function(a,b){return y.parse(a,b)},a.render=function(a,b,d){if("string"!=typeof a)throw new TypeError('Invalid template! Template should be a "string" but "'+c(a)+'" was given as the first argument for mustache#render(template, view, partials)');return y.render(a,b,d)},a.to_html=function(c,d,e,f){var g=a.render(c,d,e);return b(f)?void f(g):g},a.escape=h,a.Scanner=l,a.Context=m,a.Writer=n});
define('core/notification', ["core/yui","jquery","core/log"],function(a,b,c){var d={types:{success:"core/notification_success",info:"core/notification_info",warning:"core/notification_warning",error:"core/notification_error"},fieldName:"user-notifications",fetchNotifications:function(){require(["core/ajax"],function(a){var b=a.call([{methodname:"core_fetch_notifications",args:{contextid:d.contextid}}]);b[0].done(d.addNotifications)})},addNotifications:function(a){a||(a=[]),b.each(a,function(a,b){d.renderNotification(b.template,b.variables)})},setupTargetRegion:function(){var a=b("#"+d.fieldName);if(a.length)return!1;var c=b("<span>").attr("id",d.fieldName);return a=b("#region-main"),a.length?a.prepend(c):(a=b('[role="main"]'),a.length?a.prepend(c):(a=b("body"),a.prepend(c)))},addNotification:function(a){var c=d.types.error;return a=b.extend({closebutton:!0,announce:!0,type:"error"},a),a.template?(c=a.template,delete a.template):a.type&&("undefined"!=typeof d.types[a.type]&&(c=d.types[a.type]),delete a.type),d.renderNotification(c,a)},clearNotifications:function(){document.getElementById(d.fieldName).innerHTML=""},renderNotification:function(a,e){return"undefined"!=typeof e.message&&e.message?void require(["core/templates"],function(c){c.render(a,e).done(function(a,e){b("#"+d.fieldName).prepend(a),c.runTemplateJS(e)}).fail(d.exception)}):void c.debug("Notification received without content. Skipping.")},alert:function(b,c,d){a.use("moodle-core-notification-alert",function(){var a=new M.core.alert({title:b,message:c,yesLabel:d});a.show()})},confirm:function(b,c,d,e,f,g){a.use("moodle-core-notification-confirm",function(){var a=new M.core.confirm({title:b,question:c,yesLabel:d,noLabel:e});a.on("complete-yes",function(){f()}),g&&a.on("complete-no",function(){g()}),a.show()})},exception:function(b){if("undefined"==typeof b.stack&&(b.stack=""),b.debuginfo&&(b.stack+=b.debuginfo+"\n"),!b.backtrace&&b.stacktrace&&(b.backtrace=b.stacktrace),b.backtrace){b.stack+=b.backtrace;var c=b.backtrace.match(/line ([^ ]*) of/),d=b.backtrace.match(/ of ([^:]*): /);c&&c[1]&&(b.lineNumber=c[1]),d&&d[1]&&(b.fileName=d[1],b.fileName.length>30&&(b.fileName="..."+b.fileName.substr(b.fileName.length-27)))}"undefined"==typeof b.name&&b.errorcode&&(b.name=b.errorcode),a.use("moodle-core-notification-exception",function(){var a=new M.core.exception(b);a.show()})}};return{init:function(a,b){d.contextid=a,d.setupTargetRegion(),d.addNotifications(b),d.fetchNotifications()},fetchNotifications:d.fetchNotifications,addNotification:d.addNotification,clearNotifications:d.clearNotifications,alert:d.alert,confirm:d.confirm,exception:d.exception}});
define('core/permissionmanager', ["jquery","core/config","core/notification","core/templates","core/flex_icon","core/yui"],function(a,b,c,d,e,f){var g,h,i,j,k={ADDROLE:"a.allowlink, a.prohibitlink",REMOVEROLE:"a.preventlink, a.unprohibitlink",UNPROHIBIT:"a.unprohibitlink"},l=a.Event("rolesloaded"),m=null,n=function(){var d={contextid:g,getroles:1,sesskey:b.sesskey};a.post(i+"roles/ajax.php",d,null,"json").done(function(b){try{j=b,n=function(){a("body").trigger(l)},n()}catch(d){c.exception(d)}}).fail(function(a,b,d){c.exception(d)})},o=function(b,f,h){var k={contextid:g,roleid:f,sesskey:M.cfg.sesskey,action:h,capability:b.data("name")};a.post(i+"roles/ajax.php",k,null,"json").done(function(g){var h=g;try{var k={rolename:j[f],roleid:f,adminurl:i,imageurl:"delete-ns"};switch(h){case"allow":k.spanclass="label label-success allowed",k.linkclass="preventlink",k.action="prevent";break;case"prohibit":k.spanclass="label label-danger forbidden",k.linkclass="unprohibitlink",k.action="unprohibit";break;case"prevent":return void b.find('a[data-role-id="'+f+'"]').first().closest(".allowed").remove();case"unprohibit":return void b.find('a[data-role-id="'+f+'"]').first().closest(".forbidden").remove();default:return}e.getIconData("delete-ns","",{alt:k.action}).then(function(a){return k.deleteicon=a,d.render("core/permissionmanager_role",k)}).then(function(c){if("allow"==h)a(c).insertBefore(b.find(".allowmore:first"));else if("prohibit"==h){a(c).insertBefore(b.find(".prohibitmore:first"));var d=b.find(".allowedroles").first().find('a[data-role-id="'+f+'"]');d&&d.first().closest(".allowed").remove()}m.hide()}).fail(c.exception)}catch(l){c.exception(l)}}).fail(function(a,b,d){c.exception(d)})},p=function(b){b.preventDefault(),f.use("moodle-core-notification-dialogue",function(){a("body").one("rolesloaded",function(){var e=a(b.currentTarget),f=e.data("action"),g=e.closest("tr.rolecap"),i={cap:g.data("humanname"),context:h},l=M.util.get_string("role"+f+"info","core_role",i);null===m&&(m=new M.core.dialogue({draggable:!0,modal:!0,closeButton:!0,width:"450px"})),m.set("headerContent",M.util.get_string("role"+f+"header","core_role"));var n,p,q=[];switch(f){case"allow":p=g.find(k.REMOVEROLE);break;case"prohibit":p=g.find(k.UNPROHIBIT)}for(n in j){var r="",s=p.filter("[data-role-id='"+n+"']").length;s&&(r="disabled");var t={roleid:n,rolename:j[n],disabled:r};q.push(t)}d.render("core/permissionmanager_panelcontent",{message:l,roles:q}).done(function(b){m.set("bodyContent",b),m.show(),a("div.role_buttons").delegate("input","click",function(b){var c=a(b.currentTarget).data("role-id");o(g,c,f)})}).fail(c.exception)})}),n()},q=function(b){b.preventDefault(),a("body").one("rolesloaded",function(){var d=a(b.currentTarget),e=d.data("action"),f=d.data("role-id"),g=d.closest("tr.rolecap"),i={role:j[f],cap:g.data("humanname"),context:h};c.confirm(M.util.get_string("confirmunassigntitle","core_role"),M.util.get_string("confirmrole"+e,"core_role",i),M.util.get_string("confirmunassignyes","core_role"),M.util.get_string("confirmunassignno","core_role"),function(){o(g,f,e)})}),n()};return{initialize:function(b){g=b.contextid,h=b.contextname,i=b.adminurl;var c=a("body");c.delegate(k.ADDROLE,"click",p),c.delegate(k.REMOVEROLE,"click",q)}}});
define('core/popover', ["jquery","theme_legacy/bootstrap"],function(a){function b(){function b(b){var d=b.target;null!==c&&d.closest("[aria-describedby]")!==c&&null===d.closest("#"+c.getAttribute("aria-describedby"))&&a(c).popover("hide")}a('[data-component="/core/output/popover"][data-enhanced="false"]').each(function(){var b=this,c=a(this),d=c.parent(),e=this.getAttribute("data-arrow_placement")?this.getAttribute("data-arrow_placement"):"bottom",f=this.getAttribute("data-trigger")?this.getAttribute("data-trigger"):"focus";if("smartPosition"===e){var g=!1;e=function(a,c){var d=c.getBoundingClientRect(),e=b.getAttribute("data-placement_max_height")?b.getAttribute("data-placement_max_height"):300,f=b.getAttribute("data-placement_max_width")?b.getAttribute("data-placement_max_width"):300;return e+=10,f+=10,window.innerHeight-d.bottom>e?(g=!0,"bottom"):d.top>e?(g=!1,"top"):d.left>f?"left":window.innerWidth-d.right>f?"right":(g=!1,"top")},window.innerWidth<992&&d.on("shown.bs.popover",function(){b.parentNode.scrollIntoView(g)})}if(d.popover({title:c.data("title")?c.data("title"):"",content:a(".popover__content",this).html(),placement:e,trigger:f,html:!0,sanitize:!1}),"manual"===f){var h=function(){d.popover("show")},i=function(){d.popover("hide")},j=function(){d.popover("destroy"),b.parentNode.removeEventListener("core/popover:show",h),b.parentNode.removeEventListener("core/popover:hide",i),b.parentNode.removeEventListener("core/popover:destroy",j),b.remove()};b.parentNode.addEventListener("core/popover:show",h),b.parentNode.addEventListener("core/popover:hide",i),b.parentNode.addEventListener("core/popover:destroy",j)}else d.attr("tabindex",0).css("cursor","pointer");c.attr("data-enhanced","true")});var d=document.querySelector('[data-component="/core/output/popover"][data-close_on_focus_out]');d&&(document.removeEventListener("click",b,!1),document.removeEventListener("touchstart",b,!1),document.addEventListener("click",b,!1),document.addEventListener("touchstart",b,!1))}var c=null;return a(document).on("shown.bs.popover",function(a){c=a.target}),a(document).on("hide.bs.modal",function(){c=null}),{scan:b}});
define('core/popover_region_controller', ["jquery","core/str","core/custom_interaction_events"],function(a,b,c){var d={CONTENT:".popover-region-content",CONTENT_CONTAINER:".popover-region-content-container",MENU_CONTAINER:".popover-region-container",MENU_TOGGLE:".popover-region-toggle",CAN_RECEIVE_FOCUS:'input:not([type="hidden"]), a[href], button, textarea, select, [tabindex]'},e=function(b){this.root=a(b),this.content=this.root.find(d.CONTENT),this.contentContainer=this.root.find(d.CONTENT_CONTAINER),this.menuContainer=this.root.find(d.MENU_CONTAINER),this.menuToggle=this.root.find(d.MENU_TOGGLE),this.isLoading=!1,this.promises={closeHandlers:a.Deferred(),navigationHandlers:a.Deferred()},this.registerBaseEventListeners()};return e.prototype.events=function(){return{menuOpened:"popoverregion:menuopened",menuClosed:"popoverregion:menuclosed",startLoading:"popoverregion:startLoading",stopLoading:"popoverregion:stopLoading"}},e.prototype.getContentContainer=function(){return this.contentContainer},e.prototype.getContent=function(){return this.content},e.prototype.isMenuOpen=function(){return!this.root.hasClass("collapsed")},e.prototype.toggleMenu=function(){this.isMenuOpen()?this.closeMenu():this.openMenu()},e.prototype.closeMenu=function(){this.isMenuOpen()&&(this.root.addClass("collapsed"),this.menuToggle.attr("aria-expanded","false"),this.menuContainer.attr("aria-hidden","true"),this.updateButtonAriaLabel(),this.root.trigger(this.events().menuClosed))},e.prototype.openMenu=function(){this.isMenuOpen()||(this.root.removeClass("collapsed"),this.menuToggle.attr("aria-expanded","true"),this.menuContainer.attr("aria-hidden","false"),this.updateButtonAriaLabel(),this.promises.closeHandlers.resolve(),this.promises.navigationHandlers.resolve(),this.root.trigger(this.events().menuOpened))},e.prototype.updateButtonAriaLabel=function(){this.isMenuOpen()?b.get_string("hidepopoverwindow").done(function(a){this.menuToggle.attr("aria-label",a)}.bind(this)):b.get_string("showpopoverwindow").done(function(a){this.menuToggle.attr("aria-label",a)}.bind(this))},e.prototype.startLoading=function(){this.isLoading=!0,this.getContentContainer().addClass("loading"),this.getContentContainer().attr("aria-busy","true"),this.root.trigger(this.events().startLoading)},e.prototype.stopLoading=function(){this.isLoading=!1,this.getContentContainer().removeClass("loading"),this.getContentContainer().attr("aria-busy","false"),this.root.trigger(this.events().stopLoading)},e.prototype.focusMenuToggle=function(){this.menuToggle.focus()},e.prototype.contentItemHasFocus=function(){return this.getContentItemWithFocus().length>0},e.prototype.getContentItemWithFocus=function(){var b=a(document.activeElement),c=this.getContent().children(),d=c.filter(b);return d.length||(d=c.has(b)),d},e.prototype.focusContentItem=function(a){a.is(d.CAN_RECEIVE_FOCUS)?a.focus():a.find(d.CAN_RECEIVE_FOCUS).first().focus()},e.prototype.focusFirstContentItem=function(){this.focusContentItem(this.getContent().children().first())},e.prototype.focusLastContentItem=function(){this.focusContentItem(this.getContent().children().last())},e.prototype.focusNextContentItem=function(){var a=this.getContentItemWithFocus();a.length&&a.next()&&this.focusContentItem(a.next())},e.prototype.focusPreviousContentItem=function(){var a=this.getContentItemWithFocus();a.length&&a.prev()&&this.focusContentItem(a.prev())},e.prototype.registerBaseEventListeners=function(){c.define(this.root,[c.events.activate,c.events.escape]),this.root.on(c.events.activate,d.MENU_TOGGLE,function(){this.toggleMenu()}.bind(this)),this.promises.closeHandlers.done(function(){this.root.on(c.events.escape,function(){this.closeMenu(),this.focusMenuToggle()}.bind(this)),a("html").on("focusin click",function(b){var c=a(b.target);this.root.is(c)||this.root.has(c).length||this.closeMenu()}.bind(this)),c.define(this.getContentContainer(),[c.events.scrollBottom])}.bind(this))},e.prototype.registerListNavigationEventListeners=function(){c.define(this.root,[c.events.down]),this.root.on(c.events.down,function(a,b){this.isMenuOpen()?this.contentItemHasFocus()?this.focusNextContentItem():this.focusFirstContentItem():(this.openMenu(),this.focusFirstContentItem()),b.originalEvent.preventDefault()}.bind(this)),this.promises.navigationHandlers.done(function(){c.define(this.root,[c.events.up,c.events.home,c.events.end]),this.root.on(c.events.up,function(a,b){this.focusPreviousContentItem(),b.originalEvent.preventDefault()}.bind(this)),this.root.on(c.events.home,function(a,b){this.focusFirstContentItem(),b.originalEvent.preventDefault()}.bind(this)),this.root.on(c.events.end,function(a,b){this.focusLastContentItem(),b.originalEvent.preventDefault()}.bind(this))}.bind(this))},e});
define('core/search-input', ["jquery"],function(a){var b=null,c=function(a){b.hasClass("expanded")?e():d(a)},d=function(c){var d=a(document).width();if("keydown"!==c.type||13===c.keyCode||32===c.keyCode)return d<=767&&("click"===c.type||"keydown"===c.type)?void f():void(d<=767||("keydown"===c.type&&c.preventDefault(),b.addClass("expanded"),b.find("form").addClass("expanded"),b.find("input").focus()))},e=function(){b.removeClass("expanded"),b.find("form").removeClass("expanded")},f=function(){b.find("form").submit()};return{init:function(d){b=a("#"+d),b.on("click mouseover keydown","div",c)}}});
define('core/sessionstorage', ["core/config","core/storagewrapper"],function(a,b){var c=new b(window.sessionStorage);return{get:function(a){return c.get(a)},set:function(a,b){return c.set(a,b)}}});
define('core/showhidesettings', ["jquery"],function(a){function b(a){return a.is("input[type=hidden]")&&a.siblings('input[type=checkbox][name="'+a.attr("name")+'"]').length}function c(a,b){return a.is("input[type=radio]")&&a.attr("value")!==b}function d(a,d){return!b(a)&&!c(a,d)}function e(a){return a.is("input[type=radio]")&&!a.prop("checked")}function f(a){return a.is("input[type=checkbox]")&&!a.prop("checked")}function g(a){return a.is("select")&&a.prop("multiple")}function h(a,b){var c=a.val()||[];if(!b.length)return!1;if(c.length!==b.length)return!1;for(var d in c)if(c.hasOwnProperty(d)&&b.indexOf(c[d])===-1)return!1;return!0}function i(b){return a('[name="'+b+'"],[name="'+b+'[]"]')}function j(b){return a(b).attr("name").replace(/\[]/,"")}function k(a,b,c){return"function"==typeof p[b]?p[b](a,c):p.defaultCondition(a,c)}function l(b,c){c=c||j(b.currentTarget);var d=i(c);if(o.hasOwnProperty(c)){var e={};a.each(o[c],function(b,c){a.each(c,function(c,f){var g=k(d,b,c);a.each(f,function(a,b){e.hasOwnProperty(b)?e[b]=e[b]||g:e[b]=g})})}),a.each(e,function(b,c){i(b).each(function(b,d){var e=a(d).closest(".form-item");e.length&&(c?e.hide():e.show())})})}}function m(){a.each(o,function(a){var b=i(a);b.length&&(b.on("change",l),l(null,a))})}function n(){a(".form-dependenton").hide()}var o,p={notchecked:function(b,c){var e=!1;return c=String(c),b.each(function(b,f){var g=a(f);d(g,c)&&(e=e||!g.prop("checked"))}),e},checked:function(b,c){var e=!1;return c=String(c),b.each(function(b,f){var g=a(f);d(g,c)&&(e=e||g.prop("checked"))}),e},noitemselected:function(b){var c=!1;return b.each(function(b,d){var e=a(d);c=c||e.prop("selectedIndex")===-1}),c},eq:function(c,d){var i=!1,j=!1;return d=String(d),c.each(function(c,k){var l=a(k);if(!e(l)){if(b(l))return void(j=l.val()===d);if(f(l))return void(i=i||j);if(g(l)){var m=d.split("|");return void(i=h(l,m))}i=i||l.val()===d}}),i},"in":function(c,d){var i=!1,j=!1,k=d.split("|");return c.each(function(c,d){var l=a(d);if(!e(l))return b(l)?void(j=k.indexOf(l.val())>-1):f(l)?void(i=i||j):g(l)?void(i=h(l,k)):void(i=i||k.indexOf(l.val())>-1)}),i},defaultCondition:function(c,d){var i=!1,j=!1;return d=String(d),c.each(function(c,k){var l=a(k);if(!e(l)){if(b(l))return void(j=l.val()!==d);if(f(l))return void(i=i||j);if(g(l)){var m=d.split("|");return void(i=!h(l,m))}i=i||l.val()!==d}}),i}};return{init:function(a){o=a.dependencies,m(),n()}}});
define('core/storagewrapper', ["core/config"],function(a){var b=function(a){this.storage=a,this.supported=this.detectSupport(),this.prefix="totara:cache:"+this._rootPath()+":",this.jsrevPrefix=this.prefix+"__jsrev",this.validateCache()};return b.prototype.detectSupport=function(){if(a.jsrev==-1)return!1;if("undefined"==typeof this.storage)return!1;var b="test";try{return null!==this.storage&&(this.storage.setItem(b,"1"),this.storage.removeItem(b),!0)}catch(c){return!1}},b.prototype.prefixKey=function(a){return this.prefix+a},b.prototype.validateCache=function(){var b=this.storage.getItem(this.jsrevPrefix);null!==b&&a.jsrev==b||(this._clear(),this.storage.setItem(this.jsrevPrefix,a.jsrev))},b.prototype.get=function(a){return!!this.supported&&(a=this.prefixKey(a),this.storage.getItem(a))},b.prototype.set=function(a,b){if(!this.supported)return!1;a=this.prefixKey(a);try{this.storage.setItem(a,b)}catch(c){return!1}return!0},b.prototype._rootPath=function(){var b=/^\w+:\/\/[^/]+\/?(.*)$/.exec(a.wwwroot);return b?b[1]:a.wwwroot},b.prototype._clear=function(){for(var a=this,b=[],c=0;c<this.storage.length;c++){var d=this.storage.key(c);(d.startsWith(this.prefix)||/^-?\d+\//.test(d))&&b.push(d)}b.forEach(function(b){return a.storage.removeItem(b)})},b});
define('core/str', ["jquery","core/webapi","core/localstorage","core/config","core/log"],function(a,b,c,d,e){var f=[];return{get_string:function(a,b,c){arguments.length>3&&e.debug("get_string() cannot accept lang parameter");var d=this.get_strings([{key:a,component:b,param:c}]);return d.then(function(a){return a[0]})},get_strings:function(e){var g,h,i,j=a.Deferred(),k=[],l=[],m=0,n=[],o=d.currentlanguage;for(m=0;m<e.length;m++)if(h=e[m],"undefined"==typeof h.component?h.component="moodle":"core"===h.component?h.component="moodle":"core_"===h.component.substring(0,5)?h.component=h.component.substring(5):"mod_"===h.component.substring(0,4)&&(h.component=h.component.substring(4)),"undefined"==typeof M.str[h.component]&&(M.str[h.component]=[]),"undefined"==typeof M.str[h.component][h.key]){g="core_str/"+o+"/"+h.component+"/"+h.key;var p=c.get(g);p?M.str[h.component][h.key]=JSON.parse(p):"undefined"==typeof f[g]?n.push({identifier:h.key,component:h.component,lang:o}):k.push(f[g])}if(0===n.length&&0===k.length){for(m=0;m<e.length;m++)h=e[m],l[m]=M.util.get_string(h.key,h.component,h.param);return j.resolve(l),j.promise()}if(n.length>0){var q=n.map(function(a){return a.identifier+", "+a.component}),r=b.call({operationName:"core_lang_strings_nosession",variables:{lang:o,ids:q}});for(r.then(function(a){for(m=0;m<a.lang_strings.length;m++)i=a.lang_strings[m],"undefined"==typeof M.str[i.component][i.identifier]&&(M.str[i.component][i.identifier]=i.string,c.set("core_str/"+i.lang+"/"+i.component+"/"+i.identifier,JSON.stringify(i.string)))}),k.push(r),m=0;m<n.length;m++)i=n[m],f["core_str/"+i.lang+"/"+i.component+"/"+i.identifier]=r}return Promise.all(k).then(function(){for(m=0;m<e.length;m++)h=e[m],l[m]=M.util.get_string(h.key,h.component,h.param);j.resolve(l)})["catch"](function(){for(m=0;m<e.length;m++)h=e[m],l[m]=M.util.get_string(h.key,h.component,h.param);j.resolve(l)}),j.promise()}}});
define('core/tag', ["jquery","core/ajax","core/templates","core/notification","core/str","core/yui"],function(a,b,c,d,e,f){return{initTagindexPage:function(){a("body").delegate(".tagarea[data-ta] a[data-quickload=1]","click",function(d){d.preventDefault();var e=a(this),f=e[0].search.replace(/^\?/,""),g=e.closest(".tagarea[data-ta]"),h=f.split("&").reduce(function(a,b){var c=b.split("=");return a[c[0]]=decodeURIComponent(c[1]),a},{}),i=b.call([{methodname:"core_tag_get_tagindex",args:{tagindex:h}}],!0);a.when.apply(a,i).done(function(a){c.render("core_tag/index",a).done(function(a){g.replaceWith(a)})})})},initManagePage:function(){a("body").on("updated","[data-inplaceeditable]",function(b){if(e.get_strings([{key:"now"},{key:"selecttag",component:"tag"}]).then(function(c){a(b.target).closest("tr").find("td.col-timemodified").html(c[0]),a('label[for="tagselect'+b.ajaxreturn.itemid+'"]').html(c[1])}).fail(d.exception),"tagflag"===b.ajaxreturn.itemtype){var c=a(b.target).closest("tr");"0"===b.ajaxreturn.value?c.removeClass("flagged-tag"):c.addClass("flagged-tag")}}),a(".tag-management-table").delegate("a.tagdelete","click",function(b){b.preventDefault();var c=a(this).attr("href");e.get_strings([{key:"delete"},{key:"confirmdeletetag",component:"tag"},{key:"yes"},{key:"no"}]).done(function(a){d.confirm(a[0],a[1],a[2],a[3],function(){window.location.href=c})})}),a("#tag-management-delete").click(function(b){var c=a(this).closest("form").get(0),f=a(c).find("input[type=checkbox]:checked").length;if(f){var g=a("<input type='hidden'/>").attr("name",this.name);b.preventDefault(),e.get_strings([{key:"delete"},{key:"confirmdeletetags",component:"tag"},{key:"yes"},{key:"no"}]).done(function(a){d.confirm(a[0],a[1],a[2],a[3],function(){g.appendTo(c),c.submit()})})}}),a("#tag-management-combine").click(function(b){b.preventDefault();var c=a(this).closest("form").get(0),g=a(c).find("input[type=checkbox]:checked");if(g.length<=1)return void e.get_strings([{key:"combineselected",component:"tag"},{key:"selectmultipletags",component:"tag"},{key:"ok"}]).done(function(a){d.alert(a[0],a[1],a[2])});var h=a("<input type='hidden'/>").attr("name",this.name);e.get_strings([{key:"combineselected",component:"tag"},{key:"selectmaintag",component:"tag"},{key:"continue"},{key:"cancel"}]).done(function(b){var d=a('<div><form id="combinetags_form" class="form-inline"><p class="description"></p><p class="options"></p><p class="mdl-align"><input type="submit" id="combinetags_submit"/><input type="button" id="combinetags_cancel"/></p></form></div>');d.find(".description").html(b[1]),d.find("#combinetags_submit").attr("value",b[2]),d.find("#combinetags_cancel").attr("value",b[3]);var e=d.find(".options");g.each(function(){var b=a(this).val(),c=a(".inplaceeditable[data-itemtype=tagname][data-itemid="+b+"]").attr("data-value");e.append(a('<input type="radio" name="maintag" id="combinetags_maintag_'+b+'" value="'+b+'"/><label for="combinetags_maintag_'+b+'">'+c+"</label><br>"))}),f.use("moodle-core-notification-dialogue",function(){var e=new M.core.dialogue({draggable:!0,modal:!0,closeButton:!0,headerContent:b[0],bodyContent:d.html()});e.show(),a("#combinetags_form input[type=radio]").first().focus().prop("checked",!0),a("#combinetags_form #combinetags_cancel").on("click",function(){e.destroy()}),a("#combinetags_form").on("submit",function(){h.appendTo(c);var b=a("input[name=maintag]:checked","#combinetags_form").val();return a("<input type='hidden'/>").attr("name","maintag").attr("value",b).appendTo(c),c.submit(),!1})})})}),a("body").on("updatefailed","[data-inplaceeditable][data-itemtype=tagname]",function(b){var c=b.exception,f=b.newvalue,g=a(b.target).attr("data-itemid");"namesalreadybeeingused"===c.errorcode&&(b.preventDefault(),e.get_strings([{key:"nameuseddocombine",component:"tag"},{key:"yes"},{key:"cancel"}]).done(function(a){d.confirm(b.message,a[0],a[1],a[2],function(){window.location.href=window.location.href+"&newname="+encodeURIComponent(f)+"&tagid="+encodeURIComponent(g)+"&action=renamecombine&sesskey="+M.cfg.sesskey})}))}),a("body").on("click","a[data-action=addstandardtag]",function(b){b.preventDefault(),e.get_strings([{key:"addotags",component:"tag"},{key:"inputstandardtags",component:"tag"},{key:"continue"},{key:"cancel"}]).done(function(b){var c=a('<div><form id="addtags_form" class="form-inline" method="POST"><input type="hidden" name="action" value="addstandardtag"/><input type="hidden" name="sesskey" value="'+M.cfg.sesskey+'"/><p><label for="id_tagslist">'+b[1]+'</label><input type="text" id="id_tagslist" name="tagslist"/></p><p class="mdl-align"><input type="submit" id="addtags_submit"/><input type="button" id="addtags_cancel"/></p></form></div>');c.find("#addtags_form").attr("action",window.location.href),c.find("#addtags_submit").attr("value",b[2]),c.find("#addtags_cancel").attr("value",b[3]),f.use("moodle-core-notification-dialogue",function(){var d=new M.core.dialogue({draggable:!0,modal:!0,closeButton:!0,headerContent:b[0],bodyContent:c.html()});d.show(),a("#addtags_form input[type=text]").focus(),a("#addtags_form #addtags_cancel").on("click",function(){d.destroy()})})})})},initManageCollectionsPage:function(){a("body").on("updated","[data-inplaceeditable]",function(b){var c,d,e,f=b.ajaxreturn;"core_tag"===f.component&&"tagareaenable"===f.itemtype&&(c=a(this).attr("data-itemid"),a(".tag-collections-table ul[data-collectionid] li[data-areaid="+c+"]").hide(),e=f.value,"1"===e?(a(this).closest("tr").removeClass("dimmed_text"),d=a(this).closest("tr").find('[data-itemtype="tagareacollection"]').attr("data-value"),a(".tag-collections-table ul[data-collectionid="+d+"] li[data-areaid="+c+"]").show()):a(this).closest("tr").addClass("dimmed_text")),"core_tag"===f.component&&"tagareacollection"===f.itemtype&&(c=a(this).attr("data-itemid"),a(".tag-collections-table ul[data-collectionid] li[data-areaid="+c+"]").hide(),d=a(this).attr("data-value"),e=a(this).closest("tr").find('[data-itemtype="tagareaenable"]').attr("data-value"),"1"===e&&a(".tag-collections-table ul[data-collectionid="+d+"] li[data-areaid="+c+"]").show())}),a("body").on("click",".addtagcoll > a",function(b){b.preventDefault();var c=a(this).attr("data-url")+"&sesskey="+M.cfg.sesskey;e.get_strings([{key:"addtagcoll",component:"tag"},{key:"name"},{key:"searchable",component:"tag"},{key:"create"},{key:"cancel"}]).done(function(b){var d=a('<div><form id="addtagcoll_form" class="form-inline"><p><label for="addtagcoll_name"></label>: <input id="addtagcoll_name" type="text"/></p><p><label for="addtagcoll_searchable"></label>: <input id="addtagcoll_searchable" type="checkbox" value="1" checked/></p><p class="mdl-align"><input type="submit" id="addtagcoll_submit"/><input type="button" id="addtagcoll_cancel"/></p></form></div>');d.find('label[for="addtagcoll_name"]').html(b[1]),d.find('label[for="addtagcoll_searchable"]').html(b[2]),d.find("#addtagcoll_submit").attr("value",b[3]),d.find("#addtagcoll_cancel").attr("value",b[4]),f.use("moodle-core-notification-dialogue",function(){var e=new M.core.dialogue({draggable:!0,modal:!0,closeButton:!0,headerContent:b[0],bodyContent:d.html()});e.show(),a("#addtagcoll_form #addtagcoll_name").focus(),a("#addtagcoll_form #addtagcoll_cancel").on("click",function(){e.destroy()}),a("#addtagcoll_form").on("submit",function(){var b=a("#addtagcoll_form #addtagcoll_name").val(),d=a("#addtagcoll_form #addtagcoll_searchable").prop("checked")?1:0;return String(b).length>0&&(window.location.href=c+"&name="+encodeURIComponent(b)+"&searchable="+d),!1})})})}),a("body").on("click",".tag-collections-table .action_delete",function(b){b.preventDefault();var c=a(this).attr("data-url")+"&sesskey="+M.cfg.sesskey;e.get_strings([{key:"delete"},{key:"suredeletecoll",component:"tag",param:a(this).attr("data-collname")},{key:"yes"},{key:"no"}]).done(function(a){d.confirm(a[0],a[1],a[2],a[3],function(){window.location.href=c})})})}}});
define('core/templates', ["core/mustache","jquery","core/webapi","core/str","core/notification","core/url","core/config","core/localstorage","core/event","core/flex_icon","core/log","core/user_date","core/truncate"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){a.escape=function(a){var b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};return a=String(a).replace(/[&<>"'\/`=]/g,function(a){return b[a]}),a=a.replace(/&amp;#([0-9]+|x[0-9a-fA-F]+);/g,"&#$1")},String.prototype.startsWith||(String.prototype.startsWith=function(a,b){return b=b||0,this.substr(b,a.length)===a});var n={},o={},p=function(c,f){arguments.length>2&&k.debug("template rendering cannot accept themeName parameter");var h=b.Deferred(),i=[],j=[],n=[],o="",p=[],r=[],s=!0,u=!0,v=function(a){var b="",c=q(a);return c.done(function(a){b=a}).fail(e.exception),""===b&&(n.push(c),s=!1),b},w=function(a,b){if(a.indexOf("{{")===-1||a.indexOf("}}")===-1)return a;if(a.match(/^\{{2,3}\s*([a-zA-Z0-9_\.]+)\s*\}{2,3}$/)){var c=a.replace(/^\{{2,3}\s*([a-zA-Z0-9_\.]+)\s*\}{2,3}$/,"$1");if(this.hasOwnProperty(c))return this[c];if(c.indexOf(".")!==-1){var d=this;if(c.split(".").forEach(function(a){d.hasOwnProperty(a)&&(d=d[a])}),null===d)return"";if("function"!=typeof d||"object"!=typeof d)return d.toString()}}return k.debug("Escaped content contains unexpected mustache processing queues. It will be lost."),""},x=function(a,b){var c=a.split(","),d=function(a,b,c,d){var e="",f=0,g=0;return void 0!==c&&""!==c&&(f=p.length,p.push({key:c,component:d}),e="[[_s"+f+"]]"),g=p.length,p.push({key:a,component:b,param:e}),"[[_s"+g+"]]"},e=function(a){var b=a.shift();return void 0===b&&(b=""),b.trim()},f=function(a){return 0===a.indexOf("{{")&&(a=b("{{#esc}}"+a+"{{/esc}}",this)),a},g=function(a){var b=e(a);return b=f(b)},h=function(a){var b=a[0].trim(),c=a[a.length-1].trim();return 0===b.search("{")||"}"===c.substr(c.length-1)},i=function(a,b,c){var d=c.join(",").trim(),e={};0===d.indexOf("{")&&0!==d.indexOf("{{")?(d=f(d),e=JSON.parse(d)):(e=f(d),0===e.indexOf("{")&&0!==e.indexOf("{{")&&(e=JSON.parse(e)));var g=p.length;return p.push({key:a,component:b,param:e}),"[[_s"+g+"]]"},j=g(c),l=g(c),m="",n="";return j.match(/^[a-zA-Z][a-zA-Z0-9\.:\/_\-]*$/)?(""===l?l="core":(!l.match(/^[a-z]+(_[a-z][a-z0-9_]*)?[a-z0-9]+$/)||l.search("__")>0)&&(k.debug("invalid component:"+l),l="core"),0===c.length?d(j,l):h(c)?(k.debug('Legacy string helper API in use for "'+a+'"'),i(j,l,c)):(m=g(c),n=g(c),m.match(/^[a-zA-Z][a-zA-Z0-9\.:\/_\-]*$/)||(k.debug('Invalid string identifier in "'+a+'"'),m=""),""===n?n="":(!n.match(/^[a-z]+(_[a-z][a-z0-9_]*)?[a-z0-9]+$/)||n.search("__")>0)&&(k.debug("Invalid component:"+n),n=""),d(j,l,m,n))):(k.debug('Invalid string identifier in "'+a+'"'),"")},y=function(a,b){var c=a.split(","),d=function(a,b,c){var d=j.length;return a=f(a),j.push(t(a,b,c)),"<_p"+d+">"},e=function(a){var b=a.shift();return void 0===b&&(b=""),b.trim()},f=function(a){return 0===a.indexOf("{{")&&(a=b("{{#esc}}"+a+"{{/esc}}",this)),a},g=function(a){var b=e(a);return b=f(b)},h=f(c.shift().trim()),i=function(a){if(0===a.length)return!1;var b=a[0].trim(),c=a[a.length-1].trim();return(0===b.search("{")||"}"===c.substr(c.length-1))&&((0!==b.search("{{")||"}}"!==c.substr(c.length-2))&&("{"===b[0]&&"}"===c[c.length-1]))},l=function(a,b){var c=b.join(",").trim(),e="",g="";if(""!==c){c.match(/^\{{2}.*?\}{2}$/)&&(c=f(c));try{c=JSON.parse(c)}catch(h){k.error("Unable to parse customdata for flex icon helper. Not valid JSON."),c={}}"undefined"!=typeof c.alt&&(e=f(c.alt)),c.classes&&(g=f(c.classes))}return d(a,e,g)},m="",n="",o="",q="";if(i(c))return k.debug('Legacy flex icon helper API in use for "'+a+'"'),l(h,c);if(m=g(c),""===m||m.match(/^[a-zA-Z][a-zA-Z0-9\.:\/_\-]*$/)||k.debug('Invalid alt identifier for flex icon "'+m+'", it must be a string identifier.'),n=g(c),""!==n&&(!n.match(/^[a-z]+(_[a-z][a-z0-9_]*)?[a-z0-9]+$/)||n.search("__")>0)&&k.debug('Invalid alt identifier for flex icon "'+n+'", it must be a component identifier.'),""!==m){var r=p.length;p.push({key:m,component:n}),o="[[_s"+r+"]]"}else o="";return q=e(c),d(h,o,q)},z=function(a,b){var c=a.split(","),d=function(a,b,c,d){var e=j.length;return""===b&&(b="core"),a=f(a),j.push(t(b+"|"+a,c,d)),"<_p"+e+">"},e=function(a){var b=a.shift();return void 0===b&&(b=""),b.trim()},f=function(a){return 0===a.indexOf("{{")&&(a=b("{{#esc}}"+a+"{{/esc}}",this)),a},g=function(a,b){var c=e(a);return c=f(c,b)},h=function(a){if(0===a.length)return!1;var b=a[0].trim(),c=a[a.length-1].trim();return(0===b.search("{")||"}"===c.substr(c.length-1))&&(0!==b.search("{{")||c.search("}}")===c.length-1)},i=function(a,b,c){var d,e;try{e=JSON.parse(c)}catch(g){e={alt:c}}for(d in e)e.hasOwnProperty(d)&&(e[d]=f(e[d]));return e},l="",m="",n="",o="",q="",r="",s="",u={};if(l=g(c),m=g(c),!c.length)return d(l,m);if(r=e(c),r.match(/^[a-zA-Z][a-zA-Z0-9\.:\/_\-]*$/)){n=r.trim(),o=e(c),""!==o&&(!o.match(/^[a-z]+(_[a-z][a-z0-9_]*)?[a-z0-9]+$/)||o.search("__")>0)&&k.debug("invalid component:"+o);var v=p.length;p.push({key:n,component:o}),q="[[_s"+v+"]]",s=e(c)}else k.debug('Legacy pix API in use for string:"'+a+'" - Please use the pix icon template or new API'),c.unshift(r),h(c)?(u=i(l,m,c.join(",")),u.hasOwnProperty("alt")&&(q=u.alt),u.hasOwnProperty("classes")&&(s=u.classes)):q=f(c.join(","));return"flexicon"===m?y.apply(this,[l+","+q,b]):d(l,m,q,s)},A=function(a,b){return i.push(b(a,this)),""},B=function(a,b){var c=b(a.trim(),this);return c=c.replace('"','\\"').replace(/([\{\}]{2,3})/g,"{{=<% %>=}}$1<%={{ }}=%>"),'"'+c+'"'},C=function(a,b){var c=/(.*?),(.*)/,d=a.match(c),e=b("{{#esc}}"+d[1].trim()+"{{/esc}}",this),f=b(d[2].trim(),this),g=r.length;return r.push({timestamp:parseInt(e,10),format:f}),"[[_t_"+g+"]]"},D=function(a,b){var c=/(.*?),(.*)/,d=a.match(c),e=parseInt(d[1].trim(),10),f=d[2].trim(),g=b("{{#esc}}"+f+"{{/esc}}",this);return m.truncate(g,{length:e,words:!0,ellipsis:"..."})};f.str=function(){return x},f.pix=function(){return z},f.flex_icon=function(){return y},f.js=function(){return A},f.quote=function(){return B},f.userdate=function(){return C},f.esc=function(){return w},f.shortentext=function(){return D},f.globals={config:g};var E=b.Deferred(),F=function(){b.when.apply(b,n).done(function(){if(s&&!u)E.resolve();else{u=!1,i=[],j=[],n=[],o="",p=[],r=[],s=!0;try{o=a.render(c,f,v),F()}catch(b){h.reject(b)}}})};return F(),E.done(function(){for(var a=0;a<j.length;a++)j[a].done(function(a){return function(b,c){i.push(c),o=o.replace("<_p"+a+">",b)}}(a));b.when.apply(b,j).then(function(){var a=b.Deferred();return i=i.join(";\n"),p.length>0?d.get_strings(p).done(function(b){for(var c,d=0;(o.indexOf("[[_s")!==-1||i.indexOf("[[_s")!==-1)&&d<2;){for(c=0;c<b.length;c++){for(;o.indexOf("[[_s"+c+"]]")!==-1;)o=o.replace("[[_s"+c+"]]",b[c]);for(;i.indexOf("[[_s"+c+"]]")!==-1;)i=i.replace("[[_s"+c+"]]",b[c])}d++}r.length>0&&r.forEach(function(a){return a.format=a.format.replace(/\[\[_s\d+\]\]/,function(a){var c=parseInt(a.match(/\d+/),10);return b[c]}),a}),a.resolve()}):a.resolve(),a}).then(function(){return r.length>0?(k.debug("userdate mustache helper in use - This has a potential XSS security issue"),l.get(r).then(function(a){a.forEach(function(a,b){var c="\\[\\[_t_"+b+"\\]\\]",d=new RegExp(c,"g");o=o.replace(d,a),i=i.replace(d,a)})})):b.Deferred().resolve().promise()}).then(function(){h.resolve(o.trim(),i)},function(a){h.reject(a)})}),h.promise()},q=function(a){var d=b.Deferred(),e=a.split("/"),f=e.shift(),i=e.shift(),j=g.theme+"/"+a;if(j in n)return d.resolve(n[j]),d.promise();var k=h.get("core_template/"+j);if(k)return d.resolve(k),n[j]=k,d.promise();if(j in o)return o[j].promise();o[j]=d;var l=c.call({operationName:"core_template_nosession",variables:{component:f,name:i,theme:g.theme}});return l.then(function(a){var b=a.template;h.set("core_template/"+j,b),n[j]=b,d.resolve(b)})["catch"](function(a){d.reject(a)}),d.promise()},r=function(a){if(void 0!==a&&""!==a.trim()){M.util.js_pending("core-templates-customjs"),a+=";M.util.js_complete('core-templates-customjs');";var b=document.createElement("script");b.text=a,document.head.insertAdjacentElement("beforeend",b)}return M.util.js_pending("core-autoinitialise"),new Promise(function(a,b){require(["core/autoinitialise"],function(c){c.scan().then(function(){M.util.js_complete("core-autoinitialise"),a()})["catch"](b)},b)})},s=function(a,c,d,e){var f=b(a);if(f.length){var g=b(c);e?(f.empty(),f.append(g)):f.replaceWith(g),r(d),i.notifyFilterContentUpdated(g)}},t=function(a,c,d,e){var g={};g.classes=d||"",g=b.extend(g,e),Boolean(c)&&("[object Object]"===c.toString()?g=b.extend(g,c):g.alt=c);var h=b.Deferred();return j.getFlexTemplateData(a).done(function(a){"undefined"==typeof a.data&&(a.data={}),a.data.customdata=g,"undefined"==typeof a.data.customdata.title&&"undefined"!=typeof a.data.customdata.alt&&(a.data.customdata.title=a.data.customdata.alt),w.render(a.template,a.data).done(function(a){h.resolve(a)})}).fail(function(){var b=a.split("|");1===b.length&&b.unshift("core");var c=f.imageUrl(b[1],b[0]),d=[{name:"src",value:c},{name:"alt",value:g.alt},{name:"title",value:g.alt}],e=g.classes;delete g.alt,delete g.classes;for(var i in g)d.push({name:i,value:g[i]});w.render("core/pix_icon",{attributes:d,extraclasses:e}).done(h.resolve)}),h.promise()},u=function(a,c,d){var e=b(a);e.length&&(e.prepend(c),r(d),i.notifyFilterContentUpdated(e))},v=function(a,c,d){var e=b(a);e.length&&(e.append(c),r(d),i.notifyFilterContentUpdated(e))},w={render:function(a,c){arguments.length>2&&k.debug("template rendering cannot accept themeName parameter");var d=b.Deferred(),e=b.extend({},c),f=q(a);return f.done(function(a){var b=p(a,e);b.done(function(a,b){d.resolve(a,b)}).fail(function(a){d.reject(a)})}).fail(function(a){d.reject(a)}),d},runTemplateJS:r,replaceNodeContents:function(a,b,c){return s(a,b,c,!0)},replaceNode:function(a,b,c){return s(a,b,c,!1)},prependNodeContents:function(a,b,c){u(a,b,c)},appendNodeContents:function(a,b,c){v(a,b,c)},renderIcon:t,renderPix:function(a,b,c){return t(b+"|"+a,c)},renderAppend:function(a,b,c){var d,f=document.createRange(),g=this;return new Promise(function(h,i){var j=g.render(a,b);j.done(function(a){f.selectNode(c),d=f.createContextualFragment(a),c.insertBefore(d,null),h()}).fail(function(a){e.exception(a),i()})})},renderAppendByItem:function(a,b,c,d){var f,g=document.createRange(),h=this;return new Promise(function(i,j){var k=h.render(a,b);k.done(function(a){g.selectNode(c),f=g.createContextualFragment(a);for(var b=f.querySelectorAll(d),e=0;e<b.length;e++)c.appendChild(b[e]);i()}).fail(function(a){e.exception(a),j()})})},renderReplace:function(a,b,c){var d=this;return new Promise(function(f,g){var h=d.render(a,b);h.done(function(a){c.innerHTML=a,f()}).fail(function(a){e.exception(a),g()})})}};return w});
define('core/tooltip', ["jquery"],function(a){var b=function(b){this._regionSelector=b,a(this._regionSelector).each(function(b,c){var d=a(c).attr("aria-describedby");if(d){var e=document.getElementById(d);if(e){var f="tooltip"==a(e).attr("role");f&&(a(e).hide(),a(c).attr("tabindex","0")),a(c).on("focus",this._handleFocus.bind(this)),a(c).on("mouseover",this._handleMouseOver.bind(this)),a(c).on("mouseout",this._handleMouseOut.bind(this)),a(c).on("blur",this._handleBlur.bind(this)),a(c).on("keydown",this._handleKeyDown.bind(this))}}}.bind(this))};return b.prototype._regionSelector=null,b.prototype._showTooltip=function(b){var c=a(b.target),d=c.attr("aria-describedby");if(d){var e=a(document.getElementById(d));if(e.show(),e.attr("aria-hidden","false"),!e.is(".tooltip")){var f=a('<div class="tooltip-inner"></div>');f.append(e.contents()),e.append(f),e.addClass("tooltip"),e.addClass("bottom"),e.append('<div class="tooltip-arrow"></div>')}var g=c.offset();g.top+=c.height()+10,a(e).offset(g)}},b.prototype._hideTooltip=function(b){var c=a(b.target),d=c.attr("aria-describedby");if(d){var e=document.getElementById(d);a(e).hide(),a(e).attr("aria-hidden","true")}},b.prototype._handleFocus=function(a){this._showTooltip(a)},b.prototype._handleKeyDown=function(a){27==a.which&&this._hideTooltip(a)},b.prototype._handleMouseOver=function(a){this._showTooltip(a)},b.prototype._handleMouseOut=function(b){var c=a(b.target);c.is(":focus")||this._hideTooltip(b)},b.prototype._handleBlur=function(a){this._hideTooltip(a)},b});
define('core/tree', ["jquery"],function(a){var b={ITEM:"[role=treeitem]",GROUP:"[role=treeitem]:has([role=group]), [role=treeitem][aria-owns], [role=treeitem][data-requires-ajax=true]",CLOSED_GROUP:"[role=treeitem]:has([role=group])[aria-expanded=false], [role=treeitem][aria-owns][aria-expanded=false], [role=treeitem][data-requires-ajax=true][aria-expanded=false]",FIRST_ITEM:"[role=treeitem]:first",VISIBLE_ITEM:"[role=treeitem]:visible",UNLOADED_AJAX_ITEM:"[role=treeitem][data-requires-ajax=true][data-loaded=false][aria-expanded=true]"},c=function(c,d){this.treeRoot=a(c),this.treeRoot.data("activeItem",null),this.selectCallback=d,this.keys={tab:9,enter:13,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,asterisk:106},this.initialiseNodes(this.treeRoot),this.setActiveItem(this.treeRoot.find(b.FIRST_ITEM)),this.refreshVisibleItemsCache(),this.bindEventHandlers()};return c.prototype.refreshVisibleItemsCache=function(){this.treeRoot.data("visibleItems",this.treeRoot.find(b.VISIBLE_ITEM))},c.prototype.getVisibleItems=function(){return this.treeRoot.data("visibleItems")},c.prototype.setActiveItem=function(a){var b=this.treeRoot.data("activeItem");a!==b&&(b&&(b.attr("tabindex","-1"),b.attr("aria-selected","false")),a.attr("tabindex","0"),a.attr("aria-selected","true"),this.treeRoot.data("activeItem",a),"function"==typeof this.selectCallback&&this.selectCallback(a))},c.prototype.isGroupItem=function(a){return a.is(b.GROUP)},c.prototype.getGroupFromItem=function(a){return this.treeRoot.find("#"+a.attr("aria-owns"))||a.children("[role=group]")},c.prototype.isGroupCollapsed=function(a){return"false"===a.attr("aria-expanded")},c.prototype.isGroupCollapsible=function(a){return"false"!==a.attr("data-collapsible")},c.prototype.initialiseNodes=function(c){this.removeAllFromTabOrder(c),this.setAriaSelectedFalseOnItems(c);var d=this;c.find(b.UNLOADED_AJAX_ITEM).each(function(){var b=a(this);d.collapseGroup(b),d.expandGroup(b)})},c.prototype.removeAllFromTabOrder=function(b){b.find("*").attr("tabindex","-1"),this.getGroupFromItem(a(b)).find("*").attr("tabindex","-1")},c.prototype.setAriaSelectedFalseOnItems=function(a){a.find(b.ITEM).attr("aria-selected","false")},c.prototype.expandAllGroups=function(){var c=this;this.treeRoot.find(b.CLOSED_GROUP).each(function(){var b=a(this);c.expandGroup(a(this)).done(function(){c.expandAllChildGroups(b)})})},c.prototype.expandAllChildGroups=function(c){var d=this;this.getGroupFromItem(c).find(b.CLOSED_GROUP).each(function(){var b=a(this);d.expandGroup(a(this)).done(function(){d.expandAllChildGroups(b)})})},c.prototype.expandGroup=function(b){var c=a.Deferred(),d="Tree-expandGroup-"+b.attr("id");if(M.util.js_pending(d),c.then(function(){M.util.js_complete(d)}),require(["core/templates"],function(a){a.renderIcon("loading").done(function(a){"pending"===c.state()&&(b.find(".flex-icon").remove(),b.prepend(a))})}),"false"!==b.attr("data-expandable")&&this.isGroupCollapsed(b))if("true"===b.attr("data-requires-ajax")&&"true"!==b.attr("data-loaded")){b.attr("data-loaded",!1);var e=b.closest("[data-ajax-loader]").attr("data-ajax-loader"),f=this;require([e],function(a){a.load(b).done(function(){b.attr("data-loaded",!0),f.initialiseNodes(b),f.finishExpandingGroup(b),c.resolve()})})}else this.finishExpandingGroup(b),c.resolve();else c.resolve();return c},c.prototype.finishExpandingGroup=function(a){var b=this.getGroupFromItem(a);b.attr("aria-hidden","false"),a.parent("li").hasClass("collapsed")&&a.parent("li").removeClass("collapsed").addClass("branch_expanded"),a.attr("aria-expanded","true"),require(["core/templates"],function(b){b.renderIcon("expanded").done(function(b){"true"===a.attr("aria-expanded")&&(a.find(".flex-icon").remove(),a.prepend(b))})}),this.refreshVisibleItemsCache()},c.prototype.collapseGroup=function(a){if(this.isGroupCollapsible(a)&&!this.isGroupCollapsed(a)){var b=this.getGroupFromItem(a);b.attr("aria-hidden","true"),a.attr("aria-expanded","false"),a.parent("li").hasClass("branch_expanded")&&a.parent("li").removeClass("branch_expanded").addClass("collapsed"),require(["core/templates"],function(b){b.renderIcon("collapsed").done(function(b){"false"===a.attr("aria-expanded")&&(a.find(".flex-icon").remove(),a.prepend(b))})}),this.refreshVisibleItemsCache()}},c.prototype.toggleGroup=function(a){"true"===a.attr("aria-expanded")?this.collapseGroup(a):this.expandGroup(a)},c.prototype.handleKeyDown=function(c,d){var e=this.getVisibleItems().index(c);if(d.altKey||d.ctrlKey||d.metaKey||d.shiftKey&&d.keyCode!=this.keys.tab)return!0;switch(d.keyCode){case this.keys.home:return this.getVisibleItems().first().focus(),d.stopPropagation(),!1;case this.keys.end:return this.getVisibleItems().last().focus(),d.stopPropagation(),!1;case this.keys.enter:var f=c.children("a").length?c.children("a"):c.children().not(b.GROUP).find("a");return f.length?window.location.href=f.first().attr("href"):this.isGroupItem(c)&&this.toggleGroup(c,!0),d.stopPropagation(),!1;case this.keys.space:return this.isGroupItem(c)&&this.toggleGroup(c,!0),d.stopPropagation(),!1;case this.keys.left:var g=function(b){b.getVisibleItems().filter(function(){return b.getGroupFromItem(a(this)).has(c).length}).focus()};return this.isGroupItem(c)?this.isGroupCollapsed(c)?g(this):this.collapseGroup(c):g(this),d.stopPropagation(),!1;case this.keys.right:return this.isGroupItem(c)&&(this.isGroupCollapsed(c)?this.expandGroup(c):this.getGroupFromItem(c).find(b.ITEM).first().focus()),d.stopPropagation(),!1;case this.keys.up:if(e>0){var h=this.getVisibleItems().eq(e-1);h.focus()}return d.stopPropagation(),!1;case this.keys.down:if(e<this.getVisibleItems().length-1){var i=this.getVisibleItems().eq(e+1);i.focus()}return d.stopPropagation(),!1;case this.keys.asterisk:return this.expandAllGroups(),d.stopPropagation(),!1}return!0},c.prototype.handleClick=function(a,b){return!!(b.altKey||b.ctrlKey||b.shiftKey||b.metaKey)||(a.focus(),this.isGroupItem(a)&&this.toggleGroup(a),b.stopPropagation(),!0)},c.prototype.handleFocus=function(a,b){return this.setActiveItem(a),b.stopPropagation(),!0},c.prototype.bindEventHandlers=function(){var c=this;this.treeRoot.on({click:function(b){return b.target.closest("a")?(b.stopPropagation(),null):c.handleClick(a(this),b)},keydown:function(b){return c.handleKeyDown(a(this),b)},focus:function(b){return c.handleFocus(a(this),b)}},b.ITEM)},c});
define('core/truncate', ["jquery"],function(a){var b=/(\s*\S+|\s)$/,c=/^(\S*)/,d=/\s/,e=function(a,b){if(null==this)throw TypeError();var c=String(a),d=c.length,e=b?Number(b):0;if(e!=e&&(e=0),e<=-1||e>=d)return"";e=0|e;var f,g=c.charCodeAt(e),h=e+1,i=1;return g>=55296&&g<=56319&&d>h&&(f=c.charCodeAt(h),f>=56320&&f<=57343&&(i=2)),i},f=function(a){for(var b=0,c=0;c<a.length;c+=e(a,c))b++;return b},g=function(a,b){if(!a.length)return 0;var c=0,d=0;do c+=e(a,c),d++;while(c<a.length&&d<b);return c};return a.truncate=function(b,c){return a("<div></div>").append(b).truncate(c).html()},a.fn.truncate=function(e){isNaN(parseFloat(e))||(e={length:e});var h=a.extend({},a.truncate.defaults,e);return this.each(function(){var e=a(this);h.noBreaks&&e.find("br").replaceWith(" ");var i=h.ellipsis.length,j=e.text(),k=f(j),l=k-h.length+i;if(!(k<h.length)){if(h.stripTags&&e.text(j),h.words&&l>0){var m=j.slice(0,g(j,h.length-i)+1),n=m.replace(b,""),o=f(n),p=!m.match(d);l=h.keepFirstWord&&0===o?k-f(c.exec(j)[0])-i:p&&0===o?k-h.length+i:k-o-1}l>k&&(l=k-h.length),l<0||!l&&!h.truncated||a.each(e.contents().get().reverse(),function(b,c){var d=a(c),e=d.text(),j=f(e);if(j<=l)return h.truncated=!0,l-=j,void d.remove();if(3===c.nodeType){var k=j-l;return k=k>=0?g(e,k):0,a(c.splitText(k)).replaceWith(h.ellipsis),!1}return d.truncate(a.extend(h,{length:j-l+i})),!1})}})},a.truncate.defaults={stripTags:!1,words:!1,keepFirstWord:!1,noBreaks:!1,length:1/0,ellipsis:"…"},{truncate:a.truncate}});
define('core/url', ["jquery","core/config"],function(a,b){return{fileUrl:function(a,c){var d=b.wwwroot+a;return"/"!=c.charAt(0)&&(c="/"+c),d+=b.slasharguments?c:"?file="+encodeURIComponent(c)},relativeUrl:function(c,d,e){if(0===c.indexOf("http:")||0===c.indexOf("https:")||c.indexOf("://")>=0)throw new Error("relativeUrl function does not accept absolute urls");"/"!=c.charAt(0)&&(c="/"+c),"admin"!==b.admin&&(c=c.replace(/^\/admin\//,"/"+b.admin+"/")),d=d||{},e&&(d.sesskey=b.sesskey);var f="";return Object.keys(d).length&&(f=a.map(d,function(a,b){return b+"="+a}).join("&")),""!==f?b.wwwroot+c+"?"+f:b.wwwroot+c},imageUrl:function(a,b){return M.util.image_url(a,b)}}});
define('core/user_date', ["jquery","core/ajax","core/sessionstorage","core/config"],function(a,b,c,d){var e={},f=function(b){var c=a("html").attr("lang").replace("-","_");return"core_user_date/"+c+"/"+d.usertimezone+"/"+b.timestamp+"/"+b.format},g=function(a){return c.get(a)},h=function(a,b){c.set(a,b)},i=function(a){return"undefined"!=typeof e[a]},j=function(a){return e[a]},k=function(a,b){e[a]=b},l=function(a){var c=a.map(function(a){return{timestamp:a.timestamp,format:a.format}}),e={methodname:"core_get_user_dates",args:{contextid:d.contextid,timestamps:c}};return b.call([e],!0,!0)[0].then(function(b){b.dates.forEach(function(b,c){var d=a[c],e=f(d);h(e,b),d.deferred.resolve(b)})})["catch"](function(b){a.forEach(function(a){a.deferred.reject(b)})})},m=function(b){var c=[],d=[];return b.forEach(function(b){var e=f(b);if(i(e))d.push(j(e));else{var h=a.Deferred(),l=g(e);l?h.resolve(l):(b.deferred=h,c.push(b)),k(e,h.promise()),d.push(h.promise())}}),c.length&&l(c),a.when.apply(a,d).then(function(){return 1===arguments.length?[arguments[0]]:Array.apply(null,arguments)})};return{get:m}});
define('core/webapi', ["core/config","core/log"],function(a,b){function c(a){if(Error.call(this,a.message),this.graphQLErrors=a.graphQLErrors||[],this.networkError=a.networkError||null,a.message)this.message=a.message;else{var b=[];Array.isArray(this.graphQLErrors)&&this.graphQLErrors.forEach(function(a){var c=a?a.message:"Error message not found.";b.push("GraphQL error: "+c)}),this.networkError&&b.push("Network error: "+this.networkError.message),this.message=b.join("\n")}}function d(a){return a instanceof c?a:new c(a instanceof Error?{networkError:a}:a&&a.errors?{graphQLErrors:a.errors}:{message:String(a)})}function e(a,b,c){var d=Array.isArray(c);for(var e in a){var f=d?c[e]:c;a[e][b](f)}}function f(a,b){function c(){var a=d;d=null;var c=a.map(function(a){return a.arg});b(c).then(function(b){e(a,"resolve",b)},function(b){e(a,"reject",b)}).then(function(){M.util.js_complete(o)})}var d=null,f=null;return function(b){return null===d&&(d=[],f=setTimeout(c,a.timeout),M.util.js_pending(o)),new Promise(function(e,g){d.push({arg:b,resolve:e,reject:g}),d.length>=a.maxSize&&(clearTimeout(f),c())})}}function g(c){M.util.js_pending(n);var d=a.wwwroot+"/totara/webapi/ajax.php"+(Array.isArray(c)?"?operationNames="+c.map(function(a){return a.operationName}).join(","):"?operationName="+c.operationName);return new Promise(function(e,f){fetch(d,{credentials:"same-origin",method:"post",body:JSON.stringify(c),headers:new Headers({"X-Totara-Sesskey":a.sesskey})}).then(function(a){return a.ok?a.json():a.json().then(function(a){return Promise.reject(a)},function(){throw new Error("Request failed with status code "+a.status)})}).then(function(a){M.util.js_complete(n),e(a)})["catch"](function(a){M.util.js_complete(n),m?(b.error("Page unloaded."),b.error(a)):(b.error(a),f(a))})})}function h(a){return{operationName:a.operationName,variables:a.variables||{},extensions:a.extensions}}function i(a){return a.then(function(a){return a.errors?Promise.reject(a):a.data})["catch"](function(a){return Promise.reject(d(a))})}const j=10,k=10;var l=!1,m=!1,n="core_webapi",o="core_webapi_timeout";c.prototype=Object.create(Error.prototype),c.prototype.constructor=c,c.prototype.name="";var p={timeout:j,maxSize:k},q=f(p,g),r=f(p,g);return{call:function(a){l||(window.addEventListener("beforeunload",function(){m=!0}),l=!0);var b,c=h(a);return b=a.batch?a.operationName.endsWith("_nosession")?r(c):q(c):g(c),a.rawResponse?b:i(b)}}});
define('core/yui', function(){return Y});
define('core_calendar/calendar', [],function(){function a(a){var b=a.target.closest('[data-calendar-popover-shown="true"]');if(b){var c=!b.contains(a.relatedTarget);if(c){var d=new CustomEvent("core/popover:hide");b.removeAttribute("data-calendar-popover-shown"),b.querySelector('[data-component="/core/output/popover"]').parentElement.dispatchEvent(d)}}}function b(a){var b=a.target.closest(".hasevent, .today");if(b&&"true"!==b.getAttribute("data-calendar-popover-shown")){c();var d=new CustomEvent("core/popover:show");a.preventDefault(),b.setAttribute("data-calendar-popover-shown",!0),b.querySelector('[data-component="/core/output/popover"]').parentElement.dispatchEvent(d)}}function c(){var a;a=document.querySelectorAll('[data-calendar-popover-shown="true"]');var b=new CustomEvent("core/popover:hide");a.forEach(function(a){a.removeAttribute("data-calendar-popover-shown"),a.querySelector('[data-component="/core/output/popover"]').parentElement.dispatchEvent(b)})}return{init:function(){var c=document.querySelectorAll(".minicalendar"),d=0;for(d=0;d<c.length;d++)c[d].addEventListener("mouseover",b),c[d].addEventListener("focusin",b),c[d].addEventListener("mouseout",a),c[d].addEventListener("focusout",a)}}});
define('core_form/filetypes', ["jquery","core/log","core/str","core/modal_factory","core/modal_events","core/ajax","core/templates","core/tree"],function(a,b,c,d,e,f,g,h){"use strict";var i=function(c,d,e,f){if(this.elementId=c,this.elementLabel=d,this.onlyTypes=e,this.allowAll=f,this.inputField=a("#"+c),this.wrapperBrowserTrigger=a('[data-filetypesbrowser="'+c+'"]'),this.wrapperDescriptions=a('[data-filetypesdescriptions="'+c+'"]'),this.wrapperBrowserTrigger.length)return this.inputField.length&&this.wrapperDescriptions.length?void this.prepareBrowserTrigger().then(function(){return this.prepareBrowserModal()}.bind(this)).then(function(){return this.prepareBrowserTree()}.bind(this)):void b.error("core_form/filetypes: Unexpected DOM structure, unable to enhance filetypes field "+c)};return i.prototype.prepareBrowserTrigger=function(){return g.render("core_form/filetypes-trigger",{}).then(function(a){this.wrapperBrowserTrigger.html(a),this.browserTrigger=this.wrapperBrowserTrigger.find('[data-filetypeswidget="browsertrigger"]')}.bind(this))},i.prototype.prepareBrowserModal=function(){return d.create({type:d.types.SAVE_CANCEL,title:this.elementLabel}).then(function(a){this.browserModal=a}.bind(this)).then(function(){this.browserModal.getRoot().on(e.hidden,function(){this.browserTrigger.focus()}.bind(this)),this.browserModal.getRoot().on(e.save,function(){this.saveBrowserModal()}.bind(this))}.bind(this))},i.prototype.prepareBrowserTree=function(){return this.browserTrigger.on("click",function(b){if(b.preventDefault(),!this.inputField.is("[disabled]")){var c=this.loadBrowserModalBody();c.then(function(){this.browserTree=new h(this.browserModal.getBody()),this.browserTree.handleKeyDown=function(a,b){b.keyCode==this.browserTree.keys.enter||b.keyCode==this.browserTree.keys.space?(b.preventDefault(),b.stopPropagation(),this.toggleCheckbox(a.attr("data-filetypesbrowserkey"))):h.prototype.handleKeyDown.call(this.browserTree,a,b)}.bind(this),this.allowAll&&(this.hideOrShowItemsDependingOnAllowAll(this.browserModal.getRoot().find('input[type="checkbox"][data-filetypesbrowserkey="*"]:first')),this.browserModal.getRoot().on("change",'input[type="checkbox"][data-filetypesbrowserkey="*"]',function(b){this.hideOrShowItemsDependingOnAllowAll(a(b.currentTarget))}.bind(this))),this.browserModal.getRoot().on("change",'input[type="checkbox"][data-filetypesbrowserkey]',function(b){var c=a(b.currentTarget),d=c.attr("data-filetypesbrowserkey");this.browserModal.getRoot().find('input[type="checkbox"][data-filetypesbrowserkey="'+d+'"]').prop("checked",c.prop("checked"))}.bind(this))}.bind(this)).then(function(){this.browserModal.show()}.bind(this)),this.browserModal.setBody(c)}}.bind(this)),a.when()},i.prototype.loadBrowserModalBody=function(){var a={onlytypes:this.onlyTypes.join(),allowall:this.allowAll,current:this.inputField.val()};return f.call([{methodname:"core_form_get_filetypes_browser_data",args:a}])[0].then(function(a){return g.render("core_form/filetypes-browser",{elementid:this.elementId,groups:a.groups})}.bind(this))},i.prototype.toggleCheckbox=function(a){var b=this.browserModal.getRoot().find('input[type="checkbox"][data-filetypesbrowserkey="'+a+'"]:first');b.prop("checked",!b.prop("checked"))},i.prototype.saveBrowserModal=function(){if(this.allowAll){var b=this.browserModal.getRoot().find('input[type="checkbox"][data-filetypesbrowserkey="*"]');if(b.length&&b.prop("checked"))return this.inputField.val("*"),void this.updateDescriptions(["*"])}var c=[];this.browserModal.getRoot().find('input[type="checkbox"]').each(function(){var b=a(this),d=b.attr("data-filetypesbrowserkey");b.prop("checked")&&c.push(d)}),c=c.filter(function(a,b,c){return c.indexOf(a)==b}),this.inputField.val(c.join(" ")),this.updateDescriptions(c)},i.prototype.updateDescriptions=function(a){var b=[];a.forEach(function(a){b.push({description:this.browserModal.getRoot().find('[data-filetypesname="'+a+'"]:first').text().trim(),extensions:this.browserModal.getRoot().find('[data-filetypesextensions="'+a+'"]:first').text().trim()})}.bind(this));var c={hasdescriptions:b.length>0,descriptions:b};return g.render("core_form/filetypes-descriptions",c).then(function(a){this.wrapperDescriptions.html(a)}.bind(this))},i.prototype.hideOrShowItemsDependingOnAllowAll=function(a){var b=this.browserModal.getRoot().find('[role="treeitem"][data-filetypesbrowserkey!="*"]');a.prop("checked")?b.hide():b.show()},{init:function(a,b,c,d){new i(a,b,c,d)}}});
define('core_form/passwordunmask', ["jquery"],function(a){String.prototype.repeat||(String.prototype.repeat=function(a){"use strict";if(null==this)throw new TypeError("can't convert "+this+" to object");var b=""+this;if(a=+a,a!=a&&(a=0),a<0)throw new RangeError("repeat count must be non-negative");if(a==1/0)throw new RangeError("repeat count must be less than infinity");if(a=Math.floor(a),0==b.length||0==a)return"";if(b.length*a>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");for(var c="";1==(1&a)&&(c+=b),a>>>=1,0!=a;)b+=b;return c});var b=function(b){var c=a("#"+b);this.id=b,this.input=null,this.unmaskinput=null,this.input=c,this.unmaskinput=a("#"+b+"unmask"),this.wrap=this.input.parent(".wrap");var d=a('<input type="text" value="" class="inputmask" />');this.input.attr("readonly")&&d.attr("readonly","readonly"),d.insertBefore("#"+b),this.mask=this.wrap.find(".inputmask"),this.updateMask(),this.mask.focus(function(a){c.focus()}),this.unmaskinput.change(a.proxy(this.unmask,this)),this.input.keyup(a.proxy(this.updateMask,this)),this.input.mouseup()};return b.prototype.toString=function(){return"[object PasswordUnmask]"},b.prototype.updateMask=function(){this.mask.val("●".repeat(this.input.val().length))},b.prototype.unmask=function(a){this.unmaskinput.is(":checked")?this.input.parents(".totara_passwordunmask").addClass("unmask-password"):this.input.parents(".totara_passwordunmask").removeClass("unmask-password"),a.stopPropagation()},b});
define('core_grades/edittree_index', ["jquery"],function(a){var b=function(){a("body").on("change",".itemselect.ignoredirty",b.checkMoveMenuState),a("body").on("click",'[data-action="grade_edittree-index-bulkselect"]',b.toggleAllSelectItems),a("body").on("change",".weightoverride",b.toggleWeightInput),a("#menumoveafter").on("change",function(){var b=a(this).closest("form"),c=b.find("#bulkmoveinput");c.val(1),b.submit()}),b.checkMoveMenuState()};return b.toggleWeightInput=function(b){b.preventDefault();var c=a(this),d=c.closest("tr");a('input[name="weight_'+d.data("itemid")+'"]').prop("disabled",!c.prop("checked"))},b.toggleAllSelectItems=function(c){c.preventDefault();var d=a(this),e=d.closest("tr");a("."+e.data("category")+" .itemselect").prop("checked",d.data("checked")),b.checkMoveMenuState()},b.getMoveMenu=function(){return a("#menumoveafter")},b.checkMoveMenuState=function(){var c=b.getMoveMenu();if(!c.length)return!1;var d;return a(".itemselect").each(function(){return d=a(this).prop("checked"),!d}),c.prop("disabled",!d),d},{enhance:b}});
define('core_message/dialogue', ["core/yui"],function(a){var b=function(b,c,d,e,f){this.yuiDialogue=null;var g=this;"undefined"==typeof f&&(f=!1),a.use("moodle-core-notification","timers",function(){var h="480px";f&&(h="800px"),g.yuiDialogue=new M.core.dialogue({headerContent:b,bodyContent:c,draggable:!0,visible:!1,center:!0,modal:!0,width:h}),g.yuiDialogue.after("visibleChange",function(b){b.newVal?"undefined"!=typeof d&&a.soon(function(){d(g),g.yuiDialogue.centerDialogue()}):"undefined"!=typeof e&&a.soon(function(){e(g)})}),g.yuiDialogue.show()})};return b.prototype.close=function(){this.yuiDialogue.hide(),this.yuiDialogue.destroy()},b.prototype.getContent=function(){return this.yuiDialogue.bodyNode.getDOMNode()},b});
define('core_message/message_area', ["jquery","core_message/message_area_contacts","core_message/message_area_messages","core_message/message_area_profile","core_message/message_area_tabs","core_message/message_area_search"],function(a,b,c,d,e,f){function g(b,c,d,e){this.node=a(b),this.pollmin=c,this.pollmax=d,this.polltimeout=e,this._init()}return g.prototype.node=null,g.prototype.pollmin=null,g.prototype.pollmax=null,g.prototype.polltimeout=null,g.prototype._init=function(){new b(this),new c(this),new d(this),new e(this),new f(this)},g.prototype.onDelegateEvent=function(a,b,c){this.node.on(a,b,c)},g.prototype.onCustomEvent=function(a,b){this.node.on(a,b)},g.prototype.trigger=function(a,b){"undefined"==typeof b&&(b=""),this.node.trigger(a,b)},g.prototype.find=function(a){return this.node.find(a)},g.prototype.getCurrentUserId=function(){return this.node.data("userid")},g.prototype.showContactsFirst=function(){return!!this.node.data("displaycontacts")},g});
define('core_message/message_area_actions', ["core_message/message_area_events"],function(a){function b(a){this.messageArea=a}var c={MESSAGES:"[data-region='messages']"};return b.prototype.messageArea=null,b.prototype.chooseMessagesToDelete=function(){0!==this.messageArea.find(c.MESSAGES).length&&this.messageArea.trigger(a.CHOOSEMESSAGESTODELETE)},b});
define('core_message/message_area_contacts', ["jquery","core/ajax","core/templates","core/notification","core/custom_interaction_events","core/str","core_message/message_area_events"],function(a,b,c,d,e,f,g){function h(a){this.messageArea=a,this._init()}var i={CONTACT:"[data-region='contact']",CONTACTICONBLOCKED:"[data-region='contact-icon-blocked']",CONTACTS:"[data-region='contacts'][data-region-content='contacts']",CONTACTSAREA:"[data-region='contacts-area']",CONVERSATIONS:"[data-region='contacts'][data-region-content='conversations']",COURSE:"[data-region='course']",LASTMESSAGETEXT:"[data-region='last-message-text']",LASTMESSAGEUSER:"[data-region='last-message-user']",LOADINGICON:".loading-icon",MESSAGETEXT:"[data-region='message-text']",MESSAGINGAREA:"[data-region='messaging-area']",NOCONTACTS:"[data-region=no-contacts]",SEARCHBOX:"[data-region='search-box']",SEARCHRESULTSAREA:"[data-region='search-results-area']",SEARCHTEXTAREA:"[data-region='search-text-area']",SELECTEDVIEWCONVERSATION:"[data-action='view-contact-msg'].selected",SELECTEDVIEWPROFILE:"[data-action='view-contact-profile'].selected",SHOWMESSAGES:"[data-action='show-messages']",VIEWCONVERSATION:"[data-action='view-contact-msg']",VIEWPROFILE:"[data-action='view-contact-profile']"};return h.prototype._isLoadingConversations=!1,h.prototype._isLoadingContacts=!1,h.prototype._numContactsDisplayed=0,h.prototype._numContactsToRetrieve=20,h.prototype._numConversationsDisplayed=0,h.prototype._numConversationsToRetrieve=20,h.prototype._messageLength=60,h.prototype.messageArea=null,h.prototype._init=function(){e.define(this.messageArea.node,[e.events.activate,e.events.down,e.events.up]),this.messageArea.onCustomEvent(g.MESSAGESEARCHCANCELED,this._viewConversations.bind(this)),this.messageArea.onCustomEvent(g.USERSSEARCHCANCELED,this._viewContacts.bind(this)),this.messageArea.onCustomEvent(g.CONTACTSSELECTED,this._viewContacts.bind(this)),this.messageArea.onCustomEvent(g.CONVERSATIONDELETED,this._deleteConversation.bind(this)),this.messageArea.onCustomEvent(g.CONVERSATIONSSELECTED,this._viewConversations.bind(this)),this.messageArea.onCustomEvent(g.CONTACTSSELECTED,this._viewContacts.bind(this)),this.messageArea.onCustomEvent(g.MESSAGESDELETED,this._updateLastMessage.bind(this)),this.messageArea.onCustomEvent(g.MESSAGESENT,this._handleMessageSent.bind(this)),this.messageArea.onCustomEvent(g.CONTACTREMOVED,function(a,b){this._removeContact(i.CONTACTS,b)}.bind(this)),this.messageArea.onCustomEvent(g.CONTACTADDED,function(a,b){this._addContact(b)}.bind(this)),this.messageArea.onCustomEvent(g.CONTACTBLOCKED,function(a,b){this._blockContact(b)}.bind(this)),this.messageArea.onCustomEvent(g.CONTACTUNBLOCKED,function(a,b){this._unblockContact(b)}.bind(this)),this.messageArea.onCustomEvent(g.CHOOSEMESSAGESTODELETE,this._startDeleting.bind(this)),this.messageArea.onCustomEvent(g.CANCELDELETEMESSAGES,this._stopDeleting.bind(this)),this.messageArea.onDelegateEvent(e.events.activate,i.VIEWCONVERSATION,this._viewConversation.bind(this)),this.messageArea.onDelegateEvent(e.events.activate,i.VIEWPROFILE,this._viewContact.bind(this)),this.messageArea.onDelegateEvent(e.events.activate,i.SHOWMESSAGES,this._showMessagingArea.bind(this)),this.messageArea.onDelegateEvent(e.events.up,i.CONTACT,this._selectPreviousContact.bind(this)),this.messageArea.onDelegateEvent(e.events.down,i.CONTACT,this._selectNextContact.bind(this)),this.messageArea.onDelegateEvent(e.events.up,i.VIEWCONVERSATION,this._selectPreviousConversation.bind(this)),this.messageArea.onDelegateEvent(e.events.down,i.VIEWCONVERSATION,this._selectNextConversation.bind(this)),this.messageArea.onDelegateEvent(e.events.up,i.COURSE,this._selectPreviousCourse.bind()),this.messageArea.onDelegateEvent(e.events.down,i.COURSE,this._selectNextCourse.bind()),this.messageArea.onDelegateEvent("focus",i.SEARCHBOX,this._setSearching.bind(this)),this.messageArea.onDelegateEvent("blur",i.SEARCHBOX,this._clearSearching.bind(this)),e.define(this.messageArea.find(i.CONVERSATIONS),[e.events.scrollBottom]),e.define(this.messageArea.find(i.CONTACTS),[e.events.scrollBottom]),this.messageArea.onDelegateEvent(e.events.scrollBottom,i.CONVERSATIONS,this._loadConversations.bind(this)),this.messageArea.onDelegateEvent(e.events.scrollBottom,i.CONTACTS,this._loadContacts.bind(this)),this.messageArea.showContactsFirst()||(this._numConversationsDisplayed=20)},h.prototype._startDeleting=function(){this.messageArea.find(i.CONTACTSAREA).addClass("editing")},h.prototype._stopDeleting=function(){this.messageArea.find(i.CONTACTSAREA).removeClass("editing")},h.prototype._viewConversations=function(){0===this._numConversationsDisplayed&&this._loadConversations(),this.messageArea.find(i.CONTACTS).hide(),this.messageArea.find(i.CONVERSATIONS).show()},h.prototype._viewContacts=function(){0===this._numContactsDisplayed&&this._loadContacts(),this.messageArea.find(i.CONVERSATIONS).hide(),this.messageArea.find(i.CONTACTS).show()},h.prototype._handleMessageSent=function(a,b,c){this._viewConversations();var d=this._getUserNode(i.CONVERSATIONS,b);if(0===d.length){var e=this._getUserNode(i.CONTACTS,b);if(0===e.length&&(e=this._getUserNode(i.SEARCHRESULTSAREA,b)),0==e.length)return;d=e.clone(),d.attr("data-action","view-contact-msg"),this.messageArea.find(i.CONVERSATIONS+" "+i.NOCONTACTS).remove(),this._numConversationsDisplayed++}d.prependTo(this.messageArea.find(i.CONVERSATIONS)),this.messageArea.find(i.CONVERSATIONS).scrollTop(0),this._updateContactText(d,c,!0),this._setSelectedUser("[data-userid='"+b+"']")},h.prototype._loadConversations=function(){if(this._isLoadingConversations)return!1;this._isLoadingConversations=!0;var a=0;return c.render("core/loading",{}).then(function(a,b){return this._numConversationsDisplayed?c.appendNodeContents(this.messageArea.find(i.CONVERSATIONS),"<div style='text-align:center'>"+a+"</div>",b):c.replaceNodeContents(this.messageArea.find(i.CONVERSATIONS),"<div style='text-align:center'>"+a+"</div>",b),this._getItems("core_message_data_for_messagearea_conversations",this._numConversationsDisplayed,this._numConversationsToRetrieve)}.bind(this)).then(function(b){return a=b.contacts.length,b.isconversation=!0,c.render("core_message/message_area_contacts",b)}).then(function(b,d){this.messageArea.find(i.CONVERSATIONS+" "+i.LOADINGICON).remove(),a>0?(c.appendNodeContents(this.messageArea.find(i.CONVERSATIONS),b,d),this._numConversationsDisplayed+=this._numConversationsToRetrieve):this._numConversationsDisplayed||c.replaceNodeContents(this.messageArea.find(i.CONVERSATIONS),b,d),this._isLoadingConversations=!1}.bind(this)).fail(d.exception)},h.prototype._loadContacts=function(){if(this._isLoadingContacts)return!1;this._isLoadingContacts=!0;var a=0;return c.render("core/loading",{}).then(function(a,b){return this._numContactsDisplayed?c.appendNodeContents(this.messageArea.find(i.CONTACTS),"<div style='text-align:center'>"+a+"</div>",b):c.replaceNodeContents(this.messageArea.find(i.CONTACTS),"<div style='text-align:center'>"+a+"</div>",b),this._getItems("core_message_data_for_messagearea_contacts",this._numContactsDisplayed,this._numContactsToRetrieve)}.bind(this)).then(function(b){return a=b.contacts.length,b.isconversation=!1,c.render("core_message/message_area_contacts",b)}).then(function(b,d){this.messageArea.find(i.CONTACTS+" "+i.LOADINGICON).remove(),a>0?(c.appendNodeContents(this.messageArea.find(i.CONTACTS),b,d),this._numContactsDisplayed+=a):this._numContactsDisplayed||c.replaceNodeContents(this.messageArea.find(i.CONTACTS),b,d),this._isLoadingContacts=!1}.bind(this)).fail(d.exception)},h.prototype._viewConversation=function(b){this.messageArea.trigger(g.CANCELDELETEMESSAGES);var c=a(b.currentTarget).data("userid"),d=a(b.currentTarget).data("messageid"),e="[data-userid='"+c+"']";d&&(e="[data-messageid='"+d+"']"),this._setSelectedUser(e),this.messageArea.trigger(g.CONVERSATIONSELECTED,c),this.messageArea.find(i.SELECTEDVIEWPROFILE).removeClass("selected"),this._showMessagingArea()},h.prototype._viewContact=function(b){this.messageArea.trigger(g.CANCELDELETEMESSAGES);var c=a(b.currentTarget).data("userid");this._setSelectedUser("[data-userid='"+c+"']"),this.messageArea.trigger(g.CONTACTSELECTED,c),this.messageArea.find(i.SELECTEDVIEWCONVERSATION).removeClass("selected"),this._showMessagingArea()},h.prototype._getItems=function(a,c,d){var e=b.call([{methodname:a,args:{userid:this.messageArea.getCurrentUserId(),limitfrom:c,limitnum:d}}]);return e[0]},h.prototype._deleteConversation=function(a,b){this._removeContact(i.CONVERSATIONS,b),this._numConversationsDisplayed--,this._hideMessagingArea(),this._stopDeleting()},h.prototype._updateLastMessage=function(a,b,c){if(c){var d=this._getUserNode(i.CONVERSATIONS,b),e=c.find(i.MESSAGETEXT).text().trim(),f=!1;c.data("useridto")==b&&(f=!0),this._updateContactText(d,e,f)}this._stopDeleting()},h.prototype._addContact=function(){this.messageArea.find(i.CONTACTS).empty(),this._numContactsDisplayed=0,this._loadContacts()},h.prototype._removeContact=function(a,b){this._getUserNode(a,b).remove(),this._numContactsDisplayed--},h.prototype._blockContact=function(a){var b=this._getUserNode(i.CONTACTS,a);b.find(i.CONTACTICONBLOCKED).removeClass("hidden"),b=this._getUserNode(i.CONVERSATIONS,a),b.find(i.CONTACTICONBLOCKED).removeClass("hidden"),b=this._getUserNode(i.SEARCHRESULTSAREA,a),b.find(i.CONTACTICONBLOCKED).removeClass("hidden")},h.prototype._unblockContact=function(a){var b=this._getUserNode(i.CONTACTS,a);b.find(i.CONTACTICONBLOCKED).addClass("hidden"),b=this._getUserNode(i.CONVERSATIONS,a),b.find(i.CONTACTICONBLOCKED).addClass("hidden"),b=this._getUserNode(i.SEARCHRESULTSAREA,a),b.find(i.CONTACTICONBLOCKED).addClass("hidden")},h.prototype._getUserNode=function(a,b){return this.messageArea.find(a+" "+i.CONTACT+"[data-userid='"+b+"']")},h.prototype._setSelectedUser=function(a){this.messageArea.find(i.CONTACT).removeClass("selected"),this.messageArea.find(i.CONTACT).attr("aria-pressed",!1),this.messageArea.find(i.CONTACT+a).addClass("selected"),this.messageArea.find(i.CONTACT+a).attr("aria-pressed",!0)},h.prototype._getContactText=function(a){return a.length>this._messageLength&&(a=a.substr(0,this._messageLength-3),a+="..."),document.createTextNode(a)},h.prototype._updateContactText=function(a,b,c){b=this._getContactText(b),c?f.get_string("you","message","").done(function(b){a.find(i.LASTMESSAGEUSER).empty().append(b)}).always(function(){a.find(i.LASTMESSAGETEXT).empty().append(b)}):(a.find(i.LASTMESSAGEUSER).empty(),a.find(i.LASTMESSAGETEXT).empty().append(b))},h.prototype._selectNextContact=function(b,c){var d=a(b.target).closest(i.CONTACT),e=d.next();e.focus(),c.originalEvent.preventDefault(),c.originalEvent.stopPropagation()},h.prototype._selectPreviousContact=function(b,c){var d=a(b.target).closest(i.CONTACT),e=d.prev();e.focus(),c.originalEvent.preventDefault(),c.originalEvent.stopPropagation()},h.prototype._selectNextCourse=function(b,c){var d=a(b.target).closest(i.COURSE);d.next().focus(),c.originalEvent.preventDefault(),c.originalEvent.stopPropagation()},h.prototype._selectPreviousCourse=function(b,c){var d=a(b.target).closest(i.COURSE);d.prev().focus(),c.originalEvent.preventDefault(),c.originalEvent.stopPropagation()},h.prototype._selectNextConversation=function(b,c){var d=a(b.target).closest(i.VIEWCONVERSATION),e=d.next();e.focus(),c.originalEvent.preventDefault(),c.originalEvent.stopPropagation()},h.prototype._selectPreviousConversation=function(b,c){var d=a(b.target).closest(i.VIEWCONVERSATION),e=d.prev();e.focus(),c.originalEvent.preventDefault(),c.originalEvent.stopPropagation()},h.prototype._setSearching=function(){a(i.SEARCHTEXTAREA).addClass("searching")},h.prototype._clearSearching=function(){a(i.SEARCHTEXTAREA).removeClass("searching")},h.prototype._showMessagingArea=function(){this.messageArea.find(i.MESSAGINGAREA).removeClass("hide-messages").addClass("show-messages")},h.prototype._hideMessagingArea=function(){this.messageArea.find(i.MESSAGINGAREA).removeClass("show-messages").addClass("hide-messages")},h});
define('core_message/message_area_events', [],function(){return{CANCELDELETEMESSAGES:"cancel-delete-messages",CHOOSEMESSAGESTODELETE:"choose-messages-to-delete",CONTACTADDED:"contact-added",CONTACTBLOCKED:"contact-blocked",CONTACTREMOVED:"contact-removed",CONTACTSELECTED:"contact-selected",CONTACTSSELECTED:"contacts-selected",CONTACTUNBLOCKED:"contact-unblocked",CONVERSATIONDELETED:"conversation-deleted",CONVERSATIONSELECTED:"conversation-selected",CONVERSATIONSSELECTED:"conversations-selected",MESSAGESDELETED:"messages-deleted",MESSAGESEARCHCANCELED:"message-search-canceled",MESSAGESENT:"message-sent",SENDMESSAGE:"message-send",USERSSEARCHCANCELED:"users-search-canceled"}});
define('core_message/message_area_messages', ["jquery","core/ajax","core/templates","core/notification","core/custom_interaction_events","core/auto_rows","core_message/message_area_actions","core/modal_factory","core/modal_events","core/str","core_message/message_area_events","core/backoff_timer"],function(a,b,c,d,e,f,g,h,i,j,k,l){function m(a){this.messageArea=a,this._init()}var n=500,o=50,p={BLOCKTIME:"[data-region='blocktime']",CANCELDELETEMESSAGES:"[data-action='cancel-delete-messages']",CONTACT:"[data-region='contact']",CONVERSATIONS:"[data-region='contacts'][data-region-content='conversations']",DELETEALLMESSAGES:"[data-action='delete-all-messages']",DELETEMESSAGES:"[data-action='delete-messages']",LOADINGICON:".loading-icon",MESSAGE:"[data-region='message']",MESSAGERESPONSE:"[data-region='response']",MESSAGES:"[data-region='messages']",MESSAGESAREA:"[data-region='messages-area']",MESSAGINGAREA:"[data-region='messaging-area']",SENDMESSAGE:"[data-action='send-message']",SENDMESSAGETEXT:"[data-region='send-message-txt']",SHOWCONTACTS:"[data-action='show-contacts']",STARTDELETEMESSAGES:"[data-action='start-delete-messages']"},q=1e3;return m.prototype._isSendingMessage=!1,m.prototype._isLoadingMessages=!1,m.prototype._numMessagesDisplayed=0,m.prototype._messageQueue=[],m.prototype._numMessagesToRetrieve=20,m.prototype._confirmationModal=null,m.prototype._latestMessageTimestamp=0,m.prototype._backoffTimer=null,m.prototype.messageArea=null,m.prototype._init=function(){e.define(this.messageArea.node,[e.events.activate,e.events.up,e.events.down,e.events.enter]),a(window).height()<=670&&(n=400),f.init(this.messageArea.node),this.messageArea.onCustomEvent(k.CONVERSATIONSELECTED,this._viewMessages.bind(this)),this.messageArea.onCustomEvent(k.SENDMESSAGE,this._viewMessages.bind(this)),this.messageArea.onCustomEvent(k.CHOOSEMESSAGESTODELETE,this._chooseMessagesToDelete.bind(this)),this.messageArea.onCustomEvent(k.CANCELDELETEMESSAGES,this._hideDeleteAction.bind(this)),this.messageArea.onDelegateEvent(e.events.activate,p.SENDMESSAGE,this._sendMessage.bind(this)),this.messageArea.onDelegateEvent(e.events.activate,p.STARTDELETEMESSAGES,this._startDeleting.bind(this)),this.messageArea.onDelegateEvent(e.events.activate,p.DELETEMESSAGES,this._deleteMessages.bind(this)),this.messageArea.onDelegateEvent(e.events.activate,p.DELETEALLMESSAGES,this._deleteAllMessages.bind(this)),this.messageArea.onDelegateEvent(e.events.activate,p.CANCELDELETEMESSAGES,this._triggerCancelMessagesToDelete.bind(this)),this.messageArea.onDelegateEvent(e.events.activate,p.MESSAGE,this._toggleMessage.bind(this)),this.messageArea.onDelegateEvent(e.events.activate,p.SHOWCONTACTS,this._hideMessagingArea.bind(this)),this.messageArea.onDelegateEvent(e.events.up,p.MESSAGE,this._selectPreviousMessage.bind(this)),this.messageArea.onDelegateEvent(e.events.down,p.MESSAGE,this._selectNextMessage.bind(this)),this.messageArea.onDelegateEvent("focus",p.SENDMESSAGETEXT,this._setMessaging.bind(this)),this.messageArea.onDelegateEvent("blur",p.SENDMESSAGETEXT,this._clearMessaging.bind(this)),a(document).on(f.events.ROW_CHANGE,this._adjustMessagesAreaHeight.bind(this));var b=this.messageArea.find(p.MESSAGES);b.length&&(this._addScrollEventListener(b.find(p.MESSAGE).length),this._latestMessageTimestamp=b.find(p.MESSAGE+":last").data("timecreated")),this._backoffTimer=new l(this._loadNewMessages.bind(this),l.getIncrementalCallback(this.messageArea.pollmin*q,q,this.messageArea.pollmax*q,this.messageArea.polltimeout*q)),this._backoffTimer.start()},m.prototype._viewMessages=function(e,f){this._numMessagesDisplayed=0,this._backoffTimer.stop(),this._latestMessageTimestamp=0;var g=b.call([{methodname:"core_message_mark_all_messages_as_read",args:{useridto:this.messageArea.getCurrentUserId(),useridfrom:f}}]),h=0;return c.render("core/loading",{}).then(function(a,b){return c.replaceNodeContents(this.messageArea.find(p.MESSAGESAREA),a,b),g[0]}.bind(this)).then(function(){var b=this.messageArea.find(p.CONVERSATIONS+" "+p.CONTACT+"[data-userid='"+f+"']");return b.hasClass("unread")&&(b.removeClass("unread"),a(document).trigger("messagearea:conversationselected",f)),this._getMessages(f)}.bind(this)).then(function(a){return h=a.messages.length,c.render("core_message/message_area_messages_area",a)}).then(function(a,b){c.replaceNodeContents(this.messageArea.find(p.MESSAGESAREA),a,b),this._addScrollEventListener(h),this._backoffTimer.restart(),this.messageArea.find(p.SENDMESSAGETEXT).focus()}.bind(this)).fail(d.exception)},m.prototype._loadMessages=function(){if(this._isLoadingMessages)return!1;this._isLoadingMessages=!0;var b=0;return c.render("core/loading",{}).then(function(a,b){return c.prependNodeContents(this.messageArea.find(p.MESSAGES),"<div style='text-align:center'>"+a+"</div>",b),this._getMessages(this._getUserId())}.bind(this)).then(function(a){return b=a.messages.length,c.render("core_message/message_area_messages",a)}).then(function(d,e){if(this.messageArea.find(p.MESSAGES+" "+p.LOADINGICON).remove(),b>0){var f=a("<div>"+d+"</div>");this._hasMatchingBlockTime(this.messageArea.node,f,!0)&&this.messageArea.node.find(p.BLOCKTIME+":first").remove();var g=this.messageArea.find(p.MESSAGES)[0].scrollHeight;c.prependNodeContents(this.messageArea.find(p.MESSAGES),d,e);var h=this.messageArea.find(p.MESSAGES)[0].scrollHeight;this.messageArea.find(p.MESSAGES).scrollTop(h-g),this._numMessagesDisplayed+=b}this._isLoadingMessages=!1}.bind(this)).fail(d.exception)},m.prototype._loadNewMessages=function(){if(this._isLoadingMessages)return!1;if(!this._getUserId())return!1;this._isLoadingMessages=!0;var a=!1,b=this.messageArea.find(p.MESSAGES);if(0!==b.length){var c=b.scrollTop(),e=b.innerHeight(),f=b[0].scrollHeight;c+e>=f&&(a=!0)}return this._getMessages(this._getUserId(),!0).then(function(b){return this._addMessagesToDom(b.messages,a)}.bind(this)).always(function(){this._isLoadingMessages=!1}.bind(this)).fail(d.exception)},m.prototype._getMessages=function(a,c){var e={currentuserid:this.messageArea.getCurrentUserId(),otheruserid:a,limitfrom:this._numMessagesDisplayed,limitnum:this._numMessagesToRetrieve,newest:!0};c&&(e.timefrom=this._latestMessageTimestamp,e.limitfrom=0,e.limitnum=0);var f=b.call([{methodname:"core_message_data_for_messagearea_messages",args:e}]);return f[0].then(function(a){var b=a.messages;if(b&&b.length){var c=b[b.length-1];c.timecreated>this._latestMessageTimestamp&&(this._latestMessageTimestamp=c.timecreated+1)}return a}.bind(this)).fail(function(a){this._backoffTimer.stop(),d.exception(a)}.bind(this))},m.prototype._sendMessage=function(){var a=this.messageArea.find(p.SENDMESSAGETEXT),c=a.val().trim();if(""===c)return!1;if(this._isSendingMessage)return!1;this._isSendingMessage=!0;var e=b.call([{methodname:"core_message_send_instant_messages",args:{messages:[{touserid:this._getUserId(),text:c}]}}]);return a.prop("disabled",!0),e[0].then(function(a){if(a.length<0)throw new Error("Invalid response");if(a[0].errormessage)throw this._isSendingMessage=!1,new Error(a[0].errormessage);return this.messageArea.trigger(k.MESSAGESENT,[this._getUserId(),a[0].msgtext]),this._addLastMessageToDom()}.bind(this)).then(function(){this._isSendingMessage=!1}.bind(this)).always(function(){a.prop("disabled",!1),a.focus()}).fail(d.exception)},m.prototype._chooseMessagesToDelete=function(){this.messageArea.find(p.MESSAGESAREA).addClass("editing"),this.messageArea.find(p.MESSAGE).attr("role","checkbox").attr("aria-checked","false")},m.prototype._deleteMessages=function(){var c=this.messageArea.getCurrentUserId(),e=this.messageArea.find(p.MESSAGE+"[aria-checked='true']"),f=[],g=[];e.each(function(b,d){var e=a(d),h=e.data("messageid"),i=e.data("messageread")?1:0;g.push(e),f.push({methodname:"core_message_delete_message",args:{messageid:h,userid:c,read:i}})}),f.length>0?Promise.all(b.call(f)).then(function(){var b=null,c=this.messageArea.find(p.MESSAGE),d=c.last(),e=g[g.length-1];a.each(g,function(a,b){b.remove()}),d.data("id")===e.data("id")&&(b=this.messageArea.find(p.MESSAGE).last()),a.each(g,function(a,b){var c=b.data("blocktime");0===this.messageArea.find(p.MESSAGE+"[data-blocktime='"+c+"']").length&&this.messageArea.find(p.BLOCKTIME+"[data-blocktime='"+c+"']").remove()}.bind(this)),0===this.messageArea.find(p.MESSAGE).length&&this.messageArea.find(p.CONVERSATIONS+" "+p.CONTACT+"[data-userid='"+this._getUserId()+"']").remove(),this.messageArea.trigger(k.MESSAGESDELETED,[this._getUserId(),b])}.bind(this))["catch"](d.exception):this.messageArea.trigger(k.MESSAGESDELETED,this._getUserId()),this._hideDeleteAction()},m.prototype._addScrollEventListener=function(a){this._scrollBottom(),this._numMessagesDisplayed=a,e.define(this.messageArea.find(p.MESSAGES),[e.events.scrollTop]),this.messageArea.onCustomEvent(e.events.scrollTop,this._loadMessages.bind(this))},m.prototype._deleteAllMessages=function(){return this._confirmationModal?void this._confirmationModal.show():void j.get_strings([{key:"confirm"},{key:"deleteallconfirm",component:"message"}]).then(function(a){return h.create({title:a[0],type:h.types.CONFIRM,body:a[1]},this.messageArea.find(p.DELETEALLMESSAGES))}.bind(this)).then(function(a){this._confirmationModal=a,a.getRoot().on(i.yes,function(){var a=this._getUserId(),c={methodname:"core_message_delete_conversation",args:{userid:this.messageArea.getCurrentUserId(),otheruserid:a}};b.call([c])[0].then(function(){this.messageArea.find(p.MESSAGESAREA).empty(),this.messageArea.trigger(k.CONVERSATIONDELETED,a),this._hideDeleteAction()}.bind(this))["catch"](d.exception)}.bind(this)),a.show()}.bind(this))["catch"](d.exception)},m.prototype._hideDeleteAction=function(){this.messageArea.find(p.MESSAGE).removeAttr("role").removeAttr("aria-checked"),this.messageArea.find(p.MESSAGESAREA).removeClass("editing")},m.prototype._triggerCancelMessagesToDelete=function(){this.messageArea.trigger(k.CANCELDELETEMESSAGES)},m.prototype._addMessagesToDom=function(b,d){var e=0,f=this.messageArea.find(p.MESSAGES);return b=b.filter(function(a){var b=""+a.id+a.isread;if(this._messageQueue[b])return!1;var c=f.find(p.MESSAGE+'[data-id="'+b+'"]');return c.length||(this._messageQueue[b]=!0),!c.length}.bind(this)),e=b.length,c.render("core_message/message_area_messages",{messages:b}).then(function(b,f){if(e>0){var g=a("<div>"+b+"</div>");this._hasMatchingBlockTime(this.messageArea.node,g,!1)&&g.find(p.BLOCKTIME+":first").remove(),c.appendNodeContents(this.messageArea.find(p.MESSAGES),g,f),d&&this._scrollBottom(),this._numMessagesDisplayed+=e,this._backoffTimer.restart()}}.bind(this))},m.prototype._addLastMessageToDom=function(){var a=b.call([{methodname:"core_message_data_for_messagearea_get_most_recent_message",args:{currentuserid:this.messageArea.getCurrentUserId(),otheruserid:this._getUserId()}}]);return a[0].then(function(a){return this._addMessagesToDom([a],!0)}.bind(this)).always(function(){this.messageArea.find(p.SENDMESSAGETEXT).val("").trigger("input")}.bind(this)).fail(d.exception)},m.prototype._getUserId=function(){return this.messageArea.find(p.MESSAGES).data("userid")},m.prototype._scrollBottom=function(){var a=this.messageArea.find(p.MESSAGES);0!==a.length&&a.scrollTop(a[0].scrollHeight)},m.prototype._selectPreviousMessage=function(b,c){var d=a(b.target).closest(p.MESSAGE);do d=d.prev();while(d.length&&!d.is(p.MESSAGE));d.focus(),c.originalEvent.preventDefault(),c.originalEvent.stopPropagation()},m.prototype._selectNextMessage=function(b,c){var d=a(b.target).closest(p.MESSAGE);do d=d.next();while(d.length&&!d.is(p.MESSAGE));d.focus(),c.originalEvent.preventDefault(),c.originalEvent.stopPropagation()},m.prototype._setMessaging=function(b){a(b.target).closest(p.MESSAGERESPONSE).addClass("messaging")},m.prototype._clearMessaging=function(b){a(b.target).closest(p.MESSAGERESPONSE).removeClass("messaging")},m.prototype._startDeleting=function(a){var b=new g(this.messageArea);b.chooseMessagesToDelete(),a.preventDefault()},m.prototype._isEditing=function(){return this.messageArea.find(p.MESSAGESAREA).hasClass("editing")},m.prototype._toggleMessage=function(b){if(this._isEditing()){var c=a(b.target).closest(p.MESSAGE);"true"===c.attr("aria-checked")?c.attr("aria-checked","false"):c.attr("aria-checked","true")}},m.prototype._adjustMessagesAreaHeight=function(){var a=this.messageArea.find(p.MESSAGES),b=this.messageArea.find(p.MESSAGERESPONSE),c=b.outerHeight(),d=c-o,e=n-d;a.outerHeight(e)},m.prototype._sendMessageHandler=function(a,b){b.originalEvent.preventDefault(),this._sendMessage()},m.prototype._hideMessagingArea=function(){this.messageArea.find(p.MESSAGINGAREA).removeClass("show-messages").addClass("hide-messages")},m.prototype._hasMatchingBlockTime=function(a,b,c){var d,e,f,g;return c?(e=":first",g=":last"):(e=":last",g=":first"),d=a.find(p.BLOCKTIME+e),f=b.find(p.BLOCKTIME+g),!(!d.length||!f.length)&&d.data("blocktime")==f.data("blocktime")},m});
define('core_message/message_area_profile', ["jquery","core/ajax","core/templates","core/notification","core/str","core/config","core/custom_interaction_events","core_message/message_area_events"],function(a,b,c,d,e,f,g,h){function i(a){this.messageArea=a,this._init()}var j={PROFILE:"[data-region='profile']",PROFILEADDCONTACT:"[data-action='profile-add-contact']",PROFILEBLOCKCONTACT:"[data-action='profile-block-contact']",PROFILEREMOVECONTACT:"[data-action='profile-remove-contact']",PROFILESENDMESSAGE:"[data-action='profile-send-message']",PROFILEUNBLOCKCONTACT:"[data-action='profile-unblock-contact']",PROFILEVIEW:"[data-action='profile-view']",SHOWCONTACTS:"[data-action='show-contacts']",MESSAGESAREA:"[data-region='messages-area']",MESSAGINGAREA:"[data-region='messaging-area']"};return i.prototype.messageArea=null,i.prototype._init=function(){g.define(this.messageArea.node,[g.events.activate]),this.messageArea.onCustomEvent(h.CONTACTSELECTED,this._viewProfile.bind(this)),this.messageArea.onDelegateEvent(g.events.activate,j.PROFILEVIEW,function(a,b){this._viewFullProfile(),b.originalEvent.preventDefault()}.bind(this)),this.messageArea.onDelegateEvent(g.events.activate,j.PROFILESENDMESSAGE,function(a,b){this._sendMessage(),b.originalEvent.preventDefault()}.bind(this)),this.messageArea.onDelegateEvent(g.events.activate,j.PROFILEUNBLOCKCONTACT,function(a,b){this._unblockContact(),b.originalEvent.preventDefault()}.bind(this)),this.messageArea.onDelegateEvent(g.events.activate,j.PROFILEBLOCKCONTACT,function(a,b){this._blockContact(),b.originalEvent.preventDefault()}.bind(this)),this.messageArea.onDelegateEvent(g.events.activate,j.PROFILEADDCONTACT,function(a,b){this._addContact(),b.originalEvent.preventDefault()}.bind(this)),this.messageArea.onDelegateEvent(g.events.activate,j.PROFILEREMOVECONTACT,function(a,b){this._removeContact(),b.originalEvent.preventDefault()}.bind(this)),this.messageArea.onDelegateEvent(g.events.activate,j.SHOWCONTACTS,this._hideMessagingArea.bind(this))},i.prototype._viewProfile=function(a,f){c.render("core/loading",{}).done(function(a,b){c.replaceNodeContents(this.messageArea.find(j.MESSAGESAREA),a,b)}.bind(this));var g=b.call([{methodname:"core_message_data_for_messagearea_get_profile",args:{currentuserid:this.messageArea.getCurrentUserId(),otheruserid:f}}]);return g[0].then(function(a){return e.get_string("pictureof","core",a.fullname).then(function(b){return a.str_pictureof=b,c.render("core_message/message_area_profile",a)})}).then(function(a,b){c.replaceNodeContents(this.messageArea.find(j.MESSAGESAREA),a,b)}.bind(this)).fail(d.exception)},i.prototype._viewFullProfile=function(){window.location.href=f.wwwroot+"/user/profile.php?id="+this._getUserId()},i.prototype._sendMessage=function(){this.messageArea.trigger(h.SENDMESSAGE,this._getUserId())},i.prototype._blockContact=function(){var a=this._performAction("core_message_block_contacts","unblockcontact","profile-block-contact","profile-unblock-contact","");return a.then(function(){this.messageArea.trigger(h.CONTACTBLOCKED,this._getUserId())}.bind(this))},i.prototype._unblockContact=function(){var a=this._performAction("core_message_unblock_contacts","blockcontact","profile-unblock-contact","profile-block-contact","danger");return a.then(function(){this.messageArea.trigger(h.CONTACTUNBLOCKED,this._getUserId())}.bind(this))},i.prototype._addContact=function(){var a=this._performAction("core_message_create_contacts","removecontact","profile-add-contact","profile-remove-contact","danger");return a.then(function(){this.messageArea.trigger(h.CONTACTADDED,this._getUserId())}.bind(this))},i.prototype._removeContact=function(){var a=this._performAction("core_message_delete_contacts","addcontact","profile-remove-contact","profile-add-contact","");return a.then(function(){this.messageArea.trigger(h.CONTACTREMOVED,this._getUserId())}.bind(this))},i.prototype._performAction=function(a,c,f,g,h){var i=b.call([{methodname:a,args:{userid:this.messageArea.getCurrentUserId(),userids:[this._getUserId()]}}]);return i[0].then(function(){return e.get_string(c,"message")}).then(function(a){this._changeText(a,f,g,h)}.bind(this)).fail(d.exception)},i.prototype._changeText=function(a,b,c,d){var e=this.messageArea.find("[data-action='"+b+"']");e.text(a),e.removeClass(),d&&e.addClass(d),e.attr("data-action",c)},i.prototype._getUserId=function(){return this.messageArea.find(j.PROFILE).data("userid")},i.prototype._hideMessagingArea=function(){this.messageArea.find(j.MESSAGINGAREA).removeClass("show-messages").addClass("hide-messages")},i});
define('core_message/message_area_search', ["jquery","core/ajax","core/templates","core/notification","core/str","core/custom_interaction_events","core_message/message_area_events"],function(a,b,c,d,e,f,g){function h(a){this.messageArea=a,this._init()}var i={CONTACTS:"[data-region='contacts'][data-region-content='contacts']",CONTACTSAREA:"[data-region='contacts-area']",CONVERSATIONS:"[data-region='contacts'][data-region-content='conversations']",DELETESEARCHFILTER:"[data-region='search-filter-area']",LOADINGICON:".loading-icon",SEARCHBOX:"[data-region='search-box']",SEARCHFILTER:"[data-region='search-filter']",SEARCHFILTERAREA:"[data-region='search-filter-area']",SEARCHRESULTSAREA:"[data-region='search-results-area']",SEARCHTEXTAREA:"[data-region='search-text-area']",SEARCHUSERSINCOURSE:"[data-action='search-users-in-course']"},j="message_area_search";return h.prototype.messageArea=null,h.prototype._searchArea=null,h.prototype._courseid=null,h.prototype._isLoading=!1,h.prototype._numMessagesDisplayed=0,h.prototype._numMessagesToRetrieve=20,h.prototype._numUsersDisplayed=0,h.prototype._numUsersToRetrieve=20,h.prototype._searchAreas={MESSAGES:"messages",USERS:"users",USERSINCOURSE:"usersincourse"},h.prototype._requestTimeout=null,h.prototype._init=function(){this.messageArea.find(i.SEARCHTEXTAREA).on("input",this._searchRequest.bind(this)),this.messageArea.onDelegateEvent(f.events.activate,i.SEARCHUSERSINCOURSE,function(b){M.util.js_pending(j),this._setFilter(a(b.currentTarget).html()),this._setPlaceholderText("searchforuser"),this._clearSearchArea(),this._searchArea=this._searchAreas.USERSINCOURSE,this._courseid=a(b.currentTarget).data("courseid"),this._searchUsersInCourse().then(function(){M.util.js_complete(j)}),this.messageArea.find(i.SEARCHBOX).focus()}.bind(this)),this.messageArea.onDelegateEvent(f.events.activate,i.DELETESEARCHFILTER,function(){this._hideSearchResults(),this._searchArea=this._searchAreas.USERS,this._setPlaceholderText("searchforuserorcourse"),this.messageArea.trigger(g.USERSSEARCHCANCELED),this.messageArea.find(i.SEARCHBOX).focus()}.bind(this)),this.messageArea.onCustomEvent(g.CONVERSATIONSSELECTED,function(){this._hideSearchResults(),this._searchArea=this._searchAreas.MESSAGES,this._setPlaceholderText("searchmessages")}.bind(this)),this.messageArea.onCustomEvent(g.CONTACTSSELECTED,function(){this._hideSearchResults(),this._searchArea=this._searchAreas.USERS,this._setPlaceholderText("searchforuserorcourse")}.bind(this)),this.messageArea.onCustomEvent(g.MESSAGESENT,function(){this._hideSearchResults(),this._searchArea=this._searchAreas.MESSAGES,this._setPlaceholderText("searchmessages")}.bind(this)),f.define(this.messageArea.find(i.SEARCHRESULTSAREA),[f.events.scrollBottom]),this.messageArea.onDelegateEvent(f.events.scrollBottom,i.SEARCHRESULTSAREA,function(){M.util.js_pending(j),this._searchArea==this._searchAreas.MESSAGES?this._searchMessages().then(function(){M.util.js_complete(j)}):this._searchArea==this._searchAreas.USERSINCOURSE&&this._searchUsersInCourse().then(function(){M.util.js_complete(j)})}.bind(this)),this._searchArea=this.messageArea.showContactsFirst()?this._searchAreas.USERS:this._searchAreas.MESSAGES},h.prototype._searchRequest=function(){var a=this.messageArea.find(i.SEARCHTEXTAREA+" input").val();return this._requestTimeout&&(clearTimeout(this._requestTimeout),M.util.js_complete(j)),""===a.trim()?void(this._searchArea==this._searchAreas.MESSAGES?(this._hideSearchResults(),this.messageArea.trigger(g.MESSAGESEARCHCANCELED)):this._searchArea==this._searchAreas.USERS?(this._hideSearchResults(),this.messageArea.trigger(g.USERSSEARCHCANCELED)):this._searchArea==this._searchAreas.USERSINCOURSE&&(this._clearSearchArea(),this._searchUsersInCourse())):(this.messageArea.find(i.CONVERSATIONS).hide(),this.messageArea.find(i.CONTACTS).hide(),this.messageArea.find(i.SEARCHRESULTSAREA).show(),M.util.js_pending(j),void(this._searchArea==this._searchAreas.MESSAGES?this._requestTimeout=setTimeout(function(){this._clearSearchArea(),this._numMessagesDisplayed=0,this._searchMessages().then(function(){M.util.js_complete(j)})}.bind(this),300):this._searchArea==this._searchAreas.USERSINCOURSE?this._requestTimeout=setTimeout(function(){this._clearSearchArea(),this._numUsersDisplayed=0,this._searchUsersInCourse().then(function(){M.util.js_complete(j)})}.bind(this),300):this._requestTimeout=setTimeout(function(){this._clearSearchArea(),this._numUsersDisplayed=0,this._searchUsers().then(function(){M.util.js_complete(j)})}.bind(this),300)))},h.prototype._searchMessages=function(){if(this._isLoading)return Promise.resolve();var a=this.messageArea.find(i.SEARCHBOX).val();this._isLoading=!0;var e=b.call([{methodname:"core_message_data_for_messagearea_search_messages",args:{userid:this.messageArea.getCurrentUserId(),search:a,limitfrom:this._numMessagesDisplayed,limitnum:this._numMessagesToRetrieve}}]),f=0;return c.render("core/loading",{}).then(function(a,b){return c.appendNodeContents(this.messageArea.find(i.SEARCHRESULTSAREA),"<div style='text-align:center'>"+a+"</div>",b),e[0]}.bind(this)).then(function(a){return f=a.contacts.length,c.render("core_message/message_area_message_search_results",a)}).then(function(a,b){this.messageArea.find(i.SEARCHRESULTSAREA+" "+i.LOADINGICON).remove(),f>0?(c.appendNodeContents(this.messageArea.find(i.SEARCHRESULTSAREA),a,b),this._numMessagesDisplayed+=f):0==this._numMessagesDisplayed&&c.replaceNodeContents(this.messageArea.find(i.SEARCHRESULTSAREA),a,b),this._isLoading=!1}.bind(this)).fail(d.exception)},h.prototype._searchUsers=function(){var a=this.messageArea.find(i.SEARCHBOX).val(),e=b.call([{methodname:"core_message_data_for_messagearea_search_users",args:{userid:this.messageArea.getCurrentUserId(),search:a,limitnum:this._numUsersToRetrieve}}]);return c.render("core/loading",{}).then(function(a,b){return c.replaceNodeContents(this.messageArea.find(i.SEARCHRESULTSAREA),"<div style='text-align:center'>"+a+"</div>",b),e[0]}.bind(this)).then(function(a){return a.contacts.length>0&&(a.hascontacts=!0),a.courses.length>0&&(a.hascourses=!0),a.noncontacts.length>0&&(a.hasnoncontacts=!0),c.render("core_message/message_area_user_search_results",a)}).then(function(a,b){c.replaceNodeContents(this.messageArea.find(i.SEARCHRESULTSAREA),a,b)}.bind(this)).fail(d.exception)},h.prototype._searchUsersInCourse=function(){if(this._isLoading)return Promise.resolve();var a=this.messageArea.find(i.SEARCHBOX).val();this._isLoading=!0;var e=b.call([{methodname:"core_message_data_for_messagearea_search_users_in_course",args:{userid:this.messageArea.getCurrentUserId(),courseid:this._courseid,search:a,limitfrom:this._numUsersDisplayed,limitnum:this._numUsersToRetrieve}}]),f=0;return c.render("core/loading",{}).then(function(a,b){return c.appendNodeContents(this.messageArea.find(i.SEARCHRESULTSAREA),"<div style='text-align:center'>"+a+"</div>",b),e[0]}.bind(this)).then(function(a){return f=a.contacts.length,f>0&&(a.hascontacts=!0),c.render("core_message/message_area_user_search_results",a)}).then(function(a,b){this.messageArea.find(i.SEARCHRESULTSAREA+" "+i.LOADINGICON).remove(),f>0?(c.appendNodeContents(this.messageArea.find(i.SEARCHRESULTSAREA),a,b),this._numUsersDisplayed+=f):0==this._numUsersDisplayed&&c.replaceNodeContents(this.messageArea.find(i.SEARCHRESULTSAREA),a,b),this._isLoading=!1}.bind(this)).fail(d.exception)},h.prototype._setPlaceholderText=function(a){return e.get_string(a,"message").then(function(a){this.messageArea.find(i.SEARCHTEXTAREA+" input").attr("placeholder",a)}.bind(this))},h.prototype._setFilter=function(a){this.messageArea.find(i.SEARCHBOX).val(""),this.messageArea.find(i.CONTACTSAREA).addClass("searchfilter"),this.messageArea.find(i.SEARCHFILTERAREA).show(),this.messageArea.find(i.SEARCHFILTER).html(a),e.get_string("removecoursefilter","message",a).then(function(a){this.messageArea.find(i.SEARCHFILTERAREA).attr("aria-label",a)}.bind(this))["catch"](d.exception)},h.prototype._clearFilters=function(){this.messageArea.find(i.CONTACTSAREA).removeClass("searchfilter"),this.messageArea.find(i.SEARCHFILTER).empty(),this.messageArea.find(i.SEARCHFILTERAREA).hide(),this.messageArea.find(i.SEARCHFILTERAREA).removeAttr("aria-label")},h.prototype._clearSearchArea=function(){this.messageArea.find(i.SEARCHRESULTSAREA).empty()},h.prototype._hideSearchResults=function(){this._clearFilters(),this.messageArea.find(i.SEARCHTEXTAREA+" input").val(""),this._clearSearchArea(),this.messageArea.find(i.SEARCHRESULTSAREA).hide()},h});
define('core_message/message_area_tabs', ["core/custom_interaction_events","core_message/message_area_events"],function(a,b){function c(a){this.messageArea=a,this._init()}var d={ACTIVECONTACTSTAB:"[data-region='contacts-area'] [role='tab'][aria-selected='true']",CONTACTSPANELS:"[data-region='contacts']",VIEWCONTACTS:"[data-action='contacts-view']",VIEWCONVERSATIONS:"[data-action='conversations-view']"};return c.prototype.messageArea=null,c.prototype._init=function(){a.define(this.messageArea.node,[a.events.activate,a.events.up,a.events.down,a.events.next,a.events.previous,a.events.ctrlPageUp,a.events.ctrlPageDown]),this.messageArea.onDelegateEvent(a.events.activate,d.VIEWCONVERSATIONS,this._viewConversations.bind(this)),this.messageArea.onDelegateEvent(a.events.activate,d.VIEWCONTACTS,this._viewContacts.bind(this)),this.messageArea.onDelegateEvent(a.events.up,d.VIEWCONVERSATIONS,this._toggleTabs.bind(this)),this.messageArea.onDelegateEvent(a.events.down,d.VIEWCONVERSATIONS,this._toggleTabs.bind(this)),this.messageArea.onDelegateEvent(a.events.next,d.VIEWCONVERSATIONS,this._toggleTabs.bind(this)),this.messageArea.onDelegateEvent(a.events.previous,d.VIEWCONVERSATIONS,this._toggleTabs.bind(this)),this.messageArea.onDelegateEvent(a.events.up,d.VIEWCONTACTS,this._toggleTabs.bind(this)),this.messageArea.onDelegateEvent(a.events.down,d.VIEWCONTACTS,this._toggleTabs.bind(this)),this.messageArea.onDelegateEvent(a.events.next,d.VIEWCONTACTS,this._toggleTabs.bind(this)),this.messageArea.onDelegateEvent(a.events.previous,d.VIEWCONTACTS,this._toggleTabs.bind(this)),this.messageArea.onDelegateEvent(a.events.ctrlPageUp,d.CONTACTSPANELS,this._toggleTabs.bind(this)),this.messageArea.onDelegateEvent(a.events.ctrlPageDown,d.CONTACTSPANELS,this._toggleTabs.bind(this)),this.messageArea.onCustomEvent(b.MESSAGESENT,function(){this._selectTab(d.VIEWCONVERSATIONS,d.VIEWCONTACTS)}.bind(this))},c.prototype._viewConversations=function(){this.messageArea.trigger(b.CONVERSATIONSSELECTED),this._selectTab(d.VIEWCONVERSATIONS,d.VIEWCONTACTS)},c.prototype._viewContacts=function(){this.messageArea.trigger(b.CONTACTSSELECTED),this._selectTab(d.VIEWCONTACTS,d.VIEWCONVERSATIONS)},c.prototype._selectTab=function(a,b){b=this.messageArea.find(b),b.removeClass("selected"),b.attr("aria-selected","false"),b.attr("tabindex","-1"),a=this.messageArea.find(a),a.addClass("selected"),a.attr("aria-selected","true"),a.attr("tabindex","0")},c.prototype._toggleTabs=function(a,b){var c=this.messageArea.find(d.ACTIVECONTACTSTAB);c.is(d.VIEWCONVERSATIONS)?this._viewContacts():this._viewConversations(),this.messageArea.find(d.ACTIVECONTACTSTAB).focus(),a.preventDefault(),a.stopPropagation(),b.originalEvent.preventDefault(),b.originalEvent.stopPropagation()},c});
define('core_message/message_notification_preference', ["jquery","core_message/notification_preference"],function(a,b){var c={PREFERENCE_KEY:"[data-preference-key]"},d=function(a,c){b.call(this,a,c)};return d.prototype=Object.create(b.prototype),d.prototype.constructor=d,d.prototype.getPreferenceKey=function(){return this.root.find(c.PREFERENCE_KEY).attr("data-preference-key")},d});
define('core_message/message_preferences', ["jquery","core/ajax","core/notification","core_message/message_notification_preference","core/custom_interaction_events"],function(a,b,c,d,e){var f={PREFERENCE:"[data-state]",PREFERENCES_CONTAINER:'[data-region="preferences-container"]',BLOCK_NON_CONTACTS:'[data-region="block-non-contacts-container"] [data-block-non-contacts]',BLOCK_NON_CONTACTS_CONTAINER:'[data-region="block-non-contacts-container"]'},g=function(b){this.root=a(b),this.userId=this.root.find(f.PREFERENCES_CONTAINER).attr("data-user-id"),this.registerEventListeners()};return g.prototype.preferencesDisabled=function(){return this.root.find(f.PREFERENCES_CONTAINER).hasClass("disabled")},g.prototype.saveBlockNonContactsStatus=function(){var d=this.root.find(f.BLOCK_NON_CONTACTS),e=this.root.find(f.BLOCK_NON_CONTACTS_CONTAINER),g=d.prop("checked");if(e.hasClass("loading"))return a.Deferred().resolve();e.addClass("loading");var h={methodname:"core_user_update_user_preferences",args:{userid:this.userId,preferences:[{type:d.attr("data-preference-key"),value:g?1:0}]}};return b.call([h])[0].fail(c.exception).always(function(){e.removeClass("loading")})},g.prototype.registerEventListeners=function(){e.define(this.root,[e.events.activate]),this.root.on(e.events.activate,f.BLOCK_NON_CONTACTS,function(){this.saveBlockNonContactsStatus()}.bind(this)),this.root.on("change",function(b){if(!this.preferencesDisabled()){var c=a(b.target).closest(f.PREFERENCES_CONTAINER),e=a(b.target).closest(f.PREFERENCE),g=new d(c,this.userId);e.addClass("loading"),g.save().always(function(){e.removeClass("loading")})}}.bind(this))},g});
define('core_message/message_repository', ["jquery","core/ajax","core/notification"],function(a,b,c){var d=function(a){"undefined"==typeof a.limit&&(a.limit=0),"undefined"==typeof a.offset&&(a.offset=0),a.limitfrom=a.offset,a.limitnum=a.limit,delete a.limit,delete a.offset;var d={methodname:"core_message_data_for_messagearea_conversations",args:a},e=b.call([d])[0];return e.fail(c.exception),e},e=function(a){var d={methodname:"core_message_get_unread_conversations_count",args:a},e=b.call([d])[0];return e.fail(c.exception),e},f=function(a){var d={methodname:"core_message_mark_all_messages_as_read",args:a},e=b.call([d])[0];return e.fail(c.exception),e};return{query:d,countUnreadConversations:e,markAllAsRead:f}});
define('core_message/notification_preference', ["jquery","core/ajax","core/notification","core_message/notification_processor"],function(a,b,c,d){var e={PROCESSOR:"[data-processor-name]",STATE_INPUTS:"[data-state] input"},f=function(b,c){this.root=a(b),this.userId=c};return f.prototype.getPreferenceKey=function(){return this.root.attr("data-preference-key")},f.prototype.getLoggedInPreferenceKey=function(){return this.getPreferenceKey()+"_loggedin"},f.prototype.getLoggedOffPreferenceKey=function(){return this.getPreferenceKey()+"_loggedoff"},f.prototype.getProcessors=function(){return this.root.find(e.PROCESSOR).map(function(b,c){return new d(a(c))})},f.prototype.startLoading=function(){this.root.addClass("loading"),this.root.find(e.STATE_INPUTS).prop("disabled",!0)},f.prototype.stopLoading=function(){this.root.removeClass("loading"),this.root.find(e.STATE_INPUTS).prop("disabled",!1)},f.prototype.isLoading=function(){return this.root.hasClass("loading")},f.prototype.save=function(){if(this.isLoading())return a.Deferred().resolve();this.startLoading();var d="",e="";this.getProcessors().each(function(a,b){b.isLoggedInEnabled()&&(""===d?d=b.getName():d+=","+b.getName()),b.isLoggedOffEnabled()&&(""===e?e=b.getName():e+=","+b.getName())}),""===d&&(d="none"),""===e&&(e="none");var f={userid:this.userId,preferences:[{type:this.getLoggedInPreferenceKey(),value:d},{type:this.getLoggedOffPreferenceKey(),value:e}]},g={methodname:"core_user_update_user_preferences",args:f};return b.call([g])[0].fail(c.exception).always(function(){this.stopLoading()}.bind(this))},f});
define('core_message/notification_processor', ["jquery"],function(a){var b={STATE_NONE:'[data-state="none"]',STATE_BOTH:'[data-state="both"]',STATE_LOGGED_IN:'[data-state="loggedin"]',STATE_LOGGED_OFF:'[data-state="loggedoff"]'},c=function(b){this.root=a(b)};return c.prototype.getName=function(){return this.root.attr("data-processor-name")},c.prototype.isLoggedInEnabled=function(){var a=this.root.find(b.STATE_NONE).find("input");if(a.prop("checked"))return!1;var c=this.root.find(b.STATE_BOTH).find("input"),d=this.root.find(b.STATE_LOGGED_IN).find("input");return d.prop("checked")||c.prop("checked")},c.prototype.isLoggedOffEnabled=function(){var a=this.root.find(b.STATE_NONE).find("input");if(a.prop("checked"))return!1;var c=this.root.find(b.STATE_BOTH).find("input"),d=this.root.find(b.STATE_LOGGED_OFF).find("input");return d.prop("checked")||c.prop("checked")},c});
define('core_message/notification_processor_settings', ["jquery","core/ajax","core/notification","core/fragment","core/templates","core/str","core_message/dialogue"],function(a,b,c,d,e,f,g){var h={PROCESSOR:"[data-processor-name]",PREFERENCE_ROW:'[data-region="preference-row"]'},i=function(b){this.root=a(b),this.name=this.root.attr("data-name"),this.userId=this.root.attr("data-user-id"),this.contextId=this.root.attr("data-context-id")};return i.prototype.show=function(){d.loadFragment("message","processor_settings",this.contextId,{userid:this.userId,type:this.name}).done(function(b,c){f.get_string("processorsettings","message").done(function(d){var f=new g(d,b,function(){e.runTemplateJS(c)},function(){f.close()});a(document).on("mpp:formsubmitted",function(){f.close(),this.updateConfiguredStatus()}.bind(this)),a(document).on("mpp:formcancelled",function(){f.close()})}.bind(this))}.bind(this))},i.prototype.updateConfiguredStatus=function(){var d=this.root.closest(h.PROCESSOR);if(!d.hasClass("unconfigured"))return!1;var e=d.attr("data-processor-name"),f={methodname:"core_message_get_message_processor",args:{name:e,userid:this.userId}};return b.call([f])[0].fail(c.exception).done(function(b){if(b.userconfigured){var c=a(h.PREFERENCE_ROW+' [data-processor-name="'+e+'"]');d.removeClass("unconfigured"),c.removeClass("disabled")}})},i});
define('core_message/preferences_notifications_list_controller', ["jquery","core/ajax","core/notification","core/custom_interaction_events","core_message/notification_preference","core_message/notification_processor_settings"],function(a,b,c,d,e,f){var g={DISABLE_NOTIFICATIONS:'[data-region="disable-notification-container"] [data-disable-notifications]',DISABLE_NOTIFICATIONS_CONTAINER:'[data-region="disable-notification-container"]',PREFERENCE:"[data-state]",PREFERENCE_ROW:'[data-region="preference-row"]',PREFERENCE_INPUT:"[data-state] input",PROCESSOR_SETTING:"[data-processor-setting]"},h=function(b){this.root=a(b),this.userId=this.root.attr("data-user-id"),this.registerEventListeners()};return h.prototype.isDisabled=function(){return this.root.hasClass("disabled")},h.prototype.setDisabled=function(){this.root.addClass("disabled"),this.root.find(g.PREFERENCE_INPUT).prop("disabled",!0)},h.prototype.setEnabled=function(){this.root.removeClass("disabled"),this.root.find(g.PREFERENCE_INPUT).prop("disabled",!1)},h.prototype.toggleDisableAllStatus=function(){var d=a(g.DISABLE_NOTIFICATIONS),e=a(g.DISABLE_NOTIFICATIONS_CONTAINER),f=d.prop("checked");if(e.hasClass("loading"))return a.Deferred().resolve();e.addClass("loading");var h={methodname:"core_user_update_user_preferences",args:{userid:this.userId,emailstop:f?1:0}};return b.call([h])[0].done(function(){f?this.setDisabled():this.setEnabled()}.bind(this)).always(function(){e.removeClass("loading")}).fail(c.exception)},h.prototype.registerEventListeners=function(){var b=a(g.DISABLE_NOTIFICATIONS);d.define(this.root,[d.events.activate]),this.root.on("change",function(b){if(!this.isDisabled()){var c=a(b.target).closest(g.PREFERENCE),d=a(b.target).closest(g.PREFERENCE_ROW),f=new e(d,this.userId);c.addClass("loading"),f.save().always(function(){c.removeClass("loading")})}}.bind(this)),this.root.on(d.events.activate,g.PROCESSOR_SETTING,function(b,c){var d=a(b.target).closest(g.PROCESSOR_SETTING),e=new f(d);e.show(),c.originalEvent.preventDefault()}),d.define(b,[d.events.activate]),b.on(d.events.activate,function(){this.toggleDisableAllStatus()}.bind(this))},h});
define('core_message/preferences_processor_form', ["jquery","core/ajax","core/notification","core/custom_interaction_events"],function(a,b,c,d){var e=function(b){this.root=a(b),this.userId=this.root.attr("data-user-id"),this.name=this.root.attr("data-processor-name"),this.root.find("form").on("submit",function(b){b.preventDefault(),this.save().done(function(){a(document).trigger("mpp:formsubmitted")})}.bind(this));var c=this.root.find("[data-cancel-button]");d.define(c,[d.events.activate]),c.on(d.events.activate,function(){a(document).trigger("mpp:formcancelled")})};return e.prototype.startLoading=function(){this.root.addClass("loading")},e.prototype.stopLoading=function(){this.root.removeClass("loading")},e.prototype.isLoading=function(){return this.root.hasClass("loading")},e.prototype.save=function(){if(this.isLoading())return a.Deferred();this.startLoading();var d=this.root.find("form").serializeArray(),e={methodname:"core_message_message_processor_config_form",args:{userid:this.userId,name:this.name,formvalues:d}};return b.call([e])[0].fail(c.exception).always(function(){this.stopLoading()}.bind(this))},e});
define('core_message/toggle_contact_button', ["jquery","core/ajax","core/templates","core/notification","core/custom_interaction_events"],function(a,b,c,d,e){var f=function(a){return"1"==a.attr("data-is-contact")},g=function(a){a.attr("data-is-contact","1")},h=function(a){a.attr("data-is-contact","0")},i=function(a){return a.attr("data-userid")},j=function(a){return a.hasClass("loading")||a.attr("disabled")},k=function(c,e){return j(c)?a.Deferred():(c.addClass("loading"),c.attr("disabled","disabled"),b.call([e])[0].fail(d.exception).always(function(){c.removeClass("loading"),c.removeAttr("disabled")}))},l=function(a){if(!j(a)){var b={methodname:"core_message_create_contacts",args:{userids:[i(a)]}};k(a,b).done(function(){g(a),c.render("message/remove_contact_button",{}).done(function(b,d){c.replaceNodeContents(a,b,d)})})}},m=function(a){if(!j(a)){var b={methodname:"core_message_delete_contacts",args:{userids:[i(a)]}};k(a,b).done(function(){h(a),c.render("message/add_contact_button",{}).done(function(b,d){c.replaceNodeContents(a,b,d)})})}},n=function(b){b=a(b),b.children(".loading-icon").length||c.render("core/loading",{}).done(function(a,c){b.append(a,c)}),e.define(b,[e.events.activate]),b.on(e.events.activate,function(a,c){f(b)?m(b):l(b),a.preventDefault(),c.originalEvent.preventDefault()})};return{enhance:n}});
define('core_elementlibrary/animate_scroll', ["jquery","core/log"],function(a,b){a.fn.animateScroll=function(c){c=a.extend({},a.fn.animateScroll.defaults,c);var d=a("html, body"),e=this.filter('a[href^="#"][href!="#"]');return e.on("click.animateScroll",function(e){e.preventDefault();var f=e.target.getAttribute("href"),g=a(f);if(g.length<1)return void b.debug("elementlibrary/pattern_library: Scroll target '"+f+"' not found in document");var h=g.first().offset().top+"px";d.stop().animate({"scroll-top":h},c.duration,c.easing)}),this},a.fn.animateScroll.defaults={duration:500,easing:"swing"}});
define('core_elementlibrary/competency_item', ["core/config","core/str"],function(a,b){var c={id:0,init:function(){var d=a.wwwroot+"/totara/hierarchy/prefix/competency/related/",e=[];e.push({key:"save",component:"totara_core"}),e.push({key:"cancel",component:"moodle"}),e.push({key:"assignrelatedcompetencies",component:"totara_hierarchy"}),b.get_strings(e).done(function(a){for(var b=[],f=0;f<e.length;f++)b[e[f].key]=a[f];var g=new totaraDialog_handler_treeview_multiselect,h={};h[b.save]=function(){g._dialog.hide()},h[b.cancel]=function(){g._cancel()},totaraDialogs[name]=new totaraDialog("related","show-related-dialog",{buttons:h,title:"<h2>"+b.assignrelatedcompetencies+"</h2>"},d+"find.php?id="+c.id,g)})}};return c});
define('core_elementlibrary/pattern_library', ["jquery","core_elementlibrary/animate_scroll"],function(a){return{init:function(){a('.pattern-library__nav a, a[href^="#"]').animateScroll(),a(".nav-tabs li a").on("click",function(a){a.preventDefault()})}}});
define('availability_audience/ajax_handler', ["jquery","core/config"],function(a,b){var c={};return{processResults:function(a,b){return b},transport:function(d,e,f,g){function h(a){for(var b,c=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),d=0;d<c.length;d++)if(b=c[d].split("="),b[0]===a)return b[1];return null}function i(){return h("course")}function j(){return h("update")}if(""!==e.trim()){var k=i(),l=j();void 0===c[e]&&(c[e]=a.ajax({url:b.wwwroot+"/availability/condition/audience/ajax.php",type:"POST",data:{filter:e,course:k,coursemodule:l}})),c[e].done(function(a){f(a)}).fail(g)}}}});
define('availability_hierarchy_organisation/ajax_handler', ["jquery","core/config"],function(a,b){var c={};return{processResults:function(a,b){return b},transport:function(b,d,e,f){""!==d.trim()&&(void 0===c[d]&&(c[d]=a.ajax({url:M.cfg.wwwroot+"/availability/condition/hierarchy_organisation/ajax.php",type:"POST",data:{filter:d}})),c[d].done(function(a){e(a)}).fail(f))}}});
define('availability_hierarchy_position/ajax_handler', ["jquery","core/config"],function(a,b){var c={};return{processResults:function(a,b){return b},transport:function(b,d,e,f){""!==d.trim()&&(void 0===c[d]&&(c[d]=a.ajax({url:M.cfg.wwwroot+"/availability/condition/hierarchy_position/ajax.php",type:"POST",data:{filter:d}})),c[d].done(function(a){e(a)}).fail(f))}}});
define('mod_assessment/attempt', ["jquery","core/notification","core/str","core/templates","totara_form/form"],function(a,b,c,d,e){return{initialize:function(){var e,f=!1,g=!1,h=a("#tf_fid_mod_assessment_form_page");h.attr("name","active_assessment_form"),h.find(".tf_element_input input").change(function(a){g=!0}),h.find("input[type=submit]").click(function(f){if("save"===a(this).attr("name")||h[0].checkValidity())h.find("input").removeAttr("required");else{var g=[{key:"error:missingrequired",component:"mod_assessment"}];c.get_strings(g).then(function(a){var c={message:a[0],announce:!0,closebutton:!0};d.render("core/notification_error",c).then(function(a,b){h.find(":first-child").hasClass("alert")||h.prepend(a)}).fail(b.exception)})}e=a(this)}),h.submit(function(a){"cancel"!=e.attr("name")&&(f=!0)}),window.onbeforeunload=function(a){if(g&&!f)return!0}}}});
define('mod_assessment/chooseroleuser', ["jquery"],function(a){var b={init:function(b){"browse"==b?a("#search-tab").hide():a("#browse-tab").hide();var c=a(".selectedroleuser");a('a[href="#browse-tab"]').click(function(b){b.preventDefault(),a("#browse-tab").show(),a("#search-tab").hide()}),a('a[href="#search-tab"]').click(function(b){b.preventDefault(),a("#browse-tab").hide(),a("#search-tab").show()}),a(".treeview .clickable").click(function(b){b.preventDefault();var d=a(this).attr("id").substr(5);c.html(a(this).find("a").html()),a('#tf_fid_mod_assessment_form_chooseroleuser input[name="selected"]').val(d)})}};return b});
define('mod_assessment/markreviewed', ["jquery"],function(a){return{initialize:function(){a('a[data-action="markreviewed"]').click(function(b){b.preventDefault();var c=a(this);c.removeClass("btn-primary"),a.ajax({url:M.cfg.wwwroot+"/mod/assessment/ajax/markasreviewed.php",data:{attemptid:c.data("attemptid"),sesskey:M.cfg.sesskey},success:function(a){c.html(a.message),"OK"==a.status?(c.addClass("btn-success"),c.delay(600).fadeOut()):c.addClass("btn-danger")}})})}}});
define('mod_assessment/updaterule', ["jquery","core/modal_factory","core/modal_events"],function(a,b,c){return{init:function(){a("#region-main input:radio").change(function(){a(this).closest("form").submit()}),a("#region-main input:checkbox").change(function(){a(this).closest("form").submit()}),a("#region-main form").on("submit",function(){window.onbeforeunload=null}),a('a[data-action="deleteitem"]').on("click",function(){var d=a(this);b.create({type:b.types.CONFIRM,body:M.util.get_string("deleteruleitemconfirm","assessment")}).then(function(b){b.getRoot().on(c.yes,function(){var b=[],c=a("#rule"+d.data("ruleid")),e=c.find('.ruleparamcontainer a[data-action="deleteitem"]');e.each(function(c,e){a(e).data("itemid")!==d.data("itemid")&&b.push(a(e).data("itemid"))}),a.ajax({url:M.cfg.wwwroot+"/mod/assessment/ajax/editrule.php?sesskey="+M.cfg.sesskey+"&ruleid="+d.data("ruleid")+"&versionid="+d.data("versionid")+"&role="+d.data("role")+"&value="+b,success:function(){location.reload()}})}),b.show()})}),a('a[data-action="delete"]').click(function(){var d=a(this);b.create({type:b.types.CONFIRM,body:M.util.get_string("deleteruleconfirm","assessment")}).then(function(b){b.getRoot().on(c.yes,function(){a.ajax({url:M.cfg.wwwroot+"/mod/assessment/ajax/deleterule.php?sesskey="+M.cfg.sesskey+"&ruleid="+d.data("ruleid"),success:function(){location.reload()}})}),b.show()})})}}});
define('mod_assign/grading_actions', ["jquery","mod_assign/grading_events"],function(a,b){var c=function(b){this._regionSelector=b,this._region=a(b),this.registerEventListeners()};return c.prototype._regionSelector=null,c.prototype._lastUserId=0,c.prototype._region=null,c.prototype._showActionsForm=function(a,b){var c=this._region.find("[data-region=grading-actions-form]");b!=this._lastUserId&&b>0&&(this._lastUserId=b),b>0?c.removeClass("hide"):c.addClass("hide")},c.prototype._trigger=function(b){a(document).trigger(b)},c.prototype.getReviewPanelElement=function(){return a('[data-region="review-panel"]')},c.prototype.hasReviewPanelElement=function(){return this.getReviewPanelElement().length>0},c.prototype.getCollapseGradePanelButton=function(){return a('[data-region="grade-actions"] .collapse-grade-panel')},c.prototype.getCollapseReviewPanelButton=function(){return a('[data-region="grade-actions"] .collapse-review-panel')},c.prototype.getExpandAllPanelsButton=function(){return a('[data-region="grade-actions"] .collapse-none')},c.prototype.resetLayoutButtons=function(){this.getCollapseGradePanelButton().removeClass("active"),this.getCollapseReviewPanelButton().removeClass("active"),this.getExpandAllPanelsButton().removeClass("active")},c.prototype.collapseReviewPanel=function(){a(document).trigger(b.COLLAPSE_REVIEW_PANEL),a(document).trigger(b.EXPAND_GRADE_PANEL),this.resetLayoutButtons(),this.getCollapseReviewPanelButton().addClass("active")},c.prototype.collapseGradePanel=function(){a(document).trigger(b.COLLAPSE_GRADE_PANEL),a(document).trigger(b.EXPAND_REVIEW_PANEL),this.resetLayoutButtons(),this.getCollapseGradePanelButton().addClass("active")},c.prototype.expandAllPanels=function(){a(document).trigger(b.EXPAND_GRADE_PANEL),a(document).trigger(b.EXPAND_REVIEW_PANEL),this.resetLayoutButtons(),this.getExpandAllPanelsButton().addClass("active")},c.prototype.registerEventListeners=function(){if(this.hasReviewPanelElement()){var b=this.getCollapseReviewPanelButton();b.click(function(a){this.collapseReviewPanel(),a.preventDefault()}.bind(this)),b.keydown(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||13!==a.keyCode&&32!==a.keyCode||(this.collapseReviewPanel(),a.preventDefault())}.bind(this));var c=this.getCollapseGradePanelButton();c.click(function(a){this.collapseGradePanel(),a.preventDefault()}.bind(this)),c.keydown(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||13!==a.keyCode&&32!==a.keyCode||(this.collapseGradePanel(),a.preventDefault())}.bind(this));var d=this.getExpandAllPanelsButton();d.click(function(a){this.expandAllPanels(),a.preventDefault()}.bind(this)),d.keydown(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||13!==a.keyCode&&32!==a.keyCode||(this.expandAllPanels(),a.preventDefault())}.bind(this))}a(document).on("user-changed",this._showActionsForm.bind(this)),this._region.find('[name="savechanges"]').on("click",this._trigger.bind(this,"save-changes")),this._region.find('[name="resetbutton"]').on("click",this._trigger.bind(this,"reset")),this._region.find("form").on("submit",function(a){a.preventDefault()})},c});
define('mod_assign/grading_events', function(){return{COLLAPSE_REVIEW_PANEL:"grading:collapse-review-panel",EXPAND_REVIEW_PANEL:"grading:expand-review-panel",COLLAPSE_GRADE_PANEL:"grading:collapse-grade-panel",EXPAND_GRADE_PANEL:"grading:expand-grade-panel"}});
define('mod_assign/grading_form_change_checker', ["jquery"],function(a){return{saveFormState:function(b){a(b).trigger("save-form-state");var c=a(b).serialize();a(b).data("saved-form-state",c)},checkFormForChanges:function(b){a(b).trigger("save-form-state");var c=a(b).serialize(),d=a(b).data("saved-form-state");return"undefined"!=typeof d&&d!=c}}});
define('mod_assign/grading_navigation', ["jquery","core/notification","core/str","core/form-autocomplete","core/ajax","mod_assign/grading_form_change_checker"],function(a,b,c,d,e,f){var g=function(e){this._regionSelector=e,this._region=a(e),this._filters=[],this._users=[],this._filteredUsers=[],this._loadAllUsers(),this._region.find('[data-action="previous-user"]').on("click",this._handlePreviousUser.bind(this)),this._region.find('[data-action="next-user"]').on("click",this._handleNextUser.bind(this)),this._region.find('[data-action="change-user"]').on("change",this._handleChangeUser.bind(this)),this._region.find('[data-region="user-filters"]').on("click",this._toggleExpandFilters.bind(this)),a(document).on("user-changed",this._refreshSelector.bind(this));var f=this._region.find('[data-region="user-filters"]'),g=a(document.getElementById(f.attr("aria-controls")));g.on("change",'[type="checkbox"]',this._filterChanged.bind(this));var h=a('[data-region="grading-navigation-panel"]').data("first-userid");h&&this._selectUserById(h),c.get_string("changeuser","mod_assign").done(function(a){d.enhance("[data-action=change-user]",!1,"mod_assign/participant_selector",a)}).fail(b.exception),a(document).on("start-loading-user",function(){this._isLoading=!0}.bind(this)),a(document).on("finish-loading-user",function(){this._isLoading=!1}.bind(this))};return g.prototype._isLoading=!1,g.prototype._regionSelector=null,g.prototype._filters=null,g.prototype._users=null,g.prototype._region=null,g.prototype._loadAllUsers=function(){var a=this._region.find("[data-action=change-user]"),c=a.attr("data-assignmentid"),d=a.attr("data-groupid");e.call([{methodname:"mod_assign_list_participants",args:{assignid:c,groupid:d,filter:"",onlyids:!0},done:this._usersLoaded.bind(this),fail:b.exception}])},g.prototype._usersLoaded=function(b){if(this._filteredUsers=this._users=b,this._users.length){var c=this._region.find('[data-region="user-filters"]'),d=a(document.getElementById(c.attr("aria-controls")));d.find('[type="checkbox"]').trigger("change")}else this._selectNoUser()},g.prototype._checkClickOutsideConfigureFilters=function(b){var c=this._region.find('[data-region="configure-filters"]');if(!c.is(b.target)&&0===c.has(b.target).length){var d=this._region.find('[data-region="user-filters"]');c.hide(),c.attr("aria-hidden","true"),d.attr("aria-expanded","false"),a(document).off("click.mod_assign_grading_navigation")}},g.prototype._filterChanged=function(d){var e=a(d.target).attr("name"),f=e.split("_").pop(),g=a(d.target).prop("checked");if(g)this._filters.indexOf(f)==-1&&(this._filters[this._filters.length]=f);else{var h=this._filters.indexOf(f);h!=-1&&this._filters.splice(h,1)}var i=[];this._region.find('[data-region="configure-filters"]').find('[type="checkbox"]').each(function(b,c){a(c).prop("checked")&&(i[i.length]=a(c).closest("label").text())}),i.length?this._region.find('[data-region="user-filters"] span.accesshide').text(i.join(", ")):c.get_string("nofilters","mod_assign").done(function(a){this._region.find('[data-region="user-filters"] span.accesshide').text(a)}.bind(this)).fail(b.exception);var j=this._region.find("[data-action=change-user]"),k=j.attr("data-selected"),l=0;this._filteredUsers=[],a.each(this._users,function(b,c){var d=!0;a.each(this._filters,function(a,b){"submitted"==b?"0"==c.submitted&&(d=!1):"notsubmitted"==b?"1"==c.submitted&&(d=!1):"requiregrading"==b?"0"==c.requiregrading&&(d=!1):"grantedextension"==b&&"0"==c.grantedextension&&(d=!1)}),d&&(this._filteredUsers[this._filteredUsers.length]=c,k==c.id&&(l=this._filteredUsers.length-1))}.bind(this)),this._filteredUsers.length?this._selectUserById(this._filteredUsers[l].id):this._selectNoUser()},g.prototype._selectNoUser=function(){this._isLoading||(f.checkFormForChanges('[data-region="grade-panel"] .gradeform')?c.get_strings([{key:"unsavedchanges",component:"mod_assign"},{key:"unsavedchangesquestion",component:"mod_assign"},{key:"saveandcontinue",component:"mod_assign"},{key:"cancel",component:"core"}]).done(function(c){b.confirm(c[0],c[1],c[2],c[3],function(){a(document).trigger("save-changes",-1)})}):a(document).trigger("user-changed",-1))},g.prototype._selectUserById=function(d){var e=this._region.find("[data-action=change-user]"),g=parseInt(d,10);this._isLoading||(f.checkFormForChanges('[data-region="grade-panel"] .gradeform')?c.get_strings([{key:"unsavedchanges",component:"mod_assign"},{key:"unsavedchangesquestion",component:"mod_assign"},{key:"saveandcontinue",component:"mod_assign"},{key:"cancel",component:"core"}]).done(function(c){b.confirm(c[0],c[1],c[2],c[3],function(){a(document).trigger("save-changes",g)})}):(e.attr("data-selected",d),!isNaN(g)&&g>0&&a(document).trigger("user-changed",d)))},g.prototype._toggleExpandFilters=function(b){b.preventDefault();var c=a(b.target).closest('[data-region="user-filters"]'),d="true"==c.attr("aria-expanded"),e=a(document.getElementById(c.attr("aria-controls")));d?(e.hide(),e.attr("aria-hidden","true"),c.attr("aria-expanded","false"),a(document).off("click.mod_assign_grading_navigation")):(e.css("display","inline-block"),e.attr("aria-hidden","false"),c.attr("aria-expanded","true"),b.stopPropagation(),a(document).on("click.mod_assign_grading_navigation",this._checkClickOutsideConfigureFilters.bind(this)))},g.prototype._handlePreviousUser=function(a){a.preventDefault();var b=this._region.find("[data-action=change-user]"),c=b.attr("data-selected"),d=0,e=0;for(d=0;d<this._filteredUsers.length;d++)if(this._filteredUsers[d].id==c){e=d;break}var f=this._filteredUsers.length,g=e-1;g<0&&(g=f-1),f&&this._selectUserById(this._filteredUsers[g].id)},g.prototype._handleNextUser=function(a){a.preventDefault();var b=this._region.find("[data-action=change-user]"),c=b.attr("data-selected"),d=0,e=0;for(d=0;d<this._filteredUsers.length;d++)if(this._filteredUsers[d].id==c){e=d;break}var f=this._filteredUsers.length,g=(e+1)%f;f&&this._selectUserById(this._filteredUsers[g].id)},g.prototype._refreshCount=function(){var a=this._region.find("[data-action=change-user]"),d=a.attr("data-selected"),e=0,f=0;if(isNaN(d)||d<=0)this._region.find('[data-region="user-count"]').hide();else{for(this._region.find('[data-region="user-count"]').show(),e=0;e<this._filteredUsers.length;e++)if(this._filteredUsers[e].id==d){f=e;break}var g=this._filteredUsers.length;g&&(f+=1);var h={x:f,y:g};c.get_string("xofy","mod_assign",h).done(function(a){this._region.find('[data-region="user-count-summary"]').text(a)}.bind(this)).fail(b.exception)}},g.prototype._refreshSelector=function(a,b){var c=this._region.find("[data-action=change-user]");b=parseInt(b,10),!isNaN(b)&&b>0&&c.attr("data-selected",b),this._refreshCount()},g.prototype._handleChangeUser=function(){var d=this._region.find("[data-action=change-user]"),e=parseInt(d.val(),10);this._isLoading||(f.checkFormForChanges('[data-region="grade-panel"] .gradeform')?c.get_strings([{key:"unsavedchanges",component:"mod_assign"},{key:"unsavedchangesquestion",component:"mod_assign"},{key:"saveandcontinue",component:"mod_assign"},{key:"cancel",component:"core"}]).done(function(c){b.confirm(c[0],c[1],c[2],c[3],function(){a(document).trigger("save-changes",e)})}):!isNaN(e)&&e>0&&(d.attr("data-selected",e),a(document).trigger("user-changed",e)))},g});
define('mod_assign/grading_navigation_user_info', ["jquery","core/notification","core/ajax","core/templates"],function(a,b,c,d){var e=function(b){this._regionSelector=b,this._region=a(b),this._userCache={},a(document).on("user-changed",this._refreshUserInfo.bind(this))};return e.prototype._regionSelector=null,e.prototype._userCache=null,e.prototype._region=null,e.prototype._lastUserId=0,e.prototype._getAssignmentId=function(){return this._region.attr("data-assignmentid")},e.prototype._refreshUserInfo=function(e,f){var g=a.Deferred();this._lastUserId!=f&&(this._lastUserId=f,d.render("mod_assign/loading",{}).done(function(e,h){if(this._region.fadeOut("fast",function(){d.replaceNodeContents(this._region,e,h),this._region.fadeIn("fast")}.bind(this)),f<0)return void d.render("mod_assign/grading_navigation_no_users",{}).done(function(a,b){this._region.fadeOut("fast",function(){d.replaceNodeContents(this._region,a,b),this._region.fadeIn("fast")}.bind(this))}.bind(this)).fail(b.exception);if("undefined"!=typeof this._userCache[f])g.resolve(this._userCache[f]);else{var i=this._getAssignmentId(),j=c.call([{methodname:"mod_assign_get_participant",args:{userid:f,assignid:i,embeduser:!0}}]);j[0].done(function(a){a.hasOwnProperty("id")?(this._userCache[f]=a,g.resolve(this._userCache[f])):g.reject("No users")}.bind(this)).fail(b.exception)}g.done(function(c){var e=a("[data-showuseridentity]").data("showuseridentity").split(","),f=[];c.courseid=a('[data-region="grading-navigation-panel"]').attr("data-courseid"),c.user&&(a.each(e,function(a,b){"undefined"!=typeof c.user[b]&&""!==c.user[b]&&(c.hasidentity=!0,f.push(c.user[b]))}),c.identity=f.join(", "),c.user.profileimageurl&&(c.profileimageurl=c.user.profileimageurl)),d.render("mod_assign/grading_navigation_user_summary",c).done(function(a,b){this._region.fadeOut("fast",function(){d.replaceNodeContents(this._region,a,b),this._region.fadeIn("fast")}.bind(this))}.bind(this)).fail(b.exception)}.bind(this)).fail(function(){d.render("mod_assign/grading_navigation_no_users",{}).done(function(a,b){this._region.fadeOut("fast",function(){d.replaceNodeContents(this._region,a,b),this._region.fadeIn("fast")}.bind(this))}.bind(this)).fail(b.exception)}.bind(this))}.bind(this)).fail(b.exception))},e});
define('mod_assign/grading_panel', ["jquery","core/yui","core/notification","core/templates","core/fragment","core/ajax","core/str","mod_assign/grading_form_change_checker","mod_assign/grading_events"],function(a,b,c,d,e,f,g,h,i){var j=function(b){this._regionSelector=b,this._region=a(b),this._userCache=[],this.registerEventListeners()};return j.prototype._regionSelector=null,j.prototype._lastUserId=0,j.prototype._lastAttemptNumber=-1,j.prototype._region=null,j.prototype._niceReplaceNodeContents=function(b,c,e){var f=a.Deferred();return b.fadeOut("fast",function(){d.replaceNodeContents(b,c,e),b.fadeIn("fast",function(){f.resolve()})}),f.promise()},j.prototype._saveFormState=function(){var b=a('[data-region="grading-actions-form"] [name="sendstudentnotifications"]').prop("checked");a('.gradeform [name="sendstudentnotifications"]').val(b)},j.prototype._submitForm=function(b,d){var e=a(this._region.find("form.gradeform"));a('[data-region="overlay"]').show(),e.trigger("save-form-state");var g=e.serialize(),h=this._region.attr("data-assignmentid");f.call([{methodname:"mod_assign_submit_grading_form",args:{assignmentid:h,userid:this._lastUserId,jsonformdata:JSON.stringify(g)},done:this._handleFormSubmissionResponse.bind(this,g,d),fail:c.exception}])},j.prototype._handleFormSubmissionResponse=function(d,e,f){"undefined"==typeof e&&(e=this._lastUserId),f.length?a(document).trigger("reset",[this._lastUserId,d]):(g.get_strings([{key:"changessaved",component:"core"},{key:"gradechangessaveddetail",component:"mod_assign"}]).done(function(a){c.alert(a[0],a[1])}).fail(c.exception),b.use("moodle-core-formchangechecker",function(){M.core_formchangechecker.reset_form_dirty_state()}),e==this._lastUserId?a(document).trigger("reset",e):a(document).trigger("user-changed",e)),a('[data-region="overlay"]').hide()},j.prototype._resetForm=function(b,c,d){var e=a.Event("custom");"undefined"==typeof c&&(c=this._lastUserId),this._lastUserId=0,this._refreshGradingPanel(e,c,d)},j.prototype._chooseAttempt=function(b){var d=a(b.target),e=d.data("submissions"),f=a(document.getElementById(e)),h=f.clone(),i=h.wrap(a("<form/>")).html();g.get_strings([{key:"viewadifferentattempt",component:"mod_assign"},{key:"view",component:"core"},{key:"cancel",component:"core"}]).done(function(b){c.confirm(b[0],i,b[1],b[2],function(){var b=a("input:radio[name='select-attemptnumber']:checked").val();this._refreshGradingPanel(null,this._lastUserId,"",b)}.bind(this))}.bind(this)).fail(c.exception)},j.prototype._addPopoutButtons=function(b){var e=a(b);d.render("mod_assign/popout_button",{}).done(function(a){var b=e.find('[data-fieldtype="filemanager"],[data-fieldtype="editor"],[data-fieldtype="grading"]').closest(".fitem");b.addClass("has-popout").find("label").parent().append(a),e.on("click",'[data-region="popout-button"]',this._togglePopout.bind(this))}.bind(this)).fail(c.exception)},j.prototype._togglePopout=function(b){b.preventDefault();var c=a(b.target).closest(".fitem");c.hasClass("popout")?a(".popout").removeClass("popout"):(a(".popout").removeClass("popout"),c.addClass("popout"),c.addClass("moodle-has-zindex"))},j.prototype._refreshGradingPanel=function(b,f,g,i){var j=this._region.attr("data-contextid");"undefined"==typeof g&&(g=""),"undefined"==typeof i&&(i=-1),this._lastUserId==f&&this._lastAttemptNumber==i&&""===g||(this._lastUserId=f,this._lastAttemptNumber=i,a(document).trigger("start-loading-user"),window.M.util.js_pending("mod-assign-loading-user"),d.render("mod_assign/loading",{}).done(function(b,d){this._niceReplaceNodeContents(this._region,b,d).done(function(){if(f>0){this._region.show();var b={userid:f,attemptnumber:i,jsonformdata:JSON.stringify(g)};e.loadFragment("mod_assign","gradingpanel",j,b).done(function(b,d){this._niceReplaceNodeContents(this._region,b,d).done(function(){h.saveFormState('[data-region="grade-panel"] .gradeform'),a(document).on("editor-content-restored",function(){h.saveFormState('[data-region="grade-panel"] .gradeform')}),a('[data-region="attempt-chooser"]').on("click",this._chooseAttempt.bind(this)),this._addPopoutButtons('[data-region="grade-panel"] .gradeform'),a(document).trigger("finish-loading-user"),window.M.util.js_complete("mod-assign-loading-user")}.bind(this)).fail(c.exception)}.bind(this)).fail(c.exception),a('[data-region="review-panel"]').show()}else this._region.hide(),a('[data-region="review-panel"]').hide(),a(document).trigger("finish-loading-user"),window.M.util.js_complete("mod-assign-loading-user")}.bind(this))}.bind(this)).fail(c.exception))},j.prototype.getPanelElement=function(){return a('[data-region="grade-panel"]')},j.prototype.collapsePanel=function(){this.getPanelElement().addClass("collapsed")},j.prototype.expandPanel=function(){this.getPanelElement().removeClass("collapsed")},j.prototype.registerEventListeners=function(){var b=a(document),c=a(this._region);c.on("submit","form",function(a){a.preventDefault()}),b.on("user-changed",this._refreshGradingPanel.bind(this)),b.on("save-changes",this._submitForm.bind(this)),b.on("reset",this._resetForm.bind(this)),b.on("save-form-state",this._saveFormState.bind(this)),b.on(i.COLLAPSE_GRADE_PANEL,function(){this.collapsePanel()}.bind(this)),b.on(i.COLLAPSE_REVIEW_PANEL,function(){this.expandPanel()}.bind(this)),b.on(i.EXPAND_GRADE_PANEL,function(){this.expandPanel()}.bind(this))},j});
define('mod_assign/grading_review_panel', ["jquery","mod_assign/grading_events"],function(a,b){var c=function(){this._region=a('[data-region="review-panel-content"]'),this.registerEventListeners()};return c.prototype._region=null,c.prototype.getReviewPanel=function(a){var b=this._region.data("panel-owner");return"undefined"==typeof b&&this._region.data("review-panel-plugin",a),this._region.data("review-panel-plugin")==a&&this._region[0]},c.prototype.getTogglePanelButton=function(){return this.getPanelElement().find('[data-region="review-panel-toggle"]')},c.prototype.getPanelElement=function(){return a('[data-region="review-panel"]')},c.prototype.getPanelContentElement=function(){return a('[data-region="review-panel-content"]')},c.prototype.togglePanel=function(){this.getPanelElement().hasClass("collapsed")?a(document).trigger(b.EXPAND_REVIEW_PANEL):a(document).trigger(b.COLLAPSE_REVIEW_PANEL)},c.prototype.collapsePanel=function(){this.getPanelElement().addClass("collapsed").removeClass("grade-panel-collapsed"),this.getPanelContentElement().attr("aria-hidden",!0)},c.prototype.expandPanel=function(){this.getPanelElement().removeClass("collapsed"),this.getPanelContentElement().removeAttr("aria-hidden")},c.prototype.registerEventListeners=function(){var c=this.getTogglePanelButton();c.click(function(a){this.togglePanel(),a.preventDefault()}.bind(this)),c.keydown(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||13!==a.keyCode&&32!==a.keyCode||(this.togglePanel(),a.preventDefault())}.bind(this));var d=a(document);d.on(b.COLLAPSE_REVIEW_PANEL,function(){this.collapsePanel()}.bind(this)),d.on(b.COLLAPSE_GRADE_PANEL,function(){this.expandPanel(),this.getPanelElement().addClass("grade-panel-collapsed")}.bind(this)),d.on(b.EXPAND_REVIEW_PANEL,function(){this.expandPanel()}.bind(this)),d.on(b.EXPAND_GRADE_PANEL,function(){this.getPanelElement().removeClass("grade-panel-collapsed")}.bind(this))},c});
define('mod_assign/participant_selector', ["core/ajax","jquery","core/templates"],function(a,b,c){return{processResults:function(a,b){return b},transport:function(d,e,f,g){var h=b(d).attr("data-assignmentid"),i=b(d).attr("data-groupid"),j=b('[data-region="configure-filters"] input[type="checkbox"]'),k=[];j.each(function(a,c){k[b(c).attr("name")]=b(c).prop("checked")}),a.call([{methodname:"mod_assign_list_participants",args:{assignid:h,groupid:i,filter:e,limit:30,includeenrolments:!1}}])[0].then(function(a){var d=[],e=b("[data-showuseridentity]").data("showuseridentity").split(",");return b.each(a,function(a,f){var g=f,h=[],i=!0;k.filter_submitted&&!f.submitted&&(i=!1),k.filter_notsubmitted&&f.submitted&&(i=!1),k.filter_requiregrading&&!f.requiregrading&&(i=!1),k.filter_grantedextension&&!f.grantedextension&&(i=!1),i&&(b.each(e,function(a,b){"undefined"!=typeof f[b]&&""!==f[b]&&(g.hasidentity=!0,h.push(f[b]))}),g.identity=h.join(", "),d.push(c.render("mod_assign/list_participant_user_summary",g).then(function(a){return{value:f.id,label:a}})))}),b.when.apply(b,d)}).then(function(){var a=[];arguments[0]&&(a=Array.prototype.slice.call(arguments)),f(a)})["catch"](g)}}});
define('mod_choice/select_all_choices', [],function(){return{init:function(){for(var a=document.querySelectorAll(".path-mod-choice .selectallnone a"),b=function(a){a.preventDefault();var b,c=document.getElementById("attemptsform").querySelectorAll("input[type=checkbox]");b=!!a.target.classList.contains("mod_choice-selectall");for(var d=0;d<c.length;d++)c[d].checked=b},c=0;c<a.length;c++)a[c].addEventListener("click",b)}}});
define('mod_customcert/dialogue', ["core/yui"],function(a){var b=function(b,c,d,e,f){this.yuiDialogue=null;var g=this;"undefined"==typeof f&&(f=!1),a.use("moodle-core-notification","timers",function(){var h="480px";f&&(h="800px"),g.yuiDialogue=new M.core.dialogue({headerContent:b,bodyContent:c,draggable:!0,visible:!1,center:!0,modal:!0,width:h}),g.yuiDialogue.after("visibleChange",function(b){b.newVal?"undefined"!=typeof d&&a.soon(function(){d(g),g.yuiDialogue.centerDialogue()}):"undefined"!=typeof e&&a.soon(function(){e(g)})}),g.yuiDialogue.show()})};return b.prototype.close=function(){this.yuiDialogue.hide(),this.yuiDialogue.destroy()},b.prototype.getContent=function(){return this.yuiDialogue.bodyNode.getDOMNode()},b});
define('mod_customcert/rearrange-area', ["jquery","core/yui","core/fragment","mod_customcert/dialogue","core/notification","core/str","core/templates","core/ajax"],function(a,b,c,d,e,f,g,h){var i=function(b){this._node=a(b),this._setEvents()};return i.prototype.CUSTOMCERT_REF_POINT_TOPLEFT=0,i.prototype.CUSTOMCERT_REF_POINT_TOPCENTER=1,i.prototype.CUSTOMCERT_REF_POINT_TOPRIGHT=2,i.prototype.PIXELSINMM=3.779527559055,i.prototype._setEvents=function(){this._node.on("click",".element",this._editElement.bind(this))},i.prototype._editElement=function(a){var g=a.currentTarget.id.substr(8),h=this._node.attr("data-contextid"),i={elementid:g};c.loadFragment("mod_customcert","editelement",h,i).done(function(a,c){f.get_string("editelement","mod_customcert").done(function(e){b.use("moodle-core-formchangechecker",function(){new d(e,"<div id='elementcontent'></div>",this._editElementDialogueConfig.bind(this,g,a,c),(void 0),(!0))}.bind(this))}.bind(this))}.bind(this)).fail(e.exception)},i.prototype._editElementDialogueConfig=function(b,c,d,f){g.replaceNode("#elementcontent",c,d),this._setPositionInForm(b);var h=a(f.getContent());h.on("click","#id_submitbutton",function(c){M.core_formchangechecker.reset_form_dirty_state(),this._saveElement(b).then(function(){this._getElementHTML(b).done(function(c){var d=this._node.find("#element-"+b),e=parseInt(a("#id_refpoint").val()),g="";e==this.CUSTOMCERT_REF_POINT_TOPLEFT?g="refpoint-left":e==this.CUSTOMCERT_REF_POINT_TOPCENTER?g="refpoint-center":e==this.CUSTOMCERT_REF_POINT_TOPRIGHT&&(g="refpoint-right"),d.empty().append(c),d.removeClass(),d.addClass("element "+g),d.attr("data-refpoint",e);var h=a("#editelementform #id_posx").val(),i=a("#editelementform #id_posy").val();this._setPosition(b,e,h,i),f.close()}.bind(this))}.bind(this)).fail(e.exception),c.preventDefault()}.bind(this)),h.on("click","#id_cancel",function(a){f.close(),a.preventDefault()})},i.prototype._setPosition=function(a,c,d,e){var f=b.one("#element-"+a);d=b.one("#pdf").getX()+d*this.PIXELSINMM,e=b.one("#pdf").getY()+e*this.PIXELSINMM;var g=parseFloat(f.getComputedStyle("width")),h=f.width*this.PIXELSINMM;switch(h&&g>h&&(g=h),c){case this.CUSTOMCERT_REF_POINT_TOPCENTER:d-=g/2;break;case this.CUSTOMCERT_REF_POINT_TOPRIGHT:d=d-g+2}f.setX(d),f.setY(e)},i.prototype._setPositionInForm=function(c){var d=a("#editelementform #id_posx"),e=a("#editelementform #id_posy");if(d.length&&e.length){var f=b.one("#element-"+c),g=f.getX()-b.one("#pdf").getX(),h=f.getY()-b.one("#pdf").getY(),i=parseInt(f.getData("refpoint")),j=parseFloat(f.getComputedStyle("width"));switch(i){case this.CUSTOMCERT_REF_POINT_TOPCENTER:g+=j/2;break;case this.CUSTOMCERT_REF_POINT_TOPRIGHT:g+=j}g=Math.round(parseFloat(g/this.PIXELSINMM)),h=Math.round(parseFloat(h/this.PIXELSINMM)),d.val(g),e.val(h)}},i.prototype._getElementHTML=function(a){var b=this._node.attr("data-templateid"),c=h.call([{methodname:"mod_customcert_get_element_html",args:{templateid:b,elementid:a}}]);return c[0]},i.prototype._saveElement=function(b){var c=this._node.attr("data-templateid"),d=a("#editelementform").serializeArray(),e=h.call([{methodname:"mod_customcert_save_element",args:{templateid:c,elementid:b,values:d}}]);return e[0]},{init:function(a){new i(a)}}});
define('mod_facetoface/attendees_addconfirm', ["jquery"],function(a){var b={init:function(c){this.attachCustomClickEvents=function(){a("a.attendee-edit-job-assignment").on("click",function(){return a.get(a(this).attr("href"),function(a){b.editJobAssignmentModalForm(a)}),!1})},this.attachCustomClickEvents()},editJobAssignmentModalForm:function(b){var c=new M.core.dialogue({headerContent:null,bodyContent:b,width:600,zIndex:5,centered:!0,modal:!0,render:!0}),d=a("#"+c.get("id"));d.find('input[type="text"]').eq(0).focus(),d.find("#id_submitbutton").on("click",function(){var b=d.find("form.mform"),e=b.serialize();return e+="&submitbutton="+a(this).attr("value"),a.post(b.attr("action"),e).done(function(b){if("success"==b.result){var d="#jobassign"+b.id;a(d).html(b.jobassignmentdisplayname),c.destroy(!0)}else a("#attendee_job_assignment_err").text(b.error)}),!1}),d.find("#id_cancel").on("click",function(){return c.destroy(!0),!1}),c.show()}};return b});
define('mod_facetoface/attendees_addremove', ["jquery","core/str","core/config"],function(a,b,c){var d={init:function(b){var c=a("a.viewbulkresults:first");c.length>0&&d.setupResultsDialog(c,b.s,b.listid),a("#add").click(function(b){b.preventDefault();var c=a("#addselect").find("option:selected");c.each(function(b,c){var d=0;a("#removeselect option").length&&a("#removeselect option").each(function(b,e){a(e).data("idx")<a(c).data("idx")&&(d=a(e).data("idx"))}),d>0?a(c).insertAfter(a("#removeselect option[data-idx="+d+"]")):a("#removeselect").append(c)})}),a("#remove").click(function(b){b.preventDefault();var c=a("#removeselect").find("option:selected");c.each(function(b,c){var d=0;a("#addselect option").length&&a("#addselect option").each(function(b,e){a(e).data("idx")<a(c).data("idx")&&(d=a(e).data("idx"))}),d>0?a(c).insertAfter(a("#addselect option[data-idx="+d+"]")):a("#addselect").append(c)})}),a("#interested").click(function(){a("form#assignform").submit()}),a("#searchtext, #searchtoremovetext").focus(function(){a("#add").attr("disabled","disabled"),a("#remove").attr("disabled","disabled")}),a("#removeselect").focus(function(){a("#add").attr("disabled","disabled"),a("#remove").removeAttr("disabled")}),a("#addselect").focus(function(){a("#add").removeAttr("disabled"),a("#remove").attr("disabled","disabled")}),a("#assignform").submit(function(){a("#removeselect option").each(function(){a(this).prop("disabled")?a(this).prop("selected",!1):a(this).prop("selected",!0)})}),a("#searchtoremovetext").on("keyup keypress blur change",function(){var b=a("#searchtoremovetext").val();b.length>0?(a("#searchtoremovereset").show(),a("#removeselect option").each(function(c,d){var e=a(d);e.text().search(b)!==-1?e.show():e.hide()})):(a("#searchtoremovereset").hide(),a("#removeselect option").show())}),a("#searchtoremovereset").click(function(b){b.preventDefault(),a("#searchtoremovetext").val(""),a("#searchtoremovetext").trigger("change")})},setupResultsDialog:function(a,d,e){a.attr("id","viewbulkresults");var f=[];f.push({key:"bulkaddattendeesresults",component:"facetoface"}),f.push({key:"closebuttontitle",component:"moodle"}),b.get_strings(f).done(function(a){var b=function(){for(var b=new totaraDialog_handler,g=[],h=0;h<f.length;h++)g[f[h].key]=a[h];var i="bulkaddvalidation",j={};j[g.closebuttontitle]=function(){b._cancel()},totaraDialogs[i]=new totaraDialog(i,"viewbulkresults",{title:"<h2>"+g.bulkaddattendeesresults+"</h2>",buttons:j},c.wwwroot+"/mod/facetoface/attendees/ajax/bulk_add.php?s="+d+"&listid="+e,b)};window.dialogsInited?b():(window.dialoginits=window.dialoginits||[],window.dialoginits.push(b))})}};return d});
define('mod_facetoface/event', ["jquery","core/config","core/str","core/templates","core/notification"],function(a,b,c,d,e){function f(a){a||e.Exception("Config not supplied")}function g(a){this.manageCustom=a.manageadhocfacilitators,this.init()}function h(a){this.manageCustom=a.manageadhocassets,this.init()}function i(a){this.manageCustom=a.manageadhocrooms,this.init()}var j=10,k=b.wwwroot+"/mod/facetoface/",l=null,m=null,n=0,o=1,p=-2,q=-3,r=-4,s=-5,t=-6;M.util.js_pending("mod_facetoface-events__dialogues_inited");var u=new Promise(function(a){window.dialogsInited?a():(window.dialoginits||(window.dialoginits=[]),window.dialoginits.push(a))}).then(function(){M.util.js_complete("mod_facetoface-events__dialogues_inited")}),v=c.get_strings([{key:"ok",component:"moodle"},{key:"cancel",component:"moodle"},{key:"loadinghelp",component:"moodle"}]).then(function(a){var b={ok:a[0],cancel:a[1],loading:a[2]};return b}),w=function(){for(var b=!1,c=!1,d=document.getElementById("id_defaultcapacity"),e=0;e<Number(a('input[name="cntdates"]').val());e++)if(!(a('input[name="datedelete['+e+']"]').val()>0)){var f=a('input[name="roomids['+e+']"]');if(f.val().length>0&&(c=!0),b=!0,b&&c)break}if(d.disabled=!c,!b){var g=a(".sessiondates table.f2fmanagedates");g.hide(),g.parent().append(a('<div class="nodates_notification">'+M.util.get_string("nodatesyet","facetoface")+"</div>"))}};return f.prototype={init:function(){var a=Number(document.querySelector('input[name="cntdates"]').value);this.localStrings=c.get_strings([{key:"choose"+this.type+"s",component:"mod_facetoface"},{key:"createnew"+this.type,component:"mod_facetoface"}]).then(function(a){var b={choose:a[0],create:a[1]};return b});for(var b=0;b<a;b++)if(!(document.querySelector('input[name="datedelete['+b+']"]').value>0)){var d=document.querySelector('input[name="'+this.type+"ids["+b+']"]');this.render(b),this.showCreateResouceDialog(d,b),this.showSelectResourceDialog(d,b)}},getResource:function(a){var b=this;return this.resources||(this.resources=[]),this.requested||(this.requested=[]),this.resources[a]?Promise.resolve(this.resources[a]):this.isLoading?(b.requested.indexOf(a)===-1&&b.requested.push(a),this.loadingPromise.then(function(){return b.getResource(a)})):(this.requested.push(a),this._triggerLoad().then(function(){return Promise.resolve(b.resources[a])}))},generateElement:function(a){var b=this;return this.getResource(a).then(function(a){var e=c.get_string("remove"+b.type+"x","mod_facetoface",a.name_only).then(function(a){return d.renderIcon("delete",a)}).then(function(a){return'<a href="#" data-action="removeresource">'+a+"</a>"});return Promise.all([a,b.editIcon(a),e])}).then(function(a){var c=a[0],d=document.createElement("li"),e='<span class="mod_facetoface-resource-title">'+c.name+"</span>";return b.getLiAttributes(c,d),d.innerHTML=e+a[1]+a[2],d})},editIcon:function(a){var b=this;return b.manageCustom&&a.custom?c.get_string("editcustom"+b.type+"x","mod_facetoface",a.name_only).then(function(a){return d.renderIcon("edit",a)}).then(function(a){return'<a href="#" data-action="editresource">'+a+"</a>"}):Promise.resolve("")},_triggerLoad:function(){var a=this;return this.isLoading=!0,this.loadingPromise=new Promise(function(b,c){setTimeout(function(){a._loadResources().then(function(){a.isLoading=!1,b()})["catch"](c)},j)}),this.loadingPromise},_loadResources:function(){var a=this,c=new FormData;return this.requested.length>0?(c.append("facetofaceid",l.facetofaceid),c.append("itemids",a.requested),c.append("sesskey",b.sesskey),M.util.js_pending("mod_facetoface-events__loading_resources"),fetch(this.loadUrl,{credentials:"same-origin",method:"POST",body:c}).then(function(a){return a.json()}).then(function(b){a.requested=[],b.forEach(function(b){a.resources[b.id]=b}),M.util.js_complete("mod_facetoface-events__loading_resources")})):Promise.resolve()},getLiAttributes:function(a,b){b.setAttribute("data-id",a.id),b.setAttribute("data-custom",a.custom),b.classList.add(this.cssClass)},showSelectResourceDialog:function(c,d){var e=this,f=Promise.all([v,this.localStrings,u]).then(function(f){var g=f[0],h=f[1],i=new totaraDialog_handler_treeview_multiselect,j={};i._update=function(){var b=a(".selected > div > span",this._container),f=this._get_ids(b);c.value=f.join(),e.render(d),this._dialog.hide()},j[g.ok]=function(){i._update()},j[g.cancel]=function(){i._cancel()},i.oldLoad=i.load,i.load=function(b){i.oldLoad(b);var c=a(".ui-dialog [id^='select"+e.type+"s'][id$='-dialog']"),d=c.height()-a(".dialog-footer",c).outerHeight();a(".select",c).outerHeight(d)},totaraDialogs["select"+e.type+"s"+d]=new totaraDialog("select"+e.type+"s"+d+"-dialog","show-select"+e.type+"s"+d+"-dialog",{buttons:j,title:"<h2>"+h.choose+"</h2>"},function(){var c=l.sessionid;return 1==Number(l.clone)&&(c=0),e.selectUrl+"?sessionid="+c+"&facetofaceid="+l.facetofaceid+"&timestart="+a('input[name="timestart['+d+']"]').val()+"&timefinish="+a('input[name="timefinish['+d+']"]').val()+"&selected="+a('input[name="'+e.type+"ids["+d+']"]').val()+"&offset="+d+"&sesskey="+b.sesskey},i)});return f},showCreateResouceDialog:function(c,d){var e=this,f=Promise.all([v,this.localStrings,u]).then(function(f){var g=f[0],h=f[1],i=new totaraDialog_handler_form;i.every_load=function(){totaraDialog_handler_form.prototype.every_load.call(this),totaraDialogs["select"+e.type+"s"+d].handler._dialog.hide(),totaraDialogs["editcustom"+e.type+d].config.title="<h2>"+h.create+"</h2>"},i._updatePage=function(b){try{var f=a.parseJSON(b),g=[];e.forceReload(f.id),c.value.length>0&&(g=c.value.split(",")),g.indexOf(f.id.toString())===-1&&g.push(f.id),c.value=g.toString(),e.render(d),i._dialog.hide()}catch(h){this._dialog.render(b)}};var j={};j[g.ok]=function(){i.submit()},j[g.cancel]=function(){i._cancel()},totaraDialogs["editcustom"+e.type+d]=new totaraDialog("editcustom"+e.type+d+"-dialog","show-editcustom"+e.type+d+"-dialog",{buttons:j,title:"<h2>"+h.create+"</h2>"},function(){var a=0;return"undefined"!=typeof l.editcustom&&(a=Number(l.editcustom),l.editcustom=0),e.createUrl+"?id="+a+"&f="+l.facetofaceid+"&s="+l.sessionid+"&sesskey="+b.sesskey},i)});return f},forceReload:function(a){var b=document.querySelectorAll("."+this.cssClass+'[data-id="'+a+'"]');this.resources&&this.resources[a]&&delete this.resources[a],b.length>0&&this.generateElement(a).then(function(a){var c;for(c=0;c<b.length;c++)b[c].outerHTML=a.outerHTML})["catch"](e.exception)},render:function(a){if(!(document.querySelector('input[name="datedelete['+a+']"]').value>0)){var b=document.querySelector('input[name="'+this.type+"ids["+a+']"]').value.split(","),c=document.getElementById(this.type+"list"+a),d=this;if(b.length&&""!==b[0]){var f=document.createElement("li");v.then(function(a){f.innerText=a.loading})["catch"](e.exception),c.appendChild(f);var g=b.map(function(a){return d.generateElement(a)});Promise.all(g).then(function(b){c.innerHTML="",b.forEach(function(a){c.appendChild(a)}),d.updateCapacity&&d.updateCapacity(a),d.resourcesUpdated&&d.resourcesUpdated(a)})["catch"](e.exception)}}}},g.prototype=Object.assign({},f.prototype),g.prototype.type="facilitator",g.prototype.loadUrl=k+"facilitator/ajax/facilitator_item.php",g.prototype.cssClass="facilitatorname",g.prototype.selectUrl=k+"facilitator/ajax/sessionfacilitators.php",g.prototype.createUrl=k+"facilitator/ajax/edit.php",h.prototype=Object.assign({},f.prototype),h.prototype.type="asset",h.prototype.loadUrl=k+"asset/ajax/asset_item.php",h.prototype.cssClass="assetname",h.prototype.selectUrl=k+"asset/ajax/sessionassets.php",h.prototype.createUrl=k+"asset/ajax/asset_edit.php",i.prototype=Object.assign({},f.prototype),i.prototype.type="room",i.prototype.loadUrl=k+"room/ajax/room_item.php",i.prototype.cssClass="roomname",i.prototype.selectUrl=k+"room/ajax/sessionrooms.php",i.prototype.createUrl=k+"room/ajax/room_edit.php",i.prototype.getLiAttributes=function(a,b){b.setAttribute("data-id",a.id),b.setAttribute("data-custom",a.custom),b.setAttribute("data-capacity",a.capacity),b.setAttribute("data-can-manage",a.can_manage),b.setAttribute("data-is-virtual",a.virtualmeeting),b.setAttribute("data-lossy-update",a.lossyupdate),b.classList.add(this.cssClass)},i.prototype.editIcon=function(a){var b=this;return b.manageCustom&&a.custom?a.can_manage?c.get_string("editcustom"+b.type+"x","mod_facetoface",a.name_only).then(function(a){return d.renderIcon("edit",a)}).then(function(a){return'<a href="#" data-action="editresource">'+a+"</a>"}):c.get_string("virtual_meeting_not_owner","mod_facetoface",a.name_only).then(function(a){return d.renderIcon("lock",a)}):Promise.resolve("")},i.prototype.updateCapacity=function(a){var b=document.querySelectorAll('.mod_facetoface-roomlist[data-offset="'+a+'"] [data-capacity]');if(0===b.length)return document.querySelector('input[name="roomcapacity['+a+']"]').value=0,void this._updateCapacityState();var c=[];b.forEach(function(a){c.push(parseInt(a.getAttribute("data-capacity"),10))});var d=Math.min.apply(null,c);d===1/0&&(d=0),document.querySelector('input[name="roomcapacity['+a+']"]').value=d,this._updateCapacityState()},i.prototype._updateCapacityState=function(){for(var a=document.querySelector('[name="cntdates"]').value,b=!0,c=0;c<a;c++)if(1!=document.querySelector('input[name="datedelete['+c+']"]').value&&0==document.querySelector('input[name="roomcapacity['+c+']"]').value){b=!1;break}document.getElementById("id_defaultcapacity").disabled=!b},i.prototype.resourcesUpdated=function(a){var b=document.querySelectorAll("#roomlist"+a+" .roomname"),f=document.getElementById("show-selectdate"+a+"-dialog"),g=document.querySelector('[name="sessiondateid['+a+"]").value,h=f.closest("tr"),i=!0,j=0,k=!1,u=this;b.forEach(function(a){u.getResource(a.getAttribute("data-id")).then(function(b){b.virtualroom_status.filter(function(a){return g==a.sessionsdateid}).forEach(function(b){switch(b.status){case m:a.classList.add("mod_facetoface-room_legacy");break;case n:a.classList.add("mod_facetoface-room_unavailable"),c.get_string("virtual_meeting_failed","mod_facetoface").then(function(b){a.setAttribute("title",b),a.setAttribute("aria-label",b)});var e=a.querySelector('[data-action="editresource"]');e&&(e.innerHTML="",d.renderIcon("lock").then(function(a){e.outerHTML=a}));break;case o:a.classList.add("mod_facetoface-room_available");break;case p:a.classList.add("mod_facetoface-room_pending_update");break;case q:a.classList.add("mod_facetoface-room_pending_deletion");break;case r:a.classList.add("mod_facetoface-room_failure_creation"),c.get_string("virtual_meeting_failed","mod_facetoface").then(function(b){a.setAttribute("title",b),a.setAttribute("aria-label",b)});break;case s:a.classList.add("mod_facetoface-room_failure_update"),c.get_string("virtual_meeting_failed","mod_facetoface").then(function(b){a.setAttribute("title",b),a.setAttribute("aria-label",b)});break;case t:a.classList.add("mod_facetoface-room_failure_deletion"),c.get_string("virtual_meeting_failed","mod_facetoface").then(function(b){a.setAttribute("title",b),a.setAttribute("aria-label",b)})}})})}),b.forEach(function(a){"false"===a.getAttribute("data-can-manage")&&(i=!1),"true"===a.getAttribute("data-is-virtual")&&j++,"true"===a.getAttribute("data-lossy-update")&&(k=!0)}),e.clearNotifications(),j>1&&c.get_string("error:toomanyvirtualmeetings","mod_facetoface").then(function(a){e.addNotification({message:a})}),k&&l.sessionid&&1!=Number(l.clone)&&c.get_string("warning:meetingmaynotbepreserved","mod_facetoface").then(function(a){e.addNotification({type:"warning",message:a})}),i?h.classList.remove("mod_facetoface-date-other-virtual-room"):h.classList.add("mod_facetoface-date-other-virtual-room")},{config:{},clonefields:["roomids","assetids","facilitatorids","timestart","timefinish","sessiontimezone"],url:b.wwwroot+"/mod/facetoface/",init:function(b){l=b,this.addDOMEvents(),this.facilitatorLib=new g(b),this.assetLib=new h(b),this.roomLib=new i(b),this.config=b,this.init_dates();var d=Number(a('input[name="cntdates"]').val()),f=a('<input name="defaultcapacity" type="button" id="id_defaultcapacity">');c.get_string("useroomcapacity","mod_facetoface").then(function(a){f.val(a)})["catch"](e.exception),f.click(function(b){b.preventDefault();for(var c=0,e=0;e<d;e++)if(!(a('input[name="datedelete['+e+']"]').val()>0)){var f=Number(a('input[name="roomcapacity['+e+']"]').val());(0===c||c>f&&f>0)&&(c=f)}c>0&&a("#id_capacity").val(c)}),f.insertAfter(a("#id_capacity")),w(),a("a.dateremove").each(function(){var b=a(this).data("offset");a('input[name="datedelete['+b+']"]').val()>0&&a(this).closest("tr").hide()}),a('input[name="date_add_fields"]').click(function(){skipClientValidation=!0,a('input[name="cntdates"]').val(d+1)}),a(".sessiondates").removeClass("hidden")},addDOMEvents:function(){var b=this,c=document.querySelector(".sessiondates .f2fmanagedates"),d=document.getElementById("mform_seminar_event");c.addEventListener("click",function(c){var d=c.target.closest("[data-action]");if(d){c.preventDefault();var e=d.getAttribute("data-offset");switch(d.getAttribute("data-action")){case"removedate":document.querySelector('input[name="datedelete['+e+']"]').value=1,d.closest("tr").style.display="none",w();break;case"clonedate":var f=Number(a('input[name="cntdates"]').val()),g=d.closest("form");b.clonefields.forEach(function(a){var b=document.createElement("input");b.setAttribute("name",a+"["+f+"]"),b.value=g.elements[a+"["+e+"]"].value,g.append(b)}),a('input[name="date_add_fields"]').click();break;case"removeresource":b._removeResource(d);break;case"editresource":b._editResource(d)}}}),d.addEventListener("submit",function(a){var b=!0;c.querySelectorAll(".mod_facetoface-roomlist").forEach(function(a){var c=!1;a.querySelectorAll(".roomname").forEach(function(a){"true"===a.getAttribute("data-is-virtual")&&(c&&(b=!1),c=!0)})}),b||a.preventDefault()})},_removeResource:function(a){var b=a.closest("[data-offset]"),c=a.closest("[data-id]"),d=null;if(c.classList.contains("assetname"))d=document.querySelector('[name="assetids['+b.getAttribute("data-offset")+']"]');else if(c.classList.contains("roomname"))d=document.querySelector('[name="roomids['+b.getAttribute("data-offset")+']"]');else{if(!c.classList.contains("facilitatorname"))throw new Error("unknown resource type");d=document.querySelector('[name="facilitatorids['+b.getAttribute("data-offset")+']"]')}d.value=d.value.split(",").filter(function(a){return a!=c.getAttribute("data-id")}).join(","),b.removeChild(c),c.classList.contains("roomname")&&(this.roomLib.updateCapacity(b.getAttribute("data-offset")),this.roomLib.resourcesUpdated(b.getAttribute("data-offset")))},_editResource:function(a){var b=a.closest("[data-offset]"),c=a.closest("[data-id]"),d=b.getAttribute("data-offset");if("true"!==c.getAttribute("data-custom"))throw new Error("Not a custom resource");if(l.editcustom=c.getAttribute("data-id"),c.classList.contains("assetname"))totaraDialogs["editcustomasset"+d].config.title="<h2>"+M.util.get_string("editasset","facetoface")+"</h2>",totaraDialogs["editcustomasset"+d].open();else if(c.classList.contains("roomname"))totaraDialogs["editcustomroom"+d].config.title="<h2>"+M.util.get_string("editroom","facetoface")+"</h2>",totaraDialogs["editcustomroom"+d].open();else{if(!c.classList.contains("facilitatorname"))throw new Error("unknown resource type");totaraDialogs["editcustomfacilitator"+d].config.title="<h2>"+M.util.get_string("editfacilitator","facetoface")+"</h2>",totaraDialogs["editcustomfacilitator"+d].open()}},init_dates:function(){var d=this.url,f=this,g=c.get_strings([{key:"dateselect",component:"mod_facetoface"}]).then(function(a){return{dateselect:a[0]}});Promise.all([v,g,u]).then(function(c){var e=c[0],g=c[1];a(".mod_facetoface-show-selectdate-dialog").each(function(){var c=a(this).data("offset"),h=a("#timeframe-text"+c);if(!(a('input[name="datedelete['+c+']"]').val()>0)){h.empty(),h.text(e.loading),a.post(d+"events/ajax/date_item.php",{timestart:a('input[name="timestart['+c+']"]').val(),timefinish:a('input[name="timefinish['+c+']"]').val(),sesiontimezone:a('input[name="sessiontimezone['+c+']"]').val(),sesskey:b.sesskey},function(a){h.empty(),h.html(a),h.addClass("nonempty")},"json");var i=new totaraDialog_handler_form,j={};j[e.ok]=function(){i.submit()},j[e.cancel]=function(){i._cancel()},i._updatePage=function(b){try{var d=a.parseJSON(b);a('input[name="timestart['+c+']"]').val(d.timestart),a('input[name="timefinish['+c+']"]').val(d.timefinish),a('input[name="sessiontimezone['+c+']"]').val(d.sessiontimezone),a("#timeframe-text"+c).html(d.html),i._dialog.hide()}catch(e){this._dialog.render(b)}},totaraDialogs["selectdate"+c]=new totaraDialog("selectdate"+c+"-dialog",a(this).attr("id"),{buttons:j,title:"<h2>"+g.dateselect+"</h2>"},function(){var e=a('input[name="sessiondateid['+c+']"]').val();return 1==Number(f.config.clone)&&(e=0),d+"events/ajax/sessiondates.php?sessiondateid="+e+"&facetofaceid="+f.config.facetofaceid+"&roomids="+a('input[name="roomids['+c+']"]').val()+"&assetids="+a('input[name="assetids['+c+']"]').val()+"&facilitatorids="+a('input[name="facilitatorids['+c+']"]').val()+"&timezone="+encodeURIComponent(a('input[name="sessiontimezone['+c+']"]').val())+"&start="+a('input[name="timestart['+c+']"]').val()+"&finish="+a('input[name="timefinish['+c+']"]').val()+"&sesskey="+b.sesskey},i)}})})["catch"](e.exception)}}});
define('mod_facetoface/event_page_navigation', [],function(){return{init:function(a){function b(a){var b=arguments.length>1?Math.floor(arguments[1]):400,c=window.pageYOffset,d=a,e=performance.now();return M.util.js_pending("mod_facetoface_event_page_navigation:scrollTo"),function(){function a(f){var g=f-e;if(g>=b)return window.scrollTo(0,d),void M.util.js_complete("mod_facetoface_event_page_navigation:scrollTo");var h=g/b,i=6*Math.pow(h,5)-15*Math.pow(h,4)+10*Math.pow(h,3),j=c+(d-c)*i;window.scrollTo(0,j),requestAnimationFrame(a)}requestAnimationFrame(a)}()}function c(a){for(var b=0;null!==a;)b+=a.offsetTop,a=a.offsetParent;return b}function d(a){var b=0,c=getComputedStyle(a);return["height","marginTop","marginBottom","paddingTop","paddingBottom"].forEach(function(a){b+=parseFloat(c[a])}),b}return new Promise(function(e){a.addEventListener("click",function(a){var e=a.target.closest('a[href^="#"]');if(null!==e){var f=e.closest(".mod_facetoface__navigation"),g=e.getAttribute("href"),h=0;/^#\w/.test(g)&&(h=c(document.querySelector(g))),/sticky$/.test(getComputedStyle(f).position)&&(h-=d(f)),h<0&&(h=0),b(h),a.preventDefault()}}),e(!0)})}}});
define('mod_facetoface/manage_archives', [],function(){return{init:function(a){a.addEventListener("change",function(b){var c=Array.prototype.slice.apply(a.querySelectorAll(".mod_facetoface__archive__select-one")),d=a.querySelector(".mod_facetoface__archive__select-all"),e=a.querySelector(".mod_facetoface__archive__submit");if(b.target===d){var f=d.checked;return c.forEach(function(a){a.checked=f}),void(e.disabled=!f)}if(c.includes(b.target))return d.checked=c.every(function(a){return a.checked}),void(e.disabled=!c.find(function(a){return a.checked}))})}}});
define('mod_facetoface/room_integration', ["core/str"],function(a){function b(b){i&&b.data.sender&&"auth_callback"===b.data.sender&&("success"===b.data.status?c(f.value):a.get_string("connectionfailed","mod_facetoface").then(function(a){document.querySelector(".mod_facetoface-connected").innerText=a}),i.close())}function c(b){M.util.js_pending("mod_facetoface-room_integration-oauth_confirmation"),h.value=0,new Promise(function(a){require(["core/ajax"],a)}).then(function(a){return a.call([{methodname:"mod_facetoface_user_profile",args:{plugin:b}}])[0]}).then(function(b){return"name"in b?("friendly_name"in b&&(b.name=b.friendly_name),"email"in b?a.get_string("connectedasx","mod_facetoface",b):a.get_string("connectedas","mod_facetoface",b.name)):Promise.resolve("")}).then(function(a){h.value=""!==a?1:0,document.querySelector(".mod_facetoface-connected").innerText=a,M.util.js_complete("mod_facetoface-room_integration-oauth_confirmation")})["catch"](function(){document.querySelector(".mod_facetoface-connected").innerText="",M.util.js_complete("mod_facetoface-room_integration-oauth_confirmation")})}function d(){var a=document.querySelector('[name="'+f.value+'_auth_endpoint"]');i&&i.close(),a?(g.disabled=!1,c(f.value)):(g.disabled=!0,h.value=1)}function e(a){if(!g.disabled){a.preventDefault();var b=document.querySelector('[name="'+f.value+'_auth_endpoint"]');b&&(!i||i.closed?i=window.open(b.value,"virtualmeeting_connect","width=400,height=500,opener"):i.focus())}}var f,g,h,i=null;return{init:function(){f=document.getElementById("id_plugin"),g=document.getElementById("show-authorise-dialog"),g.disabled=!0,h=document.getElementById("plugin-connection-state"),h.value=0,d(),f.removeEventListener("change",d),f.addEventListener("change",d),g.removeEventListener("click",e),g.addEventListener("click",e),window.removeEventListener("message",b),window.addEventListener("message",b)}}});
define('mod_facetoface/seminarevent_dashboard', ["core/ajax","core/templates","core/notification","mod_facetoface/seminarevent_dashboard_action"],function(a,b,c,d){function e(a,b){var c,d;return function(){var e=this,f=arguments,g=function(){c=null,d&&(d=!1,a.apply(e,f))};c?(d=!0,clearTimeout(c)):a.apply(e,f),c=setTimeout(g,b||0)}}function f(a){var b="mod_facetoface_event-dashboard:";return b+=1===arguments.length?a:Array.prototype.reduce.call(arguments,function(a,b){return a+":"+b}),M.util.js_pending(b),function(){M.util.js_complete(b)}}function g(a){return this instanceof g?void this._init(a):new g(a)}function h(a,b){return this instanceof h?void this._init(a,b):new h(a,b)}(function(){this.constructor=g,this._init=function(a){var b={};"undefined"!=typeof a&&(0===a.indexOf("?")&&(a=a.substring(1)),a.length&&a.split("&").forEach(function(a){var c,d,e=a.indexOf("=");e!==-1?(c=decodeURIComponent(a.substring(0,e)),d=decodeURIComponent(a.substring(e+1))):(c=decodeURIComponent(a),d=""),b[c]=d})),this._items=b},this.toString=function(){var a="";for(var b in this._items)""!==a&&(a+="&"),a+=encodeURIComponent(b)+"="+encodeURIComponent(this._items[b]);return a},this.has=function(a){return a in this._items},this.get=function(a){return a in this._items?this._items[a]:null},this.forEach=function(a){for(var b in this._items)a(this._items[b],b)},this.set=function(a,b){this._items[a]=""+b},this["delete"]=function(a){delete this._items[a]}}).call(g.prototype),h.FILTER_CHANGED_EVENT="mod_facetoface:filter.changed",function(){var a="data-show-tooltips",b="mod_facetoface__filter--active",c="mod_facetoface__filter--closed";this.constructor=h,this._init=function(a,b){this.el=a,this.resetlink=a.querySelector(".mod_facetoface__filter__link"),this.filters=Array.prototype.slice.apply(a.querySelectorAll("select")),this.filterparams=new g,this.filters.forEach(function(a){var c=a.name,d=b.get(c);null!==d?(a.value=d,this.filterparams.set(c,d)):a.selectedIndex=0,this._updateTooltip(a)}.bind(this)),this.resetlink.addEventListener("click",this._onReset.bind(this)),a.addEventListener("change",this._onChange.bind(this));var c=a.querySelector(".mod_facetoface__filter__toggle-button__label");c?c.addEventListener("click",function(a){a.preventDefault(),this._showHideBar()}.bind(this)):this._showHideBar(!0),window.addEventListener("resize",function(){this._updateAriaAttributes()}.bind(this)),this.filters.forEach(function(a){a.disabled=!1}),a.classList.remove("mod_facetoface__filter--loading"),this._updateAriaAttributes(),this.showResetLink()},this._onChange=function(a){var b=a.target.closest("select");this.filters.includes(b)!==!1&&(this._updateTooltip(b),b.selectedIndex>0?this.filterparams.set(b.name,b.value):this.filterparams["delete"](b.name),this._fireEvent())},this._onReset=function(a){var b=this,c=this.filters.filter(function(a){return a.selectedIndex>0&&(a.selectedIndex=0,b.filterparams["delete"](a.name),b._updateTooltip(a),!0)});c.length&&this._fireEvent(),a.preventDefault()},this._updateAriaAttributes=function(){var a=this.el.querySelector(".mod_facetoface__filter__toggle-button__label__hidden"),b=this.el.querySelector(".mod_facetoface__filter__toggle-button__label__shown"),c=!0;null!==a&&null!==b&&a.clientWidth&&!b.clientWidth&&(c=!1),this.el.setAttribute("aria-expanded",c.toString())},this._showHideBar=function(a){"undefined"==typeof a&&(a=!this.el.classList.contains(c)),a?this.el.classList.add(c):this.el.classList.remove(c),this._updateAriaAttributes()},this._updateTooltip=function(b){if("true"==b.getAttribute(a)){var c="",d=b.selectedIndex;0<d&&d<b.options.length&&(c=b.options[d].text),b.setAttribute("title",c)}},this._fireEvent=function(){var a=new CustomEvent(h.FILTER_CHANGED_EVENT,{bubbles:!0,detail:this});this.el.dispatchEvent(a)},this.showResetLink=function(){var a=this.filters.filter(function(a){return a.selectedIndex>0});a.length?this.el.classList.add(b):this.el.classList.remove(b)},this.forEachParams=function(a){this.filterparams.forEach(a)},this.setParam=function(a,b){this.filterparams.set(a,b)},this.deleteParam=function(a){this.filterparams["delete"](a)},this.getParamsString=function(){return this.filterparams.toString()}}.call(h.prototype);var i={args:{id:null,f:null,type:"",cookie:0,filterparams:{},debug:!1},requestCookie:0,filter:null,initDone:!1,init:function(a){this.el=a;var b=this,c=f("init");setTimeout(function(){var d=b._loadParams(),e=a.querySelector(".mod_facetoface__filter");null!==e&&(b.filter=new h(e,d),a.addEventListener(h.FILTER_CHANGED_EVENT,b._onFilterChanged.bind(b))),a.addEventListener("click",b._onClick.bind(b)),a.addEventListener("scroll",b._onScroll.bind(b),!0),b.initDone=!0,c()},0)},_loadParams:function(){var a=new g(location.search),b=a.get("id");return null!==b?this.args.id=parseInt(b,10):(b=a.get("f"),null!==b&&(this.args.f=parseInt(b,10))),1==a.get("debug")&&(this.args.debug=1),a},_onFilterChanged:e(function(a){var b=a.detail;b===this.filter&&this.update(!0,!0)},400),_onClick:function(a){if(this.filter){var b=a.target.closest(".mod_facetoface__sessionlist__show-previous__link");if(null!==b){a.preventDefault();var c=/\ballpreviousevents=(\d+)/.exec(b.getAttribute("href"));c&&c[1]?this.filter.setParam("allpreviousevents",1):this.filter.deleteParam("allpreviousevents"),this.update(!1,!0)}}},_onScroll:function(a){a.target.classList.contains("mod_facetoface__sessionlist")&&d.update()},update:function(a,b){if(a||b){var c=this.filterParams();history.replaceState({ajax:!0,filter:c},"",this.url()),this.initDone&&this.filter&&this.filter.showResetLink();var d=++this.requestCookie;a&&this.updateWorker("upcoming",d,c),b&&this.updateWorker("past",d,c)}},updateWorker:function(a,d,e){var g=this,h=this.el,i=h.querySelector(".mod_facetoface__sessions--"+a);i.classList.add("loading");var j=f("update",a,d);this.fetch(a,d,e).then(function(c){if(g.requestCookie===c.cookie){var e=h.querySelector(".mod_facetoface__event-dashboard__title");e.textContent=c.title;var k=f("update-table",a,d);b.render("mod_facetoface/seminarevent_dashboard_sessions",c.data).done(function(a,c){i.outerHTML=a,i.classList.remove("loading"),b.runTemplateJS(c),k()}),j()}else j()})["catch"](c.exception)},url:function(){var a=location.href.replace(/\?.*$/,"")+"?";if(a+=this.args.id?"id="+this.args.id:"f="+this.args.f,this.args.debug&&(a+="&debug=1"),!this.filter)return a;var b=this.filter.getParamsString();return b?a+"&"+b:a},filterParams:function(){if(!this.filter)return{};var a={};return this.filter.forEachParams(function(b,c){a[c]=b}),a},fetch:function(b,d,e){var f=Object.assign(this.args,{type:b,cookie:d,filterparams:e}),g=a.call([{methodname:"mod_facetoface_render_session_list",args:f}],!0,!0);return g[0].fail(function(a){c.exception(a)})}};return i});
define('mod_facetoface/seminarevent_dashboard_action', [],function(){function a(){var a=document.documentElement||document.body.parentNode;if("number"!=typeof a.clientWidth&&(a=document.body),"number"==typeof document.clientWidth)return{width:document.clientWidth,height:document.clientHeight};var b,c,d=document.body,e=document.defaultView||window;return a===d||(b=Math.max(a.clientWidth,d.clientWidth))>e.innerWidth||(c=Math.max(a.clientHeight,d.clientHeight))>e.innerHeight?{width:d.clientWidth,height:d.clientHeight}:{width:b,height:c}}function b(a){var b="mod_facetoface_event-action:";return b+=1===arguments.length?a:Array.prototype.reduce.call(arguments,function(a,b){return a+":"+b}),M.util.js_pending(b),function(){M.util.js_complete(b)}}function c(a){return this instanceof c?void this._init(a):new c(a)}function d(a){return this instanceof d?void this._init(a):new d(a)}c.OPEN_EVENT="mod_facetoface:dropdown.open",c.CLOSED_EVENT="mod_facetoface:dropdown.closed",function(){var d={TAB:9,ENTER:13,ESCAPE:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40};this.constructor=c,this._init=function(a){if(!a.matches(".mod_facetoface__sessionlist__action__dropdown"))throw new Error("DD: not a dropdown button");if(this.el=a,this.parent=a.closest(".mod_facetoface__sessionlist__action__buttons"),null===this.parent)throw new Error("DD: button group not found");if(this.menu=this.parent.querySelector('[data-f2f-dropdown-id="'+a.id+'"]'),null===this.menu)throw new Error("DD: menu not found");this.menuItems=Array.prototype.slice.apply(this.menu.querySelectorAll("li:not(.disabled) > .dropdown-item")).map(function(a){return a.parentNode}),this.scrollTimerId=null,this.scrollDone=null,this.el.setAttribute("aria-expanded","false"),this._onKeyDownMenu=this._onKeyDownMenu.bind(this),this._onScrollOrResize=this._onScrollOrResize.bind(this),this._onClickBackground=this._onClickBackground.bind(this),this._onBlurButton=this._onBlurButton.bind(this),this._onKeyDownButton=this._onKeyDownButton.bind(this),this.el.addEventListener("click",this._onClickButton.bind(this)),this.el.addEventListener("focus",this._onFocusButton.bind(this))},this.isMenuOpen=function(){return this.parent.classList.contains("open")},this.openMenu=function(){return this.parent.classList.add("open"),this.el.setAttribute("aria-expanded","true"),window.addEventListener("click",this._onClickBackground,!0),window.addEventListener("keydown",this._onKeyDownMenu,!0),window.addEventListener("scroll",this._onScrollOrResize,!0),window.addEventListener("resize",this._onScrollOrResize,!0),this._fireEvent(c.OPEN_EVENT),this.repositionMenu()},this.closeMenu=function(a){return this.parent.classList.remove("open"),this.el.setAttribute("aria-expanded","false"),window.removeEventListener("click",this._onClickBackground,!0),window.removeEventListener("keydown",this._onKeyDownMenu,!0),window.removeEventListener("scroll",this._onScrollOrResize,!0),window.removeEventListener("resize",this._onScrollOrResize,!0),this.scrollTimerId&&(window.cancelAnimationFrame(this.scrollTimerId),this.scrollTimerId=null),this.scrollDone&&(this.scrollDone(),this.scrollDone=null),a&&this.el.focus(),this._fireEvent(c.CLOSED_EVENT),Promise.resolve()},this.repositionMenu=function(){this.scrollTimerId&&(window.cancelAnimationFrame(this.scrollTimerId),this.scrollTimerId=null);var c=this;return new Promise(function(d){var e=function(){c.scrollTimerId=null;var b=c.el.getBoundingClientRect(),e=a(),f=b.top+b.height;if(c.menu.style.top=f+"px","rtl"===getComputedStyle(c.el).direction){var g=b.left;g<0&&(g=0),c.menu.style.left=g+"px",c.menu.style.right=""}else{var h=e.width-b.left-b.width;h<0&&(h=0),c.menu.style.left="",c.menu.style.right=h+"px"}c.scrollTimerId=null,c.scrollDone&&(c.scrollDone(),c.scrollDone=null),d()};c.scrollDone=c.scrollDone||b("reposition",c.el.id),c.scrollTimerId=window.requestAnimationFrame(e)})},this.selectItem=function(a){if(this.menuItems.length){a%=this.menuItems.length,a<0&&(a+=this.menuItems.length);var c=this.menuItems[a].querySelector("a"),d=b("selectitem",this.el.id,a);return new Promise(function(a){setTimeout(function(){c.focus(),d(),a()},0)})}return Promise.resolve()},this.openMenuAndSelectItem=function(a){var b=this;return b.openMenu().then(function(){return b.selectItem(a)})},this._fireEvent=function(a){var b=new CustomEvent(a,{bubbles:!0,detail:this});this.el.dispatchEvent(b)},this._onClickButton=function(a){a.preventDefault(),a.stopPropagation(),this.isMenuOpen()?this.closeMenu():this.openMenu()},this._onFocusButton=function(){event.stopPropagation(),this.el.addEventListener("blur",this._onBlurButton),this.el.addEventListener("keydown",this._onKeyDownButton)},this._onBlurButton=function(){event.stopPropagation(),this.el.removeEventListener("blur",this._onBlurButton),this.el.removeEventListener("keydown",this._onKeyDownButton)},this._onKeyDownButton=function(a){if(a.stopPropagation(),this.isMenuOpen())switch(a.keyCode){case d.TAB:a.shiftKey?this.closeMenu():this.selectItem(0);break;case d.ESCAPE:this.closeMenu()}else switch(a.keyCode){case d.DOWN:a.preventDefault(),this.openMenuAndSelectItem(0);break;case d.UP:a.preventDefault(),this.openMenuAndSelectItem(-1);break;case d.ENTER:case d.SPACE:a.preventDefault(),this.openMenuAndSelectItem(0)}},this._onKeyDownMenu=function(a){var b=a.target.closest("li");if(null!==b||a.target===this.el||this.el.contains(a.target)){a.stopPropagation();var c=this.menuItems.indexOf(b);switch(a.keyCode){case d.ESCAPE:a.preventDefault(),this.closeMenu(!0);break;case d.UP:a.preventDefault(),this.selectItem(c<0?c:c-1);break;case d.DOWN:a.preventDefault(),this.selectItem(c+1);break;case d.TAB:a.stopPropagation(),a.shiftKey?c<=0?this.closeMenu(!0):(a.preventDefault(),this.selectItem(c-1)):c>=this.menuItems.length-1?this.closeMenu(!0):(a.preventDefault(),this.selectItem(c+1))}}},this._onClickBackground=function(a){!this.el.contains(a.target)&&this.isMenuOpen()&&setTimeout(function(){this.closeMenu()}.bind(this),0)},this._onScrollOrResize=function(a){a.target!==document&&a.target!==window||!this.isMenuOpen()||this.repositionMenu()}}.call(c.prototype),function(){var a=null;Object.defineProperty(d,"current",{get:function(){return a}}),this.constructor=d,this._init=function(a){this.el=a;var b=a.querySelector(".mod_facetoface__sessionlist__action__dropdown");b&&(this.dropdown=new c(b),a.addEventListener(c.OPEN_EVENT,this._onDropDownOpen.bind(this)),a.addEventListener(c.CLOSED_EVENT,this._onDropDownClosed.bind(this)))},this._onDropDownOpen=function(b){b.detail!==a&&(a=b.detail)},this._onDropDownClosed=function(b){b.detail===a&&(a=null)}}.call(d.prototype);var e={init:function(a){return new Promise(function(b){var c=new d(a);b(c)})},update:function(){var a=d.current;a&&a.repositionMenu()}};return e});
define('mod_facetoface/seminarevent_detail', [],function(){const a="f2f-collapsed",b="f2f-expanded";return{init:function(c){return new Promise(function(d){"true"==c.getAttribute("data-collapsible")&&c.addEventListener("click",function(c){var d=c.target.closest('a[href="#"]');if(null!==d){c.preventDefault();var e="true"!=d.getAttribute("aria-expanded"),f=document.getElementById(d.getAttribute("data-f2f-section-id"));e?(f.style.display="",d.classList.remove(a),d.classList.add(b)):(f.style.display="none",d.classList.add(a),d.classList.remove(b)),d.setAttribute("aria-expanded",e.toString())}}),d(!0)})}}});
define('mod_facetoface/seminarevent_information', ["core/yui","core/form_duplicate_prevent"],function(a,b){return{init:function(c){return new Promise(function(d){b.init(c).then(function(){a.use("moodle-core-event",function(){a.Global.on(M.core.globalEvents.FORM_ERROR,function(a){M.util.js_pending("mod_facetoface__eventinfo_form_error"),setTimeout(function(){var d=c.querySelector("#"+a.formid);null!==d&&null!==d.querySelector("#"+a.elementid)&&b.reset(),M.util.js_complete("mod_facetoface__eventinfo_form_error")},10)}),d()})})})}}});
define('mod_facetoface/take_attendance', [],function(){function a(b){return this instanceof a?void(this.component=b):new a(b)}return a.prototype={constructor:a,toggleCheckBoxes:function(a){var b=this.component.querySelectorAll(".selectedcheckboxes");for(var c in b)b.hasOwnProperty(c)&&(b[c].checked=a)},checkNotSetUsers:function(a){var b=this.component.querySelectorAll(".selectedcheckboxes"),c=this.component.getAttribute("data-notsetcode")||0;for(var d in b)if(b.hasOwnProperty(d)){var e=b[d],f=e.getAttribute("data-selectid"),g=this.component.querySelector("#"+f);null!==g&&(e.checked=!1,a&&c==g.value?e.checked=!0:a||c==g.value||(e.checked=!0))}},addEventListeners:function(){var a=this,b=a.component.querySelector(".tw-takeAttendanceBulkAction");b.addEventListener("mod_facetoface/take_attendance_bulk_action:bulk-select-learner",function(b){var c=b.detail.options,d={};for(var e in c)if(c.hasOwnProperty(e)){var f=c[e];switch(f){case c.selectall.toString():d[f]=function(){a.toggleCheckBoxes(!0)};break;case c.selectset.toString():d[f]=function(){a.checkNotSetUsers(!1)};break;case c.selectnotset.toString():d[f]=function(){a.checkNotSetUsers(!0)};break;case c.selectnone.toString():default:d[f]=function(){a.toggleCheckBoxes(!1)}}}b.detail.hasOwnProperty("handle")&&"function"==typeof b.detail.handle&&b.detail.handle(d)}),b.addEventListener("mod_facetoface/take_attendance_bulk_action:bulk-take-attendance",function(b){var c=b.detail,d=a.component.querySelectorAll(".selectedcheckboxes"),e=0;for(var f in d)if(d.hasOwnProperty(f)){var g=d[f];if(g.checked){var h=g.getAttribute("data-selectid"),i=a.component.querySelector("#"+h);i.value=c.statusCode,e+=1}}0===e&&c.hasOwnProperty("toggleError")&&"function"==typeof c.toggleError&&c.toggleError(!0)}),a.component.addEventListener("change",function(a){a.target.closest(".mod-facetoface-attendees .selectedcheckboxes")&&b.dispatchEvent(new CustomEvent("mod_facetoface/take_attendance_bulk_action:user_selected"))})},exportToFile:function(){var a=this,b=a.component.querySelector("#menuf2f-export-actions");null!==b&&b.addEventListener("change",function(){var b=this;if(b.value&&""!=b.value){var c=b.value,d={url:a.component.getAttribute("data-url"),sessionid:a.component.getAttribute("data-sessionid"),sessiondateid:a.component.getAttribute("data-sessiondateid")};window.location.href=d.url+"?s="+d.sessionid+"&sd="+d.sessiondateid+"&onlycontent=1&download="+c.substr(6)}})}},{init:function(b){var c=new a(b);c.addEventListeners(),c.exportToFile()}}});
define('mod_facetoface/take_attendance_bulk_action', [],function(){function a(b){return this instanceof a?void(this.component=b):new a(b)}return a.prototype={constructor:a,getOptions:function(){var a=["selectall","selectnone","selectset","selectnotset"],b={};for(var c in a)if(a.hasOwnProperty(c)){var d=a[c],e="data-"+d;if(!this.component.hasAttribute(e))return null;b[d]=this.component.getAttribute(e)}return b},bulkTakeAttendance:function(){var a=this,b=a.component.querySelector("#menubulkattendanceop");null!==b&&b.addEventListener("change",function(){var b=this;a.toggleError(!1),b.value&&"-1"!==b.value&&a.triggerEvent("bulk-take-attendance",{statusCode:b.value,toggleError:function(b){a.toggleError(b)}})})},bulkSelectLearners:function(){var a=this,b=a.component.querySelector("#menubulk_select"),c=a.getOptions();null!==c&&null!==b&&b.addEventListener("change",function(){var b=c.selectnone,d=this;d.value&&(b=d.value);var e=function(a){if(!a.hasOwnProperty(b))throw new Error("No operator for selector option: "+b);var c=a[b];if("function"!=typeof c)throw new Error("Expecting function at selector option: "+b);c()};a.triggerEvent("bulk-select-learner",{value:b,options:c,handle:e}),a.toggleError(!1);var f=a.component.querySelector("#menubulkattendanceop");null!==f&&(f.selectedIndex=0)})},triggerEvent:function(a,b){var c=new CustomEvent("mod_facetoface/take_attendance_bulk_action:"+a,{bubbles:!0,detail:b});this.component.dispatchEvent(c)},toggleError:function(a){var b=this.component.querySelector("#selectoptionbefore");a?b.classList.contains("f2f-selectionoptionbefore-error")||b.classList.add("f2f-selectionoptionbefore-error"):b.classList.contains("f2f-selectionoptionbefore-error")&&b.classList.remove("f2f-selectionoptionbefore-error")},addEvents:function(){var a=this;this.bulkTakeAttendance(),this.bulkSelectLearners(),this.component.addEventListener("mod_facetoface/take_attendance_bulk_action:user_selected",function(){a.component.querySelector("#menubulk_select").value=a.getOptions().selectset})}},{init:function(b){return new Promise(function(c){var d=new a(b);d.addEvents(),c(d)})}}});
define('mod_facetoface/take_attendance_session_picker', [],function(){return{init:function(a){var b=a.querySelector("select");b.addEventListener("change",function(){window.location.href=a.dataset.url+"?s="+a.dataset.sessionid+"&sd="+this.options[this.selectedIndex].value})}}});
define('mod_facetoface/user_conflicts_confirm', ["jquery","core/modal_factory","core/modal_events","core/str"],function(a,b,c,d){var e={init:function(b){var c=a("#mform_seminar_event");void 0!==b&&b.length&&e.overrideUserConflictsModalForm(c,b)},overrideUserConflictsModalForm:function(e,f){var g=[{key:"savewithuserconflicts_header",component:"facetoface"},{key:"savewithuserconflicts",component:"facetoface"},{key:"cancel",component:"moodle"}];d.get_strings(g).then(function(d){var g=d[0],h=d[1],i=d[2];return b.create({title:g,body:f,type:b.types.CONFIRM},void 0,{yesstr:h,nostr:i}).then(function(b){b.show(),b.getRoot().on(c.yes,function(){var b=e.attr("action")+"?savewithconflicts=1";e.attr("action",b),a("#id_submitbutton").trigger("click")})})})}};return e});
define('mod_facetoface/virtualroom_card', [],function(){function a(a){this.element=a,this.copyBox=a.querySelector(".mod_facetoface__resource-card__copy-container"),this.copyLink=a.querySelector(".mod_facetoface__resource-card__copy-link")}function b(b){return new Promise(function(c){var d=new a(b);d.setupEvents(),c(d)})}return a.prototype={element:null,copyBox:null,setupEvents:function(){var a=this;this.copyLink.addEventListener("click",function(b){var c,d=window.getSelection();b.preventDefault(),d.rangeCount&&(c=d.getRangeAt(0)),a.copyBox.select(),document.execCommand("copy"),c&&(window.getSelection().removeAllRanges(),window.getSelection().addRange(c))})}},{init:b}});
define('mod_feedback/edit', ["jquery","core/ajax","core/str","core/notification"],function(a,b,c,d){var e={deleteItem:function(b){b.preventDefault(),c.get_strings([{key:"confirmation",component:"admin"},{key:"confirmdeleteitem",component:"mod_feedback"},{key:"yes",component:"moodle"},{key:"no",component:"moodle"}]).done(function(c){d.confirm(c[0],c[1],c[2],c[3],a.proxy(function(){window.location=a(this).attr("href")},b.currentTarget))})},setup:function(){a("body").delegate('[data-action="delete"]',"click",e.deleteItem)}};return{setup:e.setup}});
define('mod_forum/big_search_form', [],function(){return{init:function(){var a=document.getElementById("searchform"),b=function(b,c){for(var d=a.querySelectorAll("select[name^="+b+"]"),e=0;e<d.length;e++)d[e].disabled=c;for(var f=a.querySelectorAll("input[name^="+b+"]"),g=c?1:0,h=0;h<f.length;h++)f[h].value=g};b("from",!a.querySelector("input[name='timefromrestrict']").checked),b("to",!a.querySelector("input[name='timetorestrict']").checked),a.addEventListener("click",function(a){a.target.matches("input[name='timefromrestrict']")?b("from",!a.target.checked):a.target.matches("input[name='timetorestrict']")&&b("to",!a.target.checked)})}}});
define('mod_forum/post', ["jquery","core/notification","core/str"],function(a,b,c){var d={confirm:function(d){d.preventDefault(),c.get_strings([{key:"confirm",component:"moodle"},{key:"postingwillunlock",component:"mod_forum"},{key:"yes",component:"moodle"},{key:"no",component:"moodle"}]).done(function(c){b.confirm(c[0],c[1],c[2],c[3],a.proxy(function(){window.onbeforeunload=null,a("#mformforum").submit()}))})},setup:function(){a("body").delegate("#mformforum #id_submitbutton","click",d.confirm)}};return{setup:d.setup}});
define('mod_lti/cartridge_registration_form', ["jquery","core/ajax","core/notification","mod_lti/tool_type","mod_lti/events","mod_lti/keys","core/str"],function(a,b,c,d,e,f,g){var h={CARTRIDGE_URL:"#cartridge-url",CONSUMER_KEY:"#registration-key",SHARED_SECRET:"#registration-secret",REGISTRATION_FORM:"#cartridge-registration-form",REGISTRATION_SUBMIT_BUTTON:"#cartridge-registration-submit",REGISTRATION_CANCEL_BUTTON:"#cartridge-registration-cancel"},i=function(){return a(h.REGISTRATION_FORM).attr("data-cartridge-url")},j=function(){return a(h.REGISTRATION_SUBMIT_BUTTON)},k=function(){return a(h.REGISTRATION_CANCEL_BUTTON)},l=function(){return a(h.CONSUMER_KEY).val()},m=function(){return a(h.SHARED_SECRET).val()},n=function(){j().addClass("loading")},o=function(){j().removeClass("loading")},p=function(){return j().hasClass("loading")},q=function(){if(p())return!1;var b=i();if(""===b)return!1;n();var f=l(),h=m(),j=d.create({cartridgeurl:b,key:f,secret:h});return j.done(function(){g.get_string("successfullycreatedtooltype","mod_lti").done(function(b){a(document).trigger(e.NEW_TOOL_TYPE),a(document).trigger(e.STOP_CARTRIDGE_REGISTRATION),a(document).trigger(e.REGISTRATION_FEEDBACK,{message:b})}).fail(c.exception)}).fail(function(){g.get_string("failedtocreatetooltype","mod_lti").done(function(b){a(document).trigger(e.NEW_TOOL_TYPE),a(document).trigger(e.STOP_CARTRIDGE_REGISTRATION),a(document).trigger(e.REGISTRATION_FEEDBACK,{message:b,error:!0})}).fail(c.exception)}).always(function(){o()}),j},r=function(){var b=a(h.REGISTRATION_FORM);b.submit(function(a){a.preventDefault(),q()});var c=k();c.click(function(b){b.preventDefault(),a(document).trigger(e.STOP_CARTRIDGE_REGISTRATION)}),c.keypress(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||a.keyCode!=f.ENTER&&a.keyCode!=f.SPACE||(a.preventDefault(),c.click())})};return{init:function(){r()}}});
define('mod_lti/contentitem', ["jquery","core/notification","core/str","core/templates","mod_lti/form-field","core/modal_factory","core/modal_events"],function(a,b,c,d,e,f,g){var h,i,j={init:function(a,e,j){i=j;var k={url:a,postData:e},l=d.render("mod_lti/contentitem",k);return h?(h.setBody(l),void h.show()):void c.get_string("selectcontent","lti").then(function(a){return f.create({title:a,body:l,large:!0})}).then(function(a){h=a,a.getRoot().on(g.hidden,function(){a.setBody(""),b.fetchNotifications()}),a.show()})["catch"](b.exception)}},k=[new e("name",e.TYPES.TEXT,(!1),""),new e("introeditor",e.TYPES.EDITOR,(!1),""),new e("toolurl",e.TYPES.TEXT,(!0),""),new e("securetoolurl",e.TYPES.TEXT,(!0),""),new e("instructorchoiceacceptgrades",e.TYPES.CHECKBOX,(!0),(!0)),new e("instructorchoicesendname",e.TYPES.CHECKBOX,(!0),(!0)),new e("instructorchoicesendemailaddr",e.TYPES.CHECKBOX,(!0),(!0)),new e("instructorcustomparameters",e.TYPES.TEXT,(!0),""),new e("icon",e.TYPES.TEXT,(!0),""),new e("secureicon",e.TYPES.TEXT,(!0),""),new e("launchcontainer",e.TYPES.SELECT,(!0),0),new e("grade_modgrade_point",e.TYPES.TEXT,(!1),""),new e("cmidnumber",e.TYPES.TEXT,(!0),"")];return window.processContentItemReturnData=function(a){h&&h.hide();var b;for(b in k){var c=k[b],d=null;"undefined"!=typeof a[c.name]&&(d=a[c.name]),c.setFieldValue(d)}i&&i()},j});
define('mod_lti/contentitem_return', ["jquery"],function(a){return{init:function(b){a(window).ready(function(){window!=top?parent.processContentItemReturnData(b):window.processContentItemReturnData(b)})}}});
define('mod_lti/events', [],function(){return{NEW_TOOL_TYPE:"lti.tool.type.new",START_EXTERNAL_REGISTRATION:"lti.registration.external.start",STOP_EXTERNAL_REGISTRATION:"lti.registration.external.stop",START_CARTRIDGE_REGISTRATION:"lti.registration.cartridge.start",STOP_CARTRIDGE_REGISTRATION:"lti.registration.cartridge.stop",REGISTRATION_FEEDBACK:"lti.registration.feedback",CAPABILITIES_AGREE:"lti.tool.type.capabilities.agree",CAPABILITIES_DECLINE:"lti.tool.type.capabilities.decline"}});
define('mod_lti/external_registration', ["jquery","core/ajax","core/notification","core/templates","mod_lti/events","mod_lti/tool_proxy","mod_lti/tool_type","mod_lti/keys","core/str"],function(a,b,c,d,e,f,g,h,i){var j={EXTERNAL_REGISTRATION_CONTAINER:"#external-registration-page-container",EXTERNAL_REGISTRATION_TEMPLATE_CONTAINER:"#external-registration-template-container",EXTERNAL_REGISTRATION_CANCEL_BUTTON:"#cancel-external-registration",TOOL_TYPE_CAPABILITIES_CONTAINER:"#tool-type-capabilities-container",TOOL_TYPE_CAPABILITIES_TEMPLATE_CONTAINER:"#tool-type-capabilities-template-container",CAPABILITIES_AGREE_CONTAINER:".capabilities-container"},k=function(){return a(j.EXTERNAL_REGISTRATION_CANCEL_BUTTON)},l=function(){return a(j.EXTERNAL_REGISTRATION_CONTAINER)},m=function(){return a(j.EXTERNAL_REGISTRATION_TEMPLATE_CONTAINER)},n=function(){return a(j.TOOL_TYPE_CAPABILITIES_CONTAINER)},o=function(){return a(j.TOOL_TYPE_CAPABILITIES_TEMPLATE_CONTAINER)},p=function(){n().addClass("loading")},q=function(){n().removeClass("loading")},r=function(){k().addClass("loading")},s=function(){k().removeClass("loading")},t=function(){n().addClass("hidden")},u=function(){n().removeClass("hidden")},v=function(){l().addClass("hidden")},w=function(){l().removeClass("hidden")},x=function(a){var b=k();b.attr("data-tool-proxy-id",a)},y=function(){var a=k();return a.attr("data-tool-proxy-id")},z=function(){var a=k();a.removeAttr("data-tool-proxy-id")},A=function(){return!!y()},B=function(){var a=k();return a.attr("data-tool-proxy-new")&&A()},C=function(){var a=k();return a.attr("data-tool-proxy-new","new")},D=function(){var a=k();return a.removeAttr("data-tool-proxy-new")},E=function(a){var c={methodname:"mod_lti_get_tool_proxy_registration_request",args:{id:a}};return b.call([c])[0]},F=function(){r();var b=a.Deferred();if(B()){var d=y();f["delete"](d).done(function(){b.resolve()}).fail(function(a){b.reject(a)})}else b.resolve();return b.done(function(){L(),s()}).fail(function(b){c.exception(b),L(),s(),i.get_string("failedtodeletetoolproxy","mod_lti").done(function(b){var c={message:b,error:!0};a(document).trigger(e.REGISTRATION_FEEDBACK,c)}).fail(c.exception)}),b},G=function(a){var b=d.render("mod_lti/tool_proxy_registration_form",a);return b.done(function(a,b){var c=m();c.append(a),d.runTemplateJS(b),c.find("form").submit(),w()}).fail(c.exception),b},H=function(a){return g.update({id:a.id,state:g.constants.state.configured})},I=function(b){var f=a.Deferred();return d.render("mod_lti/tool_type_capabilities_agree",b).done(function(a,c){var g=o();v(),u(),d.replaceNodeContents(g,a,c);var h=g.find(j.CAPABILITIES_AGREE_CONTAINER);h.on(e.CAPABILITIES_AGREE,function(){p(),H(b).always(function(){q(),g.empty(),f.resolve()})}),h.on(e.CAPABILITIES_DECLINE,function(){g.empty(),f.resolve()})}).fail(f.reject),f.done(function(){t()}).fail(c.exception),f},J=function(b){var c=a.Deferred();return b&&""!==b?f.create({regurl:b}).done(function(a){C(),c=K(a.id)}).fail(function(b){F();var d={message:b.message,error:!0};a(document).trigger(e.REGISTRATION_FEEDBACK,d),c.reject(b)}):c.resolve(),c},K=function(b){var c=a.Deferred();return x(b),E(b).done(function(a){G(a).done(function(){c.resolve()}).fail(c.fail)}).fail(c.fail),c},L=function(){A()&&z(),D(!1),v();var b=m();b.empty(),a(document).trigger(e.STOP_EXTERNAL_REGISTRATION)},M=function(){a(document).on(e.START_EXTERNAL_REGISTRATION,function(a,b){b&&(b.url&&J(b.url),b.proxyid&&K(b.proxyid))});var b=k();b.click(function(a){a.preventDefault(),F()}),b.keypress(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||a.keyCode!=h.ENTER&&a.keyCode!=h.SPACE||(a.preventDefault(),F())}),window.triggerExternalRegistrationComplete=function(b){var d=a.Deferred(),f={message:"",error:!1};if("success"==b.status){if(i.get_string("successfullycreatedtooltype","mod_lti").done(function(a){f.message=a}).fail(c.exception),d.done(function(){L(),a(document).trigger(e.REGISTRATION_FEEDBACK,f),a(document).trigger(e.NEW_TOOL_TYPE)}).fail(c.exception),B()){var h=y();g.getFromToolProxyId(h).done(function(a){if(a&&a.length){var b=a[0];b.hascapabilitygroups?I(b).always(function(){d.resolve()}):d.resolve()}else d.resolve()}).fail(function(){d.resolve()})}}else f.message=b.error,f.error=!0,d.done(function(){F().always(function(){a(document).trigger(e.REGISTRATION_FEEDBACK,f)})}).fail(c.exception),d.resolve();return d}};return{init:function(){M()}}});
define('mod_lti/external_registration_return', [],function(){return{init:function(a,b,c,d){window.parent&&window.parent.triggerExternalRegistrationComplete({message:a,error:b,id:c,status:d})}}});
define('mod_lti/form-field', ["jquery"],function(a){var b=function(a,b,c,d){this.name=a,this.id="id_"+this.name,this.selector="#"+this.id,this.type=b,this.resetIfUndefined=c,this.defaultValue=d};return b.TYPES={TEXT:1,SELECT:2,CHECKBOX:3,EDITOR:4},b.prototype.setFieldValue=function(c){if(null===c){if(!this.resetIfUndefined)return;c=this.defaultValue}switch(this.type){case b.TYPES.CHECKBOX:c?a(this.selector).prop("checked",!0):a(this.selector).prop("checked",!1);break;case b.TYPES.EDITOR:if("undefined"!=typeof c.text){var d=a(this.selector+"editable");d.length&&d.html(c.text),a(this.selector).val(c.text)}break;default:a(this.selector).val(c)}},b});
define('mod_lti/keys', [],function(){return{ENTER:13,SPACE:32}});
define('mod_lti/tool_card_controller', ["jquery","core/ajax","core/notification","core/templates","core/modal_factory","mod_lti/tool_type","mod_lti/events","mod_lti/keys","core/str"],function(a,b,c,d,e,f,g,h,i){var j={DELETE_BUTTON:".delete",NAME_ELEMENT:".name",DESCRIPTION_ELEMENT:".description",CAPABILITIES_CONTAINER:".capabilities-container",ACTIVATE_BUTTON:".tool-card-footer a.activate"},k=2e3,l=function(a){return a.find(j.DELETE_BUTTON)},m=function(a){return a.find(j.NAME_ELEMENT)},n=function(a){return a.find(j.DESCRIPTION_ELEMENT)},o=function(a){return a.find(j.ACTIVATE_BUTTON)},p=function(a){return!!o(a).length},q=function(a){return a.find(j.CAPABILITIES_CONTAINER)},r=function(a){return!!q(a).length},s=function(a){return a.attr("data-type-id")},t=function(a){a.removeClass("announcement loading success fail capabilities")},u=function(a){t(a),a.addClass("announcement loading")},v=function(a){a.removeClass("announcement loading")},w=function(b){var c=a.Deferred();return t(b),b.addClass("announcement success"),setTimeout(function(){b.removeClass("announcement success"),c.resolve()},k),c},x=function(b){var c=a.Deferred();return t(b),b.addClass("announcement fail"),setTimeout(function(){b.removeClass("announcement fail"),c.resolve()},k),c},y=function(b){var d=a.Deferred(),e=s(b);return u(b),""===e?a.Deferred().resolve():(i.get_strings([{key:"delete",component:"mod_lti"},{key:"delete_confirmation",component:"mod_lti"},{key:"delete",component:"mod_lti"},{key:"cancel",component:"core"}]).done(function(a){c.confirm(a[0],a[1],a[2],a[3],function(){f["delete"](e).done(function(){v(b),w(b).done(function(){b.remove()}).fail(c.exception).always(function(){d.resolve()})}).fail(function(a){x(b),d.reject(a)})},function(){v(b),d.resolve()})}).fail(function(a){v(b),c.exception(a),d.reject(a)}),d)},z=function(a,b){a.attr("data-val-snapshot",b)},A=function(a){return a.attr("data-val-snapshot")},B=function(a){var b=n(a);if(!b.hasClass("loading")){var c=b.text().trim();z(b,c)}},C=function(b){var d=s(b);if(""===d)return a.Deferred().resolve();var e=n(b);if(e.hasClass("loading"))return a.Deferred().resolve();var g=e.text().trim(),h=A(e);if(h==g)return a.Deferred().resolve();e.addClass("loading");var i=f.update({id:d,description:g});return i.done(function(a){e.removeClass("loading"),e.text(a.description)}).fail(c.exception),i.fail(function(){e.removeClass("loading")}),i},D=function(a){var b=m(a);if(!b.hasClass("loading")){var c=b.text().trim();z(b,c)}},E=function(b){var c=s(b);if(""===c)return a.Deferred().resolve();var d=m(b);if(d.hasClass("loading"))return a.Deferred().resolve();var e=d.text().trim(),g=A(d);if(g==e)return a.Deferred().resolve();d.addClass("loading");var h=f.update({id:c,name:e});return h.done(function(a){d.removeClass("loading"),d.text(a.name)}),h.fail(function(){d.removeClass("loading")}),h},F=function(b){var c=s(b);if(""===c)return a.Deferred().resolve();u(b);var e=f.update({id:c,state:f.constants.state.configured});return e.then(function(a){return v(b),w(b),a}).then(function(a){return d.render("mod_lti/tool_card",a)}).then(function(a){var c=a[0],e=a[1];d.replaceNode(b,c,e)})["catch"](function(){v(b),x(b)}),e},G=function(a){a.addClass("announcement capabilities")},H=function(a){a.removeClass("announcement capabilities")},I=function(a){r(a)?G(a):F(a)},J=function(a){var b=l(a);b.click(function(b){b.preventDefault(),y(a)}),b.keypress(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||a.keyCode!=h.ENTER&&a.keyCode!=h.SPACE||(a.preventDefault(),b.click())});var c=n(a);c.focus(function(b){b.preventDefault(),B(a)}),c.blur(function(b){b.preventDefault(),C(a)}),c.keypress(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||a.keyCode==h.ENTER&&(a.preventDefault(),c.blur())});var d=m(a);if(d.focus(function(b){b.preventDefault(),D(a)}),d.blur(function(b){b.preventDefault(),E(a)}),d.keypress(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||a.keyCode==h.ENTER&&(a.preventDefault(),d.blur())}),p(a)){var e=o(a);e.click(function(b){b.preventDefault(),I(a)}),e.keypress(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||a.keyCode!=h.ENTER&&a.keyCode!=h.SPACE||(a.preventDefault(),e.click())})}if(r(a)){var f=q(a);f.on(g.CAPABILITIES_AGREE,function(){F(a)}),f.on(g.CAPABILITIES_DECLINE,function(){H(a)})}},K=function(b){var c=a("#"+b.data("uniqid")+"-"+b.data("deploymentid")),f={uniqid:b.data("uniqid"),platformid:b.data("platformid"),clientid:b.data("clientid"),deploymentid:b.data("deploymentid"),urls:{publickeyset:b.data("publickeyseturl"),accesstoken:b.data("accesstokenurl"),authrequest:b.data("authrequesturl")}},g=d.render("mod_lti/tool_config_modal_body",f),h="mailto:?subject="+encodeURIComponent(b.data("mailtosubject"))+"&body="+encodeURIComponent(b.data("platformidstr"))+":%20"+encodeURIComponent(b.data("platformid"))+"%0D%0A"+encodeURIComponent(b.data("clientidstr"))+":%20"+encodeURIComponent(b.data("clientid"))+"%0D%0A"+encodeURIComponent(b.data("deploymentidstr"))+":%20"+encodeURIComponent(b.data("deploymentid"))+"%0D%0A"+encodeURIComponent(b.data("publickeyseturlstr"))+":%20"+encodeURIComponent(b.data("publickeyseturl"))+"%0D%0A"+encodeURIComponent(b.data("accesstokenurlstr"))+":%20"+encodeURIComponent(b.data("accesstokenurl"))+"%0D%0A"+encodeURIComponent(b.data("authrequesturlstr"))+":%20"+encodeURIComponent(b.data("authrequesturl"))+"%0D%0A";f={mailto:h};var i=d.render("mod_lti/tool_config_modal_footer",f);e.create({large:!0,title:b.data("modaltitle"),body:g,footer:i},c)};return{init:function(a){J(a),K(a)}}});
define('mod_lti/tool_configure_controller', ["jquery","core/ajax","core/notification","core/templates","mod_lti/events","mod_lti/keys","mod_lti/tool_type","mod_lti/tool_proxy","core/str"],function(a,b,c,d,e,f,g,h,i){var j={EXTERNAL_REGISTRATION_CONTAINER:"#external-registration-container",EXTERNAL_REGISTRATION_PAGE_CONTAINER:"#external-registration-page-container",CARTRIDGE_REGISTRATION_CONTAINER:"#cartridge-registration-container",CARTRIDGE_REGISTRATION_FORM:"#cartridge-registration-form",ADD_TOOL_FORM:"#add-tool-form",TOOL_LIST_CONTAINER:"#tool-list-container",TOOL_CREATE_BUTTON:"#tool-create-button",REGISTRATION_CHOICE_CONTAINER:"#registration-choice-container",TOOL_URL:"#tool-url"},k=function(){return a(j.TOOL_CREATE_BUTTON)},l=function(){return a(j.TOOL_LIST_CONTAINER)},m=function(){return a(j.EXTERNAL_REGISTRATION_CONTAINER)},n=function(){return a(j.CARTRIDGE_REGISTRATION_CONTAINER)},o=function(){return a(j.REGISTRATION_CHOICE_CONTAINER)},p=function(){return a(j.TOOL_URL).val()},q=function(){m().addClass("hidden")},r=function(){n().addClass("hidden")},s=function(){o().addClass("hidden")},t=function(){r(),s(),m().removeClass("hidden"),w(m())},u=function(a){q(),s();var b=n();b.find("input").val(""),b.removeClass("hidden"),b.find(j.CARTRIDGE_REGISTRATION_FORM).attr("data-cartridge-url",a),w(b)},v=function(){q(),r(),o().removeClass("hidden"),w(o())},w=function(a){var b=a.children().detach();b.appendTo(a)},x=function(){l().addClass("hidden")},y=function(){l().removeClass("hidden")},z=function(a){var b=a.error?"error":"success";c.addNotification({message:a.message,type:b})},A=function(a){a.addClass("loading")},B=function(a){a.removeClass("loading")},C=function(){var b=a.Deferred(),e=l();A(e),a.when(g.query(),h.query({orphanedonly:!0})).done(function(a,c){var f=[];a.map(function(a,b){var c={key:"toolisbeingused",component:"mod_lti",param:a.instancecount};f.push(c)}),c.map(function(a,b){var c={key:"toolisbeingused",component:"mod_lti",param:a.instancecount};f.push(c)}),i.get_strings(f).then(function(b){var e=0;return a.map(function(c,d){a[d].toolusedcountstr=b[e],e++}),c.map(function(a,d){c[d].toolusedcountstr=b[e],e++}),d.render("mod_lti/tool_list",{tools:a,proxies:c})}).then(function(a,c){e.empty(),e.append(a),d.runTemplateJS(c),b.resolve()}).fail(b.reject)}).fail(b.reject),b.fail(c.exception).always(function(){B(e)})},D=function(){var b=a.trim(p());if(""===b)return a.Deferred().resolve();var d=k();A(d);var f=g.isCartridge(b);return f.always(function(){B(d)}),f.done(function(c){c.iscartridge?(a(j.TOOL_URL).val(""),a(document).trigger(e.START_CARTRIDGE_REGISTRATION,b)):a(document).trigger(e.START_EXTERNAL_REGISTRATION,{url:b})}),f.fail(function(){i.get_string("errorbadurl","mod_lti").done(function(b){a(document).trigger(e.REGISTRATION_FEEDBACK,{message:b,error:!0})}).fail(c.exception)}),f},E=function(){a(document).on(e.NEW_TOOL_TYPE,function(){C()}),a(document).on(e.START_EXTERNAL_REGISTRATION,function(){t(),a(j.TOOL_URL).val(""),x()}),a(document).on(e.STOP_EXTERNAL_REGISTRATION,function(){y(),v()}),a(document).on(e.START_CARTRIDGE_REGISTRATION,function(a,b){u(b)}),a(document).on(e.STOP_CARTRIDGE_REGISTRATION,function(){n().find(j.CARTRIDGE_REGISTRATION_FORM).removeAttr("data-cartridge-url"),v()}),a(document).on(e.REGISTRATION_FEEDBACK,function(a,b){z(b)});var b=a(j.ADD_TOOL_FORM);b.submit(function(a){a.preventDefault(),D()})};return{init:function(){E(),C()}}});
define('mod_lti/tool_proxy', ["core/ajax","core/notification"],function(a,b){return{query:function(c){var d={methodname:"mod_lti_get_tool_proxies",args:c||{}},e=a.call([d])[0];return e.fail(b.exception),e},"delete":function(c){var d={methodname:"mod_lti_delete_tool_proxy",args:{id:c}},e=a.call([d])[0];return e.fail(b.exception),e},create:function(b){var c={methodname:"mod_lti_create_tool_proxy",args:b},d=a.call([c])[0];return d}}});
define('mod_lti/tool_proxy_card_controller', ["jquery","core/ajax","core/notification","core/templates","mod_lti/tool_proxy","mod_lti/events","mod_lti/keys","core/str"],function(a,b,c,d,e,f,g,h){var i={DELETE_BUTTON:".delete",CAPABILITIES_CONTAINER:".capabilities-container",ACTIVATE_BUTTON:".tool-card-footer a.activate"},j=2e3,k=function(a){return a.find(i.DELETE_BUTTON)},l=function(a){return a.find(i.ACTIVATE_BUTTON)},m=function(a){return a.attr("data-proxy-id")},n=function(a){a.removeClass("announcement loading success fail capabilities")},o=function(a){n(a),a.addClass("announcement loading")},p=function(a){a.removeClass("announcement loading")},q=function(b){var c=a.Deferred();return n(b),b.addClass("announcement success"),setTimeout(function(){b.removeClass("announcement success"),c.resolve()},j),c},r=function(b){var c=a.Deferred();return n(b),b.addClass("announcement fail"),setTimeout(function(){b.removeClass("announcement fail"),c.resolve()},j),c},s=function(b){var d=a.Deferred(),f=m(b);return o(b),""===f?a.Deferred().resolve():(h.get_strings([{key:"delete",component:"mod_lti"},{key:"delete_confirmation",component:"mod_lti"},{key:"delete",component:"mod_lti"},{key:"cancel",component:"core"}]).done(function(a){c.confirm(a[0],a[1],a[2],a[3],function(){e["delete"](f).done(function(){p(b),q(b).done(function(){b.remove(),d.resolve()}).fail(c.exception)}).fail(function(a){r(b),d.reject(a)})},function(){p(b),d.resolve()})}).fail(function(a){p(b),c.exception(a),d.reject(a)}),d)},t=function(b){var c={proxyid:m(b)};a(document).trigger(f.START_EXTERNAL_REGISTRATION,c)},u=function(a){var b=k(a);b.click(function(b){b.preventDefault(),s(a)}),b.keypress(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||a.keyCode!=g.ENTER&&a.keyCode!=g.SPACE||(a.preventDefault(),b.click())});var c=l(a);c.click(function(b){b.preventDefault(),t(a)}),c.keypress(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||a.keyCode!=g.ENTER&&a.keyCode!=g.SPACE||(a.preventDefault(),c.click())})};return{init:function(a){u(a)}}});
define('mod_lti/tool_type', ["core/ajax","core/notification"],function(a,b){return{query:function(c){var d={methodname:"mod_lti_get_tool_types",args:c||{}},e=a.call([d])[0];return e.fail(b.exception),e},create:function(b){var c={methodname:"mod_lti_create_tool_type",args:b},d=a.call([c])[0];return d},update:function(c){var d={methodname:"mod_lti_update_tool_type",args:c},e=a.call([d])[0];return e.fail(b.exception),e},"delete":function(c){var d={methodname:"mod_lti_delete_tool_type",args:{id:c}},e=a.call([d])[0];return e.fail(b.exception),e},getFromToolProxyId:function(a){return this.query({toolproxyid:a})},isCartridge:function(b){var c={methodname:"mod_lti_is_cartridge",args:{url:b}},d=a.call([c])[0];return d},constants:{state:{configured:1,pending:2,rejected:3}}}});
define('mod_quiz/preflightcheck', ["jquery","core/yui"],function(a,b){var c={confirmDialogue:null,init:function(a,d,e,f){var g=a;b.use("moodle-core-notification",function(){b.one(e)&&(c.confirmDialogue=new M.core.dialogue({headerContent:d,bodyContent:b.one(e),draggable:!0,visible:!1,center:!0,modal:!0,width:null,extraClasses:["mod_quiz_preflight_popup"]}),b.one(a).on("click",c.displayDialogue),b.one("#id_cancel").on("click",c.hideDialogue),g=c.confirmDialogue.get("boundingBox").one('[name="submitbutton"]')),f&&b.one(g).on("click",c.launchQuizPopup,c,f)})},displayDialogue:function(a){a&&a.halt(),c.confirmDialogue.show()},hideDialogue:function(a){a&&a.halt(),c.confirmDialogue.hide(a)},launchQuizPopup:function(a,c){a.halt(),b.use("moodle-core-formchangechecker","io-form",function(){M.core_formchangechecker.reset_form_dirty_state();var d=a.target.ancestor("form");window.openpopup(a,{url:d.get("action")+"?"+b.IO.stringify(d).replace(/\bcancel=/,"x="),windowname:"quizpopup",options:c,fullscreen:!0})})}};return c});
define('mod_quiz/warn_add_randomquestions', ["jquery","core/config"],function(a,b){var c,d={init:function(){d.add_onchanges(),void 0!=c&&d.toggle_warning()},set_totara_category_counts:function(a){c=a,d.toggle_warning()},toggle_warning:function(){var b=!1,d=a("#id_category").val(),e=a("#id_includesubcategories").prop("checked"),f=parseInt(a("#id_numbertoadd").val(),10),g=c[d];e?f>g.includedcount&&(b=!0):f>g.questioncount&&(b=!0),b?a("#fitem_id_warn_random").show():a("#fitem_id_warn_random").hide()},add_onchanges:function(){var b="#id_category, #id_includesubcategories, #id_numbertoadd";a(document).on("change",b,function(){void 0!=c&&d.toggle_warning()})}};return d});
define('mod_quiz/warn_randomquestions', ["jquery","core/config"],function(a,b){var c,d={init:function(){},set_totara_random_category_selectors:function(a){c=a,d.toggle_random_usage_warning(),d.toggle_question_icons()},toggle_random_usage_warning:function(){void 0==c||0===c.notenough.length?a(".randomnotification").hide():a(".randomnotification").show()},toggle_question_icons:function(){a(".flex-icon.fa-warning").filter(c.hasenough).hide(),a(".flex-icon.fa-warning").filter(c.notenough).show()}};return d});
define('mod_survey/validation', ["jquery","core/str","core/modal_factory","core/notification"],function(a,b,c,d){return{ensureRadiosChosen:function(e){var f=b.get_strings([{key:"error",component:"moodle"},{key:"questionsnotanswered",component:"survey"}]).then(function(a){return c.create({type:c.types.CANCEL,title:a[0],body:a[1]})})["catch"](d.exception),g=a("#"+e);g.submit(function(a){return 0===g.find('input:radio[data-survey-default="true"]:checked').length||(a.preventDefault(),f.then(function(a){return a.show(),!1}))})}}});
define('mod_workshop/workshopview', ["jquery"],function(a){function b(b){var c=0;b.height("auto"),b.each(function(){var b=a(this).height();b>c&&(c=b)}),b.height(c)}return{init:function(){var c=a(".path-mod-workshop .userplan dt"),d=a(".path-mod-workshop .userplan dd");b(c),b(d),a(window).on("resize",function(){b(c),b(d)})}}});
define('auth_approved/manager-selector', ["jquery","core/ajax","core/notification"],function(a,b,c){return{processResults:function(a,b){var c,d=[],e=0;for(e=0;e<b.managers.length;e++)c=b.managers[e],d.push({value:c.jaid,label:c.displayname});return d},transport:function(c,d,e,f){"undefined"==typeof d&&(d="");var g=null,h=[{methodname:"auth_approved_job_assignment_by_user_names",args:{searchquery:d,page:0,perpage:100,termaggregation:"AND"}}];g=b.call(h),a.when.apply(a.when,g).done(function(a){e(a)}).fail(f)}}});
define('message_popup/message_popover_controller', ["jquery","core/ajax","core/templates","core/str","core/notification","core/custom_interaction_events","core/popover_region_controller","core_message/message_repository","core/url"],function(a,b,c,d,e,f,g,h,i){var j={MARK_ALL_READ_BUTTON:'[data-action="mark-all-read"]',CONTENT:'[data-region="messages"]',CONTENT_ITEM_CONTAINER:'[data-region="message-content-item-container"]',EMPTY_MESSAGE:'[data-region="empty-message"]',COUNT_CONTAINER:'[data-region="count-container"]'},k=function(a){g.call(this,a),this.markAllReadButton=this.root.find(j.MARK_ALL_READ_BUTTON),this.content=this.root.find(j.CONTENT),this.userId=this.root.attr("data-userid"),this.limit=20,this.offset=0,this.loadedAll=!1,this.initialLoad=!1,this.unreadCount=this.root.find(j.COUNT_CONTAINER).html()};return k.prototype=Object.create(g.prototype),k.prototype.constructor=k,k.prototype.getContent=function(){return this.content},k.prototype.incrementOffset=function(){this.offset+=this.limit},k.prototype.updateButtonAriaLabel=function(){this.isMenuOpen()?d.get_string("hidemessagewindow","message").done(function(a){this.menuToggle.attr("aria-label",a)}.bind(this)):this.unreadCount?d.get_string("showmessagewindowwithcount","message",this.unreadCount).done(function(a){this.menuToggle.attr("aria-label",a)}.bind(this)):d.get_string("showmessagewindownonew","message").done(function(a){this.menuToggle.attr("aria-label",a)}.bind(this))},k.prototype.renderUnreadCount=function(){var a=this.root.find(j.COUNT_CONTAINER);this.unreadCount&&this.unreadCount>0?(a.text(this.unreadCount),a.removeClass("hidden")):a.addClass("hidden")},k.prototype.hideUnreadCount=function(){this.root.find(j.COUNT_CONTAINER).addClass("hidden")},k.prototype.renderMessages=function(b,e){var f=[],g=[],h=[];return b.length&&a.each(b,function(a,b){var e="";b.contexturl=i.relativeUrl("/message/index.php",{user:this.userId,id:b.userid}),b.profileurl=i.relativeUrl("/user/profile.php",{id:b.userid}),e=b.isread?"viewmessageswith":"viewunreadmessageswith";var j=d.get_string(e,"message",b.fullname).then(function(a){return b.aria_viewmessageswith=a,c.render("message_popup/message_content_item",b)});f.push(j),j.then(function(b,c){g[a]=b,h[a]=c})}.bind(this)),a.when.apply(a.when,f).then(function(){b.length&&a.each(b,function(a){e.append(g[a]),c.runTemplateJS(h[a])})})},k.prototype.loadMoreMessages=function(){if(this.isLoading||this.loadedAll)return a.Deferred().resolve();this.startLoading();var b={userid:this.userId,limit:this.limit,offset:this.offset},c=this.getContent();return h.query(b).then(function(a){var b=a.contacts;return this.loadedAll=!b.length||b.length<this.limit,this.initialLoad=!0,this.updateButtonAriaLabel(),!!b.length&&(this.incrementOffset(),this.renderMessages(b,c))}.bind(this)).always(function(){this.stopLoading()}.bind(this))},k.prototype.markAllAsRead=function(){return this.markAllReadButton.hasClass("loading")?a.Deferred().resolve():(this.markAllReadButton.addClass("loading"),h.markAllAsRead({useridto:this.userId}).then(function(){this.unreadCount=0,this.hideUnreadCount(),this.getContent().find(j.CONTENT_ITEM_CONTAINER).removeClass("unread")}.bind(this)).always(function(){this.markAllReadButton.removeClass("loading")}.bind(this)))},k.prototype.registerEventListeners=function(){f.define(this.root,[f.events.keyboardActivate]),this.root.on(this.events().menuOpened,function(){this.hideUnreadCount(),this.updateButtonAriaLabel(),this.initialLoad||this.loadMoreMessages()}.bind(this)),this.root.on(this.events().menuClosed,function(){this.renderUnreadCount(),this.updateButtonAriaLabel()}.bind(this)),this.root.on(f.events.scrollBottom,function(){this.loadMoreMessages()}.bind(this)),this.root.on(f.events.activate,j.MARK_ALL_READ_BUTTON,function(a,b){this.markAllAsRead(),a.stopPropagation(),b.originalEvent.preventDefault()}.bind(this)),f.define(this.getContentContainer(),[f.events.scrollLock]),a(document).on("messagearea:conversationselected",function(){this.unreadCount--,this.renderUnreadCount()}.bind(this))},k});
define('message_popup/notification_area_content_area', ["jquery","core/templates","core/notification","core/custom_interaction_events","message_popup/notification_repository","message_popup/notification_area_events","core/str"],function(a,b,c,d,e,f,g){var h={CONTAINER:'[data-region="notification-area"]',CONTENT:'[data-region="content"]',HEADER:'[data-region="header"]',FOOTER:'[data-region="footer"]',TOGGLE_MODE:'[data-action="toggle-mode"]'},i={HEADER:"message_popup/notification_area_content_area_header",CONTENT:"message_popup/notification_area_content_area_content",FOOTER:"message_popup/notification_area_content_area_footer"},j=function(b,c){this.root=a(b),this.container=this.root.closest(h.CONTAINER),this.userId=c,this.header=this.root.find(h.HEADER),this.content=this.root.find(h.CONTENT),this.footer=this.root.find(h.FOOTER),this.registerEventListeners()};return j.prototype.getRoot=function(){return this.root},j.prototype.getContainer=function(){return this.container},j.prototype.getUserId=function(){return this.userId},j.prototype.getHeader=function(){return this.header},j.prototype.getContent=function(){return this.content},j.prototype.getFooter=function(){return this.footer},j.prototype.show=function(){this.getContainer().addClass("show-content-area")},j.prototype.hide=function(){this.getContainer().removeClass("show-content-area")},j.prototype.setHeaderHTML=function(a){this.getHeader().empty().html(a)},j.prototype.setContentHTML=function(a){this.getContent().empty().html(a)},j.prototype.setFooterHTML=function(a){this.getFooter().empty().html(a)},j.prototype.showNotification=function(c){var d=a.Deferred();return c.contexturlname?d=g.get_string("viewnotificationresource","message",c.contexturlname):d.resolve(""),d.then(function(d){""!==d&&(c.str_viewnotificationresource=d);var e=b.render(i.HEADER,c).done(function(a){this.setHeaderHTML(a)}.bind(this)),g=b.render(i.CONTENT,c).done(function(a){this.setContentHTML(a)}.bind(this)),h=b.render(i.FOOTER,c).done(function(a){this.setFooterHTML(a)}.bind(this));return a.when(e,g,h).done(function(){this.show(),this.getContainer().trigger(f.notificationShown,[c])}.bind(this))}.bind(this))},j.prototype.registerEventListeners=function(){d.define(this.getRoot(),[d.events.activate]),this.getRoot().on(d.events.activate,h.VIEW_TOGGLE,function(){this.hide()}.bind(this)),this.getContainer().on(f.showNotification,function(a,b){this.showNotification(b)}.bind(this))},j});
define('message_popup/notification_area_control_area', ["jquery","core/templates","core/notification","core/custom_interaction_events","message_popup/notification_repository","message_popup/notification_area_events","core/str"],function(a,b,c,d,e,f,g){var h={CONTAINER:'[data-region="notification-area"]',CONTENT:'[data-region="content"]',NOTIFICATION:'[data-region="notification-content-item-container"]',CAN_RECEIVE_FOCUS:'input:not([type="hidden"]), a[href], button, textarea, select, [tabindex]'},i=function(b,c){this.root=a(b),this.container=this.root.closest(h.CONTAINER),this.userId=c,this.content=this.root.find(h.CONTENT),this.offset=0,this.limit=20,this.initialLoad=!1,this.isLoading=!1,this.loadedAll=!1,this.notifications={},this.registerEventListeners()};return i.prototype.getRoot=function(){return this.root},i.prototype.getContainer=function(){return this.container},i.prototype.getUserId=function(){return this.userId},i.prototype.getContent=function(){return this.content},i.prototype.getOffset=function(){return this.offset},i.prototype.getLimit=function(){return this.limit},i.prototype.setOffset=function(a){this.offset=a},i.prototype.setLimit=function(a){this.limit=a},i.prototype.incrementOffset=function(){this.offset+=this.limit},i.prototype.startLoading=function(){this.isLoading=!0,this.getRoot().addClass("loading")},i.prototype.stopLoading=function(){this.isLoading=!1,this.getRoot().removeClass("loading")},i.prototype.hasDoneInitialLoad=function(){return this.initialLoad},i.prototype.hasLoadedAllContent=function(){return this.loadedAll},i.prototype.setLoadedAllContent=function(a){this.loadedAll=a},i.prototype.setCacheNotification=function(a){this.notifications[a.id]=a},i.prototype.getCacheNotification=function(a){return this.notifications[a]},i.prototype.getNotificationElement=function(a){var b=this.getRoot().find(h.NOTIFICATION+'[data-id="'+a+'"]');return 1==b.length?b:null},i.prototype.scrollNotificationIntoView=function(a){var b=a.position(),c=this.getRoot(),d=b.top-c.scrollTop();if(d>c.innerHeight()){var e=a.outerHeight();e=4*e;var f=b.top-e;c.scrollTop(f)}},i.prototype.showNotification=function(b){if("object"!=typeof b&&(b=this.getNotificationElement(b)),b&&b.length){this.getRoot().find(h.NOTIFICATION).removeClass("selected"),b.addClass("selected").find(h.CAN_RECEIVE_FOCUS).focus();var c=b.attr("data-id"),d=this.getCacheNotification(c);this.scrollNotificationIntoView(b),this.getContainer().trigger(f.showNotification,[a.extend({},d)])}},i.prototype.markNotificationAsRead=function(a){return e.markAsRead(a.attr("data-id")).done(function(){a.removeClass("unread")})},i.prototype.renderNotifications=function(d){var e=[],f=[],h=[],i=this.getContent();return d.length&&a.each(d,function(d,i){var j=i.contexturl,k=a.Deferred();delete i.contexturl,i.read?k.resolve(i.subject):k=g.get_string("unreadnotification","message",i.subject);var l=k.then(function(a){return i.aria_viewnotification=a,b.render("message_popup/notification_content_item",i)});e.push(l),l.then(function(a,b){f[d]=a,h[d]=b,i.contexturl=j,this.setCacheNotification(i)}.bind(this)).fail(c.exception)}.bind(this)),a.when.apply(a.when,e).then(function(){d.length&&a.each(d,function(a){i.append(f[a]),b.runTemplateJS(h[a])})})},i.prototype.loadMoreNotifications=function(){if(this.isLoading||this.hasLoadedAllContent())return a.Deferred().resolve();this.startLoading();var b={limit:this.getLimit(),offset:this.getOffset(),useridto:this.getUserId()};this.initialLoad||(b.limit=this.getOffset()+this.getLimit(),b.offset=0);var c=e.query(b).then(function(a){var b=a.notifications;return this.unreadCount=a.unreadcount,this.setLoadedAllContent(!b.length||b.length<this.getLimit()),this.initialLoad=!0,!!b.length&&(this.incrementOffset(),this.renderNotifications(b))}.bind(this)).always(function(){this.stopLoading()}.bind(this));return c},i.prototype.registerEventListeners=function(){d.define(this.getRoot(),[d.events.activate,d.events.scrollBottom,d.events.scrollLock,d.events.up,d.events.down]),this.getRoot().on(d.events.scrollBottom,function(){this.loadMoreNotifications()}.bind(this)),this.getRoot().on(d.events.activate,h.NOTIFICATION,function(b){var c=a(b.target).closest(h.NOTIFICATION);this.showNotification(c)}.bind(this)),this.getRoot().on(d.events.up,h.NOTIFICATION,function(b,c){var d=a(b.target).closest(h.NOTIFICATION);this.showNotification(d.prev()),c.originalEvent.preventDefault()}.bind(this)),this.getRoot().on(d.events.down,h.NOTIFICATION,function(b,c){var d=a(b.target).closest(h.NOTIFICATION);this.showNotification(d.next()),c.originalEvent.preventDefault()}.bind(this)),this.getContainer().on(f.notificationShown,function(a,b){if(!b.read){var c=this.getNotificationElement(b.id);c&&this.markNotificationAsRead(c);var d=this.getCacheNotification(b.id);d&&(d.read=!0)}}.bind(this))},i});
define('message_popup/notification_area_events', [],function(){return{showNotification:"notification-area-events:showNotification",notificationShown:"notification-area-events:notificationShown"}});
define('message_popup/notification_popover_controller', ["jquery","core/ajax","core/templates","core/str","core/url","core/notification","core/custom_interaction_events","core/popover_region_controller","message_popup/notification_repository","message_popup/notification_area_events"],function(a,b,c,d,e,f,g,h,i,j){var k={MARK_ALL_READ_BUTTON:'[data-action="mark-all-read"]',ALL_NOTIFICATIONS_CONTAINER:'[data-region="all-notifications"]',NOTIFICATION:'[data-region="notification-content-item-container"]',UNREAD_NOTIFICATION:'[data-region="notification-content-item-container"].unread',NOTIFICATION_LINK:'[data-action="content-item-link"]',EMPTY_MESSAGE:'[data-region="empty-message"]',COUNT_CONTAINER:'[data-region="count-container"]'},l=function(a){h.call(this,a),this.markAllReadButton=this.root.find(k.MARK_ALL_READ_BUTTON),this.unreadCount=0,this.userId=this.root.attr("data-userid"),this.container=this.root.find(k.ALL_NOTIFICATIONS_CONTAINER),this.limit=20,this.offset=0,this.loadedAll=!1,this.initialLoad=!1,this.unreadCount=this.root.find(k.COUNT_CONTAINER).html()};return l.prototype=Object.create(h.prototype),l.prototype.constructor=l,l.prototype.updateButtonAriaLabel=function(){this.isMenuOpen()?d.get_string("hidenotificationwindow","message").done(function(a){this.menuToggle.attr("aria-label",a)}.bind(this)):this.unreadCount?d.get_string("shownotificationwindowwithcount","message",this.unreadCount).done(function(a){this.menuToggle.attr("aria-label",a)}.bind(this)):d.get_string("shownotificationwindownonew","message").done(function(a){this.menuToggle.attr("aria-label",a)}.bind(this))},l.prototype.getContent=function(){return this.container},l.prototype.getOffset=function(){return this.offset},l.prototype.incrementOffset=function(){this.offset+=this.limit},l.prototype.hasDoneInitialLoad=function(){return this.initialLoad},l.prototype.hasLoadedAllContent=function(){return this.loadedAll},l.prototype.setLoadedAllContent=function(a){this.loadedAll=a},l.prototype.renderUnreadCount=function(){var a=this.root.find(k.COUNT_CONTAINER);this.unreadCount&&this.unreadCount>0?(a.text(this.unreadCount),a.removeClass("hidden")):a.addClass("hidden")},l.prototype.hideUnreadCount=function(){this.root.find(k.COUNT_CONTAINER).addClass("hidden")},l.prototype.getNotificationElement=function(a){var b=this.root.find(k.NOTIFICATION+'[data-id="'+a+'"]');return 1==b.length?b:null},l.prototype.renderNotifications=function(b,g){var h=[],i=[],j=[];return b.length&&a.each(b,function(b,g){var k=this.getOffset()-this.limit,l=a.Deferred();g.viewmoreurl=e.relativeUrl("/message/output/popup/notifications.php",{notificationid:g.id,offset:k}),g.isread?l.resolve(g.subject):l=d.get_string("unreadnotification","message",g.subject);var m=l.then(function(a){return g.aria_viewnotification=a,c.render("message_popup/notification_content_item",g)});h.push(m),m.then(function(a,c){i[b]=a,j[b]=c}).fail(f.exception)}.bind(this)),a.when.apply(a.when,h).then(function(){b.length&&a.each(b,function(a){g.append(i[a]),c.runTemplateJS(j[a])})})},l.prototype.loadMoreNotifications=function(){if(this.isLoading||this.hasLoadedAllContent())return a.Deferred().resolve();this.startLoading();var b={limit:this.limit,offset:this.getOffset(),useridto:this.userId},c=this.getContent();return i.query(b).then(function(a){var b=a.notifications;return this.unreadCount=a.unreadcount,this.setLoadedAllContent(!b.length||b.length<this.limit),this.initialLoad=!0,this.updateButtonAriaLabel(),!!b.length&&(this.incrementOffset(),this.renderNotifications(b,c))}.bind(this)).always(function(){this.stopLoading()}.bind(this))},l.prototype.markAllAsRead=function(){return this.markAllReadButton.addClass("loading"),i.markAllAsRead({useridto:this.userId}).then(function(){this.unreadCount=0,this.root.find(k.UNREAD_NOTIFICATION).removeClass("unread")}.bind(this)).always(function(){this.markAllReadButton.removeClass("loading")}.bind(this))},l.prototype.markNotificationAsRead=function(a){return!!a.hasClass("unread")&&i.markAsRead(a.attr("data-id")).then(function(){this.unreadCount--,a.removeClass("unread")}.bind(this))},l.prototype.registerEventListeners=function(){g.define(this.root,[g.events.activate]),this.root.on(g.events.activate,k.MARK_ALL_READ_BUTTON,function(a,b){this.markAllAsRead(),a.stopPropagation(),b.originalEvent.preventDefault()}.bind(this)),this.root.on(g.events.activate,k.NOTIFICATION_LINK,function(b){var c=a(b.target).closest(k.NOTIFICATION);this.markNotificationAsRead(c),b.stopPropagation()}.bind(this)),this.root.on(this.events().menuOpened,function(){this.hideUnreadCount(),this.updateButtonAriaLabel(),this.hasDoneInitialLoad()||this.loadMoreNotifications()}.bind(this)),this.root.on(this.events().menuClosed,function(){this.renderUnreadCount(),this.updateButtonAriaLabel()}.bind(this)),this.root.on(this.events().startLoading,function(){this.getContent().attr("aria-busy","true")}.bind(this)),this.root.on(this.events().stopLoading,function(){this.getContent().attr("aria-busy","false")}.bind(this)),this.getContentContainer().on(g.events.scrollBottom,function(){this.isLoading||this.hasLoadedAllContent()||this.loadMoreNotifications()}.bind(this)),g.define(this.getContentContainer(),[g.events.scrollLock]),a(document).on(j.notificationShown,function(a,b){if(!b.read){var c=this.getNotificationElement(b.id);c&&c.removeClass("unread"),this.unreadCount--,this.renderUnreadCount()}}.bind(this))},l});
define('message_popup/notification_repository', ["core/ajax","core/notification"],function(a,b){var c=function(c){"undefined"==typeof c.limit&&(c.limit=20),"undefined"==typeof c.offset&&(c.offset=0);var d={methodname:"message_popup_get_popup_notifications",args:c},e=a.call([d])[0];return e.fail(b.exception),e},d=function(c){var d={methodname:"message_popup_get_unread_popup_notification_count",args:c},e=a.call([d])[0];return e.fail(b.exception),e},e=function(c){var d={methodname:"core_message_mark_all_notifications_as_read",args:c},e=a.call([d])[0];return e.fail(b.exception),e},f=function(c,d){var e={notificationid:c};d&&(e.timeread=d);var f={methodname:"core_message_mark_notification_read",args:e},g=a.call([f])[0];return g.fail(b.exception),g};return{query:c,countUnread:d,markAllAsRead:e,markAsRead:f}});
define('block_admin_subnav/subnavblock', ["core/yui","core/tree"],function(a,b){return{init:function(c){var d=new b(".block_admin_subnav .block_tree");d.finishExpandingGroup=function(d){b.prototype.finishExpandingGroup.call(this,d),a.use("moodle-core-event",function(){a.Global.fire(M.core.globalEvents.BLOCK_CONTENT_UPDATED,{instanceid:c})})},d.collapseGroup=function(d){b.prototype.collapseGroup.call(this,d),a.use("moodle-core-event",function(){a.Global.fire(M.core.globalEvents.BLOCK_CONTENT_UPDATED,{instanceid:c})})}}}});
define('block_carousel/cohort', ["jquery","core/templates","core/modal_factory","block_carousel/modal_cohort","block_carousel/select2"],function(a,b,c,d,e){return{blockid:null,init:function(b){var c=this;c.blockid=b,c.init_modal(),a(document).on("click","#btn-cohort-config-trigger",function(){c.add_cohort_search_fields()}),a(document).on("click","#save-cohort",function(){c.save_cohort()})},init_modal:function(){var b=a("#btn-cohort-config-trigger");c.create({type:d.TYPE},b).done(function(a){var b=a.getRoot();b.addClass("carousel-cohort-modal")})},add_cohort_search_fields:function(){var b=this;a.ajax({method:"POST",url:M.cfg.wwwroot+"/blocks/carousel/ajax/cohort_filters.php",dataType:"JSON",data:{blockid:b.blockid}}).done(function(b){a("#cohort-filters").html(b.html),e.init()})},save_cohort:function(){var b=a("#save-cohort").html();a("#save-cohort").html("Saving..."),a.ajax({method:"POST",url:M.cfg.wwwroot+"/blocks/carousel/ajax/save_cohort.php",dataType:"JSON",data:a(".cohort-configuration-from").serialize()}).done(function(){a("#save-cohort").html("Saved"),setTimeout(function(){a("#save-cohort").html(b)},3e3)})}}});
define('block_carousel/colorthief', ["jquery",M.cfg.wwwroot+"/blocks/carousel/js/colorthief/color-thief.umd.js"],function(a,b){return{init:function(){return new b},rgbCode:function(a,b){return"rgb("+a[0]+","+a[1]+","+a[2]+","+b+")"}}});
define('block_carousel/courselet', ["jquery","core/modal_factory"],function(a,b){return{init:function(){var c=this;a("button.carousel-launch-course").on("click",function(d){var e=a(d.currentTarget),f=e.data("courseid");b.create({body:'<i class="fa fa-spinner fa-spin"></i>'}).then(function(a){var b=a.getRoot();a.show(),b.addClass("courselet-modal"),c.get_courselet(f,b)})})},get_courselet:function(b,c){a.ajax({method:"POST",url:M.cfg.wwwroot+"/blocks/carousel/ajax/process_courselet.php",dataType:"JSON",data:{courseid:b}}).done(function(a){c.find(".modal-body").html(a.html)})}}});
define('block_carousel/curated', ["jquery","core/templates","core/modal_factory","block_carousel/modal_curated","block_carousel/select2","block_carousel/slick","block_carousel/colorthief"],function(a,b,c,d,e,f,g){function h(){var b={blockinstanceid:null,carouseltype:null,curatedid:0,edit_cog:null,"delete":null,loadingcarousel:!1,spinner:'<i class="fa fa-spinner fa-spin spinner"></i>',init:function(c){b.blockinstanceid=c,b.init_modal(),a(document).on("click","#btn-curated-config-trigger",function(){b.carouseltype=a("#id_config_carouseltype").val(),b.curatedid=a("#curated-configuration-from").find("#curatedid").val(),b.add_search_fields()}),a(document).on("change","select.select2",function(){b.preview_cluster()}),a(document).on("click","#save-cluster",function(){b.save_cluster()}),a(document).on("click",".edit-cluster",function(){b.edit_cog=a(this),b.edit_cog.addClass("fa-spin"),b.curatedid=a(this).data("curatedid"),b.add_search_fields()}),a(document).on("click","#add-new-cluster",function(){b.curatedid=0,a("#curated-configuration-from").find("#curatedid").val(0),b.add_search_fields()}),a(document).on("click",".delete-cluster",function(){b["delete"]=a(this),b.delete_cluster()})},init_cluster:function(c){b.blockinstanceid=c,a(document).on("click","#carousel-nested-"+b.blockinstanceid+" .toggle-card-details",function(){if(a(this).hasClass("hasContent"))return a("#carousel-nested-clusters-"+b.blockinstanceid).html(""),a("#carousel-nested-"+b.blockinstanceid+" .main-cluster").removeClass("showing-nested"),a(this).removeClass("hasContent"),!1;if(!b.loadingcarousel){a("#carousel-nested-"+b.blockinstanceid+" .toggle-card-details").removeClass("hasContent"),b.loadingcarousel=!0;var c=a(this).data("courseids"),d=a(this).data("cardcount");b.get_cluster_carousel(c,d,a(this)),a("#carousel-nested-"+b.blockinstanceid+" .main-cluster").addClass("showing-nested")}})},get_cluster_carousel:function(c,d,e){a("#carousel-nested-clusters-"+b.blockinstanceid).addClass("loading").html(b.spinner),a.ajax({method:"POST",url:M.cfg.wwwroot+"/blocks/carousel/ajax/get_cluster_carousel.php",dataType:"HTML",data:{blockinstanceid:b.blockinstanceid,courseids:c,cardcount:d}}).done(function(c){a("#carousel-nested-clusters-"+b.blockinstanceid).removeClass("loading").html(c),e.addClass("hasContent"),b.initslick(d),b.loadingcarousel=!1})},initslick:function(c){var d={asNavFor:"#carousel-nav-"+b.blockinstanceid,slidesToShow:c,slidesToScroll:1,centerMode:!1,focusOnSelect:!0,responsive:[{breakpoint:1200,settings:{slidesToShow:3,slidesToScroll:1}},{breakpoint:768,settings:{slidesToShow:2,slidesToScroll:1}},{breakpoint:600,settings:{slidesToShow:1,slidesToScroll:1}}]},e={slidesToShow:1,slidesToScroll:1,arrows:!1,fade:!0,draggable:!1,accessibility:!1},h=f.init("#carousel-nav-"+b.blockinstanceid,e);f.init("#carousel-"+b.blockinstanceid,d);h.hide(),a("#carousel-"+b.blockinstanceid+" article.learning .toggle-card-details").click(function(){h.show(),a("#carousel-"+b.blockinstanceid).addClass("showing-details"),a(window).trigger("resize");var c=a("#carousel-nav-"+b.blockinstanceid+" .slick-track").css("width");"0px"==c&&(a("#carousel-nav-"+b.blockinstanceid+" .slick-track").css("width","100%"),a("#carousel-nav-"+b.blockinstanceid+" .slick-track .slick-slide.slick-active").css("width","100%"))}),a("#carousel-"+b.blockinstanceid+" article.learning figure.tile").click(function(b){return a(this).data("displayinmodal")?void a(this).siblings(".toggle-card-details").trigger("click"):(b.stopPropagation(),window.location.href=a(this).data("url"),!1)}),a("#carousel-nav-"+b.blockinstanceid+" .close-slide-details").click(function(){h.hide("fast"),a("#carousel-"+b.blockinstanceid).removeClass("showing-details"),a(window).trigger("resize")}),a("#carousel-nav-"+b.blockinstanceid+" article").each(function(){const b=a(this),c=a(this).find("img.hidden:first").attr("src"),d=new Image;d.onload=function(){const e=g.init(),f=e.getColor(d);var h=f[0],i=f[1],j=f[2];const k=Math.sqrt(.299*h*h+.587*i*i+.114*j*j)/255;b.addClass(k>.6?"dark-text":"light-text");const l=g.rgbCode(f,1);a(this).css("background-image","linear-gradient(to right,"+l+" 0% 15%, "+l+" 15% 58%, transparent 70% 100%), url("+c+")")}.bind(this),d.src=c}),a("#carousel-nav-"+b.blockinstanceid+" article.learning-details .launch-courselet").click(function(){a.ajax({method:"POST",url:"/blocks/carousel/ajax/process_courselet.php",dataType:"JSON",data:{courseid:a(this).data("courseid"),nodisplay:1}}).done(function(){})})},init_modal:function(){var b=a("#btn-curated-config-trigger");c.create({type:d.TYPE},b).done(function(a){var b=a.getRoot();b.addClass("carousel-curated-modal")})},add_search_fields:function(){a.ajax({method:"POST",url:M.cfg.wwwroot+"/blocks/carousel/ajax/curated_filters.php",dataType:"JSON",data:{blockinstanceid:b.blockinstanceid,carouseltype:b.carouseltype,curatedid:b.curatedid}}).done(function(c){a("#curated-filters").html(c.html),e.init(),"cluster"==b.carouseltype&&a("#add-new-cluster").removeClass("hide"),b.preview_cluster()})},preview_cluster:function(){a.ajax({method:"POST",url:M.cfg.wwwroot+"/blocks/carousel/ajax/preview_cluster.php",dataType:"JSON",data:a("#curated-configuration-from").serialize()+"&carouseltype="+b.carouseltype+"&blockinstanceid="+b.blockinstanceid}).done(function(c){a("#curated-contents").html(c.html),b.edit_cog&&b.edit_cog.removeClass("fa-spin")})},save_cluster:function(){var c=a("#save-cluster").html();a("#save-cluster").html("Saving...");var d=a("#curated-configuration-from"),e=new FormData(d[0]);e.append("blockinstanceid",b.blockinstanceid),a.ajax({method:"POST",url:M.cfg.wwwroot+"/blocks/carousel/ajax/save_cluster.php",data:e,enctype:"multipart/form-data",contentType:!1,cache:!1,processData:!1}).done(function(){a("#save-cluster").html("Saved"),setTimeout(function(){a("#save-cluster").html(c)},3e3)})},delete_cluster:function(){var c=b["delete"].data("curatedid");b["delete"].parent().siblings().html("Deleting..."),a.ajax({method:"POST",url:M.cfg.wwwroot+"/blocks/carousel/ajax/delete_cluster.php",dataType:"JSON",data:{blockinstanceid:b.blockinstanceid,curatedid:c}}).done(function(){b.curatedid=0,a("#curated-configuration-from").find("#curatedid").val(0),b.add_search_fields()})}};return b}var i={},j=h();for(var k in j)j[k]instanceof Function&&"init"==k.substr(0,4)&&(i[k]=function(a){return function(){var b=h();b[a].apply(b,arguments)}}(k));return i});
define('block_carousel/ellipsis', ["jquery",M.cfg.wwwroot+"/blocks/carousel/js/ellipsis/jquery.ellipsis.js"],function(a){return{init:function(b){return a(b).ellipsis({lines:2,responsive:!0})}}});
define('block_carousel/modal_cohort', ["jquery","core/notification","core/custom_interaction_events","core/modal","core/modal_registry"],function(a,b,c,d,e){var f=!1,g={SAVE_BUTTON:'[data-action="save"]',CANCEL_BUTTON:'[data-action="cancel"]'},h=function(a){d.call(this,a),this.getFooter().find(g.SAVE_BUTTON).length||b.exception({message:"No save button found"}),this.getFooter().find(g.CANCEL_BUTTON).length||b.exception({message:"No cancel button found"})};return h.TYPE="block_carousel-ModalCohort",h.prototype=Object.create(d.prototype),h.prototype.constructor=h,h.prototype.registerEventListeners=function(){d.prototype.registerEventListeners.call(this),this.getModal().on(c.events.activate,g.CANCEL_BUTTON,function(){this.hide()}.bind(this))},f||(e.register(h.TYPE,h,"block_carousel/__config_modal_cohort"),f=!0),h});
define('block_carousel/modal_curated', ["jquery","core/notification","core/custom_interaction_events","core/modal","core/modal_registry"],function(a,b,c,d,e){var f=!1,g={SAVE_BUTTON:'[data-action="save"]',CANCEL_BUTTON:'[data-action="cancel"]'},h=function(a){d.call(this,a),this.getFooter().find(g.SAVE_BUTTON).length||b.exception({message:"No save button found"}),this.getFooter().find(g.CANCEL_BUTTON).length||b.exception({message:"No cancel button found"})};return h.TYPE="block_carousel-ModalCurated",h.prototype=Object.create(d.prototype),h.prototype.constructor=h,h.prototype.registerEventListeners=function(){d.prototype.registerEventListeners.call(this),this.getModal().on(c.events.activate,g.CANCEL_BUTTON,function(){this.hide()}.bind(this))},f||(e.register(h.TYPE,h,"block_carousel/__config_modal_curated"),f=!0),h});
define('block_carousel/select2', ["jquery",M.cfg.wwwroot+"/blocks/carousel/js/select2/js/select2.js"],function(a){return{init:function(){return a(".select2").select2()}}});
define('block_carousel/slick', ["jquery",M.cfg.wwwroot+"/blocks/carousel/js/slick/slick.js"],function(a){return{init:function(b,c){return a(b).slick(c)}}});
define('block_carousel/social', ["jquery","theme_roots/bootstrap"],function(a){return{init:function(b){var c=this;a('[data-toggle="dropdown"]').dropdown(),a(document).on("click",b+".block_carousel .carousel-like a",function(b){c.ajax_like_unlike(a(this)),b.preventDefault()}),a(document).on("submit",b+".block_carousel .dropdown-menu form",function(c){var d=a(this),e=a(b+".block_carousel"),f=d.parents("ul:first").siblings(".dropdown-toggle");c.preventDefault();var g=d.find(".btn-primary");g.prop("disabled",!0);var h=a('<img src="'+M.util.image_url("i/loading_small")+'" />');g.after(h),f.hasClass("send-message-btn")&&setTimeout(function(){h.remove(),g.prop("disabled",!1),d.find("textarea").val("")},500),a.post(d.prop("action"),d.serialize()+"&ajax=1",function(b){if(b=a.parseJSON(b),f.hasClass("follow-button")){var c=b.follow_id;b.followed?e.find(".followuser-"+c).addClass("event-feed-selected").html('<i class="fa fa-users fa-lg"></i> Unfollow'):e.find(".followuser-"+c).removeClass("event-feed-selected").html('<i class="fa fa-users fa-lg"></i> Follow');var g=d.parent();g.empty().append(b.formcontent);var h=e.find("#followingtab");h.addClass("stalled")}})})},ajax_like_unlike:function(b){a.ajax({url:b.attr("href"),dataType:"json"}).done(function(a){1==a.success&&b.parent(".carousel-like").toggleClass("liked")})}}});
define('block_course_navigation/ajax_response_renderer', ["jquery","core/templates"],function(a,b){function c(e,f){var g=a("<ul></ul>");g.attr("role","group"),g.attr("aria-hidden",!0),a.each(f,function(e,f){if("object"==typeof f){var h=a("<li></li>"),i=a("<p></p>"),j=f.id||f.key+"_tree_item",k=null,l=!(!f.expandable&&!f.haschildren);if(i.addClass("tree_item"),i.attr("id",j),i.attr("role","treeitem"),i.attr("tabindex","-1"),f.requiresajaxloading&&(i.attr("data-requires-ajax",!0),i.attr("data-node-id",f.id),i.attr("data-node-key",f.key),i.attr("data-node-type",f.type)),l&&(h.addClass("collapsed contains_branch"),i.attr("aria-expanded",!1),i.addClass("branch"),b.renderIcon("collapsed").done(function(a){"false"===i.attr("aria-expanded")&&(i.find(".flex-icon").remove(),i.prepend(a))})),f.icon&&(!l||f.type===d.ACTIVITY||f.type===d.RESOURCE)){h.addClass("item_with_icon"),i.addClass("hasicon");var m=f.flex_icon;"string"==typeof m?k=a(m):(k=a("<img/>"),k.attr("alt",f.icon.alt),k.attr("title",f.icon.title),k.attr("src",M.util.image_url(f.icon.pix,f.icon.component)),a.each(f.icon.classes,function(a,b){k.addClass(b)}))}if(f.link){var n=a('<a title="'+f.title+'" href="'+f.link+'"></a>');k?(n.append(k),n.append('<span class="item-content-wrap">'+f.name+"</span>")):n.append(f.name),f.hidden&&n.addClass("dimmed"),i.append(n)}else{var o=a("<span></span>");k?(o.append(k),o.append('<span class="item-content-wrap">'+f.name+"</span>")):o.append(f.name),f.hidden&&o.addClass("dimmed"),i.append(o)}h.append(i),g.append(h),f.children&&f.children.length?c(i,f.children):l&&!f.requiresajaxloading&&(h.removeClass("contains_branch"),i.addClass("emptybranch"),b.renderIcon("collapsed-empty").done(function(a){"true"===i.attr("aria-expanded")&&(i.find(".flex-icon").remove(),i.prepend(a))}))}}),e.parent().append(g);var h=e.attr("id")+"_group";g.attr("id",h),e.attr("aria-owns",h),e.attr("role","treeitem")}var d={ACTIVITY:40,RESOURCE:50};return{render:function(a,d){if(d.children&&d.children.length){c(a,d.children);var e=a.children("[role='treeitem']").first(),f=a.find("#"+e.attr("aria-owns"));e.attr("aria-expanded",!0),f.attr("aria-hidden",!1)}else a.parent().hasClass("contains_branch")&&(a.parent().removeClass("contains_branch"),b.renderIcon("collapsed-empty").done(function(b){"true"===a.attr("aria-expanded")&&(a.find(".flex-icon").remove(),a.prepend(b))}))}}});
define('block_course_navigation/navblock', ["core/yui","core/tree"],function(a,b){return{init:function(c){var d=new b(".block_course_navigation .block_tree");d.finishExpandingGroup=function(d){b.prototype.finishExpandingGroup.call(this,d),a.use("moodle-core-event",function(){a.Global.fire(M.core.globalEvents.BLOCK_CONTENT_UPDATED,{instanceid:c})})},d.collapseGroup=function(d){b.prototype.collapseGroup.call(this,d),a.use("moodle-core-event",function(){a.Global.fire(M.core.globalEvents.BLOCK_CONTENT_UPDATED,{instanceid:c})})}}}});
define('block_course_navigation/nav_loader', ["jquery","core/ajax","core/config","block_course_navigation/ajax_response_renderer"],function(a,b,c,d){function e(a){return a.closest("[data-block]").attr("data-instanceid")}function f(a){return a.closest("[data-block]").attr("data-block")}var g=c.wwwroot+"/lib/ajax/getnavbranch.php";return{load:function(b){b=a(b);var h=a.Deferred(),i={elementid:b.attr("data-node-id"),id:b.attr("data-node-key"),type:b.attr("data-node-type"),sesskey:c.sesskey,instance:e(b),blocktype:f(b)},j={type:"POST",dataType:"json",data:i};return a.ajax(g,j).done(function(a){d.render(b,a),h.resolve()}),h}}});
define('block_current_learning/current_learning', ["jquery","core/templates","core/notification","core/str","core/log"],function(a,b,c,d,e){var f,g=null,h=10,i=function(b,c){var e=parseInt(a(f+" .pagination li.active a").attr("data-page")),g=null;g="next"==c?e+1:"prev"==c?e-1:c;var i=b.learningitems.length,j=Math.ceil(i/h),k={},l=(g-1)*h+1;k.learningitems=b.learningitems.slice(l-1,l-1+h);var m=b.pagination;g>1?m.previousclass="":m.previousclass="disabled",g>=j?m.nextclass="disabled":m.nextclass="",m.pages.forEach(function(a){a.page==g?a.active="active":a.active=""});var n={},o=a.Deferred();n.start=(g-1)*h+1;var p=null;return p=b.pagination.totalitems<g*h?b.pagination.totalitems:g*h,n.end=p,n.total=b.pagination.totalitems,d.get_string("displayingxofx","block_current_learning",n).done(function(a){m.text=a,k.pagination=m,k.haslearningitems=!0,o.resolve(k)}).fail(function(a){o.reject(a)}),o.promise()},j=function(){a(f+" .pagination").on("click","a",function(d){d.preventDefault();var e=a(this),h=e.parent();if(h.hasClass("disabled"))return!1;var k=e.attr("data-page");i(g,k).done(function(d){b.render("block_current_learning/main_content",d).done(function(c,d){a(f+" .current-learning-content").replaceWith(c).trigger("block_current_learning:content_updated"),b.runTemplateJS(d)}).fail(function(a){c.exception(a)}),b.render("block_current_learning/paging",d).done(function(b){a(f+" .panel-footer").replaceWith(b),j()}).fail(function(a){c.exception(a)})})})},k=function(){var b=f+' [data-toggle="tooltip"]';a(b).tooltip(),a(f+" .current-learning-content").on("block_current_learning:content_updated",function(c){a(b).tooltip()})},l=function(b){if(b.pagination.pages.length>1){var c=a(f+" .current-learning-content");c.css("min-height",c.outerHeight())}},m=function(c){f="#inst"+c.instanceid.toString(),c.pagination&&c.pagination.itemsperpage&&(h=c.pagination.itemsperpage);var i=!0;a.fn.collapse&&a.fn.tooltip||(e.debug("Current learning block requires Bootstrap 3 JavaScript, please include it or find your own solution."),i=!1),g=c;var m=["block_current_learning/main_content","block_current_learning/course_row","block_current_learning/program_row"];if(m.forEach(function(a){b.render(a,{})}),c.pagination){var n={pagination:{onepage:!1,previousclass:"disabled",nextclass:""}};b.render("block_current_learning/paging",n),d.get_string("displayingxofx","block_current_learning",{start:1,end:2,total:2}),j(),l(c)}i&&k()};return{init:m}});
define('block_current_learning/current_learning_tiles', ["core/templates","core/str","core/yui"],function(templates,mdlstr,YUI){function init(a){0!==a.learningitems.length&&(reloadNodes(document.getElementById("inst"+a.instanceid)),pagination=a.pagination,pagination.pagination=!0,totalPages=Math.ceil(pagination.totalitems/pagination.itemsperpage),learningItems=a.learningitems,blockinstanceid=a.instanceid,addEvents(),checkResize())}function reloadNodes(a){blockNode=a,pagesNode=blockNode.querySelector(".panel-footer"),tilesNode=blockNode.querySelector(".block_current_learning-tiles ul")}function addEvents(){if(blockNode.addEventListener("click",changePage),window.addEventListener("resize",checkResize),addDockListeners(),document.body.classList.contains("editing")){var a=function(a){a.filter(function(a){return"childList"===a.type&&a.target.hasAttribute("data-blockregion")}).forEach(function(a){a.addedNodes.forEach(function(a){a.id=="inst"+blockinstanceid&&checkResize()})})},b=new MutationObserver(a);b.observe(document.body,{attributes:!1,childList:!0,subtree:!0})}}function addDockListeners(){YUI.use("moodle-core-dock",function(){var a=M.core.dock.get();a.on("dock:resizepanelcomplete",function(){var a=document.querySelector("#dock .block_current_learning");a&&(reloadNodes(a),checkResize(),blockNode.addEventListener("click",changePage))}),a.on("dock:itemremoved",function(){var a=document.getElementById("inst"+blockinstanceid);a&&(reloadNodes(a),checkResize())})})}function checkResize(){resizePending||(resizePending=!0,setTimeout(doResize,50))}function doResize(){resizePending=!1;var a,b=parseInt(getComputedStyle(tilesNode.parentElement).width,10),c=Math.floor(b/214)||1;return a=c<2?3:c<5?2:1,c==tilesNode.getAttribute("data-items-per-row")&&"false"==tilesNode.parentElement.getAttribute("data-loading")?void updateMargin():(tilesNode.parentElement.setAttribute("data-loading",!0),pagination.itemsperpage=c*a,void render(c).then(updateMargin))}function updateMargin(){if(1==tilesNode.getAttribute("data-items-per-row")){var a=tilesNode.querySelector(".block_current_learning-tile"),b=getComputedStyle(a);if(b.maxWidth===b.width){var c=getComputedStyle(tilesNode).width,d=(parseInt(c,10)-parseInt(b.width,10))/2;tilesNode.querySelectorAll(".block_current_learning-tile").forEach(function(a){a.style.marginLeft=d+"px",a.style.marginRight=d+"px"})}else tilesNode.querySelectorAll(".block_current_learning-tile").forEach(function(a){a.style.marginLeft="",a.style.marginRight=""})}}function changePage(a){var b=a.target.closest("a");if(b&&b.hasAttribute("data-page")&&(a.preventDefault(),!b.parentElement.classList.contains("disabled"))){var c=b.getAttribute("data-page");"next"===c?pagination.currentpage+=1:"prev"===c?pagination.currentpage-=1:pagination.currentpage=parseInt(c),render().then(updateMargin)}}function render(tilesPerRow){tilesPerRow||(tilesPerRow=tilesNode.getAttribute("data-items-per-row")),totalPages=Math.ceil(pagination.totalitems/pagination.itemsperpage),pagination.onepage=1==totalPages,pagination.currentpage>totalPages&&(pagination.currentpage=totalPages),pagination.previousclass=1===pagination.currentpage?"disabled":"",pagination.nextclass=pagination.currentpage===totalPages?"disabled":"";var start=(pagination.currentpage-1)*pagination.itemsperpage,end=Math.min(pagination.currentpage*pagination.itemsperpage,pagination.totalitems),tileData=learningItems.slice(start,end),strData={end:end,start:start+1,total:learningItems.length};pagination.pages=[];for(var page=0;page<totalPages;page++)pagination.pages.push({page:page+1,active:page+1==pagination.currentpage?"active":""});M.util.js_pending("block_current_learning-updated");var pagingComplete=mdlstr.get_string("displayingxofx","block_current_learning",strData).then(function(a){return pagination.text=a,templates.render("block_current_learning/paging",pagination)}).then(function(a,b){return{html:a,js:b}}),tiles=tileData.map(function(a){return templates.render("block_current_learning/tile",a).then(function(a,b){return Promise.resolve({html:a,js:b})})}),tilesUpdated=Promise.all(tiles).then(function(a){var b="",c="";return a.forEach(function(a){b+=a.html,c+=a.js+";"}),Promise.resolve({html:b,js:c})});return Promise.all([pagingComplete,tilesUpdated]).then(function(pagingHTML){return blockNode.querySelector(".panel-footer").outerHTML=pagingHTML[0].html,tilesNode.innerHTML=pagingHTML[1].html,tilesNode.querySelectorAll("script").forEach(function(script){eval(script.innerHTML)}),tilesPerRow=tilesNode.setAttribute("data-items-per-row",tilesPerRow),tilesNode.parentElement.setAttribute("data-loading",!1),templates.runTemplateJS(pagingHTML[0].js+";"+pagingHTML[1].js)}).then(function(){M.util.js_complete("block_current_learning-updated")})}var blockNode,tilesNode,pagesNode,pagination,learningItems,totalPages,resizePending=!1,blockinstanceid;return{init:init}});
define('block_navigation/ajax_response_renderer', ["jquery"],function(a){function b(d,e){var f=a("<ul></ul>");f.attr("role","group"),f.attr("aria-hidden",!0),a.each(e,function(d,e){if("object"==typeof e){var g=a("<li></li>"),h=a("<p></p>"),i=e.id||e.key+"_tree_item",j=null,k=!(!e.expandable&&!e.haschildren);if(h.addClass("tree_item"),h.attr("id",i),h.attr("role","treeitem"),h.attr("tabindex","-1"),e.requiresajaxloading&&(h.attr("data-requires-ajax",!0),h.attr("data-node-id",e.id),h.attr("data-node-key",e.key),h.attr("data-node-type",e.type)),k&&(g.addClass("collapsed contains_branch"),h.attr("aria-expanded",!1),h.addClass("branch"),require(["core/templates"],function(a){a.renderIcon("collapsed").done(function(a){"false"===h.attr("aria-expanded")&&(h.find(".flex-icon").remove(),h.prepend(a))})})),e.icon&&(!k||e.type===c.ACTIVITY||e.type===c.RESOURCE)){g.addClass("item_with_icon"),h.addClass("hasicon");var l=e.flex_icon;"string"==typeof l?j=a(l):(j=a("<img/>"),j.attr("alt",e.icon.alt),j.attr("title",e.icon.title),j.attr("src",M.util.image_url(e.icon.pix,e.icon.component)),a.each(e.icon.classes,function(a,b){j.addClass(b)}))}if(e.link){var m=a('<a title="'+e.title+'" href="'+e.link+'"></a>');j?(m.append(j),m.append('<span class="item-content-wrap">'+e.name+"</span>")):m.append(e.name),e.hidden&&m.addClass("dimmed"),h.append(m)}else{var n=a("<span></span>");j?(n.append(j),n.append('<span class="item-content-wrap">'+e.name+"</span>")):n.append(e.name),e.hidden&&n.addClass("dimmed"),h.append(n)}g.append(h),f.append(g),e.children&&e.children.length?b(h,e.children):k&&!e.requiresajaxloading&&(g.removeClass("contains_branch"),h.addClass("emptybranch"),require(["core/templates"],function(a){a.renderIcon("collapsed-empty").done(function(a){"true"===h.attr("aria-expanded")&&(h.find(".flex-icon").remove(),h.prepend(a))})}))}}),d.parent().append(f);var g=d.attr("id")+"_group";f.attr("id",g),d.attr("aria-owns",g),d.attr("role","treeitem")}var c={ACTIVITY:40,RESOURCE:50};return{render:function(a,c){if(c.children&&c.children.length){b(a,c.children);var d=a.children("[role='treeitem']").first(),e=a.find("#"+d.attr("aria-owns"));d.attr("aria-expanded",!0),e.attr("aria-hidden",!1)}else a.parent().hasClass("contains_branch")&&(a.parent().removeClass("contains_branch"),require(["core/templates"],function(b){b.renderIcon("collapsed-empty").done(function(b){"true"===a.attr("aria-expanded")&&(a.find(".flex-icon").remove(),a.prepend(b))})}))}}});
define('block_navigation/navblock', ["core/yui","core/tree"],function(a,b){return{init:function(c){var d=new b(".block_navigation .block_tree");d.finishExpandingGroup=function(d){b.prototype.finishExpandingGroup.call(this,d),a.use("moodle-core-event",function(){a.Global.fire(M.core.globalEvents.BLOCK_CONTENT_UPDATED,{instanceid:c})})},d.collapseGroup=function(d){b.prototype.collapseGroup.call(this,d),a.use("moodle-core-event",function(){a.Global.fire(M.core.globalEvents.BLOCK_CONTENT_UPDATED,{instanceid:c})})}}}});
define('block_navigation/nav_loader', ["jquery","core/ajax","core/config","block_navigation/ajax_response_renderer"],function(a,b,c,d){function e(a){return a.closest("[data-block]").attr("data-instanceid")}function f(a){return a.closest("[data-block]").attr("data-block")}var g=c.wwwroot+"/lib/ajax/getnavbranch.php";return{load:function(b){b=a(b);var h=a.Deferred(),i={elementid:b.attr("data-node-id"),id:b.attr("data-node-key"),type:b.attr("data-node-type"),sesskey:c.sesskey,instance:e(b),blocktype:f(b)},j={type:"POST",dataType:"json",data:i};return a.ajax(g,j).done(function(a){d.render(b,a),h.resolve()}),h}}});
define('block_navigation/site_admin_loader', ["jquery","core/ajax","core/config","block_navigation/ajax_response_renderer"],function(a,b,c,d){var e=71,f=c.wwwroot+"/lib/ajax/getsiteadminbranch.php";return{load:function(b){b=a(b);var g=a.Deferred(),h={type:e,sesskey:c.sesskey},i={type:"POST",dataType:"json",data:h};return a.ajax(f,i).done(function(a){d.render(b,a),g.resolve()}),g}}});
define('block_related_courses/carousel', ["jquery","block_related_courses/slick","block_related_courses/enrol"],function(a,b,c){var d={};return d.initialise=function(b){var d=a("#inst"+b),e=d.find(".block_related_courses_courses");e.slick(),c.initialise(b)},d});
define('block_related_courses/enrol', ["jquery","core/ajax","core/notification","core/str"],function(a,b,c,d){var e={};return e.initialise=function(e,f){var g=a("#inst"+e),h=g.find(".enrol");h.removeAttr("disabled"),h.click(function(){var e=a(this).attr("data-course-id");b.call([{methodname:"block_related_courses_enrol",args:{id:e},done:function(a){if(1==a){var b=h.filter("[data-course-id="+e+"]");b.attr("disabled",!0),d.get_string("enrolled","block_related_courses").done(function(a){b.text(a)})}else d.get_string("error:enrol","block_related_courses").done(function(a){c.exception(new Error(a))})},fail:c.exception}])})},e});
define('block_related_courses/full', ["jquery","block_related_courses/enrol"],function(a,b){var c={};return c.initialise=function(c){var d=a("#inst"+c),e=d.find(".block_related_courses_tags .tag"),f=d.find(".block_related_courses_courses .course");e.click(function(){var b=a(this).attr("data-filter");f.hide().filter(b).show()}),b.initialise(c)},c});
!function(a){"use strict";"function"==typeof define&&define.amd?define('block_related_courses/slick', ["jquery"],a):"undefined"!=typeof exports?module.exports=a(require("jquery")):a(jQuery)}(function(a){"use strict";var b=window.Slick||{};b=function(){function b(b,d){var e,f=this;f.defaults={accessibility:!0,adaptiveHeight:!1,appendArrows:a(b),appendDots:a(b),arrows:!0,asNavFor:null,prevArrow:'<button type="button" data-role="none" class="slick-prev" aria-label="Previous" tabindex="0" role="button">Previous</button>',nextArrow:'<button type="button" data-role="none" class="slick-next" aria-label="Next" tabindex="0" role="button">Next</button>',autoplay:!1,autoplaySpeed:3e3,centerMode:!1,centerPadding:"50px",cssEase:"ease",customPaging:function(b,c){return a('<button type="button" data-role="none" role="button" tabindex="0" />').text(c+1)},dots:!1,dotsClass:"slick-dots",draggable:!0,easing:"linear",edgeFriction:.35,fade:!1,focusOnSelect:!1,infinite:!0,initialSlide:0,lazyLoad:"ondemand",mobileFirst:!1,pauseOnHover:!0,pauseOnFocus:!0,pauseOnDotsHover:!1,respondTo:"window",responsive:null,rows:1,rtl:!1,slide:"",slidesPerRow:1,slidesToShow:1,slidesToScroll:1,speed:500,swipe:!0,swipeToSlide:!1,touchMove:!0,touchThreshold:5,useCSS:!0,useTransform:!0,variableWidth:!1,vertical:!1,verticalSwiping:!1,waitForAnimate:!0,zIndex:1e3},f.initials={animating:!1,dragging:!1,autoPlayTimer:null,currentDirection:0,currentLeft:null,currentSlide:0,direction:1,$dots:null,listWidth:null,listHeight:null,loadIndex:0,$nextArrow:null,$prevArrow:null,slideCount:null,slideWidth:null,$slideTrack:null,$slides:null,sliding:!1,slideOffset:0,swipeLeft:null,$list:null,touchObject:{},transformsEnabled:!1,unslicked:!1},a.extend(f,f.initials),f.activeBreakpoint=null,f.animType=null,f.animProp=null,f.breakpoints=[],f.breakpointSettings=[],f.cssTransitions=!1,f.focussed=!1,f.interrupted=!1,f.hidden="hidden",f.paused=!0,f.positionProp=null,f.respondTo=null,f.rowCount=1,f.shouldClick=!0,f.$slider=a(b),f.$slidesCache=null,f.transformType=null,f.transitionType=null,f.visibilityChange="visibilitychange",f.windowWidth=0,f.windowTimer=null,e=a(b).data("slick")||{},f.options=a.extend({},f.defaults,d,e),f.currentSlide=f.options.initialSlide,f.originalSettings=f.options,"undefined"!=typeof document.mozHidden?(f.hidden="mozHidden",f.visibilityChange="mozvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(f.hidden="webkitHidden",f.visibilityChange="webkitvisibilitychange"),f.autoPlay=a.proxy(f.autoPlay,f),f.autoPlayClear=a.proxy(f.autoPlayClear,f),f.autoPlayIterator=a.proxy(f.autoPlayIterator,f),f.changeSlide=a.proxy(f.changeSlide,f),f.clickHandler=a.proxy(f.clickHandler,f),f.selectHandler=a.proxy(f.selectHandler,f),f.setPosition=a.proxy(f.setPosition,f),f.swipeHandler=a.proxy(f.swipeHandler,f),f.dragHandler=a.proxy(f.dragHandler,f),f.keyHandler=a.proxy(f.keyHandler,f),f.instanceUid=c++,f.htmlExpr=/^(?:\s*(<[\w\W]+>)[^>]*)$/,f.registerBreakpoints(),f.init(!0)}var c=0;return b}(),b.prototype.activateADA=function(){var a=this;a.$slideTrack.find(".slick-active").attr({"aria-hidden":"false"}).find("a, input, button, select").attr({tabindex:"0"})},b.prototype.addSlide=b.prototype.slickAdd=function(b,c,d){var e=this;if("boolean"==typeof c)d=c,c=null;else if(c<0||c>=e.slideCount)return!1;e.unload(),"number"==typeof c?0===c&&0===e.$slides.length?a(b).appendTo(e.$slideTrack):d?a(b).insertBefore(e.$slides.eq(c)):a(b).insertAfter(e.$slides.eq(c)):d===!0?a(b).prependTo(e.$slideTrack):a(b).appendTo(e.$slideTrack),e.$slides=e.$slideTrack.children(this.options.slide),e.$slideTrack.children(this.options.slide).detach(),e.$slideTrack.append(e.$slides),e.$slides.each(function(b,c){a(c).attr("data-slick-index",b)}),e.$slidesCache=e.$slides,e.reinit()},b.prototype.animateHeight=function(){var a=this;if(1===a.options.slidesToShow&&a.options.adaptiveHeight===!0&&a.options.vertical===!1){var b=a.$slides.eq(a.currentSlide).outerHeight(!0);a.$list.animate({height:b},a.options.speed)}},b.prototype.animateSlide=function(b,c){var d={},e=this;e.animateHeight(),e.options.rtl===!0&&e.options.vertical===!1&&(b=-b),e.transformsEnabled===!1?e.options.vertical===!1?e.$slideTrack.animate({left:b},e.options.speed,e.options.easing,c):e.$slideTrack.animate({top:b},e.options.speed,e.options.easing,c):e.cssTransitions===!1?(e.options.rtl===!0&&(e.currentLeft=-e.currentLeft),a({animStart:e.currentLeft}).animate({animStart:b},{duration:e.options.speed,easing:e.options.easing,step:function(a){a=Math.ceil(a),e.options.vertical===!1?(d[e.animType]="translate("+a+"px, 0px)",e.$slideTrack.css(d)):(d[e.animType]="translate(0px,"+a+"px)",e.$slideTrack.css(d))},complete:function(){c&&c.call()}})):(e.applyTransition(),b=Math.ceil(b),e.options.vertical===!1?d[e.animType]="translate3d("+b+"px, 0px, 0px)":d[e.animType]="translate3d(0px,"+b+"px, 0px)",e.$slideTrack.css(d),c&&setTimeout(function(){e.disableTransition(),c.call()},e.options.speed))},b.prototype.getNavTarget=function(){var b=this,c=b.options.asNavFor;return c&&null!==c&&(c=a(c).not(b.$slider)),c},b.prototype.asNavFor=function(b){var c=this,d=c.getNavTarget();null!==d&&"object"==typeof d&&d.each(function(){var c=a(this).slick("getSlick");c.unslicked||c.slideHandler(b,!0)})},b.prototype.applyTransition=function(a){var b=this,c={};b.options.fade===!1?c[b.transitionType]=b.transformType+" "+b.options.speed+"ms "+b.options.cssEase:c[b.transitionType]="opacity "+b.options.speed+"ms "+b.options.cssEase,b.options.fade===!1?b.$slideTrack.css(c):b.$slides.eq(a).css(c)},b.prototype.autoPlay=function(){var a=this;a.autoPlayClear(),a.slideCount>a.options.slidesToShow&&(a.autoPlayTimer=setInterval(a.autoPlayIterator,a.options.autoplaySpeed))},b.prototype.autoPlayClear=function(){var a=this;a.autoPlayTimer&&clearInterval(a.autoPlayTimer)},b.prototype.autoPlayIterator=function(){var a=this,b=a.currentSlide+a.options.slidesToScroll;a.paused||a.interrupted||a.focussed||(a.options.infinite===!1&&(1===a.direction&&a.currentSlide+1===a.slideCount-1?a.direction=0:0===a.direction&&(b=a.currentSlide-a.options.slidesToScroll,a.currentSlide-1===0&&(a.direction=1))),a.slideHandler(b))},b.prototype.buildArrows=function(){var b=this;b.options.arrows===!0&&(b.$prevArrow=a(b.options.prevArrow).addClass("slick-arrow"),b.$nextArrow=a(b.options.nextArrow).addClass("slick-arrow"),b.slideCount>b.options.slidesToShow?(b.$prevArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex"),b.$nextArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex"),b.htmlExpr.test(b.options.prevArrow)&&b.$prevArrow.prependTo(b.options.appendArrows),b.htmlExpr.test(b.options.nextArrow)&&b.$nextArrow.appendTo(b.options.appendArrows),b.options.infinite!==!0&&b.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true")):b.$prevArrow.add(b.$nextArrow).addClass("slick-hidden").attr({"aria-disabled":"true",tabindex:"-1"}))},b.prototype.buildDots=function(){var b,c,d=this;if(d.options.dots===!0&&d.slideCount>d.options.slidesToShow){for(d.$slider.addClass("slick-dotted"),c=a("<ul />").addClass(d.options.dotsClass),b=0;b<=d.getDotCount();b+=1)c.append(a("<li />").append(d.options.customPaging.call(this,d,b)));d.$dots=c.appendTo(d.options.appendDots),d.$dots.find("li").first().addClass("slick-active").attr("aria-hidden","false")}},b.prototype.buildOut=function(){var b=this;b.$slides=b.$slider.children(b.options.slide+":not(.slick-cloned)").addClass("slick-slide"),b.slideCount=b.$slides.length,b.$slides.each(function(b,c){a(c).attr("data-slick-index",b).data("originalStyling",a(c).attr("style")||"")}),b.$slider.addClass("slick-slider"),b.$slideTrack=0===b.slideCount?a('<div class="slick-track"/>').appendTo(b.$slider):b.$slides.wrapAll('<div class="slick-track"/>').parent(),b.$list=b.$slideTrack.wrap('<div aria-live="polite" class="slick-list"/>').parent(),b.$slideTrack.css("opacity",0),b.options.centerMode!==!0&&b.options.swipeToSlide!==!0||(b.options.slidesToScroll=1),a("img[data-lazy]",b.$slider).not("[src]").addClass("slick-loading"),b.setupInfinite(),b.buildArrows(),b.buildDots(),b.updateDots(),b.setSlideClasses("number"==typeof b.currentSlide?b.currentSlide:0),b.options.draggable===!0&&b.$list.addClass("draggable")},b.prototype.buildRows=function(){var a,b,c,d,e,f,g,h=this;if(d=document.createDocumentFragment(),f=h.$slider.children(),h.options.rows>1){for(g=h.options.slidesPerRow*h.options.rows,e=Math.ceil(f.length/g),a=0;a<e;a++){var i=document.createElement("div");for(b=0;b<h.options.rows;b++){var j=document.createElement("div");for(c=0;c<h.options.slidesPerRow;c++){var k=a*g+(b*h.options.slidesPerRow+c);f.get(k)&&j.appendChild(f.get(k))}i.appendChild(j)}d.appendChild(i)}h.$slider.empty().append(d),h.$slider.children().children().children().css({width:100/h.options.slidesPerRow+"%",display:"inline-block"})}},b.prototype.checkResponsive=function(b,c){var d,e,f,g=this,h=!1,i=g.$slider.width(),j=window.innerWidth||a(window).width();if("window"===g.respondTo?f=j:"slider"===g.respondTo?f=i:"min"===g.respondTo&&(f=Math.min(j,i)),g.options.responsive&&g.options.responsive.length&&null!==g.options.responsive){e=null;for(d in g.breakpoints)g.breakpoints.hasOwnProperty(d)&&(g.originalSettings.mobileFirst===!1?f<g.breakpoints[d]&&(e=g.breakpoints[d]):f>g.breakpoints[d]&&(e=g.breakpoints[d]));null!==e?null!==g.activeBreakpoint?(e!==g.activeBreakpoint||c)&&(g.activeBreakpoint=e,"unslick"===g.breakpointSettings[e]?g.unslick(e):(g.options=a.extend({},g.originalSettings,g.breakpointSettings[e]),b===!0&&(g.currentSlide=g.options.initialSlide),g.refresh(b)),h=e):(g.activeBreakpoint=e,"unslick"===g.breakpointSettings[e]?g.unslick(e):(g.options=a.extend({},g.originalSettings,g.breakpointSettings[e]),b===!0&&(g.currentSlide=g.options.initialSlide),g.refresh(b)),h=e):null!==g.activeBreakpoint&&(g.activeBreakpoint=null,g.options=g.originalSettings,b===!0&&(g.currentSlide=g.options.initialSlide),g.refresh(b),h=e),b||h===!1||g.$slider.trigger("breakpoint",[g,h])}},b.prototype.changeSlide=function(b,c){var d,e,f,g=this,h=a(b.currentTarget);switch(h.is("a")&&b.preventDefault(),h.is("li")||(h=h.closest("li")),f=g.slideCount%g.options.slidesToScroll!==0,d=f?0:(g.slideCount-g.currentSlide)%g.options.slidesToScroll,b.data.message){case"previous":e=0===d?g.options.slidesToScroll:g.options.slidesToShow-d,g.slideCount>g.options.slidesToShow&&g.slideHandler(g.currentSlide-e,!1,c);break;case"next":e=0===d?g.options.slidesToScroll:d,g.slideCount>g.options.slidesToShow&&g.slideHandler(g.currentSlide+e,!1,c);break;case"index":var i=0===b.data.index?0:b.data.index||h.index()*g.options.slidesToScroll;g.slideHandler(g.checkNavigable(i),!1,c),h.children().trigger("focus");break;default:return}},b.prototype.checkNavigable=function(a){var b,c,d=this;if(b=d.getNavigableIndexes(),c=0,a>b[b.length-1])a=b[b.length-1];else for(var e in b){if(a<b[e]){a=c;break}c=b[e]}return a},b.prototype.cleanUpEvents=function(){var b=this;b.options.dots&&null!==b.$dots&&a("li",b.$dots).off("click.slick",b.changeSlide).off("mouseenter.slick",a.proxy(b.interrupt,b,!0)).off("mouseleave.slick",a.proxy(b.interrupt,b,!1)),b.$slider.off("focus.slick blur.slick"),b.options.arrows===!0&&b.slideCount>b.options.slidesToShow&&(b.$prevArrow&&b.$prevArrow.off("click.slick",b.changeSlide),b.$nextArrow&&b.$nextArrow.off("click.slick",b.changeSlide)),b.$list.off("touchstart.slick mousedown.slick",b.swipeHandler),b.$list.off("touchmove.slick mousemove.slick",b.swipeHandler),b.$list.off("touchend.slick mouseup.slick",b.swipeHandler),b.$list.off("touchcancel.slick mouseleave.slick",b.swipeHandler),b.$list.off("click.slick",b.clickHandler),a(document).off(b.visibilityChange,b.visibility),b.cleanUpSlideEvents(),b.options.accessibility===!0&&b.$list.off("keydown.slick",b.keyHandler),b.options.focusOnSelect===!0&&a(b.$slideTrack).children().off("click.slick",b.selectHandler),a(window).off("orientationchange.slick.slick-"+b.instanceUid,b.orientationChange),a(window).off("resize.slick.slick-"+b.instanceUid,b.resize),a("[draggable!=true]",b.$slideTrack).off("dragstart",b.preventDefault),a(window).off("load.slick.slick-"+b.instanceUid,b.setPosition),a(document).off("ready.slick.slick-"+b.instanceUid,b.setPosition)},b.prototype.cleanUpSlideEvents=function(){var b=this;b.$list.off("mouseenter.slick",a.proxy(b.interrupt,b,!0)),b.$list.off("mouseleave.slick",a.proxy(b.interrupt,b,!1))},b.prototype.cleanUpRows=function(){var a,b=this;b.options.rows>1&&(a=b.$slides.children().children(),a.removeAttr("style"),b.$slider.empty().append(a))},b.prototype.clickHandler=function(a){var b=this;b.shouldClick===!1&&(a.stopImmediatePropagation(),a.stopPropagation(),a.preventDefault())},b.prototype.destroy=function(b){var c=this;c.autoPlayClear(),c.touchObject={},c.cleanUpEvents(),a(".slick-cloned",c.$slider).detach(),c.$dots&&c.$dots.remove(),c.$prevArrow&&c.$prevArrow.length&&(c.$prevArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display",""),c.htmlExpr.test(c.options.prevArrow)&&c.$prevArrow.remove()),c.$nextArrow&&c.$nextArrow.length&&(c.$nextArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display",""),c.htmlExpr.test(c.options.nextArrow)&&c.$nextArrow.remove()),c.$slides&&(c.$slides.removeClass("slick-slide slick-active slick-center slick-visible slick-current").removeAttr("aria-hidden").removeAttr("data-slick-index").each(function(){a(this).attr("style",a(this).data("originalStyling"))}),c.$slideTrack.children(this.options.slide).detach(),c.$slideTrack.detach(),c.$list.detach(),c.$slider.append(c.$slides)),c.cleanUpRows(),c.$slider.removeClass("slick-slider"),c.$slider.removeClass("slick-initialized"),c.$slider.removeClass("slick-dotted"),c.unslicked=!0,b||c.$slider.trigger("destroy",[c])},b.prototype.disableTransition=function(a){var b=this,c={};c[b.transitionType]="",b.options.fade===!1?b.$slideTrack.css(c):b.$slides.eq(a).css(c)},b.prototype.fadeSlide=function(a,b){var c=this;c.cssTransitions===!1?(c.$slides.eq(a).css({zIndex:c.options.zIndex}),c.$slides.eq(a).animate({opacity:1},c.options.speed,c.options.easing,b)):(c.applyTransition(a),c.$slides.eq(a).css({opacity:1,zIndex:c.options.zIndex}),b&&setTimeout(function(){c.disableTransition(a),b.call()},c.options.speed))},b.prototype.fadeSlideOut=function(a){var b=this;b.cssTransitions===!1?b.$slides.eq(a).animate({opacity:0,zIndex:b.options.zIndex-2},b.options.speed,b.options.easing):(b.applyTransition(a),b.$slides.eq(a).css({opacity:0,zIndex:b.options.zIndex-2}))},b.prototype.filterSlides=b.prototype.slickFilter=function(a){var b=this;null!==a&&(b.$slidesCache=b.$slides,b.unload(),b.$slideTrack.children(this.options.slide).detach(),b.$slidesCache.filter(a).appendTo(b.$slideTrack),b.reinit())},b.prototype.focusHandler=function(){var b=this;b.$slider.off("focus.slick blur.slick").on("focus.slick blur.slick","*:not(.slick-arrow)",function(c){c.stopImmediatePropagation();var d=a(this);setTimeout(function(){b.options.pauseOnFocus&&(b.focussed=d.is(":focus"),b.autoPlay())},0)})},b.prototype.getCurrent=b.prototype.slickCurrentSlide=function(){var a=this;return a.currentSlide},b.prototype.getDotCount=function(){var a=this,b=0,c=0,d=0;if(a.options.infinite===!0)for(;b<a.slideCount;)++d,b=c+a.options.slidesToScroll,c+=a.options.slidesToScroll<=a.options.slidesToShow?a.options.slidesToScroll:a.options.slidesToShow;else if(a.options.centerMode===!0)d=a.slideCount;else if(a.options.asNavFor)for(;b<a.slideCount;)++d,b=c+a.options.slidesToScroll,c+=a.options.slidesToScroll<=a.options.slidesToShow?a.options.slidesToScroll:a.options.slidesToShow;else d=1+Math.ceil((a.slideCount-a.options.slidesToShow)/a.options.slidesToScroll);return d-1},b.prototype.getLeft=function(a){var b,c,d,e=this,f=0;return e.slideOffset=0,c=e.$slides.first().outerHeight(!0),e.options.infinite===!0?(e.slideCount>e.options.slidesToShow&&(e.slideOffset=e.slideWidth*e.options.slidesToShow*-1,f=c*e.options.slidesToShow*-1),e.slideCount%e.options.slidesToScroll!==0&&a+e.options.slidesToScroll>e.slideCount&&e.slideCount>e.options.slidesToShow&&(a>e.slideCount?(e.slideOffset=(e.options.slidesToShow-(a-e.slideCount))*e.slideWidth*-1,f=(e.options.slidesToShow-(a-e.slideCount))*c*-1):(e.slideOffset=e.slideCount%e.options.slidesToScroll*e.slideWidth*-1,f=e.slideCount%e.options.slidesToScroll*c*-1))):a+e.options.slidesToShow>e.slideCount&&(e.slideOffset=(a+e.options.slidesToShow-e.slideCount)*e.slideWidth,f=(a+e.options.slidesToShow-e.slideCount)*c),e.slideCount<=e.options.slidesToShow&&(e.slideOffset=0,f=0),e.options.centerMode===!0&&e.options.infinite===!0?e.slideOffset+=e.slideWidth*Math.floor(e.options.slidesToShow/2)-e.slideWidth:e.options.centerMode===!0&&(e.slideOffset=0,e.slideOffset+=e.slideWidth*Math.floor(e.options.slidesToShow/2)),b=e.options.vertical===!1?a*e.slideWidth*-1+e.slideOffset:a*c*-1+f,e.options.variableWidth===!0&&(d=e.slideCount<=e.options.slidesToShow||e.options.infinite===!1?e.$slideTrack.children(".slick-slide").eq(a):e.$slideTrack.children(".slick-slide").eq(a+e.options.slidesToShow),b=e.options.rtl===!0?d[0]?(e.$slideTrack.width()-d[0].offsetLeft-d.width())*-1:0:d[0]?d[0].offsetLeft*-1:0,e.options.centerMode===!0&&(d=e.slideCount<=e.options.slidesToShow||e.options.infinite===!1?e.$slideTrack.children(".slick-slide").eq(a):e.$slideTrack.children(".slick-slide").eq(a+e.options.slidesToShow+1),b=e.options.rtl===!0?d[0]?(e.$slideTrack.width()-d[0].offsetLeft-d.width())*-1:0:d[0]?d[0].offsetLeft*-1:0,b+=(e.$list.width()-d.outerWidth())/2)),b},b.prototype.getOption=b.prototype.slickGetOption=function(a){var b=this;return b.options[a]},b.prototype.getNavigableIndexes=function(){var a,b=this,c=0,d=0,e=[];for(b.options.infinite===!1?a=b.slideCount:(c=b.options.slidesToScroll*-1,d=b.options.slidesToScroll*-1,a=2*b.slideCount);c<a;)e.push(c),c=d+b.options.slidesToScroll,d+=b.options.slidesToScroll<=b.options.slidesToShow?b.options.slidesToScroll:b.options.slidesToShow;return e},b.prototype.getSlick=function(){return this},b.prototype.getSlideCount=function(){var b,c,d,e=this;return d=e.options.centerMode===!0?e.slideWidth*Math.floor(e.options.slidesToShow/2):0,e.options.swipeToSlide===!0?(e.$slideTrack.find(".slick-slide").each(function(b,f){if(f.offsetLeft-d+a(f).outerWidth()/2>e.swipeLeft*-1)return c=f,!1}),b=Math.abs(a(c).attr("data-slick-index")-e.currentSlide)||1):e.options.slidesToScroll},b.prototype.goTo=b.prototype.slickGoTo=function(a,b){var c=this;c.changeSlide({data:{message:"index",index:parseInt(a)}},b)},b.prototype.init=function(b){var c=this;a(c.$slider).hasClass("slick-initialized")||(a(c.$slider).addClass("slick-initialized"),c.buildRows(),c.buildOut(),c.setProps(),c.startLoad(),c.loadSlider(),c.initializeEvents(),c.updateArrows(),c.updateDots(),c.checkResponsive(!0),c.focusHandler()),b&&c.$slider.trigger("init",[c]),c.options.accessibility===!0&&c.initADA(),c.options.autoplay&&(c.paused=!1,c.autoPlay())},b.prototype.initADA=function(){var b=this;b.$slides.add(b.$slideTrack.find(".slick-cloned")).attr({"aria-hidden":"true",tabindex:"-1"}).find("a, input, button, select").attr({tabindex:"-1"}),b.$slideTrack.attr("role","listbox"),b.$slides.not(b.$slideTrack.find(".slick-cloned")).each(function(c){a(this).attr({role:"option","aria-describedby":"slick-slide"+b.instanceUid+c})}),null!==b.$dots&&b.$dots.attr("role","tablist").find("li").each(function(c){a(this).attr({role:"presentation","aria-selected":"false","aria-controls":"navigation"+b.instanceUid+c,id:"slick-slide"+b.instanceUid+c})}).first().attr("aria-selected","true").end().find("button").attr("role","button").end().closest("div").attr("role","toolbar"),b.activateADA()},b.prototype.initArrowEvents=function(){var a=this;a.options.arrows===!0&&a.slideCount>a.options.slidesToShow&&(a.$prevArrow.off("click.slick").on("click.slick",{message:"previous"},a.changeSlide),a.$nextArrow.off("click.slick").on("click.slick",{message:"next"},a.changeSlide))},b.prototype.initDotEvents=function(){var b=this;b.options.dots===!0&&b.slideCount>b.options.slidesToShow&&a("li",b.$dots).on("click.slick",{message:"index"},b.changeSlide),b.options.dots===!0&&b.options.pauseOnDotsHover===!0&&a("li",b.$dots).on("mouseenter.slick",a.proxy(b.interrupt,b,!0)).on("mouseleave.slick",a.proxy(b.interrupt,b,!1))},b.prototype.initSlideEvents=function(){var b=this;b.options.pauseOnHover&&(b.$list.on("mouseenter.slick",a.proxy(b.interrupt,b,!0)),b.$list.on("mouseleave.slick",a.proxy(b.interrupt,b,!1)))},b.prototype.initializeEvents=function(){var b=this;b.initArrowEvents(),b.initDotEvents(),b.initSlideEvents(),b.$list.on("touchstart.slick mousedown.slick",{action:"start"},b.swipeHandler),b.$list.on("touchmove.slick mousemove.slick",{action:"move"},b.swipeHandler),b.$list.on("touchend.slick mouseup.slick",{action:"end"},b.swipeHandler),b.$list.on("touchcancel.slick mouseleave.slick",{action:"end"},b.swipeHandler),b.$list.on("click.slick",b.clickHandler),a(document).on(b.visibilityChange,a.proxy(b.visibility,b)),b.options.accessibility===!0&&b.$list.on("keydown.slick",b.keyHandler),b.options.focusOnSelect===!0&&a(b.$slideTrack).children().on("click.slick",b.selectHandler),a(window).on("orientationchange.slick.slick-"+b.instanceUid,a.proxy(b.orientationChange,b)),a(window).on("resize.slick.slick-"+b.instanceUid,a.proxy(b.resize,b)),a("[draggable!=true]",b.$slideTrack).on("dragstart",b.preventDefault),a(window).on("load.slick.slick-"+b.instanceUid,b.setPosition),a(document).on("ready.slick.slick-"+b.instanceUid,b.setPosition)},b.prototype.initUI=function(){var a=this;a.options.arrows===!0&&a.slideCount>a.options.slidesToShow&&(a.$prevArrow.show(),a.$nextArrow.show()),a.options.dots===!0&&a.slideCount>a.options.slidesToShow&&a.$dots.show()},b.prototype.keyHandler=function(a){var b=this;a.target.tagName.match("TEXTAREA|INPUT|SELECT")||(37===a.keyCode&&b.options.accessibility===!0?b.changeSlide({data:{message:b.options.rtl===!0?"next":"previous"}}):39===a.keyCode&&b.options.accessibility===!0&&b.changeSlide({data:{message:b.options.rtl===!0?"previous":"next"}}))},b.prototype.lazyLoad=function(){function b(b){a("img[data-lazy]",b).each(function(){var b=a(this),c=a(this).attr("data-lazy"),d=document.createElement("img");d.onload=function(){b.animate({opacity:0},100,function(){b.attr("src",c).animate({opacity:1},200,function(){b.removeAttr("data-lazy").removeClass("slick-loading")}),g.$slider.trigger("lazyLoaded",[g,b,c])})},d.onerror=function(){b.removeAttr("data-lazy").removeClass("slick-loading").addClass("slick-lazyload-error"),g.$slider.trigger("lazyLoadError",[g,b,c])},d.src=c})}var c,d,e,f,g=this;g.options.centerMode===!0?g.options.infinite===!0?(e=g.currentSlide+(g.options.slidesToShow/2+1),f=e+g.options.slidesToShow+2):(e=Math.max(0,g.currentSlide-(g.options.slidesToShow/2+1)),f=2+(g.options.slidesToShow/2+1)+g.currentSlide):(e=g.options.infinite?g.options.slidesToShow+g.currentSlide:g.currentSlide,f=Math.ceil(e+g.options.slidesToShow),g.options.fade===!0&&(e>0&&e--,f<=g.slideCount&&f++)),c=g.$slider.find(".slick-slide").slice(e,f),b(c),g.slideCount<=g.options.slidesToShow?(d=g.$slider.find(".slick-slide"),b(d)):g.currentSlide>=g.slideCount-g.options.slidesToShow?(d=g.$slider.find(".slick-cloned").slice(0,g.options.slidesToShow),b(d)):0===g.currentSlide&&(d=g.$slider.find(".slick-cloned").slice(g.options.slidesToShow*-1),b(d))},b.prototype.loadSlider=function(){var a=this;a.setPosition(),a.$slideTrack.css({opacity:1}),a.$slider.removeClass("slick-loading"),a.initUI(),"progressive"===a.options.lazyLoad&&a.progressiveLazyLoad()},b.prototype.next=b.prototype.slickNext=function(){var a=this;a.changeSlide({data:{message:"next"}})},b.prototype.orientationChange=function(){var a=this;a.checkResponsive(),a.setPosition()},b.prototype.pause=b.prototype.slickPause=function(){var a=this;a.autoPlayClear(),a.paused=!0},b.prototype.play=b.prototype.slickPlay=function(){var a=this;a.autoPlay(),a.options.autoplay=!0,a.paused=!1,a.focussed=!1,a.interrupted=!1},b.prototype.postSlide=function(a){var b=this;b.unslicked||(b.$slider.trigger("afterChange",[b,a]),b.animating=!1,b.setPosition(),b.swipeLeft=null,b.options.autoplay&&b.autoPlay(),b.options.accessibility===!0&&b.initADA())},b.prototype.prev=b.prototype.slickPrev=function(){var a=this;a.changeSlide({data:{message:"previous"}})},b.prototype.preventDefault=function(a){a.preventDefault()},b.prototype.progressiveLazyLoad=function(b){b=b||1;var c,d,e,f=this,g=a("img[data-lazy]",f.$slider);g.length?(c=g.first(),d=c.attr("data-lazy"),e=document.createElement("img"),e.onload=function(){c.attr("src",d).removeAttr("data-lazy").removeClass("slick-loading"),f.options.adaptiveHeight===!0&&f.setPosition(),f.$slider.trigger("lazyLoaded",[f,c,d]),f.progressiveLazyLoad()},e.onerror=function(){b<3?setTimeout(function(){f.progressiveLazyLoad(b+1)},500):(c.removeAttr("data-lazy").removeClass("slick-loading").addClass("slick-lazyload-error"),f.$slider.trigger("lazyLoadError",[f,c,d]),f.progressiveLazyLoad())},e.src=d):f.$slider.trigger("allImagesLoaded",[f])},b.prototype.refresh=function(b){var c,d,e=this;d=e.slideCount-e.options.slidesToShow,!e.options.infinite&&e.currentSlide>d&&(e.currentSlide=d),e.slideCount<=e.options.slidesToShow&&(e.currentSlide=0),c=e.currentSlide,e.destroy(!0),a.extend(e,e.initials,{currentSlide:c}),e.init(),b||e.changeSlide({data:{message:"index",index:c}},!1)},b.prototype.registerBreakpoints=function(){var b,c,d,e=this,f=e.options.responsive||null;if("array"===a.type(f)&&f.length){e.respondTo=e.options.respondTo||"window";for(b in f)if(d=e.breakpoints.length-1,c=f[b].breakpoint,f.hasOwnProperty(b)){for(;d>=0;)e.breakpoints[d]&&e.breakpoints[d]===c&&e.breakpoints.splice(d,1),d--;e.breakpoints.push(c),e.breakpointSettings[c]=f[b].settings}e.breakpoints.sort(function(a,b){return e.options.mobileFirst?a-b:b-a})}},b.prototype.reinit=function(){var b=this;b.$slides=b.$slideTrack.children(b.options.slide).addClass("slick-slide"),b.slideCount=b.$slides.length,b.currentSlide>=b.slideCount&&0!==b.currentSlide&&(b.currentSlide=b.currentSlide-b.options.slidesToScroll),b.slideCount<=b.options.slidesToShow&&(b.currentSlide=0),b.registerBreakpoints(),b.setProps(),b.setupInfinite(),b.buildArrows(),b.updateArrows(),b.initArrowEvents(),b.buildDots(),b.updateDots(),b.initDotEvents(),b.cleanUpSlideEvents(),b.initSlideEvents(),b.checkResponsive(!1,!0),b.options.focusOnSelect===!0&&a(b.$slideTrack).children().on("click.slick",b.selectHandler),b.setSlideClasses("number"==typeof b.currentSlide?b.currentSlide:0),b.setPosition(),b.focusHandler(),b.paused=!b.options.autoplay,b.autoPlay(),b.$slider.trigger("reInit",[b])},b.prototype.resize=function(){var b=this;a(window).width()!==b.windowWidth&&(clearTimeout(b.windowDelay),b.windowDelay=window.setTimeout(function(){b.windowWidth=a(window).width(),b.checkResponsive(),b.unslicked||b.setPosition()},50))},b.prototype.removeSlide=b.prototype.slickRemove=function(a,b,c){var d=this;return"boolean"==typeof a?(b=a,a=b===!0?0:d.slideCount-1):a=b===!0?--a:a,!(d.slideCount<1||a<0||a>d.slideCount-1)&&(d.unload(),c===!0?d.$slideTrack.children().remove():d.$slideTrack.children(this.options.slide).eq(a).remove(),d.$slides=d.$slideTrack.children(this.options.slide),d.$slideTrack.children(this.options.slide).detach(),d.$slideTrack.append(d.$slides),d.$slidesCache=d.$slides,void d.reinit())},b.prototype.setCSS=function(a){var b,c,d=this,e={};d.options.rtl===!0&&(a=-a),b="left"==d.positionProp?Math.ceil(a)+"px":"0px",c="top"==d.positionProp?Math.ceil(a)+"px":"0px",e[d.positionProp]=a,d.transformsEnabled===!1?d.$slideTrack.css(e):(e={},d.cssTransitions===!1?(e[d.animType]="translate("+b+", "+c+")",d.$slideTrack.css(e)):(e[d.animType]="translate3d("+b+", "+c+", 0px)",d.$slideTrack.css(e)))},b.prototype.setDimensions=function(){var a=this;a.options.vertical===!1?a.options.centerMode===!0&&a.$list.css({padding:"0px "+a.options.centerPadding}):(a.$list.height(a.$slides.first().outerHeight(!0)*a.options.slidesToShow),a.options.centerMode===!0&&a.$list.css({padding:a.options.centerPadding+" 0px"})),a.listWidth=a.$list.width(),a.listHeight=a.$list.height(),a.options.vertical===!1&&a.options.variableWidth===!1?(a.slideWidth=Math.ceil(a.listWidth/a.options.slidesToShow),a.$slideTrack.width(Math.ceil(a.slideWidth*a.$slideTrack.children(".slick-slide").length))):a.options.variableWidth===!0?a.$slideTrack.width(5e3*a.slideCount):(a.slideWidth=Math.ceil(a.listWidth),a.$slideTrack.height(Math.ceil(a.$slides.first().outerHeight(!0)*a.$slideTrack.children(".slick-slide").length)));var b=a.$slides.first().outerWidth(!0)-a.$slides.first().width();a.options.variableWidth===!1&&a.$slideTrack.children(".slick-slide").width(a.slideWidth-b)},b.prototype.setFade=function(){var b,c=this;c.$slides.each(function(d,e){b=c.slideWidth*d*-1,c.options.rtl===!0?a(e).css({position:"relative",right:b,top:0,zIndex:c.options.zIndex-2,opacity:0}):a(e).css({position:"relative",left:b,top:0,zIndex:c.options.zIndex-2,opacity:0})}),c.$slides.eq(c.currentSlide).css({zIndex:c.options.zIndex-1,opacity:1})},b.prototype.setHeight=function(){var a=this;if(1===a.options.slidesToShow&&a.options.adaptiveHeight===!0&&a.options.vertical===!1){var b=a.$slides.eq(a.currentSlide).outerHeight(!0);a.$list.css("height",b)}},b.prototype.setOption=b.prototype.slickSetOption=function(){var b,c,d,e,f,g=this,h=!1;if("object"===a.type(arguments[0])?(d=arguments[0],h=arguments[1],f="multiple"):"string"===a.type(arguments[0])&&(d=arguments[0],e=arguments[1],h=arguments[2],"responsive"===arguments[0]&&"array"===a.type(arguments[1])?f="responsive":"undefined"!=typeof arguments[1]&&(f="single")),"single"===f)g.options[d]=e;else if("multiple"===f)a.each(d,function(a,b){g.options[a]=b});else if("responsive"===f)for(c in e)if("array"!==a.type(g.options.responsive))g.options.responsive=[e[c]];else{for(b=g.options.responsive.length-1;b>=0;)g.options.responsive[b].breakpoint===e[c].breakpoint&&g.options.responsive.splice(b,1),b--;g.options.responsive.push(e[c])}h&&(g.unload(),g.reinit())},b.prototype.setPosition=function(){var a=this;a.setDimensions(),a.setHeight(),a.options.fade===!1?a.setCSS(a.getLeft(a.currentSlide)):a.setFade(),a.$slider.trigger("setPosition",[a])},b.prototype.setProps=function(){var a=this,b=document.body.style;a.positionProp=a.options.vertical===!0?"top":"left","top"===a.positionProp?a.$slider.addClass("slick-vertical"):a.$slider.removeClass("slick-vertical"),void 0===b.WebkitTransition&&void 0===b.MozTransition&&void 0===b.msTransition||a.options.useCSS===!0&&(a.cssTransitions=!0),a.options.fade&&("number"==typeof a.options.zIndex?a.options.zIndex<3&&(a.options.zIndex=3):a.options.zIndex=a.defaults.zIndex),void 0!==b.OTransform&&(a.animType="OTransform",a.transformType="-o-transform",a.transitionType="OTransition",void 0===b.perspectiveProperty&&void 0===b.webkitPerspective&&(a.animType=!1)),void 0!==b.MozTransform&&(a.animType="MozTransform",a.transformType="-moz-transform",a.transitionType="MozTransition",void 0===b.perspectiveProperty&&void 0===b.MozPerspective&&(a.animType=!1)),void 0!==b.webkitTransform&&(a.animType="webkitTransform",a.transformType="-webkit-transform",a.transitionType="webkitTransition",void 0===b.perspectiveProperty&&void 0===b.webkitPerspective&&(a.animType=!1)),void 0!==b.msTransform&&(a.animType="msTransform",a.transformType="-ms-transform",a.transitionType="msTransition",void 0===b.msTransform&&(a.animType=!1)),void 0!==b.transform&&a.animType!==!1&&(a.animType="transform",a.transformType="transform",a.transitionType="transition"),a.transformsEnabled=a.options.useTransform&&null!==a.animType&&a.animType!==!1},b.prototype.setSlideClasses=function(a){var b,c,d,e,f=this;c=f.$slider.find(".slick-slide").removeClass("slick-active slick-center slick-current").attr("aria-hidden","true"),f.$slides.eq(a).addClass("slick-current"),f.options.centerMode===!0?(b=Math.floor(f.options.slidesToShow/2),f.options.infinite===!0&&(a>=b&&a<=f.slideCount-1-b?f.$slides.slice(a-b,a+b+1).addClass("slick-active").attr("aria-hidden","false"):(d=f.options.slidesToShow+a,
c.slice(d-b+1,d+b+2).addClass("slick-active").attr("aria-hidden","false")),0===a?c.eq(c.length-1-f.options.slidesToShow).addClass("slick-center"):a===f.slideCount-1&&c.eq(f.options.slidesToShow).addClass("slick-center")),f.$slides.eq(a).addClass("slick-center")):a>=0&&a<=f.slideCount-f.options.slidesToShow?f.$slides.slice(a,a+f.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false"):c.length<=f.options.slidesToShow?c.addClass("slick-active").attr("aria-hidden","false"):(e=f.slideCount%f.options.slidesToShow,d=f.options.infinite===!0?f.options.slidesToShow+a:a,f.options.slidesToShow==f.options.slidesToScroll&&f.slideCount-a<f.options.slidesToShow?c.slice(d-(f.options.slidesToShow-e),d+e).addClass("slick-active").attr("aria-hidden","false"):c.slice(d,d+f.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false")),"ondemand"===f.options.lazyLoad&&f.lazyLoad()},b.prototype.setupInfinite=function(){var b,c,d,e=this;if(e.options.fade===!0&&(e.options.centerMode=!1),e.options.infinite===!0&&e.options.fade===!1&&(c=null,e.slideCount>e.options.slidesToShow)){for(d=e.options.centerMode===!0?e.options.slidesToShow+1:e.options.slidesToShow,b=e.slideCount;b>e.slideCount-d;b-=1)c=b-1,a(e.$slides[c]).clone(!0).attr("id","").attr("data-slick-index",c-e.slideCount).prependTo(e.$slideTrack).addClass("slick-cloned");for(b=0;b<d;b+=1)c=b,a(e.$slides[c]).clone(!0).attr("id","").attr("data-slick-index",c+e.slideCount).appendTo(e.$slideTrack).addClass("slick-cloned");e.$slideTrack.find(".slick-cloned").find("[id]").each(function(){a(this).attr("id","")})}},b.prototype.interrupt=function(a){var b=this;a||b.autoPlay(),b.interrupted=a},b.prototype.selectHandler=function(b){var c=this,d=a(b.target).is(".slick-slide")?a(b.target):a(b.target).parents(".slick-slide"),e=parseInt(d.attr("data-slick-index"));return e||(e=0),c.slideCount<=c.options.slidesToShow?(c.setSlideClasses(e),void c.asNavFor(e)):void c.slideHandler(e)},b.prototype.slideHandler=function(a,b,c){var d,e,f,g,h,i=null,j=this;if(b=b||!1,(j.animating!==!0||j.options.waitForAnimate!==!0)&&!(j.options.fade===!0&&j.currentSlide===a||j.slideCount<=j.options.slidesToShow))return b===!1&&j.asNavFor(a),d=a,i=j.getLeft(d),g=j.getLeft(j.currentSlide),j.currentLeft=null===j.swipeLeft?g:j.swipeLeft,j.options.infinite===!1&&j.options.centerMode===!1&&(a<0||a>j.getDotCount()*j.options.slidesToScroll)?void(j.options.fade===!1&&(d=j.currentSlide,c!==!0?j.animateSlide(g,function(){j.postSlide(d)}):j.postSlide(d))):j.options.infinite===!1&&j.options.centerMode===!0&&(a<0||a>j.slideCount-j.options.slidesToScroll)?void(j.options.fade===!1&&(d=j.currentSlide,c!==!0?j.animateSlide(g,function(){j.postSlide(d)}):j.postSlide(d))):(j.options.autoplay&&clearInterval(j.autoPlayTimer),e=d<0?j.slideCount%j.options.slidesToScroll!==0?j.slideCount-j.slideCount%j.options.slidesToScroll:j.slideCount+d:d>=j.slideCount?j.slideCount%j.options.slidesToScroll!==0?0:d-j.slideCount:d,j.animating=!0,j.$slider.trigger("beforeChange",[j,j.currentSlide,e]),f=j.currentSlide,j.currentSlide=e,j.setSlideClasses(j.currentSlide),j.options.asNavFor&&(h=j.getNavTarget(),h=h.slick("getSlick"),h.slideCount<=h.options.slidesToShow&&h.setSlideClasses(j.currentSlide)),j.updateDots(),j.updateArrows(),j.options.fade===!0?(c!==!0?(j.fadeSlideOut(f),j.fadeSlide(e,function(){j.postSlide(e)})):j.postSlide(e),void j.animateHeight()):void(c!==!0?j.animateSlide(i,function(){j.postSlide(e)}):j.postSlide(e)))},b.prototype.startLoad=function(){var a=this;a.options.arrows===!0&&a.slideCount>a.options.slidesToShow&&(a.$prevArrow.hide(),a.$nextArrow.hide()),a.options.dots===!0&&a.slideCount>a.options.slidesToShow&&a.$dots.hide(),a.$slider.addClass("slick-loading")},b.prototype.swipeDirection=function(){var a,b,c,d,e=this;return a=e.touchObject.startX-e.touchObject.curX,b=e.touchObject.startY-e.touchObject.curY,c=Math.atan2(b,a),d=Math.round(180*c/Math.PI),d<0&&(d=360-Math.abs(d)),d<=45&&d>=0?e.options.rtl===!1?"left":"right":d<=360&&d>=315?e.options.rtl===!1?"left":"right":d>=135&&d<=225?e.options.rtl===!1?"right":"left":e.options.verticalSwiping===!0?d>=35&&d<=135?"down":"up":"vertical"},b.prototype.swipeEnd=function(a){var b,c,d=this;if(d.dragging=!1,d.interrupted=!1,d.shouldClick=!(d.touchObject.swipeLength>10),void 0===d.touchObject.curX)return!1;if(d.touchObject.edgeHit===!0&&d.$slider.trigger("edge",[d,d.swipeDirection()]),d.touchObject.swipeLength>=d.touchObject.minSwipe){switch(c=d.swipeDirection()){case"left":case"down":b=d.options.swipeToSlide?d.checkNavigable(d.currentSlide+d.getSlideCount()):d.currentSlide+d.getSlideCount(),d.currentDirection=0;break;case"right":case"up":b=d.options.swipeToSlide?d.checkNavigable(d.currentSlide-d.getSlideCount()):d.currentSlide-d.getSlideCount(),d.currentDirection=1}"vertical"!=c&&(d.slideHandler(b),d.touchObject={},d.$slider.trigger("swipe",[d,c]))}else d.touchObject.startX!==d.touchObject.curX&&(d.slideHandler(d.currentSlide),d.touchObject={})},b.prototype.swipeHandler=function(a){var b=this;if(!(b.options.swipe===!1||"ontouchend"in document&&b.options.swipe===!1||b.options.draggable===!1&&a.type.indexOf("mouse")!==-1))switch(b.touchObject.fingerCount=a.originalEvent&&void 0!==a.originalEvent.touches?a.originalEvent.touches.length:1,b.touchObject.minSwipe=b.listWidth/b.options.touchThreshold,b.options.verticalSwiping===!0&&(b.touchObject.minSwipe=b.listHeight/b.options.touchThreshold),a.data.action){case"start":b.swipeStart(a);break;case"move":b.swipeMove(a);break;case"end":b.swipeEnd(a)}},b.prototype.swipeMove=function(a){var b,c,d,e,f,g=this;return f=void 0!==a.originalEvent?a.originalEvent.touches:null,!(!g.dragging||f&&1!==f.length)&&(b=g.getLeft(g.currentSlide),g.touchObject.curX=void 0!==f?f[0].pageX:a.clientX,g.touchObject.curY=void 0!==f?f[0].pageY:a.clientY,g.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(g.touchObject.curX-g.touchObject.startX,2))),g.options.verticalSwiping===!0&&(g.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(g.touchObject.curY-g.touchObject.startY,2)))),c=g.swipeDirection(),"vertical"!==c?(void 0!==a.originalEvent&&g.touchObject.swipeLength>4&&a.preventDefault(),e=(g.options.rtl===!1?1:-1)*(g.touchObject.curX>g.touchObject.startX?1:-1),g.options.verticalSwiping===!0&&(e=g.touchObject.curY>g.touchObject.startY?1:-1),d=g.touchObject.swipeLength,g.touchObject.edgeHit=!1,g.options.infinite===!1&&(0===g.currentSlide&&"right"===c||g.currentSlide>=g.getDotCount()&&"left"===c)&&(d=g.touchObject.swipeLength*g.options.edgeFriction,g.touchObject.edgeHit=!0),g.options.vertical===!1?g.swipeLeft=b+d*e:g.swipeLeft=b+d*(g.$list.height()/g.listWidth)*e,g.options.verticalSwiping===!0&&(g.swipeLeft=b+d*e),g.options.fade!==!0&&g.options.touchMove!==!1&&(g.animating===!0?(g.swipeLeft=null,!1):void g.setCSS(g.swipeLeft))):void 0)},b.prototype.swipeStart=function(a){var b,c=this;return c.interrupted=!0,1!==c.touchObject.fingerCount||c.slideCount<=c.options.slidesToShow?(c.touchObject={},!1):(void 0!==a.originalEvent&&void 0!==a.originalEvent.touches&&(b=a.originalEvent.touches[0]),c.touchObject.startX=c.touchObject.curX=void 0!==b?b.pageX:a.clientX,c.touchObject.startY=c.touchObject.curY=void 0!==b?b.pageY:a.clientY,void(c.dragging=!0))},b.prototype.unfilterSlides=b.prototype.slickUnfilter=function(){var a=this;null!==a.$slidesCache&&(a.unload(),a.$slideTrack.children(this.options.slide).detach(),a.$slidesCache.appendTo(a.$slideTrack),a.reinit())},b.prototype.unload=function(){var b=this;a(".slick-cloned",b.$slider).remove(),b.$dots&&b.$dots.remove(),b.$prevArrow&&b.htmlExpr.test(b.options.prevArrow)&&b.$prevArrow.remove(),b.$nextArrow&&b.htmlExpr.test(b.options.nextArrow)&&b.$nextArrow.remove(),b.$slides.removeClass("slick-slide slick-active slick-visible slick-current").attr("aria-hidden","true").css("width","")},b.prototype.unslick=function(a){var b=this;b.$slider.trigger("unslick",[b,a]),b.destroy()},b.prototype.updateArrows=function(){var a,b=this;a=Math.floor(b.options.slidesToShow/2),b.options.arrows===!0&&b.slideCount>b.options.slidesToShow&&!b.options.infinite&&(b.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false"),b.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false"),0===b.currentSlide?(b.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true"),b.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false")):b.currentSlide>=b.slideCount-b.options.slidesToShow&&b.options.centerMode===!1?(b.$nextArrow.addClass("slick-disabled").attr("aria-disabled","true"),b.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false")):b.currentSlide>=b.slideCount-1&&b.options.centerMode===!0&&(b.$nextArrow.addClass("slick-disabled").attr("aria-disabled","true"),b.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false")))},b.prototype.updateDots=function(){var a=this;null!==a.$dots&&(a.$dots.find("li").removeClass("slick-active").attr("aria-hidden","true"),a.$dots.find("li").eq(Math.floor(a.currentSlide/a.options.slidesToScroll)).addClass("slick-active").attr("aria-hidden","false"))},b.prototype.visibility=function(){var a=this;a.options.autoplay&&(document[a.hidden]?a.interrupted=!0:a.interrupted=!1)},a.fn.slick=function(){var a,c,d=this,e=arguments[0],f=Array.prototype.slice.call(arguments,1),g=d.length;for(a=0;a<g;a++)if("object"==typeof e||"undefined"==typeof e?d[a].slick=new b(d[a],e):c=d[a].slick[e].apply(d[a].slick,f),"undefined"!=typeof c)return c;return d}});
define('block_settings/settingsblock', ["core/yui","core/tree"],function(a,b){return{init:function(c,d){var e=new b(".block_settings .block_tree");if(d){var f=e.treeRoot.find("#"+d),g=f.children("a").first();g.replaceWith('<span tabindex="0">'+g.html()+"</span>")}e.finishExpandingGroup=function(d){b.prototype.finishExpandingGroup.call(this,d),a.use("moodle-core-event",function(){a.Global.fire(M.core.globalEvents.BLOCK_CONTENT_UPDATED,{instanceid:c})})},e.collapseGroup=function(d){b.prototype.collapseGroup.call(this,d),a.use("moodle-core-event",function(){a.Global.fire(M.core.globalEvents.BLOCK_CONTENT_UPDATED,{instanceid:c})})}}}});
define('block_totara_featured_links/ajax', ["jquery","core/ajax","core/str"],function(a,b,c){return{block_totara_featured_links_remove_tile:function(){var d=[];d.push({key:"delete",component:"core"}),d.push({key:"cancel",component:"core"}),d.push({key:"confirm",component:"block_totara_featured_links"}),c.get_strings(d).done(function(c){var d=a('a[type="remove"]');d.off("click"),d.click(function(d){d.preventDefault();var e=new M.core.confirm({question:c[2],modal:!0,yesLabel:c[0],noLabel:c[1],title:"&nbsp;",zIndex:500});e.on("complete-yes",function(){var c=a(d.target).closest("a"),e=c.attr("tileid"),f=b.call([{methodname:"block_totara_featured_links_external_remove_tile",args:{tileid:e}}]);f[0].done(function(b){b===!0&&a(d.target).closest(".block-totara-featured-links-layout > div").hide()})},this)})})}}});
define('block_totara_featured_links/audience_dialog', ["jquery","core/ajax","block_totara_featured_links/visibility_form","core/str","core/config","core/templates","core/flex_icon"],function(a,b,c,d,e,f,g){var h,i="",j={},k={ok:"",cancel:"",title:""},l=function(){var b=function(){this.baseurl=""};b.prototype=new totaraDialog_handler_treeview_multiselect,b.prototype.every_load=function(){a("#audience_visible_table").find("[cohortid]").each(function(){var b=a(this).attr("cohortid");l._toggle_items("item_"+b,!1)}),this._make_selectable(a(".treeview",this._container)),this._make_deletable(a(".selected",this._container))},i=j.instanceid;var l=new b;h=l;var m={};m[k.ok]=function(){l._update()},m[k.cancel]=function(){l._cancel()};var n=e.wwwroot+"/totara/cohort/dialog/";new totaraDialog("course-cohorts-visible-dialogue","add_audience_id",{buttons:m,title:k.title},n+"cohort.php?selected="+j.visibleselected+"&instancetype="+j.instancetype+"&instanceid="+j.instanceid+"&sesskey="+j.sesskey,l),b.prototype._update=function(){var b=a(".selected [id^=item]",this._container);b.each(function(){var b=a(this).attr("id").split("_"),e=a(this).find("a").text();b=b[b.length-1],b=parseInt(b),c.audience_list_contains(b)||d.get_string("delete_audience_rule","block_totara_featured_links",e).then(function(a){return g.getIconData("delete","core",{alt:a})}).then(function(a){var c={cohortid:b,name:e,deleteicon:a};return f.render("block_totara_featured_links/element_audience_list_item",c)}).then(function(a){c.add_to_audience_list(a),c.add_to_audience_id(b),c.add_audience_table_listeners()})}),l._dialog.hide()}};return{init:function(b,c,e){j.instancetype=b,j.instanceid=c,j.sesskey=e;var f=[];f.push({key:"ok",component:"moodle"}),f.push({key:"cancel",component:"moodle"}),f.push({key:"audience_add",component:"block_totara_featured_links"}),d.get_strings(f).done(function(b){k={ok:b[0],cancel:b[1],title:b[2]},window.dialogsInited?l():(a.isArray(window.dialoginits)||(window.dialoginits=[]),window.dialoginits.push(l))})}}});
define('block_totara_featured_links/content_form', ["jquery"],function(a){var b=function(){a('[name="type"]').change(function(b){var c=window.location.href;c.match(/type=[^&;]+/)?c=c.replace(/type=[^&;]+/,"type="+encodeURI(a(b.target).val())):c+="&type="+encodeURI(a(b.target).val()),window.location=c})};return{init:b}});
define('block_totara_featured_links/dragndrop', ["jquery","core/ajax","jqueryui"],function(a,b){return a.widget("custom.sortableGrid",a.ui.sortable,{_onRightSide:function(a,b){return this._isOverAxis(b.pageX,a.left+a.width/2,a.width/2)},_mouseDrag:function(b){var c,d,e,f,g=this.options,h=!1;for(this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-b.pageY<g.scrollSensitivity?this.scrollParent[0].scrollTop=h=this.scrollParent[0].scrollTop+g.scrollSpeed:b.pageY-this.overflowOffset.top<g.scrollSensitivity&&(this.scrollParent[0].scrollTop=h=this.scrollParent[0].scrollTop-g.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-b.pageX<g.scrollSensitivity?this.scrollParent[0].scrollLeft=h=this.scrollParent[0].scrollLeft+g.scrollSpeed:b.pageX-this.overflowOffset.left<g.scrollSensitivity&&(this.scrollParent[0].scrollLeft=h=this.scrollParent[0].scrollLeft-g.scrollSpeed)):(b.pageY-this.document.scrollTop()<g.scrollSensitivity?h=this.document.scrollTop(this.document.scrollTop()-g.scrollSpeed):this.window.height()-(b.pageY-this.document.scrollTop())<g.scrollSensitivity&&(h=this.document.scrollTop(this.document.scrollTop()+g.scrollSpeed)),b.pageX-this.document.scrollLeft()<g.scrollSensitivity?h=this.document.scrollLeft(this.document.scrollLeft()-g.scrollSpeed):this.window.width()-(b.pageX-this.document.scrollLeft())<g.scrollSensitivity&&(h=this.document.scrollLeft(this.document.scrollLeft()+g.scrollSpeed))),h!==!1&&a.ui.ddmanager&&!g.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),c=this.items.length-1;c>=0;c--)if(d=this.items[c],e=d.item[0],f=this._intersectsWithPointer(d)){if(this.direction=this._onRightSide(d,b)===!0?"right":"left",this._rearrange(b,d),!this._intersectsWithSides(d))break;this._trigger("change",b,this._uiHash());break}return this._contactContainers(b),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),this._trigger("sort",b,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_rearrange:function(a,b,c,d){c?c[0].appendChild(this.placeholder[0]):b.item[0].parentNode.insertBefore(this.placeholder[0],"left"===this.direction?b.item[0]:b.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var e=this.counter;this._delay(function(){e===this.counter&&this.refreshPositions(!d)})}}),{init:function(){a(".block-totara-featured-links-layout").sortableGrid({cursor:"move",helper:"clone",placeholder:"block-totara-featured-links-placeholder",tolerance:"intersect",items:" > [id^=block-totara-featured-links-tile-]",opacity:.5,update:function(c,d){var e=a(c.target).sortableGrid("toArray");b.call([{methodname:"block_totara_featured_links_external_reorder_tiles",args:{tiles:e}}])},start:function(b,c){c.item.show(),a(".block-totara-featured-links-layout").sortableGrid("option","cursorAt",{left:c.item.width()/2,top:c.item.height()/2})}}).disableSelection()}}});
define('block_totara_featured_links/element_icon_picker', ["jquery","core/templates","core/config","core/str","core/modal_factory","core/modal_events"],function(a,b,c,d,e,f){var g=function(c,g,h){var i=c,j=g,k=a(a('input[name="'+j+'"]')[0]),l=[];l.push({key:"ok",component:"moodle"}),l.push({key:"cancel",component:"moodle"}),l.push({key:"icon_choose_title",component:"block_totara_featured_links"}),l.push({key:"icon_choose",component:"block_totara_featured_links"}),l.push({key:"icon_change",component:"block_totara_featured_links"});var m=d.get_strings(l),n=b.render("block_totara_featured_links/icon_picker_icons",{icons:h});a.when(m,n).done(function(c,d){var g={ok:c[0],cancel:c[1],title:c[2],choose:c[3],change:c[4]};a("#"+i+"_delete").on("click",function(){a(this).hide(),a("#"+i+"_icon").html(""),a('input[name="'+j+'"]').val(""),a("#show-iconPicker-dialog").html(g.choose)}),e.create({type:"CONFIRM",title:g.title,body:d[0]},a("#show-iconPicker-dialog"),{yesstr:g.ok,nostr:g.cancel}).done(function(c){var d=c.getRoot();d.find(".icon-picker-icons .icon-picker-item").on("click",function(){a(".icon-picker-item.selected").removeClass("selected"),a(this).addClass("selected"),a("#icon-picker-selected-icon").html(a(this).attr("data-flex-icon-identifier"))}),d.on(f.shown,function(b){a(".icon-picker-item.selected").removeClass("selected");var c=a('input[name="'+j+'"]').val();a('[data-flex-icon-identifier="'+c+'"]').addClass("selected")}),d.on(f.yes,function(d){var e=a(".selected").attr("data-flex-icon-identifier");e&&(k.val(e),b.renderIcon(e).done(function(b){a("#"+i+"_icon").html(b);var c=a("#"+i+"_delete");c.removeClass("hidden"),c.show(),a("#show-iconPicker-dialog").html(g.change)}),c.hide())})})})};return{init:g}});
define('block_totara_featured_links/icon_sizer', ["jquery"],function(a){var b=function(b){var c=a("#block-totara-featured-links-tile-"+b+" .block-totara-featured-links-icon");c.each(function(b,c){a(d).attr("style","");var d=a(c).find("span.flex-icon"),e=d.height()/d.width(),f=a(c).parent("div").height(),g=a(c).parent("div").width(),h=f>g?g:f,i=1;a(c).hasClass("block-totara-featured-links-icon-small")&&(i=.5),a(c).hasClass("block-totara-featured-links-icon-medium")&&(i=.8),e<1?a(d).attr("style","font-size: "+Math.floor(e*h)*i+"px !important"):a(d).attr("style","font-size: "+Math.floor(1/e*h)*i+"px !important"),a(d).css("height",h*i+"px"),a(d).css("line-height",h*i+"px")})};return{resize:b}});
define('block_totara_featured_links/learning_item_dialog', ["jquery","core/str","core/config"],function(a,b,c){var d="",e="",f={ok:"",cancel:"",title:""},g=function(){var b=c.wwwroot+"/blocks/totara_featured_links/"+e+"_dialog.php?";totaraSingleSelectDialog(e,f.title+d,b,e+"_name_id",e+"-name"),a('input[name="'+e+'_name"]').attr("readonly","readonly")};return{init:function(c,h){e=h,d=c;var i=[];i.push({key:"cancel",component:"moodle"}),i.push({key:e+"_select",component:"block_totara_featured_links"}),b.get_strings(i).done(function(b){f={cancel:b[0],title:b[1]},window.dialogsInited?g():(a.isArray(window.dialoginits)||(window.dialoginits=[]),window.dialoginits.push(g))})}}});
!function(a){"use strict";"function"==typeof define&&define.amd?define('block_totara_featured_links/slick', ["jquery"],a):"undefined"!=typeof exports?module.exports=a(require("jquery")):a(jQuery)}(function(a){"use strict";var b=window.Slick||{};b=function(){function b(b,d){var e,f=this;f.defaults={accessibility:!0,adaptiveHeight:!1,appendArrows:a(b),appendDots:a(b),arrows:!0,asNavFor:null,prevArrow:'<button class="slick-prev" aria-label="Previous" type="button">Previous</button>',nextArrow:'<button class="slick-next" aria-label="Next" type="button">Next</button>',autoplay:!1,autoplaySpeed:3e3,centerMode:!1,centerPadding:"50px",cssEase:"ease",customPaging:function(b,c){return a('<button type="button" />').text(c+1)},dots:!1,dotsClass:"slick-dots",draggable:!0,easing:"linear",edgeFriction:.35,fade:!1,focusOnSelect:!1,focusOnChange:!1,infinite:!0,initialSlide:0,lazyLoad:"ondemand",mobileFirst:!1,pauseOnHover:!0,pauseOnFocus:!0,pauseOnDotsHover:!1,respondTo:"window",responsive:null,rows:1,rtl:!1,slide:"",slidesPerRow:1,slidesToShow:1,slidesToScroll:1,speed:500,swipe:!0,swipeToSlide:!1,touchMove:!0,touchThreshold:5,useCSS:!0,useTransform:!0,variableWidth:!1,vertical:!1,verticalSwiping:!1,waitForAnimate:!0,zIndex:1e3},f.initials={animating:!1,dragging:!1,autoPlayTimer:null,currentDirection:0,currentLeft:null,currentSlide:0,direction:1,$dots:null,listWidth:null,listHeight:null,loadIndex:0,$nextArrow:null,$prevArrow:null,scrolling:!1,slideCount:null,slideWidth:null,$slideTrack:null,$slides:null,sliding:!1,slideOffset:0,swipeLeft:null,swiping:!1,$list:null,touchObject:{},transformsEnabled:!1,unslicked:!1},a.extend(f,f.initials),f.activeBreakpoint=null,f.animType=null,f.animProp=null,f.breakpoints=[],f.breakpointSettings=[],f.cssTransitions=!1,f.focussed=!1,f.interrupted=!1,f.hidden="hidden",f.paused=!0,f.positionProp=null,f.respondTo=null,f.rowCount=1,f.shouldClick=!0,f.$slider=a(b),f.$slidesCache=null,f.transformType=null,f.transitionType=null,f.visibilityChange="visibilitychange",f.windowWidth=0,f.windowTimer=null,e=a(b).data("slick")||{},f.options=a.extend({},f.defaults,d,e),f.currentSlide=f.options.initialSlide,f.originalSettings=f.options,"undefined"!=typeof document.mozHidden?(f.hidden="mozHidden",f.visibilityChange="mozvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(f.hidden="webkitHidden",f.visibilityChange="webkitvisibilitychange"),f.autoPlay=a.proxy(f.autoPlay,f),f.autoPlayClear=a.proxy(f.autoPlayClear,f),f.autoPlayIterator=a.proxy(f.autoPlayIterator,f),f.changeSlide=a.proxy(f.changeSlide,f),f.clickHandler=a.proxy(f.clickHandler,f),f.selectHandler=a.proxy(f.selectHandler,f),f.setPosition=a.proxy(f.setPosition,f),f.swipeHandler=a.proxy(f.swipeHandler,f),f.dragHandler=a.proxy(f.dragHandler,f),f.keyHandler=a.proxy(f.keyHandler,f),f.instanceUid=c++,f.htmlExpr=/^(?:\s*(<[\w\W]+>)[^>]*)$/,f.registerBreakpoints(),f.init(!0)}var c=0;return b}(),b.prototype.activateADA=function(){var a=this;a.$slideTrack.find(".slick-active").attr({"aria-hidden":"false"}).find("a, input, button, select").attr({tabindex:"0"})},b.prototype.addSlide=b.prototype.slickAdd=function(b,c,d){var e=this;if("boolean"==typeof c)d=c,c=null;else if(c<0||c>=e.slideCount)return!1;e.unload(),"number"==typeof c?0===c&&0===e.$slides.length?a(b).appendTo(e.$slideTrack):d?a(b).insertBefore(e.$slides.eq(c)):a(b).insertAfter(e.$slides.eq(c)):d===!0?a(b).prependTo(e.$slideTrack):a(b).appendTo(e.$slideTrack),e.$slides=e.$slideTrack.children(this.options.slide),e.$slideTrack.children(this.options.slide).detach(),e.$slideTrack.append(e.$slides),e.$slides.each(function(b,c){a(c).attr("data-slick-index",b)}),e.$slidesCache=e.$slides,e.reinit()},b.prototype.animateHeight=function(){var a=this;if(1===a.options.slidesToShow&&a.options.adaptiveHeight===!0&&a.options.vertical===!1){var b=a.$slides.eq(a.currentSlide).outerHeight(!0);a.$list.animate({height:b},a.options.speed)}},b.prototype.animateSlide=function(b,c){var d={},e=this;e.animateHeight(),e.options.rtl===!0&&e.options.vertical===!1&&(b=-b),e.transformsEnabled===!1?e.options.vertical===!1?e.$slideTrack.animate({left:b},e.options.speed,e.options.easing,c):e.$slideTrack.animate({top:b},e.options.speed,e.options.easing,c):e.cssTransitions===!1?(e.options.rtl===!0&&(e.currentLeft=-e.currentLeft),a({animStart:e.currentLeft}).animate({animStart:b},{duration:e.options.speed,easing:e.options.easing,step:function(a){a=Math.ceil(a),e.options.vertical===!1?(d[e.animType]="translate("+a+"px, 0px)",e.$slideTrack.css(d)):(d[e.animType]="translate(0px,"+a+"px)",e.$slideTrack.css(d))},complete:function(){c&&c.call()}})):(e.applyTransition(),b=Math.ceil(b),e.options.vertical===!1?d[e.animType]="translate3d("+b+"px, 0px, 0px)":d[e.animType]="translate3d(0px,"+b+"px, 0px)",e.$slideTrack.css(d),c&&setTimeout(function(){e.disableTransition(),c.call()},e.options.speed))},b.prototype.getNavTarget=function(){var b=this,c=b.options.asNavFor;return c&&null!==c&&(c=a(c).not(b.$slider)),c},b.prototype.asNavFor=function(b){var c=this,d=c.getNavTarget();null!==d&&"object"==typeof d&&d.each(function(){var c=a(this).slick("getSlick");c.unslicked||c.slideHandler(b,!0)})},b.prototype.applyTransition=function(a){var b=this,c={};b.options.fade===!1?c[b.transitionType]=b.transformType+" "+b.options.speed+"ms "+b.options.cssEase:c[b.transitionType]="opacity "+b.options.speed+"ms "+b.options.cssEase,b.options.fade===!1?b.$slideTrack.css(c):b.$slides.eq(a).css(c)},b.prototype.autoPlay=function(){var a=this;a.autoPlayClear(),a.slideCount>a.options.slidesToShow&&(a.autoPlayTimer=setInterval(a.autoPlayIterator,a.options.autoplaySpeed))},b.prototype.autoPlayClear=function(){var a=this;a.autoPlayTimer&&clearInterval(a.autoPlayTimer)},b.prototype.autoPlayIterator=function(){var a=this,b=a.currentSlide+a.options.slidesToScroll;a.paused||a.interrupted||a.focussed||(a.options.infinite===!1&&(1===a.direction&&a.currentSlide+1===a.slideCount-1?a.direction=0:0===a.direction&&(b=a.currentSlide-a.options.slidesToScroll,a.currentSlide-1===0&&(a.direction=1))),a.slideHandler(b))},b.prototype.buildArrows=function(){var b=this;b.options.arrows===!0&&(b.$prevArrow=a(b.options.prevArrow).addClass("slick-arrow"),b.$nextArrow=a(b.options.nextArrow).addClass("slick-arrow"),b.slideCount>b.options.slidesToShow?(b.$prevArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex"),b.$nextArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex"),b.htmlExpr.test(b.options.prevArrow)&&b.$prevArrow.prependTo(b.options.appendArrows),b.htmlExpr.test(b.options.nextArrow)&&b.$nextArrow.appendTo(b.options.appendArrows),b.options.infinite!==!0&&b.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true")):b.$prevArrow.add(b.$nextArrow).addClass("slick-hidden").attr({"aria-disabled":"true",tabindex:"-1"}))},b.prototype.buildDots=function(){var b,c,d=this;if(d.options.dots===!0){for(d.$slider.addClass("slick-dotted"),c=a("<ul />").addClass(d.options.dotsClass),b=0;b<=d.getDotCount();b+=1)c.append(a("<li />").append(d.options.customPaging.call(this,d,b)));d.$dots=c.appendTo(d.options.appendDots),d.$dots.find("li").first().addClass("slick-active")}},b.prototype.buildOut=function(){var b=this;b.$slides=b.$slider.children(b.options.slide+":not(.slick-cloned)").addClass("slick-slide"),b.slideCount=b.$slides.length,b.$slides.each(function(b,c){a(c).attr("data-slick-index",b).data("originalStyling",a(c).attr("style")||"")}),b.$slider.addClass("slick-slider"),b.$slideTrack=0===b.slideCount?a('<div class="slick-track"/>').appendTo(b.$slider):b.$slides.wrapAll('<div class="slick-track"/>').parent(),b.$list=b.$slideTrack.wrap('<div class="slick-list"/>').parent(),b.$slideTrack.css("opacity",0),b.options.centerMode!==!0&&b.options.swipeToSlide!==!0||(b.options.slidesToScroll=1),a("img[data-lazy]",b.$slider).not("[src]").addClass("slick-loading"),b.setupInfinite(),b.buildArrows(),b.buildDots(),b.updateDots(),b.setSlideClasses("number"==typeof b.currentSlide?b.currentSlide:0),b.options.draggable===!0&&b.$list.addClass("draggable")},b.prototype.buildRows=function(){var a,b,c,d,e,f,g,h=this;if(d=document.createDocumentFragment(),f=h.$slider.children(),h.options.rows>1){for(g=h.options.slidesPerRow*h.options.rows,e=Math.ceil(f.length/g),a=0;a<e;a++){var i=document.createElement("div");for(b=0;b<h.options.rows;b++){var j=document.createElement("div");for(c=0;c<h.options.slidesPerRow;c++){var k=a*g+(b*h.options.slidesPerRow+c);f.get(k)&&j.appendChild(f.get(k))}i.appendChild(j)}d.appendChild(i)}h.$slider.empty().append(d),h.$slider.children().children().children().css({width:100/h.options.slidesPerRow+"%",display:"inline-block"})}},b.prototype.checkResponsive=function(b,c){var d,e,f,g=this,h=!1,i=g.$slider.width(),j=window.innerWidth||a(window).width();if("window"===g.respondTo?f=j:"slider"===g.respondTo?f=i:"min"===g.respondTo&&(f=Math.min(j,i)),g.options.responsive&&g.options.responsive.length&&null!==g.options.responsive){e=null;for(d in g.breakpoints)g.breakpoints.hasOwnProperty(d)&&(g.originalSettings.mobileFirst===!1?f<g.breakpoints[d]&&(e=g.breakpoints[d]):f>g.breakpoints[d]&&(e=g.breakpoints[d]));null!==e?null!==g.activeBreakpoint?(e!==g.activeBreakpoint||c)&&(g.activeBreakpoint=e,"unslick"===g.breakpointSettings[e]?g.unslick(e):(g.options=a.extend({},g.originalSettings,g.breakpointSettings[e]),b===!0&&(g.currentSlide=g.options.initialSlide),g.refresh(b)),h=e):(g.activeBreakpoint=e,"unslick"===g.breakpointSettings[e]?g.unslick(e):(g.options=a.extend({},g.originalSettings,g.breakpointSettings[e]),b===!0&&(g.currentSlide=g.options.initialSlide),g.refresh(b)),h=e):null!==g.activeBreakpoint&&(g.activeBreakpoint=null,g.options=g.originalSettings,b===!0&&(g.currentSlide=g.options.initialSlide),g.refresh(b),h=e),b||h===!1||g.$slider.trigger("breakpoint",[g,h])}},b.prototype.changeSlide=function(b,c){var d,e,f,g=this,h=a(b.currentTarget);switch(h.is("a")&&b.preventDefault(),h.is("li")||(h=h.closest("li")),f=g.slideCount%g.options.slidesToScroll!==0,d=f?0:(g.slideCount-g.currentSlide)%g.options.slidesToScroll,b.data.message){case"previous":e=0===d?g.options.slidesToScroll:g.options.slidesToShow-d,g.slideCount>g.options.slidesToShow&&g.slideHandler(g.currentSlide-e,!1,c);break;case"next":e=0===d?g.options.slidesToScroll:d,g.slideCount>g.options.slidesToShow&&g.slideHandler(g.currentSlide+e,!1,c);break;case"index":var i=0===b.data.index?0:b.data.index||h.index()*g.options.slidesToScroll;g.slideHandler(g.checkNavigable(i),!1,c),h.children().trigger("focus");break;default:return}},b.prototype.checkNavigable=function(a){var b,c,d=this;if(b=d.getNavigableIndexes(),c=0,a>b[b.length-1])a=b[b.length-1];else for(var e in b){if(a<b[e]){a=c;break}c=b[e]}return a},b.prototype.cleanUpEvents=function(){var b=this;b.options.dots&&null!==b.$dots&&(a("li",b.$dots).off("click.slick",b.changeSlide).off("mouseenter.slick",a.proxy(b.interrupt,b,!0)).off("mouseleave.slick",a.proxy(b.interrupt,b,!1)),b.options.accessibility===!0&&b.$dots.off("keydown.slick",b.keyHandler)),b.$slider.off("focus.slick blur.slick"),b.options.arrows===!0&&b.slideCount>b.options.slidesToShow&&(b.$prevArrow&&b.$prevArrow.off("click.slick",b.changeSlide),b.$nextArrow&&b.$nextArrow.off("click.slick",b.changeSlide),b.options.accessibility===!0&&(b.$prevArrow&&b.$prevArrow.off("keydown.slick",b.keyHandler),b.$nextArrow&&b.$nextArrow.off("keydown.slick",b.keyHandler))),b.$list.off("touchstart.slick mousedown.slick",b.swipeHandler),b.$list.off("touchmove.slick mousemove.slick",b.swipeHandler),b.$list.off("touchend.slick mouseup.slick",b.swipeHandler),b.$list.off("touchcancel.slick mouseleave.slick",b.swipeHandler),b.$list.off("click.slick",b.clickHandler),a(document).off(b.visibilityChange,b.visibility),b.cleanUpSlideEvents(),b.options.accessibility===!0&&b.$list.off("keydown.slick",b.keyHandler),b.options.focusOnSelect===!0&&a(b.$slideTrack).children().off("click.slick",b.selectHandler),a(window).off("orientationchange.slick.slick-"+b.instanceUid,b.orientationChange),a(window).off("resize.slick.slick-"+b.instanceUid,b.resize),a("[draggable!=true]",b.$slideTrack).off("dragstart",b.preventDefault),a(window).off("load.slick.slick-"+b.instanceUid,b.setPosition)},b.prototype.cleanUpSlideEvents=function(){var b=this;b.$list.off("mouseenter.slick",a.proxy(b.interrupt,b,!0)),b.$list.off("mouseleave.slick",a.proxy(b.interrupt,b,!1))},b.prototype.cleanUpRows=function(){var a,b=this;b.options.rows>1&&(a=b.$slides.children().children(),a.removeAttr("style"),b.$slider.empty().append(a))},b.prototype.clickHandler=function(a){var b=this;b.shouldClick===!1&&(a.stopImmediatePropagation(),a.stopPropagation(),a.preventDefault())},b.prototype.destroy=function(b){var c=this;c.autoPlayClear(),c.touchObject={},c.cleanUpEvents(),a(".slick-cloned",c.$slider).detach(),c.$dots&&c.$dots.remove(),c.$prevArrow&&c.$prevArrow.length&&(c.$prevArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display",""),c.htmlExpr.test(c.options.prevArrow)&&c.$prevArrow.remove()),c.$nextArrow&&c.$nextArrow.length&&(c.$nextArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display",""),c.htmlExpr.test(c.options.nextArrow)&&c.$nextArrow.remove()),c.$slides&&(c.$slides.removeClass("slick-slide slick-active slick-center slick-visible slick-current").removeAttr("aria-hidden").removeAttr("data-slick-index").each(function(){a(this).attr("style",a(this).data("originalStyling"))}),c.$slideTrack.children(this.options.slide).detach(),c.$slideTrack.detach(),c.$list.detach(),c.$slider.append(c.$slides)),c.cleanUpRows(),c.$slider.removeClass("slick-slider"),c.$slider.removeClass("slick-initialized"),c.$slider.removeClass("slick-dotted"),c.unslicked=!0,b||c.$slider.trigger("destroy",[c])},b.prototype.disableTransition=function(a){var b=this,c={};c[b.transitionType]="",b.options.fade===!1?b.$slideTrack.css(c):b.$slides.eq(a).css(c)},b.prototype.fadeSlide=function(a,b){var c=this;c.cssTransitions===!1?(c.$slides.eq(a).css({zIndex:c.options.zIndex}),c.$slides.eq(a).animate({opacity:1},c.options.speed,c.options.easing,b)):(c.applyTransition(a),c.$slides.eq(a).css({opacity:1,zIndex:c.options.zIndex}),b&&setTimeout(function(){c.disableTransition(a),b.call()},c.options.speed))},b.prototype.fadeSlideOut=function(a){var b=this;b.cssTransitions===!1?b.$slides.eq(a).animate({opacity:0,zIndex:b.options.zIndex-2},b.options.speed,b.options.easing):(b.applyTransition(a),b.$slides.eq(a).css({opacity:0,zIndex:b.options.zIndex-2}))},b.prototype.filterSlides=b.prototype.slickFilter=function(a){var b=this;null!==a&&(b.$slidesCache=b.$slides,b.unload(),b.$slideTrack.children(this.options.slide).detach(),b.$slidesCache.filter(a).appendTo(b.$slideTrack),b.reinit())},b.prototype.focusHandler=function(){var b=this;b.$slider.off("focus.slick blur.slick").on("focus.slick blur.slick","*",function(c){c.stopImmediatePropagation();var d=a(this);setTimeout(function(){b.options.pauseOnFocus&&(b.focussed=d.is(":focus"),b.autoPlay())},0)})},b.prototype.getCurrent=b.prototype.slickCurrentSlide=function(){var a=this;return a.currentSlide},b.prototype.getDotCount=function(){var a=this,b=0,c=0,d=0;if(a.options.infinite===!0)if(a.slideCount<=a.options.slidesToShow)++d;else for(;b<a.slideCount;)++d,b=c+a.options.slidesToScroll,c+=a.options.slidesToScroll<=a.options.slidesToShow?a.options.slidesToScroll:a.options.slidesToShow;else if(a.options.centerMode===!0)d=a.slideCount;else if(a.options.asNavFor)for(;b<a.slideCount;)++d,b=c+a.options.slidesToScroll,c+=a.options.slidesToScroll<=a.options.slidesToShow?a.options.slidesToScroll:a.options.slidesToShow;else d=1+Math.ceil((a.slideCount-a.options.slidesToShow)/a.options.slidesToScroll);return d-1},b.prototype.getLeft=function(a){var b,c,d,e,f=this,g=0;return f.slideOffset=0,c=f.$slides.first().outerHeight(!0),f.options.infinite===!0?(f.slideCount>f.options.slidesToShow&&(f.slideOffset=f.slideWidth*f.options.slidesToShow*-1,e=-1,f.options.vertical===!0&&f.options.centerMode===!0&&(2===f.options.slidesToShow?e=-1.5:1===f.options.slidesToShow&&(e=-2)),g=c*f.options.slidesToShow*e),f.slideCount%f.options.slidesToScroll!==0&&a+f.options.slidesToScroll>f.slideCount&&f.slideCount>f.options.slidesToShow&&(a>f.slideCount?(f.slideOffset=(f.options.slidesToShow-(a-f.slideCount))*f.slideWidth*-1,g=(f.options.slidesToShow-(a-f.slideCount))*c*-1):(f.slideOffset=f.slideCount%f.options.slidesToScroll*f.slideWidth*-1,g=f.slideCount%f.options.slidesToScroll*c*-1))):a+f.options.slidesToShow>f.slideCount&&(f.slideOffset=(a+f.options.slidesToShow-f.slideCount)*f.slideWidth,g=(a+f.options.slidesToShow-f.slideCount)*c),f.slideCount<=f.options.slidesToShow&&(f.slideOffset=0,g=0),f.options.centerMode===!0&&f.slideCount<=f.options.slidesToShow?f.slideOffset=f.slideWidth*Math.floor(f.options.slidesToShow)/2-f.slideWidth*f.slideCount/2:f.options.centerMode===!0&&f.options.infinite===!0?f.slideOffset+=f.slideWidth*Math.floor(f.options.slidesToShow/2)-f.slideWidth:f.options.centerMode===!0&&(f.slideOffset=0,f.slideOffset+=f.slideWidth*Math.floor(f.options.slidesToShow/2)),b=f.options.vertical===!1?a*f.slideWidth*-1+f.slideOffset:a*c*-1+g,f.options.variableWidth===!0&&(d=f.slideCount<=f.options.slidesToShow||f.options.infinite===!1?f.$slideTrack.children(".slick-slide").eq(a):f.$slideTrack.children(".slick-slide").eq(a+f.options.slidesToShow),b=f.options.rtl===!0?d[0]?(f.$slideTrack.width()-d[0].offsetLeft-d.width())*-1:0:d[0]?d[0].offsetLeft*-1:0,f.options.centerMode===!0&&(d=f.slideCount<=f.options.slidesToShow||f.options.infinite===!1?f.$slideTrack.children(".slick-slide").eq(a):f.$slideTrack.children(".slick-slide").eq(a+f.options.slidesToShow+1),b=f.options.rtl===!0?d[0]?(f.$slideTrack.width()-d[0].offsetLeft-d.width())*-1:0:d[0]?d[0].offsetLeft*-1:0,b+=(f.$list.width()-d.outerWidth())/2)),b},b.prototype.getOption=b.prototype.slickGetOption=function(a){var b=this;return b.options[a]},b.prototype.getNavigableIndexes=function(){var a,b=this,c=0,d=0,e=[];for(b.options.infinite===!1?a=b.slideCount:(c=b.options.slidesToScroll*-1,d=b.options.slidesToScroll*-1,a=2*b.slideCount);c<a;)e.push(c),c=d+b.options.slidesToScroll,d+=b.options.slidesToScroll<=b.options.slidesToShow?b.options.slidesToScroll:b.options.slidesToShow;return e},b.prototype.getSlick=function(){return this},b.prototype.getSlideCount=function(){var b,c,d,e=this;return d=e.options.centerMode===!0?e.slideWidth*Math.floor(e.options.slidesToShow/2):0,e.options.swipeToSlide===!0?(e.$slideTrack.find(".slick-slide").each(function(b,f){if(f.offsetLeft-d+a(f).outerWidth()/2>e.swipeLeft*-1)return c=f,!1}),b=Math.abs(a(c).attr("data-slick-index")-e.currentSlide)||1):e.options.slidesToScroll},b.prototype.goTo=b.prototype.slickGoTo=function(a,b){var c=this;c.changeSlide({data:{message:"index",index:parseInt(a)}},b)},b.prototype.init=function(b){var c=this;a(c.$slider).hasClass("slick-initialized")||(a(c.$slider).addClass("slick-initialized"),c.buildRows(),c.buildOut(),c.setProps(),c.startLoad(),c.loadSlider(),c.initializeEvents(),c.updateArrows(),c.updateDots(),c.checkResponsive(!0),c.focusHandler()),b&&c.$slider.trigger("init",[c]),c.options.accessibility===!0&&c.initADA(),c.options.autoplay&&(c.paused=!1,c.autoPlay())},b.prototype.initADA=function(){var b=this,c=Math.ceil(b.slideCount/b.options.slidesToShow),d=b.getNavigableIndexes().filter(function(a){return a>=0&&a<b.slideCount});b.$slides.add(b.$slideTrack.find(".slick-cloned")).attr({"aria-hidden":"true",tabindex:"-1"}).find("a, input, button, select").attr({tabindex:"-1"}),null!==b.$dots&&(b.$slides.not(b.$slideTrack.find(".slick-cloned")).each(function(c){var e=d.indexOf(c);a(this).attr({role:"tabpanel",id:"slick-slide"+b.instanceUid+c,tabindex:-1}),e!==-1&&a(this).attr({"aria-describedby":"slick-slide-control"+b.instanceUid+e})}),b.$dots.attr("role","tablist").find("li").each(function(e){var f=d[e];a(this).attr({role:"presentation"}),a(this).find("button").first().attr({role:"tab",id:"slick-slide-control"+b.instanceUid+e,"aria-controls":"slick-slide"+b.instanceUid+f,"aria-label":e+1+" of "+c,"aria-selected":null,tabindex:"-1"})}).eq(b.currentSlide).find("button").attr({"aria-selected":"true",tabindex:"0"}).end());for(var e=b.currentSlide,f=e+b.options.slidesToShow;e<f;e++)b.$slides.eq(e).attr("tabindex",0);b.activateADA()},b.prototype.initArrowEvents=function(){var a=this;a.options.arrows===!0&&a.slideCount>a.options.slidesToShow&&(a.$prevArrow.off("click.slick").on("click.slick",{message:"previous"},a.changeSlide),a.$nextArrow.off("click.slick").on("click.slick",{message:"next"},a.changeSlide),a.options.accessibility===!0&&(a.$prevArrow.on("keydown.slick",a.keyHandler),a.$nextArrow.on("keydown.slick",a.keyHandler)))},b.prototype.initDotEvents=function(){var b=this;b.options.dots===!0&&(a("li",b.$dots).on("click.slick",{message:"index"},b.changeSlide),b.options.accessibility===!0&&b.$dots.on("keydown.slick",b.keyHandler)),b.options.dots===!0&&b.options.pauseOnDotsHover===!0&&a("li",b.$dots).on("mouseenter.slick",a.proxy(b.interrupt,b,!0)).on("mouseleave.slick",a.proxy(b.interrupt,b,!1))},b.prototype.initSlideEvents=function(){var b=this;b.options.pauseOnHover&&(b.$list.on("mouseenter.slick",a.proxy(b.interrupt,b,!0)),b.$list.on("mouseleave.slick",a.proxy(b.interrupt,b,!1)))},b.prototype.initializeEvents=function(){var b=this;b.initArrowEvents(),b.initDotEvents(),b.initSlideEvents(),b.$list.on("touchstart.slick mousedown.slick",{action:"start"},b.swipeHandler),b.$list.on("touchmove.slick mousemove.slick",{action:"move"},b.swipeHandler),b.$list.on("touchend.slick mouseup.slick",{action:"end"},b.swipeHandler),b.$list.on("touchcancel.slick mouseleave.slick",{action:"end"},b.swipeHandler),b.$list.on("click.slick",b.clickHandler),a(document).on(b.visibilityChange,a.proxy(b.visibility,b)),b.options.accessibility===!0&&b.$list.on("keydown.slick",b.keyHandler),b.options.focusOnSelect===!0&&a(b.$slideTrack).children().on("click.slick",b.selectHandler),a(window).on("orientationchange.slick.slick-"+b.instanceUid,a.proxy(b.orientationChange,b)),a(window).on("resize.slick.slick-"+b.instanceUid,a.proxy(b.resize,b)),a("[draggable!=true]",b.$slideTrack).on("dragstart",b.preventDefault),a(window).on("load.slick.slick-"+b.instanceUid,b.setPosition),a(b.setPosition)},b.prototype.initUI=function(){var a=this;a.options.arrows===!0&&a.slideCount>a.options.slidesToShow&&(a.$prevArrow.show(),a.$nextArrow.show()),a.options.dots===!0&&a.slideCount>a.options.slidesToShow&&a.$dots.show()},b.prototype.keyHandler=function(a){var b=this;a.target.tagName.match("TEXTAREA|INPUT|SELECT")||(37===a.keyCode&&b.options.accessibility===!0?b.changeSlide({data:{message:b.options.rtl===!0?"next":"previous"}}):39===a.keyCode&&b.options.accessibility===!0&&b.changeSlide({data:{message:b.options.rtl===!0?"previous":"next"}}))},b.prototype.lazyLoad=function(){function b(b){a("img[data-lazy]",b).each(function(){var b=a(this),c=a(this).attr("data-lazy"),d=a(this).attr("data-srcset"),e=a(this).attr("data-sizes")||g.$slider.attr("data-sizes"),f=document.createElement("img");f.onload=function(){b.animate({opacity:0},100,function(){d&&(b.attr("srcset",d),e&&b.attr("sizes",e)),b.attr("src",c).animate({opacity:1},200,function(){b.removeAttr("data-lazy data-srcset data-sizes").removeClass("slick-loading")}),g.$slider.trigger("lazyLoaded",[g,b,c])})},f.onerror=function(){b.removeAttr("data-lazy").removeClass("slick-loading").addClass("slick-lazyload-error"),g.$slider.trigger("lazyLoadError",[g,b,c])},f.src=c})}var c,d,e,f,g=this;if(g.options.centerMode===!0?g.options.infinite===!0?(e=g.currentSlide+(g.options.slidesToShow/2+1),f=e+g.options.slidesToShow+2):(e=Math.max(0,g.currentSlide-(g.options.slidesToShow/2+1)),f=2+(g.options.slidesToShow/2+1)+g.currentSlide):(e=g.options.infinite?g.options.slidesToShow+g.currentSlide:g.currentSlide,f=Math.ceil(e+g.options.slidesToShow),g.options.fade===!0&&(e>0&&e--,f<=g.slideCount&&f++)),c=g.$slider.find(".slick-slide").slice(e,f),"anticipated"===g.options.lazyLoad)for(var h=e-1,i=f,j=g.$slider.find(".slick-slide"),k=0;k<g.options.slidesToScroll;k++)h<0&&(h=g.slideCount-1),c=c.add(j.eq(h)),c=c.add(j.eq(i)),h--,i++;b(c),g.slideCount<=g.options.slidesToShow?(d=g.$slider.find(".slick-slide"),b(d)):g.currentSlide>=g.slideCount-g.options.slidesToShow?(d=g.$slider.find(".slick-cloned").slice(0,g.options.slidesToShow),b(d)):0===g.currentSlide&&(d=g.$slider.find(".slick-cloned").slice(g.options.slidesToShow*-1),b(d))},b.prototype.loadSlider=function(){var a=this;a.setPosition(),a.$slideTrack.css({opacity:1}),a.$slider.removeClass("slick-loading"),a.initUI(),"progressive"===a.options.lazyLoad&&a.progressiveLazyLoad()},b.prototype.next=b.prototype.slickNext=function(){var a=this;a.changeSlide({data:{message:"next"}})},b.prototype.orientationChange=function(){var a=this;a.checkResponsive(),a.setPosition()},b.prototype.pause=b.prototype.slickPause=function(){var a=this;a.autoPlayClear(),a.paused=!0},b.prototype.play=b.prototype.slickPlay=function(){var a=this;a.autoPlay(),a.options.autoplay=!0,a.paused=!1,a.focussed=!1,a.interrupted=!1},b.prototype.postSlide=function(b){var c=this;if(!c.unslicked&&(c.$slider.trigger("afterChange",[c,b]),c.animating=!1,c.slideCount>c.options.slidesToShow&&c.setPosition(),c.swipeLeft=null,c.options.autoplay&&c.autoPlay(),c.options.accessibility===!0&&(c.initADA(),c.options.focusOnChange))){var d=a(c.$slides.get(c.currentSlide));d.attr("tabindex",0).focus()}},b.prototype.prev=b.prototype.slickPrev=function(){var a=this;a.changeSlide({data:{message:"previous"}})},b.prototype.preventDefault=function(a){a.preventDefault()},b.prototype.progressiveLazyLoad=function(b){b=b||1;var c,d,e,f,g,h=this,i=a("img[data-lazy]",h.$slider);i.length?(c=i.first(),d=c.attr("data-lazy"),e=c.attr("data-srcset"),f=c.attr("data-sizes")||h.$slider.attr("data-sizes"),g=document.createElement("img"),g.onload=function(){e&&(c.attr("srcset",e),f&&c.attr("sizes",f)),c.attr("src",d).removeAttr("data-lazy data-srcset data-sizes").removeClass("slick-loading"),h.options.adaptiveHeight===!0&&h.setPosition(),h.$slider.trigger("lazyLoaded",[h,c,d]),h.progressiveLazyLoad()},g.onerror=function(){b<3?setTimeout(function(){h.progressiveLazyLoad(b+1)},500):(c.removeAttr("data-lazy").removeClass("slick-loading").addClass("slick-lazyload-error"),h.$slider.trigger("lazyLoadError",[h,c,d]),h.progressiveLazyLoad())},g.src=d):h.$slider.trigger("allImagesLoaded",[h])},b.prototype.refresh=function(b){var c,d,e=this;d=e.slideCount-e.options.slidesToShow,!e.options.infinite&&e.currentSlide>d&&(e.currentSlide=d),e.slideCount<=e.options.slidesToShow&&(e.currentSlide=0),c=e.currentSlide,e.destroy(!0),a.extend(e,e.initials,{currentSlide:c}),e.init(),b||e.changeSlide({data:{message:"index",index:c}},!1)},b.prototype.registerBreakpoints=function(){var b,c,d,e=this,f=e.options.responsive||null;if("array"===a.type(f)&&f.length){e.respondTo=e.options.respondTo||"window";for(b in f)if(d=e.breakpoints.length-1,f.hasOwnProperty(b)){for(c=f[b].breakpoint;d>=0;)e.breakpoints[d]&&e.breakpoints[d]===c&&e.breakpoints.splice(d,1),d--;e.breakpoints.push(c),e.breakpointSettings[c]=f[b].settings}e.breakpoints.sort(function(a,b){return e.options.mobileFirst?a-b:b-a})}},b.prototype.reinit=function(){var b=this;b.$slides=b.$slideTrack.children(b.options.slide).addClass("slick-slide"),b.slideCount=b.$slides.length,b.currentSlide>=b.slideCount&&0!==b.currentSlide&&(b.currentSlide=b.currentSlide-b.options.slidesToScroll),b.slideCount<=b.options.slidesToShow&&(b.currentSlide=0),b.registerBreakpoints(),b.setProps(),b.setupInfinite(),b.buildArrows(),b.updateArrows(),b.initArrowEvents(),b.buildDots(),b.updateDots(),b.initDotEvents(),b.cleanUpSlideEvents(),b.initSlideEvents(),b.checkResponsive(!1,!0),b.options.focusOnSelect===!0&&a(b.$slideTrack).children().on("click.slick",b.selectHandler),b.setSlideClasses("number"==typeof b.currentSlide?b.currentSlide:0),b.setPosition(),b.focusHandler(),b.paused=!b.options.autoplay,b.autoPlay(),b.$slider.trigger("reInit",[b])},b.prototype.resize=function(){var b=this;a(window).width()!==b.windowWidth&&(clearTimeout(b.windowDelay),b.windowDelay=window.setTimeout(function(){b.windowWidth=a(window).width(),b.checkResponsive(),b.unslicked||b.setPosition()},50))},b.prototype.removeSlide=b.prototype.slickRemove=function(a,b,c){var d=this;return"boolean"==typeof a?(b=a,a=b===!0?0:d.slideCount-1):a=b===!0?--a:a,!(d.slideCount<1||a<0||a>d.slideCount-1)&&(d.unload(),c===!0?d.$slideTrack.children().remove():d.$slideTrack.children(this.options.slide).eq(a).remove(),d.$slides=d.$slideTrack.children(this.options.slide),d.$slideTrack.children(this.options.slide).detach(),d.$slideTrack.append(d.$slides),d.$slidesCache=d.$slides,void d.reinit())},b.prototype.setCSS=function(a){var b,c,d=this,e={};d.options.rtl===!0&&(a=-a),b="left"==d.positionProp?Math.ceil(a)+"px":"0px",c="top"==d.positionProp?Math.ceil(a)+"px":"0px",e[d.positionProp]=a,d.transformsEnabled===!1?d.$slideTrack.css(e):(e={},d.cssTransitions===!1?(e[d.animType]="translate("+b+", "+c+")",d.$slideTrack.css(e)):(e[d.animType]="translate3d("+b+", "+c+", 0px)",d.$slideTrack.css(e)))},b.prototype.setDimensions=function(){var a=this;a.options.vertical===!1?a.options.centerMode===!0&&a.$list.css({padding:"0px "+a.options.centerPadding}):(a.$list.height(a.$slides.first().outerHeight(!0)*a.options.slidesToShow),a.options.centerMode===!0&&a.$list.css({padding:a.options.centerPadding+" 0px"})),a.listWidth=a.$list.width(),a.listHeight=a.$list.height(),a.options.vertical===!1&&a.options.variableWidth===!1?(a.slideWidth=Math.ceil(a.listWidth/a.options.slidesToShow),a.$slideTrack.width(Math.ceil(a.slideWidth*a.$slideTrack.children(".slick-slide").length))):a.options.variableWidth===!0?a.$slideTrack.width(5e3*a.slideCount):(a.slideWidth=Math.ceil(a.listWidth),a.$slideTrack.height(Math.ceil(a.$slides.first().outerHeight(!0)*a.$slideTrack.children(".slick-slide").length)));var b=a.$slides.first().outerWidth(!0)-a.$slides.first().width();a.options.variableWidth===!1&&a.$slideTrack.children(".slick-slide").width(a.slideWidth-b)},b.prototype.setFade=function(){var b,c=this;c.$slides.each(function(d,e){b=c.slideWidth*d*-1,c.options.rtl===!0?a(e).css({position:"relative",right:b,top:0,zIndex:c.options.zIndex-2,opacity:0}):a(e).css({position:"relative",left:b,top:0,zIndex:c.options.zIndex-2,opacity:0})}),c.$slides.eq(c.currentSlide).css({zIndex:c.options.zIndex-1,opacity:1})},b.prototype.setHeight=function(){var a=this;if(1===a.options.slidesToShow&&a.options.adaptiveHeight===!0&&a.options.vertical===!1){var b=a.$slides.eq(a.currentSlide).outerHeight(!0);a.$list.css("height",b)}},b.prototype.setOption=b.prototype.slickSetOption=function(){var b,c,d,e,f,g=this,h=!1;if("object"===a.type(arguments[0])?(d=arguments[0],h=arguments[1],f="multiple"):"string"===a.type(arguments[0])&&(d=arguments[0],e=arguments[1],h=arguments[2],"responsive"===arguments[0]&&"array"===a.type(arguments[1])?f="responsive":"undefined"!=typeof arguments[1]&&(f="single")),"single"===f)g.options[d]=e;else if("multiple"===f)a.each(d,function(a,b){g.options[a]=b});else if("responsive"===f)for(c in e)if("array"!==a.type(g.options.responsive))g.options.responsive=[e[c]];else{for(b=g.options.responsive.length-1;b>=0;)g.options.responsive[b].breakpoint===e[c].breakpoint&&g.options.responsive.splice(b,1),b--;g.options.responsive.push(e[c])}h&&(g.unload(),g.reinit())},b.prototype.setPosition=function(){var a=this;a.setDimensions(),a.setHeight(),a.options.fade===!1?a.setCSS(a.getLeft(a.currentSlide)):a.setFade(),a.$slider.trigger("setPosition",[a])},b.prototype.setProps=function(){var a=this,b=document.body.style;a.positionProp=a.options.vertical===!0?"top":"left","top"===a.positionProp?a.$slider.addClass("slick-vertical"):a.$slider.removeClass("slick-vertical"),void 0===b.WebkitTransition&&void 0===b.MozTransition&&void 0===b.msTransition||a.options.useCSS===!0&&(a.cssTransitions=!0),a.options.fade&&("number"==typeof a.options.zIndex?a.options.zIndex<3&&(a.options.zIndex=3):a.options.zIndex=a.defaults.zIndex),
void 0!==b.OTransform&&(a.animType="OTransform",a.transformType="-o-transform",a.transitionType="OTransition",void 0===b.perspectiveProperty&&void 0===b.webkitPerspective&&(a.animType=!1)),void 0!==b.MozTransform&&(a.animType="MozTransform",a.transformType="-moz-transform",a.transitionType="MozTransition",void 0===b.perspectiveProperty&&void 0===b.MozPerspective&&(a.animType=!1)),void 0!==b.webkitTransform&&(a.animType="webkitTransform",a.transformType="-webkit-transform",a.transitionType="webkitTransition",void 0===b.perspectiveProperty&&void 0===b.webkitPerspective&&(a.animType=!1)),void 0!==b.msTransform&&(a.animType="msTransform",a.transformType="-ms-transform",a.transitionType="msTransition",void 0===b.msTransform&&(a.animType=!1)),void 0!==b.transform&&a.animType!==!1&&(a.animType="transform",a.transformType="transform",a.transitionType="transition"),a.transformsEnabled=a.options.useTransform&&null!==a.animType&&a.animType!==!1},b.prototype.setSlideClasses=function(a){var b,c,d,e,f=this;if(c=f.$slider.find(".slick-slide").removeClass("slick-active slick-center slick-current").attr("aria-hidden","true"),f.$slides.eq(a).addClass("slick-current"),f.options.centerMode===!0){var g=f.options.slidesToShow%2===0?1:0;b=Math.floor(f.options.slidesToShow/2),f.options.infinite===!0&&(a>=b&&a<=f.slideCount-1-b?f.$slides.slice(a-b+g,a+b+1).addClass("slick-active").attr("aria-hidden","false"):(d=f.options.slidesToShow+a,c.slice(d-b+1+g,d+b+2).addClass("slick-active").attr("aria-hidden","false")),0===a?c.eq(c.length-1-f.options.slidesToShow).addClass("slick-center"):a===f.slideCount-1&&c.eq(f.options.slidesToShow).addClass("slick-center")),f.$slides.eq(a).addClass("slick-center")}else a>=0&&a<=f.slideCount-f.options.slidesToShow?f.$slides.slice(a,a+f.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false"):c.length<=f.options.slidesToShow?c.addClass("slick-active").attr("aria-hidden","false"):(e=f.slideCount%f.options.slidesToShow,d=f.options.infinite===!0?f.options.slidesToShow+a:a,f.options.slidesToShow==f.options.slidesToScroll&&f.slideCount-a<f.options.slidesToShow?c.slice(d-(f.options.slidesToShow-e),d+e).addClass("slick-active").attr("aria-hidden","false"):c.slice(d,d+f.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false"));"ondemand"!==f.options.lazyLoad&&"anticipated"!==f.options.lazyLoad||f.lazyLoad()},b.prototype.setupInfinite=function(){var b,c,d,e=this;if(e.options.fade===!0&&(e.options.centerMode=!1),e.options.infinite===!0&&e.options.fade===!1&&(c=null,e.slideCount>e.options.slidesToShow)){for(d=e.options.centerMode===!0?e.options.slidesToShow+1:e.options.slidesToShow,b=e.slideCount;b>e.slideCount-d;b-=1)c=b-1,a(e.$slides[c]).clone(!0).attr("id","").attr("data-slick-index",c-e.slideCount).prependTo(e.$slideTrack).addClass("slick-cloned");for(b=0;b<d+e.slideCount;b+=1)c=b,a(e.$slides[c]).clone(!0).attr("id","").attr("data-slick-index",c+e.slideCount).appendTo(e.$slideTrack).addClass("slick-cloned");e.$slideTrack.find(".slick-cloned").find("[id]").each(function(){a(this).attr("id","")})}},b.prototype.interrupt=function(a){var b=this;a||b.autoPlay(),b.interrupted=a},b.prototype.selectHandler=function(b){var c=this,d=a(b.target).is(".slick-slide")?a(b.target):a(b.target).parents(".slick-slide"),e=parseInt(d.attr("data-slick-index"));return e||(e=0),c.slideCount<=c.options.slidesToShow?void c.slideHandler(e,!1,!0):void c.slideHandler(e)},b.prototype.slideHandler=function(a,b,c){var d,e,f,g,h,i=null,j=this;if(b=b||!1,!(j.animating===!0&&j.options.waitForAnimate===!0||j.options.fade===!0&&j.currentSlide===a))return b===!1&&j.asNavFor(a),d=a,i=j.getLeft(d),g=j.getLeft(j.currentSlide),j.currentLeft=null===j.swipeLeft?g:j.swipeLeft,j.options.infinite===!1&&j.options.centerMode===!1&&(a<0||a>j.getDotCount()*j.options.slidesToScroll)?void(j.options.fade===!1&&(d=j.currentSlide,c!==!0?j.animateSlide(g,function(){j.postSlide(d)}):j.postSlide(d))):j.options.infinite===!1&&j.options.centerMode===!0&&(a<0||a>j.slideCount-j.options.slidesToScroll)?void(j.options.fade===!1&&(d=j.currentSlide,c!==!0?j.animateSlide(g,function(){j.postSlide(d)}):j.postSlide(d))):(j.options.autoplay&&clearInterval(j.autoPlayTimer),e=d<0?j.slideCount%j.options.slidesToScroll!==0?j.slideCount-j.slideCount%j.options.slidesToScroll:j.slideCount+d:d>=j.slideCount?j.slideCount%j.options.slidesToScroll!==0?0:d-j.slideCount:d,j.animating=!0,j.$slider.trigger("beforeChange",[j,j.currentSlide,e]),f=j.currentSlide,j.currentSlide=e,j.setSlideClasses(j.currentSlide),j.options.asNavFor&&(h=j.getNavTarget(),h=h.slick("getSlick"),h.slideCount<=h.options.slidesToShow&&h.setSlideClasses(j.currentSlide)),j.updateDots(),j.updateArrows(),j.options.fade===!0?(c!==!0?(j.fadeSlideOut(f),j.fadeSlide(e,function(){j.postSlide(e)})):j.postSlide(e),void j.animateHeight()):void(c!==!0?j.animateSlide(i,function(){j.postSlide(e)}):j.postSlide(e)))},b.prototype.startLoad=function(){var a=this;a.options.arrows===!0&&a.slideCount>a.options.slidesToShow&&(a.$prevArrow.hide(),a.$nextArrow.hide()),a.options.dots===!0&&a.slideCount>a.options.slidesToShow&&a.$dots.hide(),a.$slider.addClass("slick-loading")},b.prototype.swipeDirection=function(){var a,b,c,d,e=this;return a=e.touchObject.startX-e.touchObject.curX,b=e.touchObject.startY-e.touchObject.curY,c=Math.atan2(b,a),d=Math.round(180*c/Math.PI),d<0&&(d=360-Math.abs(d)),d<=45&&d>=0?e.options.rtl===!1?"left":"right":d<=360&&d>=315?e.options.rtl===!1?"left":"right":d>=135&&d<=225?e.options.rtl===!1?"right":"left":e.options.verticalSwiping===!0?d>=35&&d<=135?"down":"up":"vertical"},b.prototype.swipeEnd=function(a){var b,c,d=this;if(d.dragging=!1,d.swiping=!1,d.scrolling)return d.scrolling=!1,!1;if(d.interrupted=!1,d.shouldClick=!(d.touchObject.swipeLength>10),void 0===d.touchObject.curX)return!1;if(d.touchObject.edgeHit===!0&&d.$slider.trigger("edge",[d,d.swipeDirection()]),d.touchObject.swipeLength>=d.touchObject.minSwipe){switch(c=d.swipeDirection()){case"left":case"down":b=d.options.swipeToSlide?d.checkNavigable(d.currentSlide+d.getSlideCount()):d.currentSlide+d.getSlideCount(),d.currentDirection=0;break;case"right":case"up":b=d.options.swipeToSlide?d.checkNavigable(d.currentSlide-d.getSlideCount()):d.currentSlide-d.getSlideCount(),d.currentDirection=1}"vertical"!=c&&(d.slideHandler(b),d.touchObject={},d.$slider.trigger("swipe",[d,c]))}else d.touchObject.startX!==d.touchObject.curX&&(d.slideHandler(d.currentSlide),d.touchObject={})},b.prototype.swipeHandler=function(a){var b=this;if(!(b.options.swipe===!1||"ontouchend"in document&&b.options.swipe===!1||b.options.draggable===!1&&a.type.indexOf("mouse")!==-1))switch(b.touchObject.fingerCount=a.originalEvent&&void 0!==a.originalEvent.touches?a.originalEvent.touches.length:1,b.touchObject.minSwipe=b.listWidth/b.options.touchThreshold,b.options.verticalSwiping===!0&&(b.touchObject.minSwipe=b.listHeight/b.options.touchThreshold),a.data.action){case"start":b.swipeStart(a);break;case"move":b.swipeMove(a);break;case"end":b.swipeEnd(a)}},b.prototype.swipeMove=function(a){var b,c,d,e,f,g,h=this;return f=void 0!==a.originalEvent?a.originalEvent.touches:null,!(!h.dragging||h.scrolling||f&&1!==f.length)&&(b=h.getLeft(h.currentSlide),h.touchObject.curX=void 0!==f?f[0].pageX:a.clientX,h.touchObject.curY=void 0!==f?f[0].pageY:a.clientY,h.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(h.touchObject.curX-h.touchObject.startX,2))),g=Math.round(Math.sqrt(Math.pow(h.touchObject.curY-h.touchObject.startY,2))),!h.options.verticalSwiping&&!h.swiping&&g>4?(h.scrolling=!0,!1):(h.options.verticalSwiping===!0&&(h.touchObject.swipeLength=g),c=h.swipeDirection(),void 0!==a.originalEvent&&h.touchObject.swipeLength>4&&(h.swiping=!0,a.preventDefault()),e=(h.options.rtl===!1?1:-1)*(h.touchObject.curX>h.touchObject.startX?1:-1),h.options.verticalSwiping===!0&&(e=h.touchObject.curY>h.touchObject.startY?1:-1),d=h.touchObject.swipeLength,h.touchObject.edgeHit=!1,h.options.infinite===!1&&(0===h.currentSlide&&"right"===c||h.currentSlide>=h.getDotCount()&&"left"===c)&&(d=h.touchObject.swipeLength*h.options.edgeFriction,h.touchObject.edgeHit=!0),h.options.vertical===!1?h.swipeLeft=b+d*e:h.swipeLeft=b+d*(h.$list.height()/h.listWidth)*e,h.options.verticalSwiping===!0&&(h.swipeLeft=b+d*e),h.options.fade!==!0&&h.options.touchMove!==!1&&(h.animating===!0?(h.swipeLeft=null,!1):void h.setCSS(h.swipeLeft))))},b.prototype.swipeStart=function(a){var b,c=this;return c.interrupted=!0,1!==c.touchObject.fingerCount||c.slideCount<=c.options.slidesToShow?(c.touchObject={},!1):(void 0!==a.originalEvent&&void 0!==a.originalEvent.touches&&(b=a.originalEvent.touches[0]),c.touchObject.startX=c.touchObject.curX=void 0!==b?b.pageX:a.clientX,c.touchObject.startY=c.touchObject.curY=void 0!==b?b.pageY:a.clientY,void(c.dragging=!0))},b.prototype.unfilterSlides=b.prototype.slickUnfilter=function(){var a=this;null!==a.$slidesCache&&(a.unload(),a.$slideTrack.children(this.options.slide).detach(),a.$slidesCache.appendTo(a.$slideTrack),a.reinit())},b.prototype.unload=function(){var b=this;a(".slick-cloned",b.$slider).remove(),b.$dots&&b.$dots.remove(),b.$prevArrow&&b.htmlExpr.test(b.options.prevArrow)&&b.$prevArrow.remove(),b.$nextArrow&&b.htmlExpr.test(b.options.nextArrow)&&b.$nextArrow.remove(),b.$slides.removeClass("slick-slide slick-active slick-visible slick-current").attr("aria-hidden","true").css("width","")},b.prototype.unslick=function(a){var b=this;b.$slider.trigger("unslick",[b,a]),b.destroy()},b.prototype.updateArrows=function(){var a,b=this;a=Math.floor(b.options.slidesToShow/2),b.options.arrows===!0&&b.slideCount>b.options.slidesToShow&&!b.options.infinite&&(b.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false"),b.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false"),0===b.currentSlide?(b.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true"),b.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false")):b.currentSlide>=b.slideCount-b.options.slidesToShow&&b.options.centerMode===!1?(b.$nextArrow.addClass("slick-disabled").attr("aria-disabled","true"),b.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false")):b.currentSlide>=b.slideCount-1&&b.options.centerMode===!0&&(b.$nextArrow.addClass("slick-disabled").attr("aria-disabled","true"),b.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false")))},b.prototype.updateDots=function(){var a=this;null!==a.$dots&&(a.$dots.find("li").removeClass("slick-active").end(),a.$dots.find("li").eq(Math.floor(a.currentSlide/a.options.slidesToScroll)).addClass("slick-active"))},b.prototype.visibility=function(){var a=this;a.options.autoplay&&(document[a.hidden]?a.interrupted=!0:a.interrupted=!1)},a.fn.slick=function(){var a,c,d=this,e=arguments[0],f=Array.prototype.slice.call(arguments,1),g=d.length;for(a=0;a<g;a++)if("object"==typeof e||"undefined"==typeof e?d[a].slick=new b(d[a],e):c=d[a].slick[e].apply(d[a].slick,f),"undefined"!=typeof c)return c;return d}});
define('block_totara_featured_links/spectrum', ["jquery","core/str"],function(a,b){"use strict";function c(b,c,d,e){for(var f=[],g=0;g<b.length;g++){var h=b[g];if(h){var i=tinycolor(h),j=i.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";j+=tinycolor.equals(c,h)?" sp-thumb-active":"";var k=i.toString(e.preferredFormat||"rgb"),l=q?"background-color:"+i.toRgbString():"filter:"+i.toFilter();f.push('<span title="'+k+'" data-color="'+i.toRgbString()+'" class="'+j+'"><span class="sp-thumb-inner" style="'+l+';" /></span>')}else{var m="sp-clear-display";f.push(a("<div />").append(a('<span data-color="" style="background-color:transparent;" class="'+m+'"></span>').attr("title",e.noColorSelectedText)).html())}}return"<div class='sp-cf "+d+"'>"+f.join("")+"</div>"}function d(){for(var a=0;a<o.length;a++)o[a]&&o[a].hide()}function e(b,c){var d=a.extend({},n,b);return d.callbacks={move:j(d.move,c),change:j(d.change,c),show:j(d.show,c),hide:j(d.hide,c),beforeShow:j(d.beforeShow,c)},d}function f(f,h){function j(){if(U.showPaletteOnly&&(U.showPalette=!0),Ma.text(U.showPaletteOnly?U.togglePaletteMoreText:U.togglePaletteLessText),U.palette){na=U.palette.slice(0),oa=a.isArray(na[0])?na:[na],pa={};for(var b=0;b<oa.length;b++)for(var c=0;c<oa[b].length;c++){var d=tinycolor(oa[b][c]).toRgbString();pa[d]=!0}}xa.toggleClass("sp-flat",V),xa.toggleClass("sp-input-disabled",!U.showInput),xa.toggleClass("sp-alpha-enabled",U.showAlpha),xa.toggleClass("sp-clear-enabled",Ya),xa.toggleClass("sp-buttons-disabled",!U.showButtons),xa.toggleClass("sp-palette-buttons-disabled",!U.togglePaletteOnly),xa.toggleClass("sp-palette-disabled",!U.showPalette),xa.toggleClass("sp-palette-only",U.showPaletteOnly),xa.toggleClass("sp-initial-disabled",!U.showInitial),xa.addClass(U.className).addClass(U.containerClassName),O()}function n(){function c(b){return b.data&&b.data.ignore?(H(a(b.target).closest(".sp-thumb-el").data("color")),K()):(H(a(b.target).closest(".sp-thumb-el").data("color")),K(),N(!0),U.hideAfterPaletteSelect&&F()),!1}if(p&&xa.find("*:not(input)").attr("unselectable","on"),j(),Pa&&va.after(Qa).hide(),Ya||Ka.hide(),V)va.after(xa).hide();else{var d="parent"===U.appendTo?va.parent():a(U.appendTo);1!==d.length&&(d=a("body")),d.append(xa)}t(),Ra.bind("click.spectrum touchstart.spectrum",function(b){wa||B(),b.stopPropagation(),a(b.target).is("input")||b.preventDefault()}),(va.is(":disabled")||U.disabled===!0)&&S(),xa.click(i),Ga.change(A),Ga.bind("paste",function(){setTimeout(A,1)}),Ga.keydown(function(a){13==a.keyCode&&A()}),Ja.text(U.cancelText),Ja.bind("click.spectrum",function(a){a.stopPropagation(),a.preventDefault(),G(),F()}),Ka.attr("title",U.clearText),Ka.bind("click.spectrum",function(a){a.stopPropagation(),a.preventDefault(),Xa=!0,K(),V&&N(!0)}),La.text(U.chooseText),La.bind("click.spectrum",function(a){a.stopPropagation(),a.preventDefault(),p&&Ga.is(":focus")&&Ga.trigger("change"),J()&&(N(!0),F())}),b.get_strings([{key:"cancel",component:"moodle"},{key:"choose",component:"moodle"}]).done(function(a){Ja.text(a[0]),La.text(a[1])}),Ma.text(U.showPaletteOnly?U.togglePaletteMoreText:U.togglePaletteLessText),Ma.bind("click.spectrum",function(a){a.stopPropagation(),a.preventDefault(),U.showPaletteOnly=!U.showPaletteOnly,U.showPaletteOnly||V||xa.css("left","-="+(ya.outerWidth(!0)+5)),j()}),k(Ea,function(a,b,c){ma=a/ga,Xa=!1,c.shiftKey&&(ma=Math.round(10*ma)/10),K()},y,z),k(Ba,function(a,b){ja=parseFloat(b/ea),Xa=!1,U.showAlpha||(ma=1),K()},y,z),k(za,function(a,b,c){if(c.shiftKey){if(!ta){var d=ka*ba,e=ca-la*ca,f=Math.abs(a-d)>Math.abs(b-e);ta=f?"x":"y"}}else ta=null;var g=!ta||"x"===ta,h=!ta||"y"===ta;g&&(ka=parseFloat(a/ba)),h&&(la=parseFloat((ca-b)/ca)),Xa=!1,U.showAlpha||(ma=1),K()},y,z),Ta?(H(Ta),L(),Va=U.preferredFormat||tinycolor(Ta).format,u(Ta)):L(),V&&C();var e=p?"mousedown.spectrum":"click.spectrum touchstart.spectrum";Ha.delegate(".sp-thumb-el",e,c),Ia.delegate(".sp-thumb-el:nth-child(1)",e,{ignore:!0},c)}function t(){if(X&&window.localStorage){try{var b=window.localStorage[X].split(",#");b.length>1&&(delete window.localStorage[X],a.each(b,function(a,b){u(b)}))}catch(c){}try{qa=window.localStorage[X].split(";")}catch(c){}}}function u(b){if(W){var c=tinycolor(b).toRgbString();if(!pa[c]&&a.inArray(c,qa)===-1)for(qa.push(c);qa.length>ra;)qa.shift();if(X&&window.localStorage)try{window.localStorage[X]=qa.join(";")}catch(d){}}}function v(){var a=[];if(U.showPalette)for(var b=0;b<qa.length;b++){var c=tinycolor(qa[b]).toRgbString();pa[c]||a.push(qa[b])}return a.reverse().slice(0,U.maxSelectionSize)}function w(){var b=I(),d=a.map(oa,function(a,d){return c(a,b,"sp-palette-row sp-palette-row-"+d,U)});t(),qa&&d.push(c(v(),b,"sp-palette-row sp-palette-row-selection",U)),Ha.html(d.join(""))}function x(){if(U.showInitial){var a=Ua,b=I();Ia.html(c([a,b],b,"sp-palette-row-initial",U))}}function y(){(ca<=0||ba<=0||ea<=0)&&O(),aa=!0,xa.addClass(sa),ta=null,va.trigger("dragstart.spectrum",[I()])}function z(){aa=!1,xa.removeClass(sa),va.trigger("dragstop.spectrum",[I()])}function A(){var a=Ga.val();if(null!==a&&""!==a||!Ya){var b=tinycolor(a);b.isValid()?(H(b),N(!0)):Ga.addClass("sp-validation-error")}else H(null),N(!0)}function B(){_?F():C()}function C(){var b=a.Event("beforeShow.spectrum");return _?void O():(va.trigger(b,[I()]),void(Z.beforeShow(I())===!1||b.isDefaultPrevented()||(d(),_=!0,a(ua).bind("keydown.spectrum",D),a(ua).bind("click.spectrum",E),a(window).bind("resize.spectrum",$),Qa.addClass("sp-active"),xa.removeClass("sp-hidden"),O(),L(),Ua=I(),x(),Z.show(Ua),va.trigger("show.spectrum",[Ua]))))}function D(a){27===a.keyCode&&F()}function E(a){2!=a.button&&(aa||(Wa?N(!0):G(),F()))}function F(){_&&!V&&(_=!1,a(ua).unbind("keydown.spectrum",D),a(ua).unbind("click.spectrum",E),a(window).unbind("resize.spectrum",$),Qa.removeClass("sp-active"),xa.addClass("sp-hidden"),Z.hide(I()),va.trigger("hide.spectrum",[I()]))}function G(){H(Ua,!0)}function H(a,b){if(tinycolor.equals(a,I()))return void L();var c,d;!a&&Ya?Xa=!0:(Xa=!1,c=tinycolor(a),d=c.toHsv(),ja=d.h%360/360,ka=d.s,la=d.v,ma=d.a),L(),c&&c.isValid()&&!b&&(Va=U.preferredFormat||c.getFormat())}function I(a){return a=a||{},Ya&&Xa?null:tinycolor.fromRatio({h:ja,s:ka,v:la,a:Math.round(100*ma)/100},{format:a.format||Va})}function J(){return!Ga.hasClass("sp-validation-error")}function K(){L(),Z.move(I()),va.trigger("move.spectrum",[I()])}function L(){Ga.removeClass("sp-validation-error"),M();var a=tinycolor.fromRatio({h:ja,s:1,v:1});za.css("background-color",a.toHexString());var b=Va;ma<1&&(0!==ma||"name"!==b)&&("hex"!==b&&"hex3"!==b&&"hex6"!==b&&"name"!==b||(b="rgb"));var c=I({format:b}),d="";if(Sa.removeClass("sp-clear-display"),Sa.css("background-color","transparent"),!c&&Ya)Sa.addClass("sp-clear-display");else{var e=c.toHexString(),f=c.toRgbString();if(q||1===c.alpha?Sa.css("background-color",f):(Sa.css("background-color","transparent"),Sa.css("filter",c.toFilter())),U.showAlpha){var g=c.toRgb();g.a=0;var h=tinycolor(g).toRgbString(),i="linear-gradient(left, "+h+", "+e+")";p?Da.css("filter",tinycolor(h).toFilter({gradientType:1},e)):(Da.css("background","-webkit-"+i),Da.css("background","-moz-"+i),Da.css("background","-ms-"+i),Da.css("background","linear-gradient(to right, "+h+", "+e+")"))}d=c.toString(b)}U.showInput&&Ga.val(d),U.showPalette&&w(),x()}function M(){var a=ka,b=la;if(Ya&&Xa)Fa.hide(),Ca.hide(),Aa.hide();else{Fa.show(),Ca.show(),Aa.show();var c=a*ba,d=ca-b*ca;c=Math.max(-da,Math.min(ba-da,c-da)),d=Math.max(-da,Math.min(ca-da,d-da)),Aa.css({top:d+"px",left:c+"px"});var e=ma*ga;Fa.css({left:e-ha/2+"px"});var f=ja*ea;Ca.css({top:f-ia+"px"})}}function N(a){var b=I(),c="",d=!tinycolor.equals(b,Ua);b&&(c=b.toString(Va),u(b)),Na&&va.val(c),a&&d&&(Z.change(b),va.trigger("change",[b]))}function O(){_&&(ba=za.width(),ca=za.height(),da=Aa.height(),fa=Ba.width(),ea=Ba.height(),ia=Ca.height(),ga=Ea.width(),ha=Fa.width(),V||(xa.css("position","absolute"),U.offset?xa.offset(U.offset):xa.offset(g(xa,Ra))),M(),U.showPalette&&w(),va.trigger("reflow.spectrum"))}function P(){va.show(),Ra.unbind("click.spectrum touchstart.spectrum"),xa.remove(),Qa.remove(),o[Za.id]=null}function Q(b,c){return void 0===b?a.extend({},U):void 0===c?U[b]:(U[b]=c,"preferredFormat"===b&&(Va=U.preferredFormat),void j())}function R(){wa=!1,va.attr("disabled",!1),Ra.removeClass("sp-disabled")}function S(){F(),wa=!0,va.attr("disabled",!0),Ra.addClass("sp-disabled")}function T(a){U.offset=a,O()}var U=e(h,f),V=U.flat,W=U.showSelectionPalette,X=U.localStorageKey,Y=U.theme,Z=U.callbacks,$=l(O,10),_=!1,aa=!1,ba=0,ca=0,da=0,ea=0,fa=0,ga=0,ha=0,ia=0,ja=0,ka=0,la=0,ma=1,na=[],oa=[],pa={},qa=U.selectionPalette.slice(0),ra=U.maxSelectionSize,sa="sp-dragging",ta=null,ua=f.ownerDocument,va=(ua.body,a(f)),wa=!1,xa=a(s,ua).addClass(Y),ya=xa.find(".sp-picker-container"),za=xa.find(".sp-color"),Aa=xa.find(".sp-dragger"),Ba=xa.find(".sp-hue"),Ca=xa.find(".sp-slider"),Da=xa.find(".sp-alpha-inner"),Ea=xa.find(".sp-alpha"),Fa=xa.find(".sp-alpha-handle"),Ga=xa.find(".sp-input"),Ha=xa.find(".sp-palette"),Ia=xa.find(".sp-initial"),Ja=xa.find(".sp-cancel"),Ka=xa.find(".sp-clear"),La=xa.find(".sp-choose"),Ma=xa.find(".sp-palette-toggle"),Na=va.is("input"),Oa=Na&&"color"===va.attr("type")&&m(),Pa=Na&&!V,Qa=Pa?a(r).addClass(Y).addClass(U.className).addClass(U.replacerClassName):a([]),Ra=Pa?Qa:va,Sa=Qa.find(".sp-preview-inner"),Ta=U.color||Na&&va.val(),Ua=!1,Va=U.preferredFormat,Wa=!U.showButtons||U.clickoutFiresChange,Xa=!Ta,Ya=U.allowEmpty&&!Oa;n();var Za={show:C,hide:F,toggle:B,reflow:O,option:Q,enable:R,disable:S,offset:T,set:function(a){H(a),N()},get:I,destroy:P,container:xa};return Za.id=o.push(Za)-1,Za}function g(b,c){var d=0,e=b.outerWidth(),f=b.outerHeight(),g=c.outerHeight(),h=b[0].ownerDocument,i=h.documentElement,j=i.clientWidth+a(h).scrollLeft(),k=i.clientHeight+a(h).scrollTop(),l=c.offset();return l.top+=g,l.left-=Math.min(l.left,l.left+e>j&&j>e?Math.abs(l.left+e-j):0),l.top-=Math.min(l.top,l.top+f>k&&k>f?Math.abs(f+g-d):d),l}function h(){}function i(a){a.stopPropagation()}function j(a,b){var c=Array.prototype.slice,d=c.call(arguments,2);return function(){return a.apply(b,d.concat(c.call(arguments)))}}function k(b,c,d,e){function f(a){a.stopPropagation&&a.stopPropagation(),a.preventDefault&&a.preventDefault(),a.returnValue=!1}function g(a){if(k){if(p&&j.documentMode<9&&!a.button)return i();var d=a.originalEvent&&a.originalEvent.touches&&a.originalEvent.touches[0],e=d&&d.pageX||a.pageX,g=d&&d.pageY||a.pageY,h=Math.max(0,Math.min(e-l.left,n)),q=Math.max(0,Math.min(g-l.top,m));o&&f(a),c.apply(b,[h,q,a])}}function h(c){var e=c.which?3==c.which:2==c.button;e||k||d.apply(b,arguments)!==!1&&(k=!0,m=a(b).height(),n=a(b).width(),l=a(b).offset(),a(j).bind(q),a(j.body).addClass("sp-dragging"),g(c),f(c))}function i(){k&&(a(j).unbind(q),a(j.body).removeClass("sp-dragging"),setTimeout(function(){e.apply(b,arguments)},0)),k=!1}c=c||function(){},d=d||function(){},e=e||function(){};var j=document,k=!1,l={},m=0,n=0,o="ontouchstart"in window,q={};q.selectstart=f,q.dragstart=f,q["touchmove mousemove"]=g,q["touchend mouseup"]=i,a(b).bind("touchstart mousedown",h)}function l(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,a.apply(e,f)};c&&clearTimeout(d),!c&&d||(d=setTimeout(g,b))}}function m(){return a.fn.spectrum.inputTypeColorSupport()}var n={beforeShow:h,move:h,change:h,show:h,hide:h,color:!1,flat:!1,showInput:!0,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!0,showInitial:!1,showPalette:!1,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"",chooseText:"",togglePaletteMoreText:"",togglePaletteLessText:"",clearText:"",noColorSelectedText:"",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:!1,offset:null},o=[],p=!!/msie/i.exec(window.navigator.userAgent),q=function(){function a(a,b){return!!~(""+a).indexOf(b)}var b=document.createElement("div"),c=b.style;return c.cssText="background-color:rgba(0,0,0,.5)",a(c.backgroundColor,"rgba")||a(c.backgroundColor,"hsla")}(),r=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),s=function(){var a="";if(p)for(var b=1;b<=6;b++)a+="<div class='sp-"+b+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",a,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}(),t="spectrum.id";return a.fn.spectrum=function(b,c){if("string"==typeof b){var d=this,e=Array.prototype.slice.call(arguments,1);return this.each(function(){var c=o[a(this).data(t)];if(c){var f=c[b];if(!f)throw new Error("Spectrum: no such method: '"+b+"'");"get"==b?d=c.get():"container"==b?d=c.container:"option"==b?d=c.option.apply(c,e):"destroy"==b?(c.destroy(),a(this).removeData(t)):f.apply(c,e)}}),d}return this.spectrum("destroy").each(function(){var c=a.extend({},b,a(this).data()),d=f(this,c);a(this).data(t,d.id)})},a.fn.spectrum.load=!0,a.fn.spectrum.loadOpts={},a.fn.spectrum.draggable=k,a.fn.spectrum.defaults=n,a.fn.spectrum.inputTypeColorSupport=function u(){if("undefined"==typeof u._cachedResult){var b=a("<input type='color'/>")[0];u._cachedResult="color"===b.type&&""!==b.value}return u._cachedResult},a.spectrum={},a.spectrum.localization={},a.spectrum.palettes={},a.fn.spectrum.processNativeColorInputs=function(){var b=a("input[type=color]");b.length&&!m()&&b.spectrum({preferredFormat:"hex6"})},function(){function a(a){var c={r:0,g:0,b:0},e=1,g=!1,h=!1;return"string"==typeof a&&(a=G(a)),"object"==typeof a&&(a.hasOwnProperty("r")&&a.hasOwnProperty("g")&&a.hasOwnProperty("b")?(c=b(a.r,a.g,a.b),g=!0,h="%"===String(a.r).substr(-1)?"prgb":"rgb"):a.hasOwnProperty("h")&&a.hasOwnProperty("s")&&a.hasOwnProperty("v")?(a.s=D(a.s),a.v=D(a.v),c=f(a.h,a.s,a.v),g=!0,h="hsv"):a.hasOwnProperty("h")&&a.hasOwnProperty("s")&&a.hasOwnProperty("l")&&(a.s=D(a.s),a.l=D(a.l),c=d(a.h,a.s,a.l),g=!0,h="hsl"),a.hasOwnProperty("a")&&(e=a.a)),e=w(e),{ok:g,format:a.format||h,r:M(255,N(c.r,0)),g:M(255,N(c.g,0)),b:M(255,N(c.b,0)),a:e}}function b(a,b,c){return{r:255*x(a,255),g:255*x(b,255),b:255*x(c,255)}}function c(a,b,c){a=x(a,255),b=x(b,255),c=x(c,255);var d,e,f=N(a,b,c),g=M(a,b,c),h=(f+g)/2;if(f==g)d=e=0;else{var i=f-g;switch(e=h>.5?i/(2-f-g):i/(f+g),f){case a:d=(b-c)/i+(b<c?6:0);break;case b:d=(c-a)/i+2;break;case c:d=(a-b)/i+4}d/=6}return{h:d,s:e,l:h}}function d(a,b,c){function d(a,b,c){return c<0&&(c+=1),c>1&&(c-=1),c<1/6?a+6*(b-a)*c:c<.5?b:c<2/3?a+(b-a)*(2/3-c)*6:a}var e,f,g;if(a=x(a,360),b=x(b,100),c=x(c,100),0===b)e=f=g=c;else{var h=c<.5?c*(1+b):c+b-c*b,i=2*c-h;e=d(i,h,a+1/3),f=d(i,h,a),g=d(i,h,a-1/3)}return{r:255*e,g:255*f,b:255*g}}function e(a,b,c){a=x(a,255),b=x(b,255),c=x(c,255);var d,e,f=N(a,b,c),g=M(a,b,c),h=f,i=f-g;if(e=0===f?0:i/f,f==g)d=0;else{switch(f){case a:d=(b-c)/i+(b<c?6:0);break;case b:d=(c-a)/i+2;break;case c:d=(a-b)/i+4}d/=6}return{h:d,s:e,v:h}}function f(a,b,c){a=6*x(a,360),b=x(b,100),c=x(c,100);var d=K.floor(a),e=a-d,f=c*(1-b),g=c*(1-e*b),h=c*(1-(1-e)*b),i=d%6,j=[c,g,f,f,h,c][i],k=[h,c,c,g,f,f][i],l=[f,f,h,c,c,g][i];return{r:255*j,g:255*k,b:255*l}}function g(a,b,c,d){var e=[C(L(a).toString(16)),C(L(b).toString(16)),C(L(c).toString(16))];return d&&e[0].charAt(0)==e[0].charAt(1)&&e[1].charAt(0)==e[1].charAt(1)&&e[2].charAt(0)==e[2].charAt(1)?e[0].charAt(0)+e[1].charAt(0)+e[2].charAt(0):e.join("")}function h(a,b,c,d){var e=[C(E(d)),C(L(a).toString(16)),C(L(b).toString(16)),C(L(c).toString(16))];return e.join("")}function i(a,b){b=0===b?0:b||10;var c=P(a).toHsl();return c.s-=b/100,c.s=y(c.s),P(c)}function j(a,b){b=0===b?0:b||10;var c=P(a).toHsl();return c.s+=b/100,c.s=y(c.s),P(c)}function k(a){return P(a).desaturate(100)}function l(a,b){b=0===b?0:b||10;var c=P(a).toHsl();return c.l+=b/100,c.l=y(c.l),P(c)}function m(a,b){b=0===b?0:b||10;var c=P(a).toRgb();return c.r=N(0,M(255,c.r-L(255*-(b/100)))),c.g=N(0,M(255,c.g-L(255*-(b/100)))),c.b=N(0,M(255,c.b-L(255*-(b/100)))),P(c)}function n(a,b){b=0===b?0:b||10;var c=P(a).toHsl();return c.l-=b/100,c.l=y(c.l),P(c)}function o(a,b){var c=P(a).toHsl(),d=(L(c.h)+b)%360;return c.h=d<0?360+d:d,P(c)}function p(a){var b=P(a).toHsl();return b.h=(b.h+180)%360,P(b)}function q(a){var b=P(a).toHsl(),c=b.h;return[P(a),P({h:(c+120)%360,s:b.s,l:b.l}),P({h:(c+240)%360,s:b.s,l:b.l})]}function r(a){var b=P(a).toHsl(),c=b.h;return[P(a),P({h:(c+90)%360,s:b.s,l:b.l}),P({h:(c+180)%360,s:b.s,l:b.l}),P({h:(c+270)%360,s:b.s,l:b.l})]}function s(a){var b=P(a).toHsl(),c=b.h;return[P(a),P({h:(c+72)%360,s:b.s,l:b.l}),P({h:(c+216)%360,s:b.s,l:b.l})]}function t(a,b,c){b=b||6,c=c||30;var d=P(a).toHsl(),e=360/c,f=[P(a)];for(d.h=(d.h-(e*b>>1)+720)%360;--b;)d.h=(d.h+e)%360,f.push(P(d));return f}function u(a,b){b=b||6;for(var c=P(a).toHsv(),d=c.h,e=c.s,f=c.v,g=[],h=1/b;b--;)g.push(P({h:d,s:e,v:f})),f=(f+h)%1;return g}function v(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[a[c]]=c);return b}function w(a){return a=parseFloat(a),(isNaN(a)||a<0||a>1)&&(a=1),a}function x(a,b){A(a)&&(a="100%");var c=B(a);return a=M(b,N(0,parseFloat(a))),c&&(a=parseInt(a*b,10)/100),K.abs(a-b)<1e-6?1:a%b/parseFloat(b)}function y(a){return M(1,N(0,a))}function z(a){return parseInt(a,16)}function A(a){return"string"==typeof a&&a.indexOf(".")!=-1&&1===parseFloat(a)}function B(a){return"string"==typeof a&&a.indexOf("%")!=-1}function C(a){return 1==a.length?"0"+a:""+a}function D(a){return a<=1&&(a=100*a+"%"),a}function E(a){return Math.round(255*parseFloat(a)).toString(16)}function F(a){return z(a)/255}function G(a){a=a.replace(H,"").replace(I,"").toLowerCase();var b=!1;if(Q[a])a=Q[a],b=!0;else if("transparent"==a)return{r:0,g:0,b:0,a:0,format:"name"};var c;return(c=S.rgb.exec(a))?{r:c[1],g:c[2],b:c[3]}:(c=S.rgba.exec(a))?{r:c[1],g:c[2],b:c[3],a:c[4]}:(c=S.hsl.exec(a))?{h:c[1],s:c[2],l:c[3]}:(c=S.hsla.exec(a))?{h:c[1],s:c[2],l:c[3],a:c[4]}:(c=S.hsv.exec(a))?{h:c[1],s:c[2],v:c[3]}:(c=S.hsva.exec(a))?{h:c[1],s:c[2],v:c[3],a:c[4]}:(c=S.hex8.exec(a))?{a:F(c[1]),r:z(c[2]),g:z(c[3]),b:z(c[4]),format:b?"name":"hex8"}:(c=S.hex6.exec(a))?{r:z(c[1]),g:z(c[2]),b:z(c[3]),format:b?"name":"hex"}:!!(c=S.hex3.exec(a))&&{r:z(c[1]+""+c[1]),g:z(c[2]+""+c[2]),b:z(c[3]+""+c[3]),format:b?"name":"hex"}}var H=/^[\s,#]+/,I=/\s+$/,J=0,K=Math,L=K.round,M=K.min,N=K.max,O=K.random,P=function(b,c){if(b=b?b:"",c=c||{},b instanceof P)return b;if(!(this instanceof P))return new P(b,c);var d=a(b);this._originalInput=b,this._r=d.r,this._g=d.g,this._b=d.b,this._a=d.a,this._roundA=L(100*this._a)/100,this._format=c.format||d.format,this._gradientType=c.gradientType,this._r<1&&(this._r=L(this._r)),this._g<1&&(this._g=L(this._g)),this._b<1&&(this._b=L(this._b)),this._ok=d.ok,this._tc_id=J++};P.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var a=this.toRgb();return(299*a.r+587*a.g+114*a.b)/1e3},setAlpha:function(a){return this._a=w(a),this._roundA=L(100*this._a)/100,this},toHsv:function(){var a=e(this._r,this._g,this._b);return{h:360*a.h,s:a.s,v:a.v,a:this._a}},toHsvString:function(){var a=e(this._r,this._g,this._b),b=L(360*a.h),c=L(100*a.s),d=L(100*a.v);return 1==this._a?"hsv("+b+", "+c+"%, "+d+"%)":"hsva("+b+", "+c+"%, "+d+"%, "+this._roundA+")"},toHsl:function(){var a=c(this._r,this._g,this._b);return{h:360*a.h,s:a.s,l:a.l,a:this._a}},toHslString:function(){var a=c(this._r,this._g,this._b),b=L(360*a.h),d=L(100*a.s),e=L(100*a.l);return 1==this._a?"hsl("+b+", "+d+"%, "+e+"%)":"hsla("+b+", "+d+"%, "+e+"%, "+this._roundA+")"},toHex:function(a){return g(this._r,this._g,this._b,a)},toHexString:function(a){return"#"+this.toHex(a)},toHex8:function(){return h(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:L(this._r),g:L(this._g),b:L(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+L(this._r)+", "+L(this._g)+", "+L(this._b)+")":"rgba("+L(this._r)+", "+L(this._g)+", "+L(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:L(100*x(this._r,255))+"%",g:L(100*x(this._g,255))+"%",b:L(100*x(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+L(100*x(this._r,255))+"%, "+L(100*x(this._g,255))+"%, "+L(100*x(this._b,255))+"%)":"rgba("+L(100*x(this._r,255))+"%, "+L(100*x(this._g,255))+"%, "+L(100*x(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(R[g(this._r,this._g,this._b,!0)]||!1)},toFilter:function(a){var b="#"+h(this._r,this._g,this._b,this._a),c=b,d=this._gradientType?"GradientType = 1, ":"";if(a){var e=P(a);c=e.toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+d+"startColorstr="+b+",endColorstr="+c+")"},toString:function(a){var b=!!a;a=a||this._format;var c=!1,d=this._a<1&&this._a>=0,e=!b&&d&&("hex"===a||"hex6"===a||"hex3"===a||"name"===a);return e?"name"===a&&0===this._a?this.toName():this.toRgbString():("rgb"===a&&(c=this.toRgbString()),"prgb"===a&&(c=this.toPercentageRgbString()),"hex"!==a&&"hex6"!==a||(c=this.toHexString()),"hex3"===a&&(c=this.toHexString(!0)),"hex8"===a&&(c=this.toHex8String()),"name"===a&&(c=this.toName()),"hsl"===a&&(c=this.toHslString()),"hsv"===a&&(c=this.toHsvString()),c||this.toHexString())},_applyModification:function(a,b){var c=a.apply(null,[this].concat([].slice.call(b)));return this._r=c._r,this._g=c._g,this._b=c._b,this.setAlpha(c._a),this},lighten:function(){return this._applyModification(l,arguments)},brighten:function(){return this._applyModification(m,arguments)},darken:function(){return this._applyModification(n,arguments)},desaturate:function(){return this._applyModification(i,arguments)},saturate:function(){return this._applyModification(j,arguments)},greyscale:function(){return this._applyModification(k,arguments)},spin:function(){return this._applyModification(o,arguments)},_applyCombination:function(a,b){return a.apply(null,[this].concat([].slice.call(b)))},analogous:function(){return this._applyCombination(t,arguments)},complement:function(){return this._applyCombination(p,arguments)},monochromatic:function(){return this._applyCombination(u,arguments)},splitcomplement:function(){return this._applyCombination(s,arguments)},triad:function(){return this._applyCombination(q,arguments)},tetrad:function(){return this._applyCombination(r,arguments)}},P.fromRatio=function(a,b){if("object"==typeof a){var c={};for(var d in a)a.hasOwnProperty(d)&&("a"===d?c[d]=a[d]:c[d]=D(a[d]));a=c}return P(a,b)},P.equals=function(a,b){return!(!a||!b)&&P(a).toRgbString()==P(b).toRgbString()},P.random=function(){return P.fromRatio({r:O(),g:O(),b:O()})},P.mix=function(a,b,c){c=0===c?0:c||50;var d,e=P(a).toRgb(),f=P(b).toRgb(),g=c/100,h=2*g-1,i=f.a-e.a;d=h*i==-1?h:(h+i)/(1+h*i),d=(d+1)/2;var j=1-d,k={r:f.r*d+e.r*j,g:f.g*d+e.g*j,b:f.b*d+e.b*j,a:f.a*g+e.a*(1-g)};return P(k)},P.readability=function(a,b){var c=P(a),d=P(b),e=c.toRgb(),f=d.toRgb(),g=c.getBrightness(),h=d.getBrightness(),i=Math.max(e.r,f.r)-Math.min(e.r,f.r)+Math.max(e.g,f.g)-Math.min(e.g,f.g)+Math.max(e.b,f.b)-Math.min(e.b,f.b);return{brightness:Math.abs(g-h),color:i}},P.isReadable=function(a,b){var c=P.readability(a,b);return c.brightness>125&&c.color>500},P.mostReadable=function(a,b){for(var c=null,d=0,e=!1,f=0;f<b.length;f++){var g=P.readability(a,b[f]),h=g.brightness>125&&g.color>500,i=3*(g.brightness/125)+g.color/500;(h&&!e||h&&e&&i>d||!h&&!e&&i>d)&&(e=h,d=i,c=P(b[f]))}return c};var Q=P.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},R=P.hexNames=v(Q),S=function(){var a="[-\\+]?\\d+%?",b="[-\\+]?\\d*\\.\\d+%?",c="(?:"+b+")|(?:"+a+")",d="[\\s|\\(]+("+c+")[,|\\s]+("+c+")[,|\\s]+("+c+")\\s*\\)?",e="[\\s|\\(]+("+c+")[,|\\s]+("+c+")[,|\\s]+("+c+")[,|\\s]+("+c+")\\s*\\)?";return{rgb:new RegExp("rgb"+d),rgba:new RegExp("rgba"+e),hsl:new RegExp("hsl"+d),hsla:new RegExp("hsla"+e),hsv:new RegExp("hsv"+d),hsva:new RegExp("hsva"+e),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();window.tinycolor=P}(),a(function(){a.fn.spectrum.load&&a.fn.spectrum.processNativeColorInputs()}),{spectrum:a}});
define('block_totara_featured_links/switcher', ["jquery","core/templates","block_totara_featured_links/slick"],function(a,b){return{init:function(c,d,e,f,g,h,i,j){var k=b.renderIcon("caret-left","Previous","slick-prev"),l=b.renderIcon("caret-right","Next","slick-next"),m="fade"===e,n=g.indexOf("position_indicator")!==-1,o=g.indexOf("arrows")!==-1;a.when(k,l).then(function(b,e){var g=a("#"+d);if(g.slick({autoplay:"1"===h,autoplaySpeed:c,prevArrow:b,nextArrow:e,fade:m,dots:n,rtl:"rtl"===document.dir,arrows:o,infinite:"1"===i,pauseOnHover:"1"===j}),"random"===f&&"1"===h){var k=g.slick("getSlick").slideCount,l=0;g.slick("pause"),window.setInterval(function(){var a=Math.floor(Math.random()*(k-1));a>=l&&(a+=1),g.slick("slickGoTo",a,!1),l=a},c)}})}}});
define('block_totara_featured_links/visibility_form', ["jquery"],function(a){var b,c=["audience_showing","preset_showing","tile_rules_showing"],d=function(b){var d=0;a.each(c,function(c,e){a("#tfiid_"+e+"_"+b).is(":checked")&&d++}),a("#tfiid_audience_showing_"+b).length||d++,d>=2?a('[data-element-id="tfiid_aggregation'+b+'"]').each(function(b,c){a(c).removeAttr("data-hidden")}):a('[data-element-id="tfiid_aggregation'+b+'"]').each(function(b,c){a(c).attr("data-hidden","")})},e=function(){a("[data-type=cohort_delete]").each(function(b,c){a(c).off("click"),a(c).click(function(b){a(b.target).closest("li").remove();var c=a(b.target).closest("a").attr("cohortid"),d=a('input[name="audiences_visible"]'),e=d.val().split(",");e.indexOf(c)!=-1&&e.splice(e.indexOf(c),1),d.val(e.join()),d.change()})})};return{init:function(f){b=f,a.each(c,function(b,c){a("#tfiid_"+c+"_"+f).on("change",function(){d(f)})}),a("#tfiid_visibility_"+f).on("change",function(){"2"!=a("input[name=visibility]:checked","#tfiid_visibility_"+f).val()?a('[data-element-id="tfiid_aggregation'+f+'"]').each(function(b,c){a(c).attr("data-hidden","")}):(d(f),e())}),e(),"2"!=a("input[name=visibility]:checked","#tfiid_visibility_"+f).val()?a('[data-element-id="tfiid_aggregation'+f+'"]').each(function(b,c){a(c).attr("data-hidden","")}):d(f)},add_audience_table_listeners:e,add_to_audience_id:function(b){if(0!==b.length){var c=a('input[name="audiences_visible"]');c.val(c.val()+(0===c.val().length?"":",")+b),c.change()}},add_to_audience_list:function(b){a("#audience_visible_table").append(b)},audience_list_contains:function(b){return a("#audience_visible_table").find('span[cohortid="'+b+'"]').length}}});
define('block_totara_program_completion/block', ["jquery","core/str"],function(a,b){var c={init:function(c){var d=[];d.push({key:"more",component:"block_totara_program_completion"}),d.push({key:"less",component:"block_totara_program_completion"}),b.get_strings(d).done(function(b){for(var e=[],f=0;f<d.length;f++)e[d[f].key]=b[f];a(".block-totara-prog-completion-morelink"+c).on("click",function(b){b.preventDefault(),a(".block-prog-completions-list .more"+c).toggle(),a(this).text()==e.more?a(this).text(e.less):a(this).text(e.more)})})}};return c});
define('block_totara_program_completion/edit', ["jquery","core/config","core/str"],function(a,b,c){var d={blockid:null,programsselected:null,init:function(e,f){var g=a.Deferred(),h=this;d.blockid=e,d.programsselected=f,window.dialogsInited?g.resolve():(window.dialoginits instanceof Array||(window.dialoginits=[]),window.dialoginits.push(function(){g.resolve()}));var i=[];i.push({key:"save",component:"totara_core"}),i.push({key:"cancel",component:"moodle"}),i.push({key:"addprograms",component:"block_totara_program_completion"}),a.when(c.get_strings(i),g).done(function(a){for(var c=[],e=0;e<i.length;e++)c[i[e].key]=a[e];var f=b.wwwroot+"/blocks/totara_program_completion/",g=h._createDialog(),j=new g;j.baseurl=f;var k={};k[c.save]=function(){j._update()},k[c.cancel]=function(){j._cancel()},totaraDialogs.addblockprograms=new totaraDialog("addblockprograms","add-block-programs-dialog",{buttons:k,title:"<h2>"+c.addprograms+"</h2>"},f+"findprograms.php?selected="+d.programsselected+"&blockid="+d.blockid+"&sesskey="+b.sesskey,j)})},_createDialog:function(){var c=function(){this.baseurl="",this.program_items=a('input:hidden[name="config_programids"]').val(),this.program_items=this.program_items&&this.program_items.length>0?this.program_items.split(","):[],this.program_table=a("#block-programs-table"),this.add_program_delete_event_handlers(),this.check_table_hidden_status()};return c.prototype=new totaraDialog_handler_treeview_multiselect,c.prototype._update=function(c){var d=this,e=a(".selected > div > span",this._container),f=this._get_ids(e),g=f.join(","),h=this._dialog.default_url.split("selected="),i=h[1].slice(h[1].indexOf("&"));this._dialog.default_url=h[0]+"selected="+g+i;var j=[];if(a(f).each(function(a,b){d.program_item_exists(b)||(j.push(b),d.add_program_item(b))}),j.length>0){this._dialog.showLoading();var k=b.wwwroot+"/blocks/totara_program_completion/program_item.php?itemid="+j.join(",")+i;a.getJSON(k,function(b){return b.error?(d._dialog.hide(),void alert(b.error)):(a.each(b.items,function(a,b){d.create_item(b)}),void d._dialog.hide())})}else this._dialog.hide()},c.prototype.program_item_exists=function(a){for(var b in this.program_items)if(this.program_items[b]==a)return!0;return!1},c.prototype.check_table_hidden_status=function(){0==this.program_items.length?a(this.program_table).hide():a(this.program_table).show()},c.prototype.add_program_delete_event_handlers=function(){a(".blockprogramdeletelink",this.program_table).unbind("click");var b=this;this.program_table.on("click",".blockprogramdeletelink",function(a){a.preventDefault(),b.remove_program_item(this)})},c.prototype.add_program_item=function(b){this.program_items.push(b),a('input:hidden[name="config_programids"]').val(this.program_items.join(",")),this.check_table_hidden_status()},c.prototype.create_item=function(b){var c=a(b);this.program_table.append(c)},c.prototype.remove_program_item=function(b){var c=a(b).closest("li"),d=c.data("progid");this.program_items=a.grep(this.program_items,function(a,b){return a==d},!0),c.remove(),this.check_table_hidden_status(),a('input:hidden[name="config_programids"]').val(this.program_items.join(","));var e=this._dialog.default_url.split("selected="),f=e[1].slice(e[1].indexOf("&"));this._dialog.default_url=e[0]+"selected="+this.program_items.join(",")+f},c}};return d});
define('block_totara_recently_viewed/resize_blocks', ["jquery"],function(a){var b=function(b){var c="#inst"+b;if(0!==a(c).find(".block-totara-recently-viewed.block-trv-tiles").length){var d,e=function(){clearTimeout(d),d=setTimeout(function(){var b=a("#region-main, #block-region-top, #block-region-bottom").find(c+":first");if(0!==b.length&&!b.is(".hidden")){var d=b.width(),e=Math.floor(d/214);e||(e=1);var f=100/e;1===e?b.find(".block-trv-layout-horizontal").addClass("block-trv-layout-horizontal-single"):b.find(".block-trv-layout-horizontal").removeClass("block-trv-layout-horizontal-single"),b.find("li.block-trv-card-li").css("width",f+"%")}},200)};e(),M.core.dock&&M.core.dock.get?(M.core.dock.get().on("dock:itemschanged",e),M.core.dock.get().on("dock:resizepanelcomplete",e),M.core.dock.get().on("dock:initialised",e)):a("body").one("click",".moveto",function(){setTimeout(function(){M.core.dock&&M.core.dock.get&&(M.core.dock.get().on("dock:itemschanged",e),M.core.dock.get().on("dock:resizepanelcomplete",e),M.core.dock.get().on("dock:initialised",e))},200)}),a(window).on("resize",e)}};return{init:b}});
define('block_totara_recommendations/edit_form', [],function(){return{init:function(){var a=document.getElementById("id_config_block_type"),b=document.getElementById("id_config_ratings"),c=function(){var c=parseInt(a.value,10);2===c||3===c?b.setAttribute("disabled","disabled"):b.removeAttribute("disabled")};a.addEventListener("change",c),c()}}});
define('block_totara_report_graph/graph_loader', ["core/str","core/templates","core/config"],function(a,b,c){function d(d){var e=parseInt(d.getAttribute("data-block_totara_report_graph-blockid"),10);M.util.js_pending("block_totara_report_graph-graphloading");var f=function(){a.get_string("errorrendergraph","block_totara_report_graph").done(function(a){d.innerHTML=a})},g=function(a){"undefined"==typeof a.chart?f():b.render("totara_reportbuilder/chartjs",a).done(function(a,c){d.innerHTML=a,b.runTemplateJS(c).then(function(){M.util.js_complete("block_totara_report_graph-graphloading")})})},h=new FormData;h.append("blockid",e),h.append("sesskey",c.sesskey),h.append("currentlanguage",c.currentlanguage),fetch(c.wwwroot+"/blocks/totara_report_graph/ajax_graph.php",{method:"POST",credentials:"same-origin",body:h}).then(function(a){return a.json()}).then(g)["catch"](f)}return{init:d}});
define('block_totara_report_table/module', ["jquery","core/config","core/templates"],function(a,b,c){var d={change_links:function(e,f){var g=null;a(".block_totara_report_table."+e+" .content .rb-display-table-container").find("div.paging a, th.header a").each(function(){a(this).click(function(h){h.preventDefault();var i=a(this),j=i.attr("href"),k=j.slice(j.indexOf("?")+1);if(k+="&sesskey="+b.sesskey+"&blockid="+f,g&&g.abort(),0===a(h.target).siblings(".block_totara_report_table_instant_wait").length){var l=a('<div class="block_totara_report_table_instant_wait"></div>'),m=a(".block_totara_report_table."+e+" .content .rb-display-table-container");m.addClass("block_totara_report_table_loading"),m.append(l),c.renderIcon("loading","","ft-size-600").done(function(a){l.html(a);var b=m.position();b.left+=m.width()/2-l.width()/2,b.top+=m.height()/2-l.height()/2,l.css(b)})}g=d.refresh_results(e,k,function(){d.change_links(e,f)})})})},refresh_results:function(c,d,e){return a.get(b.wwwroot+"/blocks/totara_report_table/ajax_instantreport.php?"+d).done(function(b){var d=a(".block_totara_report_table."+c+" .content");d.find(".block_totara_report_table_instant_wait").remove(),d.find(".rb-display-table-container").html(a(b).find(".rb-display-table-container").html()),d.find(".rb-display-table-container").removeClass("block_totara_report_table_loading"),d.find("form").remove(),e&&e()})},populatelist:function(){var c=a("#id_config_savedsearch");a("#id_config_reportid").change(function(){var d=a(this).val();""!==d&&(c.attr("disabled","disabled"),M.util.js_pending("block_totara_report_table-populatelist"),a.ajax({type:"POST",url:b.wwwroot+"/blocks/totara_report_table/ajax_list_saved.php",data:{reportid:d,sesskey:M.cfg.sesskey},success:function(a){c.find("option").remove(),c.append('<option value="">'+M.util.get_string("allavailabledata","block_totara_report_table")+"</option>");for(var b in a)c.append('<option value="'+b+'">'+a[b]+"</option>");c.removeAttr("disabled"),M.util.js_complete("block_totara_report_table-populatelist")}}))})}};return d});
define('media_videojs/loader', ["jquery","core/event"],function(a,b){var c,d=function(d){c=d,e(null,a("body")),b.getLegacyEvents().done(function(b){a(document).on(b.FILTER_CONTENT_UPDATED,e)})},e=function(b,d){var e=".mediaplugin_videojs";d.find(e).addBack(e).find("audio, video").each(function(){var b=a(this).attr("id"),d=a(this).data("setup-lazy"),e=["media_videojs/video-lazy"];d.techOrder&&d.techOrder.indexOf("youtube")!==-1&&e.push("media_videojs/Youtube-lazy"),require(e,function(a){c&&(c(a),c=null),a(b,d)})})};return{setUp:d}});
define ("format_tiles/browser_storage",["jquery","format_tiles/browser_storage_set_up"],function(a,b){"use strict";var c,d,e={prefix:"mdl-tiles-",course:"mdl-tiles-course-",lastSection:"-lastSecId",content:"-content",lastUpdated:"-lastUpdated",collapseSecZero:"-collapsesec0",user:"-user-",section:"-sec-",userChoicePrefix:"mdl-tiles-userPrefStorage-"},f,g=function(){return e.course+c+e.user+d+e.lastSection},h=function(a){return e.course+c+e.section+a.toString()+e.user+d+e.content},i=function(a){return e.course+c+e.section+a.toString()+e.user+d+e.lastUpdated},j=function(){return e.course+c+e.user+d+e.collapseSecZero},k=function(a){return 0===a.indexOf(e.prefix)&&a.substr(-e.lastUpdated.length)===e.lastUpdated},l=function storeCourseContent(a,c,d){if(c===void 0||a===void 0){throw new Error("Missing section id")}try{if(d!==void 0&&""!==d&&b.Enabled.session&&!0===b.storageAllowed()){sessionStorage.setItem(h(c),d);sessionStorage.setItem(i(c),Math.round(Date.now()/1e3).toString())}else{sessionStorage.removeItem(h(c));sessionStorage.removeItem(i(c))}}catch(a){require(["core/log"],function(b){b.debug(a)})}},m=function(a){var b=a.split("-");if(k(a)){return{courseId:parseInt(b[b.indexOf("course")+1]),sectionId:parseInt(b[b.indexOf("sec")+1]),userId:parseInt(b[b.indexOf("user")+1]),title:"lastUpdated"}}else{throw new Error("Invalid lastUpdated key")}},n=function(a,b,c){if(b){Object.keys(localStorage).filter(function(a){return 0===a.indexOf(e.prefix)&&0!==a.indexOf(e.userChoicePrefix)}).forEach(function(a){localStorage.removeItem(a)});Object.keys(sessionStorage).filter(function(a){return 0===a.indexOf(e.prefix)}).forEach(function(a){if(k(a)){var b=m(a);l(b.courseId,b.sectionId,"")}})}else{var d=Math.round(Date.now()/1e3)-60*a;Object.keys(sessionStorage).filter(function(a){return 0===a.indexOf(e.prefix)}).forEach(function(b){if(k(b)){var c=m(b);if(sessionStorage.getItem(b)<d||0===a){l(c.courseId,c.sectionId,"")}}});var f=Object.keys(sessionStorage).filter(function(a){return k(a)});if(f.length>c){var g=f.map(function(a){return parseInt(sessionStorage[a])}).sort(),h=g[g.length-c];if(0===c){h=Date.now()}var i;f.filter(function(a){return sessionStorage[a]<h}).forEach(function(a){i=m(a);l(i.courseId,i.sectionId,"")})}}},o=function(){n(0,1,1)},p=function setLastVisitedSection(a){if(a&&b.Enabled.local){localStorage.setItem(g(),a.toString())}else{localStorage.removeItem(g())}};return{init:function init(e,g,h,i,j,k,m){c=e.toString();d=m.toString();f=parseInt(g);b.init(d,k,o);if(0===parseInt(g)){b.setAllowed(!1)}a(document).ready(function(){if(!0!==b.storageAllowed()){n(0,1,0)}if(h){p(i);n(0,1,0);if(b.Enabled.session){l(c,i,"")}a("a.menu-action[data-title=\"switchroleto,moodle\"]").click(function(){n(0,1,0)})}else{var d=a("#page-content");if(0===d.length){d=a("#region-main")}d.on("click",".tile",function(){setTimeout(function(){n(parseInt(j),0,f)},2e3)})}})},storageEnabledSession:function storageEnabledSession(){return b.Enabled.session},storageEnabledLocal:function storageEnabledLocal(){return b.Enabled.local},storagestorageSetUperence:function storagestorageSetUperence(){return b.storageAllowed()},getLastVisitedSection:function getLastVisitedSection(){return b.Enabled.local&&localStorage.getItem(g())},getCourseContent:function getCourseContent(a,b){return sessionStorage.getItem(h(b))},getStoredContentAge:function getStoredContentAge(a,b){var c=parseInt(sessionStorage.getItem(i(b)));if(c){return Math.round(Date.now()/1e3-c)}else{return!1}},setSecZeroCollapseStatus:function setSecZeroCollapseStatus(a){if(b.Enabled.local&&b.storageAllowed()){if("collapsed"===a){localStorage.removeItem(j())}else{localStorage.setItem(j(),"1")}}},getSecZeroCollapseStatus:function getSecZeroCollapseStatus(){return!!localStorage.getItem(j())},storeCourseContent:function storeCourseContent(a,b,c){l(a,b,c)},cleanUpStorage:function cleanUpStorage(){o()},setLastVisitedSection:function setLastVisitedSection(a){if(b.storageAllowed()){p(a)}}}});
//# sourceMappingURL=browser_storage.min.js.map

define ("format_tiles/browser_storage_set_up",["jquery"],function(a){"use strict";var b={GIVEN:"yes",DENIED:"no"},c={userPrefStorage:"mdl-tiles-userPrefStorage",user:"-user-"},d={local:"local",session:"session"},e={local:!1,session:!1},f,g=null,h=function(){return c.userPrefStorage+c.user+f},i=function storageAllowed(){if(null!==g){return g}else{var a=localStorage.getItem(h());if(a){g=a===b.GIVEN;return g}else{return null}}},j=function setAllowed(a){if(a){g=!0;localStorage.setItem(h(),b.GIVEN)}else{g=!1;localStorage.setItem(h(),b.DENIED)}},k=function(a){require(["core/str","core/notification"],function(b,c){b.get_strings([{key:"datapref",component:"format_tiles"},{key:"dataprefquestion",component:"format_tiles"},{key:"yes"},{key:"no"}]).done(function(b){c.confirm(b[0],b[1],b[2],b[3],function(){j(!0)},function(){j(!1);if("function"==typeof a){a()}})})})},l=function(a){var b;try{if(a===d.local){b=localStorage}else if(a===d.session){b=sessionStorage}if("undefined"==typeof b){return!1}b.setItem("testItem","testValue");if("testValue"===b.getItem("testItem")){b.removeItem("testItem");return!0}return!1}catch(a){require(["core/log"],function(b){b.debug(a)});return!1}};return{setAllowed:function setAllowed(a){j(a)},storageAllowed:function storageAllowed(){return i()},getStorageKey:function getStorageKey(){return h()},Enabled:e,init:function init(b,c,h){f=b;a(document).ready(function(){e.local=l(d.local);e.session=l(d.session);if(c){g=!0}else if(null===i()&&e.local){setTimeout(function(){g=k(h)},3e3)}a("a[href*=\"datapref\"]").click(function(a){a.preventDefault();k(h)})})}}});
//# sourceMappingURL=browser_storage_set_up.min.js.map

define ("format_tiles/completion",["jquery","core/templates","core/config","core/ajax","format_tiles/completion"],function(a,b,c,d){"use strict";var e,f={},g={cmid:"data-cmid",numberComplete:"data-numcomplete",numberOutOf:"data-numoutof",section:"data-section"},h={launchModuleModal:"[data-action=\"launch-tiles-module-modal\"]",launchResourceModal:"[data-action=\"launch-tiles-resource-modal\"]",pageContent:"#page-content",regionMain:"#region-main",resourceModule:".activity.resource",completeonevent:".completeonevent",completeonview:".completeonview",activity:"li.activity",section:"li.section.main",togglecompletion:"form.togglecompletion",tileId:"#tile-",progressIndicatorId:"#tileprogress-",tile:".tile",spacer:".spacer",availabilityinfo:".availabilityinfo",sectionId:"#section-"},i={completionYes:"completion-icon-y",completionNo:"completion-icon-n"},j=[],k=function(b,c,d,e){var f={tileid:b,numComplete:c,numOutOf:d,showAsPercent:e,percent:Math.round(100*(c/d)),percentCircumf:106.8,percentOffset:Math.round(106.8*((d-c)/d)),isComplete:!1,isSingleDigit:!1,hastilephoto:a(h.tileId+b).hasClass("phototile")};if(0===b){f.isOverall=1}else{f.isOverall=0}if(c>=d){f.isComplete=!0}if(10>f.percent){f.isSingleDigit=!0}return f},l=function(c,d,e){if(0===d.attr(g.numberComplete)&&0>e){return}var f=Math.min(parseInt(d.attr(g.numberComplete))+e,d.attr(g.numberOutOf)),i=a("#tileprogress-0"),j=Math.min(parseInt(i.attr(g.numberComplete))+e,i.attr(g.numberOutOf));b.render("format_tiles/progress",k(c,f,d.attr(g.numberOutOf),d.hasClass("percent"))).done(function(b){d.replaceWith(b);try{a(h.progressIndicatorId+c).tooltip()}catch(a){require(["core/log"],function(b){b.debug(a)})}});b.render("format_tiles/progress",k(0,j,i.attr(g.numberOutOf),!0)).done(function(b){a("#tileprogress-0").replaceWith(b).fadeOut(0).animate({opacity:1},500)})},m=function(b){var d=b.attr(g.cmid),f=a("#completionstate_"+d),k={id:d,completionstate:parseInt(f.attr("value")),fromajax:1,sesskey:c.sesskey};try{b.tooltip("hide")}catch(a){require(["core/log"],function(b){b.debug(a)})}var m=c.wwwroot+"/course/togglecompletion.php";a.post(m,k,function(c,k){if("success"===k&&"OK"===c){var m,n=a(".completion_img_"+d);if("1"===f.attr("value")){a("#completion_dynamic_change").attr("value",0);f.attr("value",0);m=1;n.addClass(i.completionYes).removeClass(i.completionNo);a(".complete-y-"+d).fadeIn(200).fadeOut(1e3)}else{a("#completion_dynamic_change").attr("value",1);f.attr("value",1);m=-1;a(".complete-n-"+d).fadeIn(200).fadeOut(1e3);n.addClass(i.completionNo).removeClass(i.completionYes)}if(!f.closest(h.activity).is(j.map(function(a){return"."+a}).join(","))){l(b.attr(g.section),a(h.progressIndicatorId+b.attr(g.section)),m);require(["format_tiles/browser_storage"],function(a){a.storeCourseContent(e,b.attr("data-section"),"")})}}}).fail(function(){throw new Error("Failed to register completion change with server")})},n=function markAsAutoCompleteInUI(b){var c=b.closest(h.section).attr("data-section");if(b.hasClass("completeonview")){var d=b.find(".completion-icon"),g=d.closest(".completioncheckbox");if("0"===g.attr("data-ismanual")&&"0"===g.attr("data-completionstate")){d.addClass(i.completionYes).removeClass(i.completionNo);g.attr("data-completionstate",1);g.attr("data-original-title",f.completeauto);try{g.tooltip()}catch(a){require(["core/log"],function(b){b.debug(a)})}l(c,a(h.progressIndicatorId+c),1)}}require(["format_tiles/browser_storage"],function(a){a.storeCourseContent(e,c,"")})},o=function updateTileInformation(c){if(c===void 0){c=a(h.tile).not(h.spacer).map(function(b,c){return parseInt(a(c).attr("data-section"))}).toArray()}d.call([{methodname:"format_tiles_get_section_information",args:{courseid:e,sectionnums:c}}]).forEach(function(c){c.then(function(c){c.sections.forEach(function(c){var d=a(h.tileId+c.sectionnum);if(c.isavailable&&d.hasClass("tile-restricted")){d.removeClass("tile-restricted")}else if(!c.isavailable){d.addClass("tile-restricted")}if(c.isclickable&&!d.hasClass("tile-clickable")){d.addClass("tile-clickable")}else if(!c.isclickable&&d.hasClass("tile-clickable")){d.removeClass("tile-clickable")}var e=a(h.progressIndicatorId+c.sectionnum);if(e.attr("data-numcomplete")!==void 0&&e.attr("data-numcomplete")!==c.numcomplete.toString()){b.render("format_tiles/progress",k(c.sectionnum,c.numcomplete,c.numoutof,e.hasClass("percent"))).done(function(b){e.replaceWith(b);try{a(h.progressIndicatorId+c.sectionnum).tooltip()}catch(a){require(["core/log"],function(b){b.debug(a)})}})}var f=d.find(h.availabilityinfo);if(0<f.length&&c.isavailable&&!c.availabilitymessage){f.fadeOut()}else if(!c.isavailable&&c.availabilitymessage){if(0<f.length){f.html="NEW"+c.availabilitymessage;f.fadeIn()}else{b.render("format_tiles/availability_info",{availabilitymessage:c.availabilitymessage,visible:!0}).done(function(b){e.replaceWith(b);try{a(h.progressIndicatorId+c.sectionnum).tooltip()}catch(a){require(["core/log"],function(b){b.debug(a)})}})}}})}).catch(function(a){require(["core/log"],function(b){b.debug("Failed to get section information to check completion status of section");b.debug(a)})})})};return{init:function init(b,c,d){e=b;a(document).ready(function(){j=JSON.parse(d);f.completeauto=c;a("body").on("click",h.togglecompletion,function(b){b.preventDefault();m(a(b.currentTarget))});var b=a("#page-content");if(0===b.length){b=a("#region-main")}b.on("click",h.launchModuleModal+", "+h.launchResourceModal,function(b){var c=a(b.currentTarget).closest(h.activity);if(c.hasClass("completeonview")){n(c)}});a(h.pageContent).on("click",h.completeonevent+", "+h.completeonview,function(b){var c=a(b.currentTarget).closest(h.section).attr("data-section");require(["format_tiles/browser_storage"],function(a){a.storeCourseContent(e,c,"")})})})},markAsAutoCompleteInUI:function markAsAutoCompleteInUI(a,b){e=a;n(b)},updateTileInformation:function updateTileInformation(a){try{o(a)}catch(a){require(["core/log"],function(b){b.debug(a)})}}}});
//# sourceMappingURL=completion.min.js.map

define ("format_tiles/course",["jquery","core/templates","core/ajax","format_tiles/browser_storage","core/notification","core/str","format_tiles/tile_fitter"],function(a,b,c,d,e,f,g){"use strict";var h=a("body"),i=a("body, html"),j,k,l=[],m,n,o=!1,p=!1,q=60,r=!1,s=0,t,u=!1,v,w=0,x={PAGE:"#page",TILE:".tile",TILEID:"#tile-",MOVEABLE_SECTION:".moveablesection",FILTER_BUTTON:".filterbutton",TILE_LOADING_ICON:".tile-loading-icon",TILE_LOADING_ICON_ID:"#loading-icon-",TILE_COLLAPSED:".tile-collapsed",TILE_CLICKABLE:".tile-clickable",TILES:"ul.tiles",ACTIVITY:".activity",SPACER:".spacer",SECTION_MOVEABLE:".moveablesection",SECTION_ID:"#section-",SECTION_TITLE:".sectiontitle",SECTION_MAIN:".section.main",SECTION_BUTTONS:"#sectionbuttons",CLOSE_SEC_BTN:".closesectionbtn",HIDE_SEC0_BTN:"#buttonhidesec0",SECTION_ZERO:"#section-0",MOODLE_VIDEO:".mediaplugin.mediaplugin_videojs",LAUNCH_STANDARD:"[data-action=\"launch-tiles-standard\"]",TOOLTIP:"[data-toggle=tooltip]",HEADER_BAR:["header.navbar","nav.fixed-top.navbar","#essentialnavbar.moodle-has-zindex","#navwrap","nav.navbar-fixed-top","#main-navbar"]},y={SELECTED:"selected",HEADER_OVERLAY:"header-overlay",OPEN:"open",CLOSED:"closed",LAUNCH_CM_MODAL:"launch-tiles-cm-modal",STATE_VISIBLE:"state-visible"},z={CLICK:"click",KEYDOWN:"keydown",SCROLL:"scroll"},A={DISPLAY:"display",Z_INDEX:"z-index",HEIGHT:"height",BG_COLOUR:"background-color"},B={ESCAPE:27,TAB:9,RETURN:13},C=function(a){if(n===void 0){return!1}else{if(!0===a){n.fadeIn(300)}else{n.fadeOut(300)}return!0}},D=function(b){var c=a(x.SECTION_ID+b);c.find("iframe").each(function(b,c){c=a(c);if(c.attr("src")){c.attr("data-src",c.attr("src"));c.attr("src","")}});var d=c.find(x.MOODLE_VIDEO);if(0<d.length){c.html("")}},E=function(b){a(x.MOVEABLE_SECTION).each(function(b,c){c=a(c);if(c.is(":visible")){D(c.attr("data-section"));c.slideUp().removeClass(y.STATE_VISIBLE)}});a(x.TILE).removeClass(y.SELECTED).css(A.Z_INDEX,"").css(A.BG_COLOUR,"");a(".section "+y.SELECTED).removeClass(y.SELECTED).css(A.Z_INDEX,"");m.fadeOut(300);C(!1);if(b!==void 0&&0!==b){a(x.TILEID+b).focus()}a(x.TILE_LOADING_ICON).fadeOut(300,function(){a(x.TILE_LOADING_ICON).html("")});p=!1;w=0},F=function(b,c){if(c){b.html(c);a(x.TILE_LOADING_ICON).fadeOut(300,function(){a(x.TILE_LOADING_ICON).html("")});if(b.attr("id")!==x.SECTION_ZERO){var e=b.find(x.ACTIVITY).not(x.SPACER);b.on(z.KEYDOWN,function(c){if(c.keyCode===B.ESCAPE){d.setLastVisitedSection(0);E(0);a(x.TILEID+b.attr("data-section")).focus()}});e.on(z.KEYDOWN,function(b){if(b.keyCode===B.RETURN){var c=a(b.currentTarget).find("a");if(c.hasClass(y.LAUNCH_CM_MODAL)){c.click()}else if(c.attr("href")!==void 0){window.location=c.attr("href")}}});if(!j){e.last().on(z.KEYDOWN,function(c){if(c.keyCode===B.TAB&&!c.shiftKey&&a(c.relatedTarget).closest(x.SECTION_MAIN).attr("id")!==b.attr("id")){setTimeout(function(){b.find(x.SECTION_TITLE).focus();i.animate({scrollTop:b.offset().top-q},"slow");b.find("#sectionbuttons").css("top","")},200)}});b.find(x.SECTION_TITLE).on(z.KEYDOWN,function(c){if(c.keyCode===B.TAB&&c.shiftKey&&a(c.relatedTarget).closest(x.SECTION_MAIN).attr("id")!==b.attr("id")){setTimeout(function(){e.last().focus()},200)}})}}if(!j){setTimeout(function(){try{b.find(".togglecompletion, .completioncheckbox, .tag-info").tooltip()}catch(a){require(["core/log"],function(b){b.debug(a)})}},500)}if(0!==b.find(x.MOODLE_VIDEO).length){require(["media_videojs/loader"],function(a){a.setUp()})}return!0}return!1},G=function(b,c){var d=function(){var d=a("#tileText-"+c).offset().top-q;if(d===a(window).scrollTop){d+=1}b.find(x.SECTION_TITLE).focus();h.on("scroll mousedown wheel DOMMouseScroll mousewheel keyup touchmove",function(){h.stop()});i.animate({scrollTop:d},"slow",function(){i.off("scroll mousedown wheel DOMMouseScroll mousewheel keyup touchmove",function(){i.stop()})});p=!0;w=c;b.find(x.ACTIVITY).first().focus();var e=b.find("iframe");if(0<e.length){e.each(function(b,c){c=a(c);if(""===c.attr("src")&&c.attr("data-src")!==void 0){c.attr("src",c.attr("data-src"))}});if(v){require(["format_tiles/completion"],function(a){setTimeout(function(){a.updateTileInformation()},1e3)})}}},e=function(){var c=b.find(x.SECTION_BUTTONS);a(window).on(z.SCROLL,function(){if(!o&&p){o=!0;c.fadeOut(300);setTimeout(function(){var d=a(window).scrollTop(),e=d-b.offset().top+50;if(0<e&&e<b.outerHeight()-100){e=d-b.offset().top+50;c.css("top",e);if("none"===m.css(A.DISPLAY)){m.fadeIn(300)}}else if(0>e){c.css("top",0)}if(d>b.offset().top+b.outerHeight()-50){if("block"===m.css(A.DISPLAY)){m.fadeOut(300);C(!1)}c.css("top",0)}else if(b.offset().top>d+a(window).outerHeight()){if("block"===m.css(A.DISPLAY)){m.fadeOut(300);C(!1)}c.css("top",0)}else if("none"===m.css(A.DISPLAY)){m.fadeIn(300)}c.fadeIn(300,function(){o=!1})},500)}});if(!o&&!p&&m.is(":visible")){m.fadeOut(300)}};b.addClass(y.STATE_VISIBLE);b.slideDown(350,function(){d();e()});w=c},H=function(b,c){var d=new a.Deferred,e=a(".moveablesection:visible"),f=0;if(0<e.length){f=e.attr("data-section");E()}var h=function(a){g.runReOrg(a).done(function(a){if(0!==f){G(e,f)}d.resolve(a)}).fail(function(a){if(0!==f){G(e,f)}d.reject(a)})};if(c){setTimeout(function(){g.resizeTilesDivWidth(t).done(function(){h(!1)},b)})}else{h(b)}return d.promise()},I=function(a,b,c){if(b){e.confirm(l.sectionerrortitle,l.sectionerrorstring,l.refresh,l.cancel,function(){window.location.reload()},null);c.html("")}else{F(c,"<p>"+l.noconnectionerror+"</p>");setTimeout(function(){G(c,a)},500)}require(["core/log"],function(a){a.debug(b)});throw new Error("Not successful retrieving tile content by AJAX for section "+a)},J=function(a,b){return c.call([{methodname:"format_tiles_get_single_section_page_html",args:{courseid:a,sectionid:b,setjsusedsession:!0}}])[0]},K=function(a,c,d,e){var f=0>e?0:255,h=0>e?-1*e:e,i=Math.round((f-a)*h)+a,j=Math.round((f-c)*h)+c,g=Math.round((f-d)*h)+d;return"rgb("+i+","+j+","+g+")"},L=function(b){m.fadeIn(300);s=parseInt(m.css(A.Z_INDEX));var c=a(x.TILEID+b);c.css(A.Z_INDEX,s+1);C(!0);a(x.SECTION_ID+b).css(A.Z_INDEX,s+1);if(c.css(A.BG_COLOUR)&&"rgba"===c.css(A.BG_COLOUR).substr(0,4)){var d=c.css(A.BG_COLOUR).replace("rgba(","").replace(")","").replace(" ","").split(",");c.css(A.BG_COLOUR,K(parseInt(d[0]),parseInt(d[1]),parseInt(d[2]),.95))}},M=function(b){var c=a(b.currentTarget);if("window-overlay"===c.attr("id")||c.attr("id")===y.HEADER_OVERLAY){c.hide();var d=a(document.elementFromPoint(b.clientX,b.clientY));c.show();if("window-overlay"===c.attr("id")){if(d.hasClass("filterbutton")||d.hasClass("list-group-item")){d.click()}else{var e=d.closest(x.TILE);if(e){e.click()}}}else{E(0);d.click()}}},N=function(){var b=a(x.HIDE_SEC0_BTN),c=a(x.SECTION_ZERO);if(d.storageEnabledLocal()){if(!0===d.getSecZeroCollapseStatus()){c.slideUp(0);b.addClass(y.CLOSED).removeClass(y.OPEN)}else{c.slideDown(300);b.addClass(y.OPEN).removeClass(y.CLOSED)}}else{b.addClass(y.OPEN).removeClass(y.CLOSED);c.slideDown(300)}},O=function(b,f,g,h){L(g);a(x.TILE).removeClass(y.SELECTED);f.addClass(y.SELECTED);w=g;a(x.MOVEABLE_SECTION).each(function(b,c){c=a(c);if(c.is(":visible")){D(c.attr("data-section"));c.slideUp(200).removeClass(y.STATE_VISIBLE)}});c.call([{methodname:"format_tiles_log_tile_click",args:{courseid:b,sectionid:g}}])[0].fail(e.exception);var i=a(x.SECTION_ID+g);if(0<i.find(x.ACTIVITY).length){G(i,g);if(d.getStoredContentAge(b,g)>h||!d.getStoredContentAge(b,g)){J(b,g).done(function(c){if(d.storageEnabledSession()){d.storeCourseContent(b,g,a(c.html).html())}})}}else{i.html(k);if(d.storageEnabledLocal()){var j=d.getStoredContentAge(b,g);if(j){F(i,d.getCourseContent(b,g));G(i,g)}if(!j||j>h){var l=a(x.TILE_LOADING_ICON_ID+g);if(l!==void 0){l.html(k).fadeIn(200)}else{l=a("<div>").html(k);i.html(l)}J(b,g).done(function(c){var e=a(c.html).html();F(i,e);G(i,g);if(d.storageEnabledSession()){d.storeCourseContent(b,g,e)}}).fail(function(a){I(g,a,i);E(g)})}}else{J(b,g).done(function(b){F(i,a(b.html).html());G(i,g)}).fail(function(a){I(g,a,i);E(g)})}}d.setLastVisitedSection(g)};return{init:function init(e,i,o,p,C,D,G,I,K,L,P,Q,R,S){t=e;j=p;r="1"===L;I=1===I;K="1"===K;v="1"===S;d.init(t,o,!1,C,G,K,P);a(document).ready(function(){var e=a("#page-content");if(0===e.length){e=a("#region-main")}if(0!==C){w=C}else{if(r&&d.storageEnabledLocal){w=d.getLastVisitedSection()}}if(0!==w){g.init(t,w,Q,!1)}else{a(x.TILEID+"1").focus();g.init(t,null,Q,!1)}var o=a(window).outerWidth();if(i){m=a("<div></div>").addClass("modal-backdrop fade in").hide().attr("id","window-overlay").appendTo(h);m.click(function(a){E(0);M(a)});e.on(z.CLICK,x.TILE_CLICKABLE,function(b){if(!i){return}b.preventDefault();a(window).off(z.SCROLL);a(x.TILE_LOADING_ICON).fadeOut(300,function(){a(x.TILE_LOADING_ICON).html()});var c=a(b.currentTarget).closest(x.TILE),e=parseInt(c.attr("data-section"));if(c.hasClass(y.SELECTED)){E(e);d.setLastVisitedSection(0)}else{O(t,c,e,D)}var f=a(x.SECTION_ID+(e+1));if(!j&&!R&&f.length&&0<e){setTimeout(function(){var b=d.getStoredContentAge(t,e+1);if(b){F(f,d.getCourseContent(t,e+1))}if(!b||b>D){J(t,e+1).done(function(b){F(f,a(b.html).html());if(d.storageEnabledSession()){d.storeCourseContent(t,e+1,a(b.html).html())}})}},2e3)}});a(window).on("resize",function(){if(u||o===a(window).outerWidth()){return}u=!0;setTimeout(function(){var b=!0,c=a(".moveablesection:visible");if(0!==c.length){var d=c.find(".mediaplugin iframe");if(0!==d.length){d.each(function(d,e){e=a(e);if(e.outerWidth()>c.outerWidth()){b=!1}})}}if(b){o=a(window).outerWidth();H(!0,Q)}u=!1},600)});var p=parseInt(m.css(A.Z_INDEX)),v=a(x.HEADER_BAR.find(function(b){return 0<a(b).length}));if(v!==void 0&&0!==v.length){v.css(A.Z_INDEX,p+2);if("navwrap"!==v.attr("id")){if(v.outerHeight()!==void 0){q=v.outerHeight();n=a("<div></div>").addClass(y.HEADER_OVERLAY).attr("id",y.HEADER_OVERLAY).css(A.DISPLAY,"none");n.insertAfter(x.PAGE).css(A.Z_INDEX,p+3).css(A.HEIGHT,q).click(function(a){E(0);M(a)})}else{require(["core/log"],function(a){a.debug("Failed to get navbar.  Ensure theme's navbar selector is included in global HEADER_BAR")})}}}e.on(z.CLICK,x.CLOSE_SEC_BTN,function(b){E(a(b.currentTarget).attr("data-section"))});e.on(z.CLICK,x.LAUNCH_STANDARD,function(b){var c=a(b.currentTarget);if(c.attr("href")!==void 0){window.location=c.attr("href")}else if(c.find("a").attr("href")!==void 0){window.location=c.find("a").attr("href")}});N()}e.on(z.CLICK,x.HIDE_SEC0_BTN,function(b){var c=a(x.SECTION_ZERO);if("none"===c.css(A.DISPLAY)){c.slideDown(250);a(b.currentTarget).addClass(y.OPEN).removeClass(y.CLOSED);d.setSecZeroCollapseStatus("collapsed")}else{c.slideUp(250);a(b.currentTarget).addClass(y.CLOSED).removeClass(y.OPEN);d.setSecZeroCollapseStatus("expanded")}});if(I){require(["format_tiles/filter_buttons"],function(a){a.init(t,d.storageEnabledLocal)});if(i){e.on(z.CLICK,x.FILTER_BUTTON,function(){E(0);H(!0,!1)})}}a(".tiles_coursenav").removeClass("hidden");b.render("format_tiles/loading",{}).done(function(a){k=a});var G=[{key:"sectionerrortitle",component:"format_tiles"},{key:"sectionerrorstring",component:"format_tiles"},{key:"refresh"},{key:"cancel"},{key:"noconnectionerror",component:"format_tiles"},{key:"show"},{key:"hide"},{key:"other",component:"format_tiles"},{key:"blockedpopuptitle",component:"format_tiles"}];f.get_strings(G).done(function(a){a.forEach(function(a,b){l[G[b].key]=a})});if(j){e.on(z.CLICK,x.ACTIVITY+".video a",function(b){var d=a(b.currentTarget),e=d.closest(x.ACTIVITY).attr("data-url-secondary");if(e!==void 0){b.preventDefault();b.stopPropagation();var f=d.closest(x.ACTIVITY);c.call([{methodname:"format_tiles_log_mod_view",args:{courseid:t,cmid:f.attr("data-cmid")}}])[0].done(function(){require(["format_tiles/completion"],function(a){a.markAsAutoCompleteInUI(t,f)})});window.location=e}})}else{a(x.TILE).on(z.KEYDOWN,function(b){if(b.keyCode===B.RETURN){a(b.currentTarget).click()}});a("ul.tiles .tile").first().focus()}a(document).on("filter-content-updated",function(b,c){if(0<c.length){var d=a(c[0]);if(d.hasClass("moodle-dialogue")&&d.css("z-index")<s){d.css("z-index",s+1)}}})})}}});
//# sourceMappingURL=course.min.js.map

function _typeof(a){if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("format_tiles/course_mod_modal",["jquery","core/modal_factory","core/config","core/templates","core/notification","core/ajax"],function(a,b,c,d,f,g){"use strict";var h={},i,j=a(window),k,l={toggleCompletion:".togglecompletion",modal:".modal",modalDialog:".modal-dialog",modalBody:".modal-body",sectionMain:".section.main",pageContent:"#page-content",regionMain:"#region-main",completionState:"#completionstate_",cmModalClose:".embed_cm_modal .close",cmModal:".embed_cm_modal",moodleMediaPlayer:".mediaplugin_videojs",urlModalLoadWarning:"#embed-url-error-msg-",closeBtn:"button.close",ACTIVITY:"li.activity",URLACTIVITYPOPUPLINK:".activity.modtype_url.urlpopup a",newWindowButton:".button_expand",modalHeader:".modal-header",embedModuleButtons:".embed-module-buttons"},m={launchResourceModal:"launch-tiles-resource-modal",launchModuleModal:"launch-tiles-module-modal",launchUrlModal:"launch-tiles-url-modal"},n=function(){return Math.min(j.width(),1e3)},o=function(b){var c=b.find("iframe");if(0<c.length){b.find(l.closeBtn).click(function(b){a(b.currentTarget).closest(l.cmModal).find("iframe").each(function(b,c){c=a(c);c.attr("src",c.attr("src"))})})}var d=b.find("object");if(0<d.length){b.find(l.closeBtn).click(function(b){var c=a(b.currentTarget).closest(l.cmModal);c.find("object").each(function(b,c){c=a(c);c.attr("data","")});h[c.attr("data-cmid")]=void 0})}var e=b.find(l.moodleMediaPlayer);if(0<e.length){b.find(l.closeBtn).click(function(){b.find(l.moodleMediaPlayer).html("")});h[b.attr("data-cmid")]=void 0}},p=function(e){var g=e.attr("data-cmid");b.create({type:b.types.DEFAULT,title:e.attr("data-title"),body:i}).done(function(b){h[g]=b;b.setLarge();b.show();var i=a(b.root);i.attr("id","embed_mod_modal_"+g);i.attr("data-cmid",g);i.addClass("embed_cm_modal");var k={id:g,pluginfileUrl:e.attr("data-url"),objectType:"text/html",width:"100%",height:Math.round(j.height()-60),cmid:g,tileid:e.closest(l.sectionMain).attr("data-section"),isediting:0,sesskey:c.sesskey,modtitle:e.attr("data-title"),config:{wwwroot:c.wwwroot},showDownload:0,showNewWindow:0,completionInUseForCm:0};if("resource_pdf"===e.attr("data-modtype")){k.objectType="application/pdf";k.showDownload=1;k.showNewWindow=1}d.render("format_tiles/embed_file_modal_body",k).done(function(a){b.setBody(a);i.find(l.modalBody).animate({"min-height":Math.round(j.height()-60)},"fast");if("resource_html"===e.attr("data-modtype")){i.find(l.modal).animate({"max-width":"100%"},"fast");i.find(l.modalDialog).animate({"max-width":"100%"},"fast");i.find(l.modalBody).animate({"max-width":"100%"},"fast");o(i)}else{i.find(l.modal).animate({"max-width":n()},"fast");i.find(l.modalDialog).animate({"max-width":n()},"fast")}}).fail(f.exception);if(0!==e.find(l.toggleCompletion).length){var m=parseInt(a(l.completionState+g).attr("value"));k.completionInUseForCm=1;k.completionstate=1-m;k.completionicon=1===m?"n":"y";k.completionstateInverse=m;k.completionIsManual=e.find(l.toggleCompletion).attr("data-ismanual")}d.render("format_tiles/embed_module_modal_header_btns",k).done(function(a){i.find(l.modalHeader).append(a);i.find(l.closeBtn).detach().appendTo(i.find(l.embedModuleButtons))}).fail(f.exception);return!0});return!1},q=function(e){var g=e.attr("data-cmid");b.create({type:b.types.DEFAULT,title:e.attr("data-title"),body:i}).done(function(b){h[g]=b;b.setLarge();b.show();var i=a(b.root);i.attr("id","embed_mod_modal_"+g);i.attr("data-cmid",g);i.addClass("embed_cm_modal");var k=Math.round(.9*j.width()),m=Math.round(.9*j.height()),n={id:g,pluginfileUrl:e.attr("data-url"),objectType:"text/html",width:k-30,height:m-30,cmid:g,tileid:e.closest(l.sectionMain).attr("data-section"),isediting:0,sesskey:c.sesskey,modtitle:e.attr("data-title"),config:{wwwroot:c.wwwroot},showDownload:0,showNewWindow:1,completionInUseForCm:0,secondaryurl:e.closest(l.ACTIVITY).attr("data-url-secondary")};d.render("format_tiles/embed_url_modal_body",n).done(function(a){b.setBody(a);i.find(l.modalBody).animate({"min-height":m},"fast");i.find(l.modal).animate({"max-width":k},"fast");i.find(l.modalDialog).animate({"max-width":k},"fast");i.find(l.modalBody).animate({"max-width":k},"fast");o(i);i.find(l.modalBody).addClass("text-center")}).fail(f.exception);if(0!==e.find(l.toggleCompletion).length){var p=parseInt(a(l.completionState+g).attr("value"));n.completionInUseForCm=1;n.completionstate=1-p;n.completionicon=1===p?"n":"y";n.completionstateInverse=p;n.completionIsManual=e.find(l.toggleCompletion).attr("data-ismanual")}d.render("format_tiles/embed_module_modal_header_btns",n).done(function(a){i.find(l.modalHeader).append(a);i.find(l.closeBtn).detach().appendTo(i.find(l.embedModuleButtons))}).fail(f.exception);setTimeout(function(){i.find(l.newWindowButton).click(function(){h[i.attr("data-cmid")]=void 0;i.remove();a(".modal-backdrop").not("#window-overlay").removeClass("show").addClass("hide")})},1e3);return!0});return!1},r=function(b){b.find(l.modal).animate({"max-width":n()},"fast");var c=a(l.moodleMediaPlayer);c.find("div").each(function(b,c){a(c).css("max-width","")});if(0<c.length){o(b)}b.find("iframe").each(function(c,d){var e=b.find(l.modalDialog);if(0===e.length){e=b.find(l.modal)}var f=Math.min(a(d).width(),j.width());if(f>e.width()-70){e.animate({"max-width":Math.max(f+70,n())},"fast");b.find(l.modal).animate({"max-width":Math.max(f+70,n())},"fast")}var g=Math.min(a(d).height(),j.height()),h=b.find(l.modalBody);if(g>h.height()-70){h.animate({"min-height":Math.min(g+70,j.height())},"fast")}o(b)})},s=function(e){var j=e.attr("data-cmid"),m="format_tiles_get_mod_"+e.attr("data-modtype")+"_html";b.create({type:b.types.DEFAULT,title:e.attr("data-title"),body:i}).done(function(b){h[j]=b;b.setLarge();b.show();var i=a(b.root);i.attr("data-cmid",j);i.attr("id","embed_mod_modal_"+j);i.addClass("embed_cm_modal");i.addClass("mod_"+e.attr("data-modtype"));o(i);g.call([{methodname:m,args:{courseid:k,cmid:j}}])[0].done(function(c){var g={cmid:j,modtitle:e.attr("data-title"),content:c.html};if(0!==e.find(l.toggleCompletion).length){var h=parseInt(a(l.completionState+j).attr("value"));g.completionInUseForCm=1;g.completionstate=1-h;g.completionstateInverse=h;g.completionIsManual=e.find(l.toggleCompletion).attr("data-ismanual");g.completionicon=1===h?"n":"y"}else{g.completionInUseForCm=0}b.setBody(g.content);d.render("format_tiles/embed_module_modal_header_btns",g).done(function(a){i.find(l.modalHeader).append(a);i.find(l.closeBtn).detach().appendTo(i.find(l.embedModuleButtons))}).fail(f.exception);r(i);return!0}).fail(function(a){if(!0!==c.developerdebug){window.location=c.wwwroot+"/mod/"+e.attr("data-modtype")+"/view.php?id="+j}else{f.exception(a)}})});return!1},t=function(b){var c=a(b.currentTarget).closest(l.ACTIVITY);if(c.attr("data-url")!==void 0){b.stopPropagation();b.preventDefault();g.call([{methodname:"format_tiles_log_mod_view",args:{courseid:k,cmid:c.attr("data-cmid")}}])[0].done(function(){require(["format_tiles/completion"],function(a){a.markAsAutoCompleteInUI(k,c)});var a=window.open(c.attr("data-url"));try{a.focus()}catch(a){var b="<div><a href=\""+c.attr("data-url")+"\">"+c.attr("data-url")+"</a></div>";require(["core/str","core/notification"],function(a,c){a.get_strings([{key:"sectionerrortitle",component:"format_tiles"},{key:"blockedpopup",component:"format_tiles"},{key:"cancel"}]).done(function(a){c.alert(a[0],a[1]+b,a[2])})})}}).fail(f.exception)}};return{init:function init(b,c){k=b;a(document).ready(function(){var b=Object.keys(m).map(function(a){return"[data-action=\""+m[a]+"\"]"}).join(", "),e=a(l.pageContent);if(0===e.length){e=a(l.regionMain)}e.on("click",b,function(b){b.preventDefault();var c=a(b.currentTarget),d=c.closest("li.activity"),e=h[d.attr("data-cmid")];if("object"===_typeof(e)){e.show()}else{switch(c.attr("data-action")){case m.launchModuleModal:s(d);break;case m.launchResourceModal:p(d);break;case m.launchUrlModal:q(d);break;default:throw new Error("Unknown modal type "+c.attr("data-action"));}g.call([{methodname:"format_tiles_log_mod_view",args:{courseid:k,cmid:d.attr("data-cmid")}}])[0].fail(f.exception)}});d.render("format_tiles/loading",{}).catch(f.exception).done(function(a){i=a}).fail(f.exception);if(!c){e.on("click",l.URLACTIVITYPOPUPLINK,function(a){t(a)})}})}}});
//# sourceMappingURL=course_mod_modal.min.js.map

define ("format_tiles/edit_actions",["jquery","core/str","core/notification"],function(a,b,c){"use strict";var d={ACTIONAREA:".actions"},e={EDITINPROGRESS:"editinprogress"},f=function getModuleName(a){var b="";Y.use("moodle-course-util",function(c){b=c.Moodle.core_course.util.cm.getName(c.Node(a.get(0)))});return b},g=function confirmDeleteModule(a,d){var e=a.attr("class").match(/modtype_([^\s]*)/)[1],g=f(a);b.get_string("pluginname",e).done(function(a){b.get_strings([{key:"confirm"},{key:null===g?"deletechecktype":"deletechecktypename",param:{type:a,name:g}},{key:"yes"},{key:"no"}]).done(function(a){c.confirm(a[0],a[1],a[2],a[3],d)}).fail(c.exception)})},h=function addActivitySpinner(a){a.addClass(e.EDITINPROGRESS);var b=a.find(d.ACTIONAREA).get(0);if(b){var c=M.util.add_spinner(Y,Y.Node(b));c.show();return c}return null},i=function addSectionLightbox(a){var b=M.util.add_lightbox(Y,Y.Node(a.get(0)));b.show();return b},j=function removeSpinner(a,b,c){window.setTimeout(function(){a.removeClass(e.EDITINPROGRESS);if(b){b.hide()}},c)},k=function removeLightbox(a,b){if(a){window.setTimeout(function(){a.hide()},b)}};return{confirmDeleteModule:function confirmDeleteModule(a,b){g(a,b)},removeLightbox:function removeLightbox(a,b){k(a,b)},removeSpinner:function removeSpinner(a,b,c){j(a,b,c)},getModuleName:function getModuleName(a){f(a)},addSectionLightbox:function addSectionLightbox(a){i(a)},addActivitySpinner:function addActivitySpinner(a){h(a)}}});
//# sourceMappingURL=edit_actions.min.js.map

define ("format_tiles/edit_browser_storage",["jquery","format_tiles/browser_storage_set_up"],function(a,b){"use strict";var c={PAGE:"#page",EDITING_COLLAPSE_SECID:"#collapse",EDITING_COLLAPSE_SEC:".collapse-section",EDITING_EXPAND_SEC:".expand-section",EDITING_EXPAND_SECID:"#expand",SECTION_CONTENT:"li.section.main .content",SECTION_MAIN:"li.section.main",SECTION_ID:"#section-"},d,e,f={COURSE_VISIT:"mdl-tiles-editing-last-visit-course-",EDITING_COURSE:"mdl-tiles-editing-course-",SECTION:"-section-",COURSE:"mdl-tiles-course-",LAST_SECTION:"-lastSecId",USER:"-user-",PREFIX:"mdl-tiles-",USER_CHOICE_PREFIX:"mdl-tiles-userPrefStorage-",CONTENT_SUFFIX:"-content",LAST_UPDATED_SUFFIX:"-lastUpdated"},g={OPEN:"1",CLOSED:"0"},h,i=function(a){return f.EDITING_COURSE+d+f.SECTION+a+f.USER+e},j=function getOpenSections(a){if(!a||50<a){a=50}for(var b=[],c,d=1;d<=a;d++){c=sessionStorage.getItem(i(d));if(c===g.OPEN){b.push(d)}}return b},k=function(){return f.COURSE+d+f.USER+e+f.LAST_SECTION},l=function setLastSection(a){if(!a){localStorage.clear(k())}else if(a!==h&&b.storageAllowed){h=a;localStorage.setItem(k(),a.toString())}},m=function getLastSection(){if(!h){h=localStorage.getItem(k())}return h},n=function setSectionStatus(a,c){if(b.storageAllowed&&c){sessionStorage.setItem(i(a),g.OPEN)}else{sessionStorage.removeItem(i(a))}},o=function(){Object.keys(sessionStorage).filter(function(a){return 0===a.indexOf(f.PREFIX)&&(a.indexOf(f.CONTENT_SUFFIX)===a.length-f.CONTENT_SUFFIX.length||a.indexOf(f.LAST_UPDATED_SUFFIX)===a.length-f.LAST_UPDATED_SUFFIX.length)}).forEach(function(a){sessionStorage.removeItem(a)})},p=function(){Object.keys(localStorage).filter(function(a){return 0===a.indexOf(f.PREFIX)&&-1===a.indexOf(f.USER_CHOICE_PREFIX)}).forEach(function(a){localStorage.removeItem(a)});Object.keys(sessionStorage).filter(function(a){return 0===a.indexOf(f.PREFIX)&&-1===a.indexOf(f.USER_CHOICE_PREFIX)}).forEach(function(a){sessionStorage.removeItem(a)})};return{getOpenSections:function getOpenSections(a){return j(a)},init:function init(g,h,j,k,m,q,r){d=h;e=g;if(q){n(q,!0)}a(document).ready(function(){b.init(e,m,p);if(0===parseInt(j)){b.setAllowed(!1);return}o();if(b.storageAllowed()){sessionStorage.setItem(f.COURSE_VISIT+d+f.USER+e,Date.now().toString());if(r){for(var g=1;g<=q;g++){n(g,!1)}}a(c.PAGE).on("click",c.SECTION_CONTENT,function(b){var d=a(b.currentTarget),e=d.closest(c.SECTION_MAIN).attr("data-section");l(e)})}})},getLastSection:function getLastSection(){return m()},setSectionStatus:function setSectionStatus(a,b){return n(a,b)},setLastSection:function setLastSection(a){return l(a)}}});
//# sourceMappingURL=edit_browser_storage.min.js.map

define ("format_tiles/edit_course",["jquery","core/config","core/str","core/ajax","format_tiles/edit_browser_storage"],function(a,b,c,d,e){"use strict";var f={EDITING_COLLAPSE_SECID:"#collapse",EDITING_COLLAPSE_SEC:".collapse-section",EDITING_EXPAND_SEC:".expand-section",EDITING_EXPAND_SECID:"#expand",ACTIVITY:"li.activity",SECTION_ID:"#section-",TILE_TITLE:"li.section.main .tile_bar_text .inplaceeditable a:not(.quickeditlink)",TILE_BAR_TEXT:".tile_bar_text",SECTION:"ul.section",SECTION_MAIN:"li.section.main",DNDUPLOAD_HIDDEN:"dndupload-hidden",ACTIVITYACTION:"a.cm-edit-action",ACTIONAREA:".actions",EXPAND_ALL_BTNS:".expand-collapse-all-btns a",EXPAND_COLLAPSE_SEC:".expand-collapse-sec ",EDIT_TITLE_PENCIL:".quickeditlink",ICON_PICKER_BTN:".tileiconcontainer",TILE_BAR:".tile_bar",SECTIONACTIONMENU:".section_action_menu",MENU_ACTION:".menu-action"},g={ESCAPE:27,TAB:9,RETURN:13},h={CLICK:"click",KEYDOWN:"keydown",SCROLL:"scroll"},i={SECTION:"data-section",ORIG_TITLE:"data-original-title"},j,k=function(b){var c=a(f.SECTION_ID+b);a(f.SECTION_ID+b+"-content").animate({opacity:0},300);c.find(f.ACTIVITY).slideUp(500);c.find(".section-modchooser").slideUp(500);c.addClass("collapsed").removeClass("expanded");c.find(".mod-chooser-outer").fadeOut(500);e.setSectionStatus(b,!1)};return{init:function init(c,d,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){j=c;r="1"===r;require(["format_tiles/edit_icon_picker"],function(a){a.init(j,v,w,z)});if(x){require(["format_tiles/edit_course_mod"],function(a){a.init(j,n,y)})}a(document).ready(function(){a(f.TILE_BAR_TEXT).on(h.KEYDOWN,function(c){if(c.keyCode===g.RETURN&&!a(c.target).hasClass("form-control")){window.location=b.wwwroot+"/course/view.php?id="+j+"&section="+a(c.currentTarget).parent().attr(i.SECTION)}});if(d&&!m){var c=-1!==window.location.search.indexOf("expanded=-1"),n=a(f.SECTION_MAIN).last().attr("data-section");e.init(t,j,l,p,r,n,c)}if(!m){var o=a("[data-toggle=tooltip]");if(0!==o.length){try{o.tooltip()}catch(a){require(["core/log"],function(b){b.debug(a)})}}}a("body").on("click keypress",f.SECTION_MAIN+" "+f.SECTIONACTIONMENU+"[data-sectionid] a[data-action]",function(b){var c=a(b.target).closest(f.MENU_ACTION),d=c.closest(f.SECTION_MAIN);if("hide"===c.attr("data-action")||"show"===c.attr("data-action")){k(d.attr("data-section"));d.find(f.SECTION).find(f.ACTIVITY).slideUp(300).remove()}})})}}});
//# sourceMappingURL=edit_course.min.js.map

define ("format_tiles/edit_course_mod",["jquery","core/ajax","core/templates","core/notification","core/str","core/url","core/config"],function(a,b,c,d,e,f,g){"use strict";var h={},i=a("html,body"),j=a("#page"),k={MENU_ACTION:".menu-action-text",SUBTILE:".subtile",SPACER:".spacer",AVAIL_INFO:".availabilityinfo",ACTIVITY_INSTANCE:".subtile-activityinstance",INSTANCE_NAME:".instancename",SECTION_CM_EDIT_ACTIONS:".section-cm-edit-actions",EDITING_MOVE:".editing_move",LABEL_CONVERT:".editing_labelconvert",CM_EDIT_ACTION:".cm-edit-action",ACTIVITY_ICON:".activityicon",EDITING_DELETE:".editing_delete",SECTION_MAIN:".section.main",STEALTH_UNAVAIL_LINK:".editing_makeunavailable"},l={SHOW:"show",HIDE:"hide",FA_EYE_SLASH:"fa-eye-slash",FA_EYE:"fa-eye",DIMMED:"dimmed",EDITING:"editing_",ACTIVITY:"activity",LABEL:"label",SECTION_DRAGGABLE:"sectiondraggable"},m={CLICK:"click",MODULE_ADDED:"filter-content-updated",MOUSEDOWN:"mousedown"},n=function(c){var d=a(c.currentTarget),e;if("tiles-hide"===d.attr("data-action")){e={changeTo:l.HIDE,old:l.SHOW};a(k.STEALTH_UNAVAIL_LINK).hide()}else if("tiles-show"===d.attr("data-action")){e={changeTo:l.SHOW,old:l.HIDE}}if(e){c.preventDefault();d.attr("data-action","tiles-"+e.old);var f=b.call([{methodname:"core_course_edit_module",args:{id:d.attr("data-cmid"),action:e.changeTo}}],!0);f[0].done(function(b){d.removeClass(l.EDITING+e.old).addClass(l.EDITING+e.changeTo);d.attr("href",d.attr("href").replace("&"+e.old+"=","&"+e.changeTo+"="));var c=d.find(k.MENU_ACTION),f=d.closest(k.SUBTILE);if(e.changeTo===l.SHOW){c.html(c.html().replace(h.show,h.hide));d.find("i").removeClass(l.FA_EYE_SLASH).addClass(l.FA_EYE);f.removeClass(l.DIMMED)}else if(e.changeTo===l.HIDE){c.html(c.html().replace(h.hide,h.show));d.find("i").removeClass(l.FA_EYE).addClass(l.FA_EYE_SLASH);f.addClass(l.DIMMED)}var g=a(b).find(k.AVAIL_INFO),i=f.find(k.AVAIL_INFO);if(g){if(i.length){i.replaceWith(g)}else{g.appendTo(f.find(k.ACTIVITY_INSTANCE))}}else{i.hide()}});f[0].fail(function(){window.location.replace(d.attr("href"))})}},o=function(a){return{powerpoint:"ppt",document:"doc",spreadsheet:"xls",archive:"zip",pdf:"pdf",mp3:"mp3",mpeg:"mp4",jpeg:"jpeg",text:"txt",html:"html"}[a.split("/").slice(-1)[0].split("-")[0]]},p=function(b,c,d){if(d===void 0||""===d){d=h.other}b.find("a.cm-edit-action").each(function(b,c){a(c).attr("data-action","")});b.find("a.editing_moveright").remove();var e={cmid:b.attr("id").split("-").slice(-1)[0],modtitle:b.find(k.INSTANCE_NAME).html().split("<")[0],cmeditmenu:b.find(k.SECTION_CM_EDIT_ACTIONS)[0].outerHTML.replace(/\n/g,""),cmmove:b.find(k.EDITING_MOVE)[0].outerHTML,modname:"resource",modResourceType:c,modnameDisplay:d,useSubtiles:1,isEmbeddedResource:0,clickable:1,isediting:1,visible:1};e.isPdf="pdf"===e.modResourceType;return e},q=function(b,d,j,n){if(j.hasClass(l.SECTION_DRAGGABLE)&&-1===window.location.href.indexOf("expand=")){window.location=g.wwwroot+"/course/view.php?id="+b+"&expand="+j.attr("data-section")+"#section-"+j.attr("data-section")}else if(d.hasClass(l.LABEL)&&d.closest("ul").hasClass("subtiles")){window.location.reload()}else if(d.hasClass(l.ACTIVITY)&&d.closest("ul").hasClass("subtiles")){d.children().hide();d.append(a("<img/>").attr("src",f.imageUrl("loading","format_tiles")).addClass("loading-subtile").attr("title",h.loading));var q=d.prevAll(k.SUBTILE).not(k.SPACER).first();d.prevUntil(q,k.SPACER).hide();var r=o(d.find(k.ACTIVITY_ICON).attr("src"));if(r===void 0){window.location.reload()}var s="displaytitle_mod_"+r;if(h[s]===void 0){e.get_string(s,"format_tiles").done(function(b){if("[["!==b.substring(0,2)){h[s]=b}else{b=""}var e=p(d,r,b);c.render("format_tiles/course_module",e).done(function(b){d.replaceWith(b);var c=a("#"+a(n).attr("id"));i.animate({scrollTop:c.offset().top-130},"fast");for(var f=0;3>f;f++){c.fadeOut(300).fadeIn(300)}a("#module-"+e.cmid).find(".editing_move").attr("data-action","").on(m.MOUSEDOWN,function(){window.location.reload()})})})}else{var t=p(d,r,h[s]);c.render("format_tiles/course_module",t).done(function(b){d.replaceWith(b);a("#module-"+t.cmid).find(".editing_move").attr("data-action","").on(m.MOUSEDOWN,function(){window.location.reload()})})}}else{d.find("div.mod-indent-outer").css("position","absolute").css("top","0").css("width","100%").css("padding-left","0")}};return{init:function init(b,c,f){a(document).ready(function(){Y.use("moodle-course-coursebase",function(){if("undefined"!=typeof M.course){setTimeout(function(){M.course.coursebase.registermodules=[]},500)}});a(k.LABEL_CONVERT).on(m.CLICK,function(b){b.preventDefault();d.confirm(h.areyousure,h.converttopage_confirm,h.yes,h.no,function(){window.location=a(b.currentTarget).attr("href")},null)});if(0!==f){var c=a("#module-"+f);i.animate({scrollTop:c.offset().top-130},"fast");for(var g=0;3>g;g++){c.fadeOut(300).fadeIn(300)}}j.on("click",k.CM_EDIT_ACTION,function(a){n(a)});a(document).on(m.MODULE_ADDED,function(c,d){var e=a("#"+a(d).attr("id")),f=e.closest(k.SECTION_MAIN);if(1<=f.length){q(b,e,f,d)}});j.on(m.CLICK,k.EDITING_DELETE,function(b){var c=a(b.currentTarget).closest("li"+l.ACTIVITY),d=c.prevAll(k.SUBTILE).not(k.SPACER).first();if(c.hasClass(l.LABEL)){c.prevUntil(d,k.SPACER).hide()}});e.get_strings([{key:"yes"},{key:"no"},{key:"show"},{key:"hide"},{key:"converttopage_confirm",component:"format_tiles"},{key:"areyousure"},{key:"complete",component:"format_tiles"},{key:"fileaddedtobottom",component:"format_tiles"},{key:"loading",component:"format_tiles"}]).done(function(a){h={yes:a[0],no:a[1],show:a[2],hide:a[3],converttopage_confirm:a[4],areyousure:a[5],complete:a[6],fileaddedtobottom:a[7],loading:a[8]}})})}}});
//# sourceMappingURL=edit_course_mod.min.js.map

define('format_tiles/edit_form_helper', ["jquery","core/notification","core/str","core/templates","format_tiles/browser_storage"],function(a,b,c,d,e){"use strict";return{init:function(f,g,h,i,j,k,l,m){a(document).ready(function(){a("select#id_courseusesubtiles").change(function(b){"0"!==b.currentTarget.value&&a("input#id_courseusebarforheadings").prop("checked",!1)}),a("select#id_courseshowtileprogress").change(function(d){if("0"!==d.currentTarget.value){var e=a("select#id_enablecompletion");"0"===e.val()&&(e.val("1"),c.get_strings([{key:"completion",component:"completion"},{key:"completionswitchhelp",component:"format_tiles"}]).done(function(a){b.alert(a[0],a[1])}))}}),a("select#id_enablecompletion").change(function(b){"0"===b.currentTarget.value&&a("select#id_courseshowtileprogress").val("0")});var n=a("select#id_basecolour");d.render("format_tiles/colour_picker",{colours:n.find("option").map(function(b,c){var d=a(c),e=d.attr("value");return{colour:e,colourname:d.text(),selected:e===n.val(),id:e.replace("#","")}}).toArray()}).done(function(b){a(b).insertAfter(n),n.hide();var c=a(".colourpickercircle");c.click(function(b){var d=a(b.currentTarget);c.removeClass("selected"),d.addClass("selected"),n.val(d.attr("data-colour")),a("#colourselectnotify").fadeIn(200).fadeOut(1200)}),n.change(function(){c.removeClass("selected"),a("#colourpick_"+n.val().replace("#","")).addClass("selected")});var d=a("body");d.hasClass("format-tiles")||d.addClass("format-tiles")});var o,p;if("course-edit"===f?(p=a("#id_defaulttileicon"),o=a("#id_defaulttileicon option:selected").text()):"course-editsection"===f&&(p=a("#id_tileicon"),o=a("#id_tileicon option:selected").text()),"course-edit"===f||"course-editsection"===f&&"0"!==j){var q;q=""===p.val()?g:p.val(),d.render("format_tiles/icon_picker_launch_btn",{initialicon:"tileicon/"+q,initialname:o,sectionId:i,allowphototiles:l}).done(function(b){a(b).insertAfter(p),p.hide(),require(["format_tiles/edit_icon_picker"],function(a){a.init(h,f,l,m)})})}d.render("format_tiles/edit_form_helptext",{documentationurl:m+"/teacher"}).done(function(b){a(b).appendTo(a("#id_courseformathdr .fcontainer"))}),e.init(h,1,!0,1,0,!0,k),e.cleanUpStorage()})}}});
define('format_tiles/edit_icon_picker', ["jquery","core/templates","core/ajax","core/str","core/notification","core/config"],function(a,b,c,d,e,f){"use strict";var g,h={pickAnIcon:""},i=[],j=[],k=function(b,d){var e=c.call([{methodname:"format_tiles_get_icon_set",args:{courseid:b}}]);e[0].done(function(b){b.photos&&(j=JSON.parse(b.photos));var c=JSON.parse(b.icons);Object.keys(c).forEach(function(a){i.push({filename:"tileicon/"+a,displayname:c[a]})}),i.length<=0&&require(["core/log"],function(a){a.error("Error empty icon set"),a.debug(b)}),"function"==typeof d&&d();var e=j.map(function(a){return a.filename});a("#iconpickerphotos").find(".photo").each(function(b,c){c=a(c),e.indexOf(c.attr("data-filename"))===-1&&c.fadeOut(500)}),b.status!==!0&&require(["core/log"],function(a){a.error("Non true status response when getting icon set"),a.debug(b)})}),e[0].fail(function(a){require(["core/log"],function(b){b.error("Fail when getting icon set"),b.debug(a)})})},l=function(a,b){return f.wwwroot+"/course/format/tiles/editimage.php?courseid="+a+"&sectionid="+b},m=function(f,g,h,i,j,m,n,o,p){var q=a("#selectedicon"),r=function(c,d,e){var i="",n={tileicon:h,tileid:g,secid:f,isediting:1};switch(e){case"tileicon":i="tileicon";break;case"tilephoto":i="tilebarphoto",n.phototileurl=d,n.phototileediturl=l(m,f),n.iamgetype=e,c.closest(".tileiconcontainer").addClass("hasphoto"),setTimeout(function(){k(m)},3e3);break;case"draftfile":i="tilebarphoto",n.phototileurl=d,n.phototileediturl=l(m,f),n.iamgetype=e;break;default:throw new Error("Invalid image type "+e)}var o="course-view-tiles"===j?c:q;o.animate({opacity:0},500,function(){b.render("format_tiles/"+i,n).done(function(a){o.html(a).animate({opacity:1},500)})}),"course-editsection"===j&&"tilephoto"===e&&a("input[name=tilephoto]").val(h)},s={image:h,courseid:m,sectionid:f,imagetype:n,sourcecontextid:void 0===o?0:o,sourceitemid:void 0===p?0:p},t=c.call([{methodname:"format_tiles_set_image",args:s}]);t[0].done(function(c){if(c.status===!0)if("course-view-tiles"===j)r(a("#tileicon_"+g),c.imageurl,n);else if("course-edit"===j||"course-editsection"===j){var f=a("#id_defaulttileicon");"course-editsection"===j&&(f=a("#id_tileicon")),f.val(h),"tileicon"===n?(b.renderPix(h,"format_tiles",i).done(function(a){q.html(a),"course-editsection"===j&&d.get_strings([{key:"tip",component:"format_tiles"},{key:"tileselecttip",component:"format_tiles"}]).done(function(a){e.alert(a[0],a[1])})}),"course-editsection"===j&&a("input[name=tilephoto]").val("")):"tilephoto"===n&&r(a("#tileicon_"+g),c.imageurl,n)}}).fail(function(a){require(["core/log"],function(b){b.error("Fail setting icon"),b.debug(a)})})},n=function(c,d,e,n,o,p){var q=function(b,e,f){var g=a("#iconpickerphotos");g.html(b);var h=2e5,i=[];g.find("img").each(function(b,g){g=a(g),g.attr("data-filesize")<h?setTimeout(function(){g.attr("src",g.attr("data-url"))},20*b):i.push(g),g.click(function(b){var g=a(b.currentTarget);m(e.attr("data-sectionid"),e.attr("data-section"),g.attr("data-filename"),g.attr("data-filename"),c,d,g.attr("data-imagetype"),g.attr("data-contextid"),g.attr("data-itemid")),f.hide()})}),setTimeout(function(){i.forEach(function(a){a.attr("src",a.attr("data-url"))})},1e3)};if("object"!=typeof g){var r=function(){b.render("format_tiles/icon_picker_modal_body",{icon_picker_icons:i,photosallowed:o,wwwroot:f.wwwroot,documentationurl:p}).done(function(i){require(["core/modal_factory"],function(k){k.create({type:k.types.DEFAULT,title:h.pickAnIcon,body:i}).done(function(h){g=h,h.setLarge(),h.show();var i=a(h.root);i.attr("id","icon_picker_modal"),i.attr("data-sectionid",e),i.attr("data-section",n),i.addClass("icon_picker_modal"),i.on("click",".pickericon",function(b){var f=a(b.currentTarget);m(e,n,f.attr("data-icon"),f.attr("title"),c,d,"tileicon",f.attr("data-contextid"),f.attr("data-itemid")),h.hide()}),i.on("input","input.iconsearch",function(b){var c=b.currentTarget.value.toLowerCase();i.find(".pickericon").show(),c.length>=3&&i.find(".pickericon").filter(function(b,d){return a(d).attr("data-original-title").toLowerCase().indexOf(c)<0}).hide()});try{a(".pickericon").tooltip()}catch(k){require(["core/log"],function(a){a.debug(k)})}if(o){var p=l(d,e);i.find("#phototilebtn").attr("href",p),a("#launch-photo-library").click(function(){0!==j.length&&b.render("format_tiles/icon_picker_photos",{icon_picker_photos:j,wwwroot:f.wwwroot}).done(function(a){q(a,i,h)})})}})})})};i.length<=0?k(d,r):r()}else{if(g.root.attr("data-sectionid",e),g.root.attr("data-section",n),g.root.off("click"),g.root.on("click",".pickericon",function(b){var f=a(b.currentTarget);m(e,n,f.attr("data-icon"),f.attr("title"),c,d,f.attr("data-imagetype"),f.attr("data-contextid"),f.attr("data-itemid")),g.hide()}),o){var s=l(d,e);g.root.find("#phototilebtn").attr("href",s)}g.show()}};return{init:function(b,c,e,f){a(document).ready(function(){var g=e?"picknewiconphoto":"picknewicon";d.get_string(g,"format_tiles").done(function(a){h.pickAnIcon=a}),k(b);var i=a("#page-content");0===i.length&&(i=a("#region-main")),i.on("click",".launchiconpicker",function(d){d.preventDefault();var g=a(d.currentTarget);n(c,b,g.attr("data-sectionid"),g.attr("data-section"),e,f)})})}}});
define ("format_tiles/edit_upload_image_helper",["jquery"],function(a){"use strict";return{init:function init(){a(document).ready(function(){a(".fp-btn-choose").click(function(){a("#id_headertag").addClass("collapsed");a("#id_guidance").addClass("collapsed")})})}}});
//# sourceMappingURL=edit_upload_image_helper.min.js.map

define ("format_tiles/filter_buttons",["jquery"],function(a){"use strict";var b={FILTER_BUTTON:".filterbutton",TILE:".tile",COLLAPSING:".tile-collapsing",COLLAPSED:".tile-collapsed",SPACER:".spacer",PAGE_CONTENT:"#page-content",REGION_MAIN:"#region-main"},c={COLLAPSING:"tile-collapsing",COLLAPSED:"tile-collapsed",SELECTED:"selected"},d={getPressedFilterButton:function getPressedFilterButton(a,b){return b?localStorage.getItem("mdl-course-"+a+"-filter-btn"):null},setPressedFilterButton:function setPressedFilterButton(a,b,c){if(c){if(0===b){localStorage.removeItem("mdl-course-"+a+"-filter-btn")}else{localStorage.setItem("mdl-course-"+a+"-filter-btn",b)}}},unCollapseTiles:function unCollapseTiles(d){d.forEach(function(b,e){a("#tile-"+d[e]).addClass(c.COLLAPSING).removeClass(c.COLLAPSED)});setTimeout(function(){a(b.COLLAPSING).removeClass(c.COLLAPSING)},300)},collapseAllTiles:function collapseAllTiles(){a(b.TILE).not(a(b.COLLAPSED)).not(a(b.SPACER)).addClass(c.COLLAPSING);setTimeout(function(){a(b.COLLAPSING).addClass(c.COLLAPSED).removeClass(c.COLLAPSING)},250)},unCollapseAllTiles:function unCollapseAllTiles(){setTimeout(function(){a(b.COLLAPSED).addClass(c.COLLAPSING).removeClass(c.COLLAPSED);setTimeout(function(){a(b.COLLAPSING).removeClass(c.COLLAPSING)},250)},250)}};return{init:function init(f,g){a(document).ready(function(){var e=d.getPressedFilterButton(f,g);if(e){var h=a("#filterbutton"+e);if(!h){d.setPressedFilterButton(f,e,0)}a(b.FILTER_BUTTON).removeClass(c.SELECTED);h.addClass(c.SELECTED);d.collapseAllTiles();setTimeout(function(){d.unCollapseTiles(JSON.parse(h.attr("data-sections")))},250);d.setPressedFilterButton(f,e,g)}var i=a(b.PAGE_CONTENT);if(0===i.length){i=a(b.REGION_MAIN)}i.on("click",b.FILTER_BUTTON,function(h){var e=a(h.target),i=e.attr("data-buttonid");if("all"===i||d.getPressedFilterButton(f,g)===i){d.collapseAllTiles();setTimeout(function(){d.unCollapseAllTiles()},500);a(b.FILTER_BUTTON).removeClass(c.SELECTED);d.setPressedFilterButton(f,0,g);a("#filterbutton-all").addClass(c.SELECTED)}else{a(b.FILTER_BUTTON).removeClass(c.SELECTED);e.addClass(c.SELECTED);d.collapseAllTiles();setTimeout(function(){d.unCollapseTiles(JSON.parse(e.attr("data-sections")))},250);d.setPressedFilterButton(f,i,g)}})})}}});
//# sourceMappingURL=filter_buttons.min.js.map

define ("format_tiles/registration",["jquery","core/notification","core/config","core/str"],function(a,b,c,d){"use strict";return{attemptRegistration:function attemptRegistration(e,f,g){g.useragent=navigator.userAgent;g.browserlanguages=navigator.languages;a(document).ready(function(){a.ajax({url:f,type:"POST",crossDomain:!0,contentType:"application/json",data:JSON.stringify(g),dataType:"json",success:function success(a){if(a.status){d.get_strings([{key:"registration",component:"admin"},{key:"registeredthanks",component:"format_tiles"},{key:"registerclicktocomplete",component:"format_tiles"},{key:"ok",component:"format_tiles"},{key:"cancel"}]).done(function(d){b.confirm(d[0],d[1]+" "+d[2],d[3],d[4],function(){window.location.href=c.wwwroot+"/course/format/tiles/register.php?key="+a.key+"&sesskey="+e},function(){window.location.href=c.wwwroot+"/admin/settings.php?section=formatsettingtiles"})})}},error:b.exception})})}}});
//# sourceMappingURL=registration.min.js.map

define ("format_tiles/tile_fitter",["jquery","core/ajax"],function(a,b){"use strict";var c=!1,d,e={PAGE:"#page",TILE:".tile",TILEID:"#tile-",TILE_COLLAPSED:".tile-collapsed",TILES:".format-tiles.jsenabled ul.tiles",ACTIVITY:".activity",SPACER:".spacer",SECTION_ID:"#section-",OPEN_SECTION:".moveablesection:visible",SECTION_ZERO:"#section-0",CONTENT_SECTIONS:".moveablesection"},f=null,g=function resizeTilesDivWidth(){var c=a(window).width(),g=new a.Deferred,h=a(e.TILES),i={standard:260,min:225,mobileMin:160};try{var j=h.parent().innerWidth(),k=a(h.find(e.TILE)[0]),l=k.width()?k.width():i.standard,m=14;l=l+m;var n="inherit",o=Math.floor(j/i.min),p=a(e.TILE).not(e.SPACER).length;if(j<2*i.mobileMin){g.reject("Too narrow to resize")}else if(3>=p&&j>p*i.mobileMin){n=4*i.standard}else if(j<3*i.min){n=2*(i.standard-m)}else if(4>o){n=i.standard*o}else{var q=function(a,b){var c=[];for(a;a<=b;a+=1){c.push(a)}return c},r=Math.min(Math.floor(j/l),p);if(p<=r&&5<p){n=(Math.floor(p/2)+1)*l}else if(3<r&&3>=p/r){var s=Math.floor(j/l),t=q(s,r).reverse(),u=t.map(function(a){return p%a});if(-1!==u.indexOf(0)){n=l*t[u.indexOf(0)]}else if(p<s){n=p*l}else{n=l*t[u.indexOf(Math.max.apply(null,u))]}}else{n=r*l}}var v=parseInt(h.css("max-width").replace("px",""));if(100>Math.abs(n-v)){g.resolve()}else{h.css("max-width",c).animate({"max-width":n},500,"swing",function(){setTimeout(function(){g.resolve()},600);a(e.CONTENT_SECTIONS).animate({"max-width":n},500,"swing")})}if(f){clearTimeout(f)}f=setTimeout(function(){b.call([{methodname:"format_tiles_set_session_width",args:{courseid:d,width:Math.floor(n)}}])},3e3)}catch(a){h.css("max-width",c).animate({"max-width":"100%"},500,"swing");b.call([{methodname:"format_tiles_set_session_width",args:{courseid:d,width:0}}]);g.reject("Failed to resize")}return g.promise()},h={getContentSectionPositions:function getContentSectionPositions(){var b=[],c,d,f=a(e.OPEN_SECTION);f.css("display","none");var g=1,h=0,i=a(e.TILES).children(e.TILE).not(e.TILE_COLLAPSED).not(".spacer");i.each(function(b,e){c=a(e).attr("data-section");if(c){if(0===b){h=1}else if(Math.abs(a(e).position().top-a(d).position().top)<=100){h+=1}else{h=0}if(h>g){g=h}d=e}});f.css("display","block");i.each(function(d,e){c=a(e).attr("data-section");if(0===b.length||b[b.length-1].sections.length>=g){if(1<=b.length){b[b.length-1].displayAfterTile=b[b.length-1].sections[b[b.length-1].sections.length-1]}b.push({displayAfterTile:"",sections:[c]})}else{b[b.length-1].sections.push(c)}});b[b.length-1].displayAfterTile=b[b.length-1].sections[b[b.length-1].sections.length-1];return b},moveContentSectionsToPlaces:function moveContentSectionsToPlaces(b,c){b.forEach(function(c){c.sections.forEach(function(d){if(c.displayAfterTile===b[b.length-1].displayAfterTile){a(e.SECTION_ID+d).detach().insertAfter(a("ul.tiles .tile").last())}else{a(e.SECTION_ID+d).detach().insertAfter(a("#tile-"+c.displayAfterTile))}})});c.forEach(function(a){if("function"==typeof a){a()}})},runReOrg:function runReOrg(b){var d=new a.Deferred;if(!0===c){d.reject("Re-org locked")}c=!0;var e=function(){h.moveContentSectionsToPlaces(h.getContentSectionPositions(),[function(){a("body").removeClass("modal-open");d.resolve("Finished organising tiles");c=!1}])};if(!0===b){setTimeout(function(){e();d.resolve("Re-org complete")},1e3)}else{e();d.resolve("Re-org complete")}return d.promise()}},i=function(){a(".block-hider-hide").click(function(){h.runReOrg(!0)});a(".block-hider-show").click(function(){h.runReOrg(!0)});a(".navbar button[data-action=\"toggle-drawer\"]").click(function(){setTimeout(function(){h.runReOrg(!0);g()},600)})},j=function(){a(e.TILES).animate({opacity:1},"fast");a(e.SECTION_ZERO).animate({opacity:1},"fast");a("#page-loading-icon").fadeOut(500).remove()};return{init:function init(b,c,f,k){d=b;a(document).ready(function(){i();if("1"===a(e.TILES).css("opacity")){h.runReOrg().done(function(){if(0!==c){a(e.TILEID+c).click()}})}var b=function(){h.runReOrg().done(function(){if(0!==c&&0===a(e.OPEN_SECTION).length){a(e.TILEID+c).click()}j()})};if(f&&!k){g().done(function(){b()}).fail(function(){b()})}else{b()}})},resizeTilesDivWidth:function resizeTilesDivWidth(){return g()},runReOrg:function runReOrg(a){return h.runReOrg(a)}}});
//# sourceMappingURL=tile_fitter.min.js.map

define('report_loglive/fetchlogs', ["core/config","core/str","core/notification"],function(a,b,c){function d(){o.style.display="none"}function e(){o.style.display=""}function f(){e();const b={logreader:p.logreader,since:p.since,page:p.page,id:p.courseid},c=Object.keys(b).map(function(a){return a+"="+b[a]}).join("&"),d=a.wwwroot+"/report/loglive/loglive_ajax.php?"+c,f="report_loglive_fetchlogs";M.util.js_pending(f),fetch(d,{credentials:"same-origin",method:"get"}).then(function(a){return a.json()}).then(function(a){g(a),M.util.js_complete(f)})}function g(a){setTimeout(d,600),a||c.exception(a),p.since=a.until;const b=a.logs,e=document.querySelector(l.TBODY);if(e&&b){e.insertAdjacentHTML("afterbegin",b);for(const f=p.perpage;e.childNodes.length>f;)e.removeChild(e.lastElementChild);setTimeout(h,5e3)}}function h(){for(var a=document.querySelectorAll(".time"+p.since),b=0;b<a.length;b++)a[b].classList.remove(k.NEWROW)}function i(a){b.get_string(a,"report_loglive").done(function(a){n.innerText=a})}function j(){m?(i("resume"),clearInterval(m),m=null):(i("pause"),f(),m=setInterval(f,1e3*p.interval))}const k={NEWROW:"newrow",SPINNER:"spinner"},l={NEWROW:"."+k.NEWROW,TBODY:".flexible tbody",PAUSEBUTTON:"#livelogs-pause-button",SPINNER:"."+k.SPINNER};var m,n,o,p={since:null};return{init:function(a,b,c,e,g,h){Object.assign(p,{since:a,courseid:b||0,page:c||0,logreader:e||"logstore_standard",interval:g||60,perpage:h||100}),n=document.querySelector(l.PAUSEBUTTON),o=document.querySelector(l.SPINNER),d(),n.addEventListener("click",j),0===p.page&&(f(),m=setInterval(f,1e3*p.interval))}}});
define('gradingform_guide/comment_chooser', ["jquery","core/templates","core/notification","core/yui"],function(a,b,c){return{initialise:function(d,e,f,g){function h(b,c){var e="<label>"+M.util.get_string("insertcomment","gradingform_guide")+"</label>",g="comment-chooser-"+d+"-cancel",h='<button id="'+g+'">'+M.util.get_string("cancel","moodle")+"</button>",i=new M.core.dialogue({modal:!0,headerContent:e,bodyContent:b,footerContent:h,focusAfterHide:"#"+f,id:"comments-chooser-dialog-"+d});a("#"+g).click(function(){i.hide()}),a.each(c,function(b,c){var e="#comment-option-"+d+"-"+c.id;a(e).click(function(){var b=a("#"+f),d=b.val();""!==a.trim(d)&&(d+="\n"),d+=c.description,b.val(d),i.hide()}),a(document).off("keypress",e).on("keypress",e,function(){var b=event.which||event.keyCode;13!=b&&32!=b||a(e).click()})}),i.after("visibleChange",function(a){a.prevVal&&!a.newVal&&this.destroy()},i),i.show()}function i(){var a={criterionId:d,comments:g};b.render("gradingform_guide/comment_chooser",a).done(function(a){h(a,g)}).fail(c.exception)}a("#"+e).click(function(a){a.preventDefault(),i()})}}});
define('totara_appraisal/myappraisal', ["jquery","core/str","core/config"],function(a,b,c){var d={config:{},init:function(b){b&&(d.config=a.parseJSON(b));var c=a("input#id_submitbutton").closest("form"),e=a("<input>").attr({type:"hidden",name:"submitaction"}).val("saveprogress"),f=a("<input>").attr({type:"hidden",name:"submitaction"}).val("completestage");a("#saveprogress").on("submit",function(a){window.onbeforeunload=null,a.preventDefault(),c.append(e),c.submit()}),a("#completestage").on("submit",function(a){window.onbeforeunload=null,a.preventDefault(),c.append(f),c.submit()}),window.dialogsInited?(d.stagesSelectDialog(),d.savePdfDialog()):(a.isArray(window.dialoginits)||(window.dialoginits=[]),window.dialoginits.push(this.stagesSelectDialog),window.dialoginits.push(this.savePdfDialog)),setInterval(d.keepAlive,1e3*d.config.keepalivetime)},stagesSelectDialog:function(){var e=new totaraDialog_handler;e._print=function(b,d){var f=a("#printform").serialize();M.util.help_popups.setup(Y);var g={name:"printpopup",url:c.wwwroot+"/totara/appraisal/snapshot.php?"+f,options:"height=500,width=600,top=100,left=100,menubar=0,location=0,scrollbars,resizable,toolbar,status,directories=0,dependent"};openpopup(b,g),e._cancel()};var f={appraisalid:d.config.appraisalid,role:d.config.role,subjectid:d.config.subjectid,action:"stages"},g=a.param(f),h=[];h.push({key:"printnow",component:"totara_appraisal"}),h.push({key:"cancel",component:"moodle"}),h.push({key:"printyourappraisal",component:"totara_appraisal"}),b.get_strings(h).done(function(a){for(var b=[],d=0;d<h.length;d++)b[h[d].key]=a[d];var f={};f[b.printnow]=function(a){e._print(a,c.wwwroot+"/totara/appraisal/snapshot.php?"+g)},f[b.cancel]=function(){e._cancel()},totaraDialogs.print=new totaraDialog("print","show-print-dialog",{buttons:f,title:"<h2>"+b.printyourappraisal+"</h2>"},c.wwwroot+"/totara/appraisal/snapshot.php?"+g,e)})},savePdfDialog:function(){var e=new totaraDialog_handler;e._download=function(){var b=a("#downloadurl").val();b&&(window.location.href=b,e._cancel())},e._open=function(){e._dialog.dialog.html(b.get_string("snapshotgeneration","totara_appraisal"))};var f={appraisalid:d.config.appraisalid,role:d.config.role,subjectid:d.config.subjectid,action:"snapshot",sesskey:c.sesskey},g=a.param(f),h=[];h.push({key:"downloadnow",component:"totara_appraisal"}),h.push({key:"cancel",component:"moodle"}),h.push({key:"snapshotdialogtitle",component:"totara_appraisal"}),b.get_strings(h).done(function(a){for(var b=[],d=0;d<h.length;d++)b[h[d].key]=a[d];var f={};f[b.downloadnow]=function(){e._download()},f[b.cancel]=function(){e._cancel()},totaraDialogs.savepdf=new totaraDialog("savepdf","show-savepdf-dialog",{buttons:f,title:"<h2>"+b.snapshotdialogtitle+"</h2>",height:"200"},c.wwwroot+"/totara/appraisal/snapshot.php?"+g,e)})},keepAlive:function(){a.get(c.wwwroot+"/totara/appraisal/keepalive.php")}};return d});
define('totara_catalog/catalog', ["core/templates","core/ajax","core/notification","core/event"],function(a,b,c,d){function e(){return this instanceof e?(this.filterPanelCount=0,this.overlayClass="tw-catalog__overlay",this.activePopoverClass="tw-catalog__activePopover",this.widget="",this.fetchedData="",this.pageChangeType="",this.requestData={debug:!1,filterparams:{},limitfrom:0,maxcount:-1,orderbykey:"featured",request:1,resultsonly:!1,itemstyle:"narrow"},this.requestItemData={catalogid:0,request:1},this.lastRequest={catalogid:""},this.requestEpoch="",void(this.requestPending=!1)):new e}e.prototype={constructor:e,bubbledEventsListener:function(){var a=this,b="totara_core/select_region_panel",c="totara_core/select_region_primary",d="totara_core/grid",e="totara_catalog/pagination",f="totara_catalog/results_sort",g="totara_catalog/item_style_toggle",h="totara_catalog/toggle_filter_panel";this.widget.addEventListener(b+":add",function(b){a.setFilterAdd(b.detail),a.filterPanelCount++,a.setFilterPanelToggleCount()}),this.widget.addEventListener(b+":changed",function(){a.eventFilterChange()}),this.widget.addEventListener(b+":remove",function(b){a.setFilterRemove(b.detail),a.filterPanelCount--,a.setFilterPanelToggleCount()}),this.widget.addEventListener(c+":add",function(b){"catalog_fts"!==b.detail.key||a.requestData.filterparams.catalog_fts||a.setOrderBy({val:"score"}),a.setFilterAdd(b.detail)}),this.widget.addEventListener(c+":changed",function(){a.eventFilterChange()}),this.widget.addEventListener(c+":remove",function(b){a.setFilterRemove(b.detail)}),this.widget.addEventListener(f+":add",function(b){a.setOrderBy(b.detail)}),this.widget.addEventListener(f+":changed",function(){a.eventFilterChange()}),this.widget.addEventListener(g+":add",function(b){a.setItemStyle(b.detail)}),this.widget.addEventListener(g+":changed",function(){a.eventFilterChange()}),this.widget.addEventListener(e+":changed",function(b){a.setLimitFrom(b.detail.limitfrom),a.setMaxCount(b.detail.maxcount),a.setPageChangeType("resultsOnly"),a.setResultsOnly(!0),a.contentRequest()}),this.widget.addEventListener(h+":changed",function(b){var c=a.widget.querySelector(b.detail.targetwidget);c.classList.toggle(b.detail.toggleClass)}),this.widget.addEventListener(d+":add",function(b){b.detail.val!==a.lastRequest.catalogid&&(a.setItemAdd(b.detail),a.setPageChangeType("details"),a.contentRequest())})},checkDebugMode:function(){var a=window.location.search.slice(1);a=a.split("#")[0];for(var b=a.split("&"),c=0;c<b.length;c++)"debug=true"!==b[c]&&"debug=1"!==b[c]||(this.requestData.debug=!0)},contentRequest:function(){var a,b=this;this.loadingDisplayAdd().then(function(){b.setRequestEpoch(Date.now()),a=b.getData(),a.then(function(a){if(a.request==b.requestEpoch){b.setData(a);var c=b.widget.getAttribute("data-tw-catalog-jsRenderState");"locked"===c?b.requestPending=!0:(b.widget.setAttribute("data-tw-catalog-jsRenderState","locked"),b.contentUpdate(),b.contentRequestPageURL())}})})},contentRequestPageURL:function(){if("details"!==this.pageChangeType){var a=Object.assign({},this.requestData);delete a.limitfrom,delete a.maxcount,delete a.request,delete a.resultsonly,delete a.debug,this.setPageURL(this.getRequestPathString(a))}},contentUpdate:function(){var a,b=this,d=this.fetchedData,e=this.pageChangeType,f={data:d,renderType:"fullHTML",target:this.widget.querySelector("[data-tw-catalogDebug]"),template:"totara_catalog/debug"},g={data:d.pagination_template_data,renderType:"innerHTML",target:this.widget.querySelector("[data-tw-pagination]"),template:"totara_catalog/pagination"},h={data:d,renderType:"innerHTML",target:this.widget.querySelector("[data-tw-catalogResultsCount]"),template:"totara_catalog/results_count"},i={data:d,renderType:"fullHTML",target:this.widget.querySelector("[data-tw-catalogResultsEmpty]"),template:"totara_catalog/results_empty"},j={data:d,renderType:"innerHTML",target:this.widget.querySelector("[data-tw-catalogResultsSort]"),template:"totara_catalog/results_sort"},k={data:d.grid_template_data,renderType:"additionalItemHTML",target:this.widget.querySelector("[data-tw-grid]"),template:"totara_core/grid"},l={data:d,renderType:"fullHTML",target:this.widget.querySelector('[data-tw-grid-item-id="'+d.id+'"] [data-tw-catalogDetails]'),template:"totara_catalog/details"};if("filter"===e)M.util.js_pending("totara_catalog-rendering_template"),a=Promise.all([this.contentUpdateRender(k),this.contentUpdateRender(h),this.contentUpdateRender(g),this.contentUpdateRender(j),this.contentUpdateRender(f),this.contentUpdateRender(i)]);else if("details"===e)M.util.js_pending("totara_catalog-rendering_template"),a=Promise.all([this.contentUpdateRender(l)]);else{if("resultsOnly"!==e)return b.widget.setAttribute("data-tw-catalog-jsRenderState","ready"),void this.loadingDisplayRemove();M.util.js_pending("totara_catalog-rendering_template"),a=Promise.all([this.contentUpdateRender(k),this.contentUpdateRender(h),this.contentUpdateRender(g)])}a.then(function(){b.widget.setAttribute("data-tw-catalog-jsRenderState","ready"),b.loadingDisplayRemove(),b.setPageChangeType(""),M.util.js_complete("totara_catalog-rendering_template")})["catch"](function(a){b.pageError(),c.exception({fileName:"catalog.js",message:a,name:"Error rendering template"}),b.widget.setAttribute("data-tw-catalog-jsRenderState","ready")})},contentUpdateRender:function(b){var c,e=b.data,f=document.createRange(),g=b.renderType,h=b.target,i=b.template,j=this;return new Promise(function(b,k){var l=setTimeout(function(){k("Communication error, could not render "+i)},45e3);a.render(i,e).then(function(e){if(!h)return void b(i);if(f.selectNode(h),c=f.createContextualFragment(e),"additionalItemHTML"===g){var k="[data-tw-grid-item]",m=c.querySelectorAll(k);"resultsOnly"!==j.pageChangeType&&(h.innerHTML="");for(var n=0;n<m.length;n++)h.appendChild(m[n]);if(j.showOverflowEllipsis(),m&&m.length>0&&"resultsOnly"===j.pageChangeType){var o=m[0].querySelector("[data-tw-grid-item-toggle]");o.focus(),o.scrollIntoView({block:"start"})}}else if("loadingDisplay"===g)h.appendChild(c);else if("fullHTML"===g)h.innerHTML="",h.appendChild(c);else if("innerHTML"===g){var p=c.querySelector("div"),q=p.querySelector("div");h.innerHTML="",h.appendChild(q)}d.notifyFilterContentUpdated(h),a.runTemplateJS(""),clearTimeout(l),b(i)})["catch"](k)})},events:function(){var a=this;window.onpopstate=function(a){null!==a.state&&location.reload()},window.addEventListener("resize",function(){var b;b||(b=setTimeout(function(){b=null;for(var c=a.widget.querySelectorAll('[data-tw-catalogItem="checked"]'),d=0;d<c.length;d++)c[d].setAttribute("data-tw-catalogItem","check"),c[d].classList.remove("tw-catalogItem__showEllipsis");a.showOverflowEllipsis()},66))}),document.addEventListener("click",function(b){var c=document.querySelector("."+a.activePopoverClass);if(c&&b.target){var d=b.target.closest("."+a.activePopoverClass);d||c.classList.remove(a.activePopoverClass)}});var b=new MutationObserver(function(b){var c=a.widget.getAttribute("data-tw-catalog-jsRenderState");if(a.requestPending&&"locked"!==c)for(var d=0;d<b.length;d++){var e=b[d].oldValue;"ready"===c&&"locked"===e&&(a.contentUpdate(),a.contentRequestPageURL())}});b.observe(this.widget,{attributes:!0,attributeFilter:["data-tw-catalog-jsrenderstate"],attributeOldValue:!0,subtree:!1})},eventFilterChange:function(){this.setPageChangeType("filter"),this.setResultsOnly(!1),this.setLimitFrom("0"),this.setMaxCount("-1"),this.contentRequest()},getData:function(){var a,d,e=this;"details"===this.pageChangeType?(a=this.requestItemData,d="totara_catalog_external_get_details_template_data"):(e.setLastItemRemove(),a=this.requestData,d="totara_catalog_external_get_catalog_template_data");var f=[{args:a,methodname:d}];return M.util.js_pending("totara_catalog-requesting_data"),new Promise(function(a,d){var g=b.call(f,!0,!0);g[0].done(function(b){a(b),M.util.js_complete("totara_catalog-requesting_data")}).fail(function(a){c.exception(a),d(a),e.pageError(),M.util.js_complete("totara_catalog-requesting_data")})})},getRequestPathString:function(a){var b="";return Object.keys(a).forEach(function(c){var d=a[c];"filterparams"===c?Object.keys(a.filterparams).forEach(function(c){var d=a.filterparams[c];if(Array.isArray(d)){if(d.length)for(var e=0;e<d.length;e++)b+=""===b?"?":"&",b+=c+"[]="+d[e]}else b+=""===b?"?":"&",b+=c+"="+d}):(b+=""===b?"?":"&",b+=c+"="+d)}),b},loadingDisplayAdd:function(){var a,b=this;a="details"===this.pageChangeType?this.widget.querySelector("[data-tw-grid-item-active] [data-tw-catalogDetails]"):"filter"===this.pageChangeType||"resultsOnly"===this.pageChangeType?this.widget.querySelector("[data-tw-grid]"):this.widget.querySelector("[data-tw-catalogContent]"),a.classList.add(b.overlayClass);var c={data:"",renderType:"loadingDisplay",target:a,template:"totara_catalog/loading_overlay"};return M.util.js_pending("totara_catalog-rendering_template"),new Promise(function(a,d){b.contentUpdateRender(c).then(function(){a(),M.util.js_complete("totara_catalog-rendering_template")})["catch"](function(){d()})})},loadingDisplayRemove:function(){for(var a=this.widget.querySelectorAll("[data-tw-catalog-overlay]"),b=this.widget.parentNode.querySelectorAll("."+this.overlayClass),c=0;c<a.length;c++)a[c].remove();for(var d=0;d<b.length;d++)b[d].classList.remove(this.overlayClass)},pageError:function(){this.setPageChangeType(""),this.loadingDisplayRemove()},setData:function(a){this.fetchedData=a},setFilterAdd:function(a){var b=this.requestData.filterparams;a.groupValues?b[a.key]=a.groupValues:(this.setFilterRemove(a),b[a.key]=a.val)},setFilterRemove:function(a){var b=this.requestData.filterparams;a.groupValues?b[a.key]=a.groupValues:delete b[a.key]},setFilterPanelToggleCount:function(){var a=this.filterPanelCount>=1?"( "+this.filterPanelCount+" )":"",b=this.widget.querySelector("[data-tw-toggleFilterPanel]");b.setAttribute("data-tw-toggleFilterPanel-addLabelContent",a)},setLimitFrom:function(a){this.requestData.limitfrom=a},setMaxCount:function(a){this.requestData.maxcount=a},setOrderBy:function(a){this.requestData.orderbykey=a.val},setPageChangeType:function(a){this.pageChangeType=a},setPageURL:function(a){var b=window.location.pathname+a;history.pushState({ajaxPageChange:!0},null,b)},setParent:function(a){this.widget=a},setRequestEpoch:function(a){this.requestEpoch=a,"details"===this.pageChangeType?this.requestItemData.request=a:this.requestData.request=a},showOverflowEllipsis:function(){for(var a,b,c,d=this.widget.querySelectorAll('[data-tw-catalogItem="check"]'),e=0;e<d.length;e++)a=d[e],b=a.offsetHeight,c=a.parentNode.offsetHeight,b>c&&a.classList.add("tw-catalogItem__showEllipsis"),a.setAttribute("data-tw-catalogItem","checked")},setResultsOnly:function(a){this.requestData.resultsonly=a},setItemAdd:function(a){this.setItemRemove(),this.requestItemData.catalogid=a.val,this.lastRequest.catalogid=a.val},setItemRemove:function(){this.requestItemData.catalogid=""},setItemStyle:function(a){this.requestData.itemstyle=a.val},setLastItemRemove:function(){this.lastRequest.catalogid=""}};var f=function(a){return new Promise(function(b){var c=new e;c.setParent(a),c.bubbledEventsListener(),c.events(),c.checkDebugMode(),c.showOverflowEllipsis(),c.loadingDisplayRemove(),b(c)})};return{init:f}});
define('totara_catalog/config_form', ["core/str","totara_form/form"],function(a,b){var c=null,d="data-totara_catalog--dirty",e=function(f,g){var h="totaraCatalogAdminFormInit"+f,i="tf_fid_"+f;M.util.js_pending(h);var j=new Promise(function(b){a.get_string("discard_unsaved_changes","totara_catalog").then(b)}).then(function(a){null===c&&(c=function(b){var c=document.getElementById(i);if("true"===c.getAttribute(d))return b.preventDefault(),b.returnValue=a,a},window.addEventListener("beforeunload",c))}),k=new Promise(function(a,c){var d=b.getFormInstance(i);if(null===d||g){var e=document.getElementById(i);null===e&&c();var f=function(){"true"===e.getAttribute("data-totara_form-initialised")&&(h.disconnect(),a(b.getFormInstance(i)))},h=new MutationObserver(f);h.observe(e,{attributes:!0,attributeFilter:["data-totara_form-initialised"]})}else a(d)}).then(function(a){var b=a.form[0],c=b.querySelector('[data-name="submitbutton"], [name="submitbutton"]'),i=b.querySelector('[data-name="cancelbutton"], [name="cancelbutton"]'),j=function(){b.removeAttribute(d)},k=function(){b.setAttribute(d,"true")};g&&k(),c.addEventListener("click",j),i.addEventListener("click",j),a._parentValueChanged=a.valueChanged,a.valueChanged=function(b,d){var e=a.form[0].parentElement.querySelectorAll(".alert"),f=0;for(f=0;f<e.length;f++)e[f].remove();c.removeAttribute("disabled"),c.setAttribute("name",c.getAttribute("data-name")),c.closest('[data-item-classification="element"]').setAttribute("data-element-frozen","0"),i.removeAttribute("disabled"),i.setAttribute("name",i.getAttribute("data-name")),i.closest('[data-item-classification="element"]').setAttribute("data-element-frozen","0"),k(),this._parentValueChanged(b,d)},a._parentReload=a.reload,a.reload=function(a){var c=f;M.util.js_pending(h+"_reload"),this.ajaxSubmit(a,!0).then(function(){var a=b.parentElement,d=function(){e(c,!0),f.disconnect(),M.util.js_complete(h+"_reload")},f=new MutationObserver(d);f.observe(a,{childList:!0})})}});Promise.all([j,k]).then(function(){M.util.js_complete(h)})};return{init:e}});
define('totara_catalog/form_element_matrix', ["totara_form/form","core/templates"],function(a,b){function c(b,d,e,f){return this instanceof c?(a.Element.apply(this,arguments),this.input=document.getElementById(e),this.id=e,this.parent=b,this.node=f,this.potentialfilters={},void(this.name=this.input.getAttribute("data-name"))):new c(b,d,e,f)}return c.prototype=Object.create(a.Element.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object Matrix]"},c.prototype.init=function(a){var b=this.input.getElementsByClassName("totara_catalog-matrix__addfilter")[0].options,c=0;for(c=1;c<b.length;c++)this.potentialfilters[b[c].value]=b[c].label,this.input.querySelectorAll("[data-id="+b[c].value+"]").length>0&&(b[c].classList.add("totara_form_option_invisible"),b[c].disabled=!0);this.input.getElementsByClassName("totara_catalog-matrix__addfilter")[0].addEventListener("change",this._addItem.bind(this)),this.input.addEventListener("click",this._changeItem.bind(this)),this.input.addEventListener("change",this.changed.bind(this)),a()},c.prototype.getValue=function(){var a,b=this.input.getElementsByTagName("tbody")[0].getElementsByTagName("tr"),c=[];for(a=0;a<b.length;a++)c.push({id:b[a].getAttribute("data-id"),name:b[a].getElementsByTagName("input")[0].value});return c},c.prototype._addItem=function(a){if(""!==a.target.value){var c=this,d={id:a.target.value,filtername:this.potentialfilters[a.target.value],heading:this.potentialfilters[a.target.value],name:this.name},e=a.target;b.render("totara_catalog/element_matrix__row",d).done(function(a){c.input.querySelector("#"+c.id+"_table tbody").insertAdjacentHTML("beforeend",a),e.options[e.selectedIndex].classList.add("totara_form_option_invisible"),e.options[e.selectedIndex].disabled=!0,e.selectedIndex=0,c.changed()})}},c.prototype._changeItem=function(a){var b=a.target.closest("tr"),c=a.target.closest("[data-action]");if(c){switch(a.preventDefault(),c.getAttribute("data-action")){case"delete":var d,e=this.input.getElementsByClassName("totara_catalog-matrix__addfilter")[0];d=e.querySelector("option[value="+b.getAttribute("data-id")+"]"),d.classList.remove("totara_form_option_invisible"),d.disabled=!1,b.remove();break;case"move-up":null!==b.previousElementSibling&&b.parentElement.insertBefore(b,b.previousElementSibling);break;case"move-down":null!==b.nextElementSibling&&b.nextElementSibling.insertAdjacentElement("afterend",b)}this.changed()}},c});
define('totara_catalog/form_element_multiple_select', ["totara_form/form","core/templates"],function(a,b){function c(b,d,e,f){return this instanceof c?(a.Element.apply(this,arguments),this.input=document.getElementById(e),this.id=e,this.parent=b,this.node=f,this.addSelector=this.input.getElementsByClassName("totara_catalog-multiple_select__addicon")[0],void(this.name=this.input.getAttribute("data-name"))):new c(b,d,e,f)}return c.prototype=Object.create(a.Element.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object multiSelect]"},c.prototype.init=function(a){var b=this.addSelector.options,c=0;for(c=1;c<b.length;c++)this.input.querySelectorAll("[data-id="+b[c].value+"]").length>0&&(b[c].classList.add("totara_form_option_invisible"),b[c].disabled=!0);this.addSelector.addEventListener("change",this._addItem.bind(this)),this.input.addEventListener("click",this._changeItem.bind(this)),this._checkempty(),a()},c.prototype.getValue=function(){var a,b=this.input.getElementsByTagName("ol")[0].getElementsByTagName("li"),c=[];for(a=0;a<b.length;a++)c.push(b[a].getAttribute("data-id"));return c},c.prototype._addItem=function(a){if(""!==a.target.value){var c=this,d=a.target,e=d.selectedIndex,f={id:d.value,iconname:d.options[e].text};b.render("totara_catalog/element_multiple_select__item",f).done(function(a){c.input.querySelector("#"+c.id+"_list").insertAdjacentHTML("beforeend",a),d.options[e].classList.add("totara_form_option_invisible"),d.options[e].disabled=!0,d.selectedIndex=0,c._changed()})}},c.prototype._changeItem=function(a){var b=a.target.closest("li"),c=a.target.closest("[data-action]");if(c){switch(a.preventDefault(),c.getAttribute("data-action")){case"delete":var d,e=this.input.getElementsByClassName("totara_catalog-multiple_select__addicon")[0];d=e.querySelector("option[value="+b.getAttribute("data-id")+"]"),d.classList.remove("totara_form_option_invisible"),d.disabled=!1,b.remove();break;case"move-up":null!==b.previousElementSibling&&b.parentElement.insertBefore(b,b.previousElementSibling);break;case"move-down":null!==b.nextElementSibling&&b.nextElementSibling.insertAdjacentElement("afterend",b)}this._changed()}},c.prototype._changed=function(){this.node.querySelector("[type=hidden]").value=JSON.stringify(this.getValue()),this._checkempty(),this.changed()},c.prototype._checkempty=function(){null===this.input.querySelector(".totara_catalog-multiple_select__selected li")?this.input.classList.add("totara_catalog-multiple_select__noitems"):this.input.classList.remove("totara_catalog-multiple_select__noitems")},c});
define('totara_catalog/item_style_toggle', [],function(){function a(){return this instanceof a?(this.activeClass="tw-catalogItemStyleToggle__btn_active",void(this.widget="")):new a}a.prototype={events:function(){var a=this;this.widget.addEventListener("click",function(b){if(b.preventDefault(),b.target&&b.target.closest("[data-tw-catalogItemStyleToggle_trigger]")){var c=b.target.closest("[data-tw-catalogItemStyleToggle_trigger]");if(c.classList.contains(a.activeClass))return;a.toggle(c),a.triggerEvent("changed",{})}})},preset:function(){var a=this.widget.querySelector("."+this.activeClass);a&&this.triggerEvent("add",{key:"itemstyle",val:a.getAttribute("data-tw-catalogItemStyleToggle_trigger")})},setParent:function(a){this.widget=a},toggle:function(a){for(var b=this.widget.querySelectorAll("[data-tw-catalogItemStyleToggle_trigger]"),c=0;c<b.length;c++)b[c].classList.toggle(this.activeClass);this.triggerEvent("add",{key:"itemstyle",val:a.getAttribute("data-tw-catalogItemStyleToggle_trigger")})},triggerEvent:function(a,b){var c=new CustomEvent("totara_catalog/item_style_toggle:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),d.preset(),d.events(),c(d)})};return{init:b}});
define('totara_catalog/manage_btns', [],function(){function a(){return this instanceof a?void(this.widget=""):new a}a.prototype={events:function(){this.widget.addEventListener("click",function(a){if(a.target){var b=a.target.closest("#tw-catalogMagageBtns_button");if(b){a.target.closest(".tw-catalogManageBtns__group_options")||a.preventDefault(),"true"===b.getAttribute("aria-expanded")?b.setAttribute("aria-expanded","false"):b.setAttribute("aria-expanded","true");var c=a.target.closest("[data-tw-catalogManageBtnsGroup]");c.classList.toggle("tw-catalog__activePopover")}}})},setParent:function(a){this.widget=a}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),d.events(),c(d)})};return{init:b}});
define('totara_catalog/pagination', [],function(){function a(){return this instanceof a?void(this.widget=""):new a}a.prototype={events:function(){var a=this;this.widget.addEventListener("click",function(b){if(b.preventDefault(),b.target&&b.target.closest("[data-tw-pagination-trigger]")){var c=b.target.getAttribute("data-tw-pagination-limitFrom"),d=b.target.getAttribute("data-tw-pagination-maxCount");a.triggerEvent("changed",{limitfrom:c,maxcount:d})}})},setParent:function(a){this.widget=a},triggerEvent:function(a,b){var c=new CustomEvent("totara_catalog/pagination:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),d.events(),c(d)})};return{init:b}});
define('totara_catalog/results_share', [],function(){function a(){return this instanceof a?(this.activeClass="tw-catalog__activePopover",void(this.widget="")):new a}a.prototype={copyToClipboard:function(){var a=this.widget.querySelector("[data-tw-catalogResultsShare_url]");a.select(),document.execCommand("copy")},displayURL:function(){var a=this.widget.querySelector("[data-tw-catalogResultsShare_url]"),b=window.location.href;a.setAttribute("value",b)},events:function(){var a=this;this.widget.addEventListener("click",function(b){if(b.target&&!b.target.closest("label"))if(b.preventDefault(),b.target.closest("[data-tw-catalogResultsShare_btn]")){a.displayURL(),a.toggleUI();var c=a.widget.querySelector("[data-tw-catalogresultsshare_expanded]");c.getBoundingClientRect().top<0&&c.scrollIntoView({block:"start"})}else b.target.closest("[data-tw-catalogresultsshare_close]")?a.toggleUI():b.target.closest("[data-tw-catalogResultsShare_expanded_btn]")&&a.copyToClipboard()})},setParent:function(a){this.widget=a},toggleUI:function(){this.widget.classList.toggle(this.activeClass)},triggerEvent:function(a,b){var c=new CustomEvent("catalog/results_share:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),d.events(),c(d)})};return{init:b}});
define('totara_catalog/results_sort', [],function(){function a(){return this instanceof a?void(this.widget=""):new a}a.prototype={bubbledEventsListener:function(){var a="totara_core/select_tree",b=this;this.widget.addEventListener(a+":add",function(a){b.triggerEvent("add",a.detail)}),this.widget.addEventListener(a+":changed",function(){b.triggerEvent("changed",{})}),this.widget.addEventListener(a+":remove",function(a){b.triggerEvent("remove",a.detail)})},setParent:function(a){this.widget=a},triggerEvent:function(a,b){var c=new CustomEvent("totara_catalog/results_sort:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),d.bubbledEventsListener(),c(d)})};return{init:b}});
define('totara_catalog/toggle_filter_panel', [],function(){function a(){return this instanceof a?(this.activeClass="tw-toggleFilterPanel__active",this.fixedClass="tw-toggleFilterPanel__trigger_fixed",this.targetwidget=".tw-selectRegionPanel",this.toggleClass="tw-selectRegionPanel__hiddenOnSmall_show",void(this.widget="")):new a}a.prototype={constructor:a,events:function(){var a=this;this.widget.addEventListener("click",function(b){b.preventDefault(),b.target&&b.target.closest("[data-tw-toggleFilterPanel-trigger]")&&a.toggleWidget()}),this.setPositionFixedEvent=function(){var b=a.widget.querySelector("[data-tw-toggleFilterPanel-trigger]"),c=a.widget.parentNode,d=c.getBoundingClientRect().top,e=a.widget.offsetHeight,f=c.offsetHeight-e;d<0&&d>-f?b.classList.add(a.fixedClass):b.classList.remove(a.fixedClass)};var b=new MutationObserver(function(){if("false"!==a.widget.getAttribute("data-tw-toggleFilterPanel-addLabelContent")){var b=a.widget.getAttribute("data-tw-toggleFilterPanel-addLabelContent");a.widget.querySelector("[data-tw-toggleFilterPanel-extraContent]").innerHTML=b,a.widget.setAttribute("data-tw-toggleFilterPanel-addLabelContent",!1)}});b.observe(this.widget,{attributes:!0,attributeFilter:["data-tw-togglefilterpanel-addlabelcontent"],subtree:!1})},setParent:function(a){this.widget=a},setPositionFixed:function(){var a=this.widget.querySelector("[data-tw-toggleFilterPanel-trigger]");this.widget.classList.contains(this.activeClass)?window.addEventListener("scroll",this.setPositionFixedEvent,!0):(window.removeEventListener("scroll",this.setPositionFixedEvent,!0),a.classList.remove(this.fixedClass))},toggleWidget:function(){this.widget.classList.toggle(this.activeClass),this.setPositionFixed(),this.triggerEvent("changed",{targetwidget:this.targetwidget,toggleClass:this.toggleClass})},triggerEvent:function(a,b){var c=new CustomEvent("totara_catalog/toggle_filter_panel:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),d.events(),c(d)})};return{init:b}});
define('totara_cohort/assignroles', ["jquery"],function(a){var b={init:function(){a("#selectallnoneroles").click(function(){a(".selectedroles").prop("checked",!a(".selectedroles").prop("checked"))})}};return b});
define('totara_competency/achievement_paths', ["core/templates","core/ajax","core/modal_factory","core/modal_events","core/notification","core/str","totara_competency/loader_manager"],function(a,b,c,d,e,f,g){function h(){return this instanceof h?(this.widget="",this.aggFunction="",this.aggType="",this.competencyId="",this.criteriaTypes=[],this.dirty=!1,this.draggedNode="",this.filename="achievement_paths.js",this.lastKey=0,this.loader=null,this.markedForDeletionPathways=[],this.nDeletedPaths=0,this.nPaths=0,this.pathways=[],this.singlevalShown=!1,this.busyAddPathway="",this.dropPlaceholder=document.createElement("div"),this.dropPlaceholder.className="tw-editAchievementPaths__dropPlaceholder",this.dropPlaceholder.innerText=" ",this.endpoints={criteriaTypes:"pathway_criteria_group_get_criteria_types",pathways:"totara_competency_get_pathways",deletePathways:"totara_competency_delete_pathways",setOverallAggregation:"totara_competency_set_overall_aggregation"},void(this.handleDrop=this.handleDrop.bind(this))):new h}h.prototype={events:function(){var a=this;this.widget.addEventListener("click",function(b){if(b.target&&""===a.busyAddPathway)if(b.target.closest("[data-tw-editAchievementPaths-action]")){var c=b.target.closest("[data-tw-editAchievementPaths-action]").getAttribute("data-tw-editAchievementPaths-action");"apply"===c?a.applyChanges():"cancel"===c&&a.cancelChanges()}else if(b.target.closest("[data-tw-editScaleValuePaths-add")){var d=b.target.closest("[data-tw-editScaleValuePaths-add]"),e=b.target.closest("[data-tw-editScaleValuePaths-scale-id]");d&&a.showCriteriaTypeDropDown(e)}else if(b.target.closest('[data-tw-editScaleValuePaths-dropDown-level="scalevalue"]')){var f=b.target.closest('[data-tw-editScaleValuePaths-dropDown-level="scalevalue"]'),g=b.target.closest("[data-tw-editScaleValuePaths-scale-id]");a.addSingleValuePath(g,f)}else if(b.target.closest("[data-tw-editAchievementPaths-pathway-action]")){var h=b.target.closest("[data-tw-editAchievementPaths-pathway-action]").getAttribute("data-tw-editAchievementPaths-pathway-action"),i=b.target.closest("[data-tw-editAchievementPaths-pathway-key]").getAttribute("data-tw-editAchievementPaths-pathway-key");"remove"===h?a.removePathway(i,""):"undo"===h&&a.undoRemovePathway(i)}else if(b.target.closest("[data-tw-editAchievementPaths-aggregation-action]")){var j=b.target.closest("[data-tw-editAchievementPaths-aggregation-action]"),k=j.getAttribute("data-tw-editAchievementPaths-aggregation-action");if(j.classList.contains("tw-editAchievementPaths__btn-active"))return;a.widget.querySelector(".tw-editAchievementPaths__btn-active").classList.remove("tw-editAchievementPaths__btn-active"),j.classList.add("tw-editAchievementPaths__btn-active"),"edit"===k?a.disableOrdering():"move"===k&&a.enableOrdering()}}),this.widget.addEventListener("change",function(b){if(b.target&&""===a.busyAddPathway)if(b.target.closest("[data-tw-editAchievementPaths-add-pathway]")){var c=b.target.closest("[data-tw-editAchievementPaths-add-pathway]"),d=c.querySelector("option:checked");if("0"!=d.value){a.addPath(d),c.value="0";var e=document.querySelector("#add-pathway-sr-only");e.innerText=d.innerText+" "+e.dataset.ariaLiveExtraText}}else b.target.closest("[data-tw-editAchievementPaths-aggregation-change]")&&(a.setOverallAggregation(),a.dirty=!0,a.enableApplyChanges())}),this.widget.addEventListener("dragstart",function(b){b.target.hasAttribute("data-tw-editAchievementPaths-draggable")&&(a.draggedNode=b.target,setTimeout(function(){a.dropPosition=a.getDropPosition(a.draggedNode,b.clientY),a.dropPosition&&a.insertChildAtIndex(a.dropPosition.groupNode,a.dropPosition.index,a.dropPlaceholder),a.draggedNode===b.target&&(a.draggedNode.style.display="none")},0))}),this.widget.addEventListener("dragend",function(b){a.handleDrop(b),a.draggedNode.style.display="",a.draggedNode="",a.dropPlaceholder.remove()}),this.widget.addEventListener("drag",function(a){a.preventDefault()}),this.widget.addEventListener("dragover",function(b){a.draggedNode&&(a.dropPosition=a.getDropPosition(a.draggedNode,b.clientY),a.dropPosition&&a.insertChildAtIndex(a.dropPosition.groupNode,a.dropPosition.index,a.dropPlaceholder))}),window.addEventListener("click",this.hideCriteriaTypeSelectors.bind(this)),window.addEventListener("beforeunload",function(b){return a.dirty?(b.preventDefault(),b.returnValue="",""):""})},bubbledEventsListener:function(){var a=this,b="totara_competency/pathway:";this.widget.addEventListener(b+"dirty",function(b){var c=b.detail.key;a.pathways[c]&&(a.pathways[c].dirty=!0),a.dirty=!0,a.enableApplyChanges()}),this.widget.addEventListener(b+"update",function(b){var c=b.detail.key,d=b.detail.pathway;a.pathways[c]||(a.pathways[c]={id:d.id||0,type:d.type||""},d.scalevalue&&(a.singlevalShown=!0,a.toggleSingleUseCriteriaTypes(!1,d.scalevalue)),a.nPaths+=1,a.showHideNoPaths()),d.type&&delete d.type,a.pathways[c].singleuse=d.singleuse||0,a.pathways[c].singleuse&&a.toggleSingleUsePathwayTypes(!1,a.pathways[c].type),delete d.singleuse,a.pathways[c].detail=d,a.unsetBusyAddPathway()}),this.widget.addEventListener(b+"remove",function(b){var c=b.detail.key,d=b.detail.pendingJsKey||"";a.removePathway(c,d)}),this.widget.addEventListener(b+"singleUseCriterion",function(b){var c=b.detail.used,d=b.detail.scalevalue;a.widget.setAttribute("data-tw-editAchievementPaths-criteria-singleUse",c?"1":"0"),a.toggleAllSingleUseCriteriaTypes(!c),c?a.hideAddScaleValuePaths(d):a.showAddScaleValuePaths(d)})},setParent:function(a){this.widget=a},showNotification:function(a,b,c,d){"undefined"==typeof d&&(d={}),e.clearNotifications(),f.get_string(b,c,d).done(function(b){e.addNotification({message:b,type:a}),window.scrollTo(0,0)}).fail(e.exception)},initData:function(){var a=this;return new Promise(function(b,c){a.competencyId=a.widget.getAttribute("data-tw-editAchievementPaths-competency"),a.getCriteriaTypes().then(function(){a.setOverallAggregation(),b()})["catch"](function(b){b.fileName=a.filename,b.name="Error retrieving criteria types",e.exception(b),c()})})},getNextKey:function(){return this.lastKey++,"pw_new_"+this.lastKey},updatePage:function(){var c=this,d="totara_competency/achievement_paths_group",f=this.widget.querySelector("[data-tw-editAchievementPaths-groups]"),g={args:{competency_id:c.competencyId},methodname:c.endpoints.pathways};return new Promise(function(h,i){b.getData(g).then(function(b){var g=b.results;c.pathways=[],c.nPaths=0,a.renderReplace(d,{criteria_types:c.criteriaTypes,pathway_groups:g},f).then(function(){c.singlevalShown=c.hasSingleValuePaths(),c.showHideNoPaths(),h()})["catch"](function(a){a.fileName=c.filename,a.name="Error updating pathways",e.exception(a),i()})})["catch"](function(a){a.fileName=c.filename,a.name="Error retrieving pathways",e.exception(a),i()})})},addPath:function(b){var c=b.value,d=b.text,f="";if(""===this.busyAddPathway&&(b.hasAttribute("data-tw-editAchievementPaths-path-template")&&(f=b.getAttribute("data-tw-editAchievementPaths-path-template")),"0"!=c)){if("singlevalue"===c)return this.singlevalShown=!0,void this.showHideNoPaths();this.setBusyAddPathway(c);var g,h,i=this,j=i.getNextKey(),k="totara_competency/partial_pathway";h={key:j,id:0,type:c,title:d,sortorder:0,pathway_templatename:f},this.pathways[j]=h,this.nPaths+=1,g=i.singlevalShown?i.widget.querySelector('[data-tw-editAchievementPaths-group="high-sortorder"]'):i.widget.querySelector('[data-tw-editAchievementPaths-group="low-sortorder"]'),a.renderAppend(k,this.pathways[j],g).then(function(){i.calculateSortOrderFromDisplay(),i.dirty=!0,i.showHideNoPaths(),i.enableApplyChanges(),a.runTemplateJS("")})["catch"](function(a){a.fileName=i.filename,a.name="Error displaying "+c,e.exception(a)})}},hideCriteriaTypeSelectors:function(a){var b=a&&a.target&&a.target.closest("[data-tw-editscalevaluepaths-add]");if(!b){for(var c=this.widget.querySelectorAll('[data-tw-editScaleValuePaths-dropDown="scalevalue"]'),d=0;d<c.length;d++)c[d].classList.add("tw-editAchievementPaths--hidden");for(var e=document.querySelectorAll("[data-tw-editscalevaluepaths-add]"),d=0;d<e.length;d++)e[d].setAttribute("aria-expanded","false")}},showCriteriaTypeDropDown:function(a){var b=a.querySelector('[data-tw-editScaleValuePaths-dropDown="scalevalue"]'),c=!b.classList.contains("tw-editAchievementPaths--hidden"),d=a.querySelector("[data-tw-editscalevaluepaths-add]");this.hideCriteriaTypeSelectors(),b&&!c&&(b.classList.remove("tw-editAchievementPaths--hidden"),d&&d.setAttribute("aria-expanded","true"))},addSingleValuePath:function(b,c){var d,f,g,h,i=this,j="criteria_group",k=b,l=parseInt(k.getAttribute("data-tw-editScaleValuePaths-pathway-list")),m="totara_competency/partial_pathway",n=c.getAttribute("data-tw-editScaleValuePaths-dropDown-item-type"),o=b.getAttribute("data-tw-editScaleValuePaths-scale-id");""===this.busyAddPathway&&(i.setBusyAddPathway("criteria_group"),d=this.getNextKey(),g=d+"_criterion_1",h=this.criteriaTypes.find(function(a){return a.type===n}),h.key=g,h.expandable=!h.singleuse,f={key:d,type:j,scalevalue:o,sortorder:0,pathway_templatename:"pathway_criteria_group/pathway_criteria_group_edit",criteria_type_level:j,criteria_types:this.criteriaTypes,criteria:[h],showor:l>0},this.pathways[d]=f,this.nPaths+=1,a.renderAppend(m,f,k).then(function(){k.setAttribute("data-tw-editScaleValuePaths-pathway-list",l+1),i.hideCriteriaTypeSelectors(),i.toggleSingleUseCriteriaTypes(!1,o),i.calculateSortOrderFromDisplay(),i.dirty=!0,i.enableApplyChanges(),a.runTemplateJS("")})["catch"](function(a){a.fileName=i.filename,a.name="Error displaying "+j,e.exception(a)}))},applyChanges:function(){var a,c,d,f,g,h=this,i=this.widget.querySelectorAll("[data-tw-editAchievementPaths-save-endPoint]"),j=[];if(this.dirty){M.util.js_pending("competencyAchievementPathsApplyChanges"),this.loader.show(),this.disableOrdering(),this.dirty=!1,this.disableApplyChanges();for(var k=Math.round(Date.now()/1e3),l=0;l<i.length;l++)a=i[l].getAttribute("data-tw-editAchievementPaths-save-endPoint"),c=i[l].getAttribute("data-tw-editAchievementPaths-save-req-sortOrder"),d=i[l].closest("[data-tw-editAchievementPaths-pathway-key]").getAttribute("data-tw-editAchievementPaths-pathway-key"),this.pathways[d]&&this.pathways[d].dirty&&this.pathways[d].detail&&(g={args:this.pathways[d].detail,methodname:a},g.args.actiontime=k,c&&(f=i[l].closest("[data-tw-editAchievementPaths-pathway-sortOrder]"),f&&(g.args.sortorder=f.getAttribute("data-tw-editAchievementPaths-pathway-sortOrder"))),j.push(b.getData(g)));if(this.nDeletedPaths>0){var m=[];for(d in this.markedForDeletionPathways)m.push({type:this.markedForDeletionPathways[d].type,id:this.markedForDeletionPathways[d].id});g={args:{competency_id:this.competencyId,pathways:m,actiontime:k},methodname:this.endpoints.deletePathways},j.push(b.getData(g))}g={args:{competency_id:this.competencyId,type:this.aggType,actiontime:k},methodname:this.endpoints.setOverallAggregation},j.push(b.getData(g)),j.length>0&&Promise.all(j).then(function(){h.updatePage().then(function(){h.showNotification("success","apply_success","totara_competency",{}),h.loader.hide(),M.util.js_complete("competencyAchievementPathsApplyChanges")})["catch"](function(a){a.fileName=h.filename,a.name="Error updating the page",e.exception(a),h.loader.hide(),M.util.js_complete("competencyAchievementPathsApplyChanges")})})["catch"](function(a){h.dirty=!0,h.enableApplyChanges(),a.fileName=h.filename,a.name="Error applying changes",e.exception(a),h.loader.hide(),M.util.js_complete("competencyAchievementPathsApplyChanges")})}},showHideNoPaths:function(){var a=this.widget.querySelector("[data-tw-editAchievementPaths-aggregation]"),b=this.widget.querySelector("[data-tw-editAchievementPaths-empty]"),c=this.widget.querySelector('[data-tw-editAchievementPaths-group="singlevalue"]'),d=this.widget.querySelector('[data-tw-editAchievementPaths-add-pathway] option[value="singlevalue"]');0!=this.nPaths||this.singlevalShown?(a&&a.classList.remove("tw-editAchievementPaths--hidden"),b&&b.classList.add("tw-editAchievementPaths--hidden")):(a&&a.classList.add("tw-editAchievementPaths--hidden"),b&&b.classList.remove("tw-editAchievementPaths--hidden")),this.singlevalShown?(c&&c.classList.remove("tw-editAchievementPaths--hidden"),d&&(d.disabled=!0)):(c&&c.classList.add("tw-editAchievementPaths--hidden"),d&&(d.disabled=!1))},calculateSortOrderFromDisplay:function(){for(var a,b,c=this.widget.querySelectorAll("[data-tw-editAchievementPaths-pathway-key]"),d=0,e=0;e<c.length;e++)a=c[e].getAttribute("data-tw-editAchievementPaths-pathway-key"),this.pathways[a]?b=this.pathways[a]:this.markedForDeletionPathways[a]&&(b=this.markedForDeletionPathways[a]),b.sortorder!=d+1&&(this.pathways[a]?this.pathways[a].dirty=!0:this.markedForDeletionPathways[a]&&(this.markedForDeletionPathways[a].dirty=!0)),b.sortorder=++d,c[e].setAttribute("data-tw-editAchievementPaths-pathway-sortOrder",b.sortorder)},cancelChanges:function(){var a=this.widget.getAttribute("data-tw-editAchievementPaths-back-url");a&&(window.location.href=a)},removePathway:function(a,b){var c=this.widget.querySelector('[data-tw-editAchievementPaths-pathway-key="'+a+'"]');if(e.clearNotifications(),this.pathways[a])if(this.dirty=!0,this.enableApplyChanges(),this.pathways[a].singleuse&&this.toggleSingleUsePathwayTypes(!0,this.pathways[a].type),this.pathways[a].id&&0!=this.pathways[a].id){var d={};d[a]=this.pathways[a],Object.assign(this.markedForDeletionPathways,d),this.nDeletedPaths+=1,delete this.pathways[a];for(var f,g=c.querySelectorAll("[data-pw-on-delete]"),h=0;h<g.length;h++)f=g[h].getAttribute("data-pw-on-delete"),"mark"==f?g[h].classList.add("tw-editAchievementPaths--deleted"):"hide"==f&&g[h].classList.add("tw-editAchievementPaths--hidden");var i=c.querySelector('[data-tw-editAchievementPaths-pathway-action="remove"]'),j=c.querySelector('[data-tw-editAchievementPaths-pathway-action="undo"]');i.classList.add("tw-editAchievementPaths--hidden"),j.classList.remove("tw-editAchievementPaths--hidden")}else{if(this.pathways[a].scalevalue){var k=this.widget.querySelector('[data-tw-editScaleValuePaths-scale-id="'+this.pathways[a].scalevalue+'"]'),l=this.widget.querySelector('[data-pw-or="'+a+'"]'),m=k,n=parseInt(m.getAttribute("data-tw-editScaleValuePaths-pathway-list"));if(l)l.remove();else{var o=k.querySelectorAll("[data-pw-or]");o.length>0&&o[0].remove()}if(n-=1,m.setAttribute("data-tw-editScaleValuePaths-pathway-list",n),0==n){var p=this.hasSingleUseCriteria();p||this.toggleSingleUseCriteriaTypes(!0,this.pathways[a].scalevalue)}}delete this.pathways[a],this.nPaths-=1,this.showHideNoPaths(),c&&c.remove()}""!==b&&M.util.js_complete(b)},undoRemovePathway:function(a){var b=this.widget.querySelector('[data-tw-editAchievementPaths-pathway-key="'+a+'"]'),c={};if(this.markedForDeletionPathways[a]){if(e.clearNotifications(),this.markedForDeletionPathways[a].singleuse){var d=this.widget.querySelectorAll('[data-tw-editachievementpaths-pathway-type="'+this.markedForDeletionPathways[a].type+'"]');if(d.length>1)return f.get_string("error_cant_undo_single_use","totara_competency").done(function(a){e.addNotification({message:a,type:"error"}),window.scrollTo(0,0)}).fail(e.exception),!1;this.toggleSingleUsePathwayTypes(!1,this.markedForDeletionPathways[a].type)}c[a]=this.markedForDeletionPathways[a],Object.assign(this.pathways,c),delete this.markedForDeletionPathways[a],this.nDeletedPaths-=1;for(var g,h=b.querySelectorAll("[data-pw-on-delete]"),i=0;i<h.length;i++)g=h[i].getAttribute("data-pw-on-delete"),"mark"==g?h[i].classList.remove("tw-editAchievementPaths--deleted"):"hide"==g&&h[i].classList.remove("tw-editAchievementPaths--hidden");var j=b.querySelector('[data-tw-editAchievementPaths-pathway-action="remove"]'),k=b.querySelector('[data-tw-editAchievementPaths-pathway-action="undo"]');j.classList.remove("tw-editAchievementPaths--hidden"),k.classList.add("tw-editAchievementPaths--hidden")}},getCriteriaTypes:function(){var a=this,c=this.hasSingleUseCriteria();return new Promise(function(d,f){if(a.criteriaTypes&&a.criteriaTypes.length>0)d();else{var g={args:{},methodname:a.endpoints.criteriaTypes};b.getData(g).then(function(b){var e=b.results;a.criteriaTypes=[];for(var f=0;f<e.length;f++)e[f].disabled=!!+e[f].singleuse&&c,a.criteriaTypes.push(e[f]);d()})["catch"](function(b){b.fileName=a.filename,b.name="Error getting criteria types",e.exception(b),f()})}})},toggleSingleUsePathwayTypes:function(a,b){var c,d=this.widget.querySelector("[data-tw-editAchievementPaths-add-pathway]");if(d&&(c=d.querySelectorAll('[data-tw-editachievementpaths-path-singleUse="1"]')),c)for(var e=0;e<c.length;e++)c[e].getAttribute("data-tw-editachievementpaths-path-type")==b&&(a?c[e].removeAttribute("disabled"):c[e].setAttribute("disabled",""))},toggleAllSingleUseCriteriaTypes:function(a){for(var b,c,d,e,f=this.widget.querySelectorAll('[data-tw-editScaleValuePaths-dropDown="scalevalue"]'),g=0;g<f.length;g++)if(b=f[g].closest("[data-tw-editScaleValuePaths-scale-id]"),c=null,e=0,d=f[g].querySelectorAll('[data-tw-editScaleValuePaths-dropDown-item-singleUse="1"]'),b&&(c=b.getAttribute("data-tw-editScaleValuePaths-scale-id"),e=parseInt(b.getAttribute("data-tw-editscalevaluepaths-pathway-list")||"0")),c&&d.length&&!(e>0))if(a)for(var h=0;h<d.length;h++)d[h].removeAttribute("disabled");else for(var i=0;i<d.length;i++)d[i].setAttribute("disabled","")},toggleSingleUseCriteriaTypes:function(a,b){var c,d,e=this.widget.querySelector('[data-tw-editScaleValuePaths-scale-id="'+b+'"]');if(e&&(c=e.querySelector('[data-tw-editScaleValuePaths-dropDown="scalevalue"]')),c&&(d=c.querySelectorAll('[data-tw-editScaleValuePaths-dropDown-item-singleUse="1"]')))if(a)for(var f=0;f<d.length;f++)d[f].removeAttribute("disabled");else for(var g=0;g<d.length;g++)d[g].setAttribute("disabled","")},hideAddScaleValuePaths:function(a){var b,c=this.widget.querySelector('[data-tw-editScaleValuePaths-scale-id="'+a+'"]');c&&(b=c.querySelector("[data-tw-editScaleValuePaths-add]")),b&&b.classList.add("tw-editAchievementPaths--hidden")},showAddScaleValuePaths:function(a){var b,c=this.widget.querySelector('[data-tw-editScaleValuePaths-scale-id="'+a+'"]');c&&(b=c.querySelector("[data-tw-editScaleValuePaths-add]")),b&&b.classList.remove("tw-editAchievementPaths--hidden")},setOverallAggregation:function(){var a=this.widget.querySelector("[data-tw-editAchievementPaths-aggregation-change]"),b=a.querySelector("option:checked"),c=this.widget.querySelector("[data-tw-editAchievementPaths-aggregation-actions]");this.aggType=b.value,b.hasAttribute("data-tw-editAchievementPaths-aggregation-function")?(this.aggFunction=b.getAttribute("data-tw-editAchievementPaths-aggregation-function"),c&&c.classList.remove("tw-editAchievementPaths--hidden")):(this.aggFunction="",c&&c.classList.add("tw-editAchievementPaths--hidden"))},enableOrdering:function(){for(var a,b=this.widget.querySelectorAll("[data-tw-editAchievementPaths-draggable]"),c=this.widget.querySelectorAll("[data-tw-editAchievementPaths-on-ordering]"),d=0;d<b.length;d++)b[d].classList.add("tw-editAchievementPaths__activeDropZone"),b[d].draggable=!0;for(var e=0;e<c.length;e++)a=c[e].getAttribute("data-tw-editAchievementPaths-on-ordering"),"hide"==a?c[e].classList.add("tw-editAchievementPaths--hidden"):"show"==a?c[e].classList.remove("tw-editAchievementPaths--hidden"):"disable"==a&&(c[e].disabled=!0)},disableOrdering:function(){this.widget.querySelector(".tw-editAchievementPaths__btn-active").classList.remove("tw-editAchievementPaths__btn-active"),this.widget.querySelector(".tw-editAchievementPaths__btn[data-tw-editachievementpaths-aggregation-action=edit]").classList.add("tw-editAchievementPaths__btn-active");for(var a,b=this.widget.querySelectorAll("[data-tw-editAchievementPaths-draggable]"),c=this.widget.querySelectorAll("[data-tw-editAchievementPaths-on-ordering]"),d=0;d<b.length;d++)b[d].classList.remove("tw-editAchievementPaths__activeDropZone"),b[d].draggable=!1;for(var e=0;e<c.length;e++)a=c[e].getAttribute("data-tw-editAchievementPaths-on-ordering"),"hide"==a?c[e].classList.remove("tw-editAchievementPaths--hidden"):"show"==a?c[e].classList.add("tw-editAchievementPaths--hidden"):"disable"==a&&(c[e].disabled=!1);this.aggFunction&&"function"==typeof this[this.aggFunction]&&this[this.aggFunction]()},hasSingleValuePaths:function(){return!!this.widget.querySelectorAll(".tw-editScaleValuePathsGroup").length},hasSingleUseCriteria:function(){var a=this.widget.getAttribute("[data-tw-editAchievementPaths-criteria-singleUse]")||0;return!!+a},enableApplyChanges:function(){var a=this.widget.querySelector('[data-tw-editAchievementPaths-action="apply"]');a&&this.dirty&&a.removeAttribute("disabled")},disableApplyChanges:function(){var a=this.widget.querySelector('[data-tw-editAchievementPaths-action="apply"]');a&&a.setAttribute("disabled","")},getDropPosition:function(a,b){if(!b)return null;var c=this.widget.querySelector('[data-tw-editAchievementPaths-group="high-sortorder"]'),d=this.widget.querySelector('[data-tw-editAchievementPaths-group="low-sortorder"]'),e=Array.prototype.slice.call(this.widget.querySelectorAll(".tw-editAchievementPaths__activeDropZone")),f={groupNode:d,index:0};return e.forEach(function(a){var d=a.getBoundingClientRect();if(0!==d.height){var e=d.top+d.height/2;if(b>e){var g=a.closest("[data-tw-editAchievementPaths-group]"),h=g.getAttribute("data-tw-editAchievementPaths-group");if("singlevalue"===h)return void(f={groupNode:c,index:0});var i=Array.prototype.slice.call(g.children),j=i.indexOf(a);f={groupNode:g,index:j+1}}}}),f},insertChildAtIndex:function(a,b,c){a.children[b]?a.insertBefore(c,a.children[b]):a.appendChild(c)},handleDrop:function(a){var b=this;a.preventDefault(),a.stopPropagation();var c=this.draggedNode&&(this.dropPosition||this.getDropPosition(this.draggedNode,a.clientY));if(this.draggedNode&&c){var d=c.groupNode.getAttribute("data-tw-editAchievementPaths-group"),e=this.draggedNode.closest("[data-tw-editAchievementPaths-group]").getAttribute("data-tw-editAchievementPaths-group"),f=this.widget.querySelector('[data-tw-editAchievementPaths-group="high-sortorder"]'),g=this.widget.querySelector('[data-tw-editAchievementPaths-group="low-sortorder"]');if(this.draggedNode.style.display="","singlevalue"===e){var h=Array.prototype.slice.call(c.groupNode.children);"low-sortorder"===d?h.slice(c.index).forEach(function(a,c){b.insertChildAtIndex(f,c,a)}):"high-sortorder"===d&&h.slice(0,c.index).forEach(function(a){g.appendChild(a)})}else this.insertChildAtIndex(c.groupNode,c.index,this.draggedNode);this.dirty=!0,this.enableApplyChanges()}this.dropPlaceholder.parentNode&&this.dropPlaceholder.remove()},setBusyAddPathway:function(a){this.busyAddPathway=a,M.util.js_pending(this.busyAddPathway),this.loader.show()},unsetBusyAddPathway:function(){""!==this.busyAddPathway&&(this.loader.hide(),M.util.js_complete(this.busyAddPathway),this.busyAddPathway="")}};var i=function(a){return new Promise(function(b){var c=new h;c.setParent(a),c.events(),c.bubbledEventsListener(),c.loader=g.init(a),b(c),M.util.js_pending("competencyAchievementPaths"),c.loader.show(),c.initData().then(function(){c.loader.hide(),M.util.js_complete("competencyAchievementPaths")})["catch"](function(){})})};return{init:i}});
define('totara_competency/action_list_manager', ["core/str","core/templates","core/notification","totara_competency/paging_manager","core/ajax"],function(a,b,c,d,e){function f(){return this instanceof f?(this.appendType="replace",this.counter="",this.disabledItems=[],this.disabledItemClass=".tw-list__cell_select_label_disabled",this.enabledActions=!0,this.enabledHierarchy=!0,this.eventListener="totara_core/lists",this.eventListenerNode="",this.listDataMap=[],this.listRequestArgs={direction:"asc",filters:{},order:""},this.iconList={},this.orderBy="",this.paging="",this.rowsSelector="[data-tw-list-row]",this.rowsTemplate="totara_competency/lists_rows",this.selectedItems=[],this.toggleLevel="",this.webservice="",void(this.widget="")):new f}f.prototype.onCustomAction=function(){},f.prototype.onHideSubLevelItems=function(){},f.prototype.onItemSelected=function(){},f.prototype.onItemUnselected=function(){},f.prototype.onItemUpdate=function(){},f.prototype.onListHierarchyLevelChange=function(){},f.prototype.onListHierarchyLevelChangeExtend=function(){},f.prototype.onPostRequest=function(){},f.prototype.onPreRequest=function(){},f.prototype.onShowSubLevelItems=function(){},f.prototype.propagatedListEvents=function(){var a=this;this.eventListenerNode.addEventListener(this.eventListener+":action",function(b){a.onCustomAction(b)}),this.eventListenerNode.addEventListener(this.eventListener+":add",function(b){a.onItemSelected(b.detail.val)}),this.eventListenerNode.addEventListener(this.eventListener+":remove",function(b){a.onItemUnselected(b.detail.val)}),this.eventListenerNode.addEventListener(this.eventListener+":update",function(){a.onItemUpdate()}),this.eventListenerNode.addEventListener(this.eventListener+":hierarchyRequest",function(b){a.onListHierarchyLevelChange(b),a.onListHierarchyLevelChangeExtend(b)}),this.orderBy&&(this.orderBy.addEventListener("totara_core/select_tree:add",function(b){a.setOrderBy(b.detail.val)}),this.orderBy.addEventListener("totara_core/select_tree:changed",function(){a.update()})),this.toggleLevel&&this.eventListenerNode.addEventListener("totara_core/lists_toggle_level:changed",function(b){"all"==b.detail.level?a.onShowSubLevelItems():a.onHideSubLevelItems()})},f.prototype.formatListData=function(a){var b,c,d,e,f,g=!1,h=!1,i=this.getDataMap(),j=i.cols,k=i.actions?i.actions:[],l=i.icons?i.icons:null,m=a.items,n={has_actions:!1,hierarchyEnabled:i.hasHierarchy,noResultsText:i.noResultsString&&i.noResultsString.value?i.noResultsString.value:"",rows:[],row_header:{columns:[],header:!0},select_enabled:!!i.hasCheckboxes&&i.hasCheckboxes},o=this.selectedItems,p=this.disabledItems,q=this;return this.enabledHierarchy||(n.hierarchyEnabled=this.enabledHierarchy),c=!!i.hasExpandedView&&i.hasExpandedView,i.expandTemplate&&(n.expandTemplate=i.expandTemplate),i.expandWebservice&&(n.expandWebservice=i.expandWebservice),i.expandWebserviceArgs&&(n.expandWebserviceArgs=i.expandWebserviceArgs),o=o.map(function(a){return parseInt(a,10)}),p=p.map(function(a){return parseInt(a,10)}),new Promise(function(a){q.prepareListIcons(l).then(function(){for(var l=0;l<j.length;l++)b=j[l],n.row_header.columns.push({value:b.headerString.value,width:b.size});for(var r=!1,s=0;s<m.length;s++){if(o&&(g=o.indexOf(m[s].id)>-1),p&&(h=p.indexOf(m[s].id)>-1),i.extraRowData){d={};for(var t=0;t<i.extraRowData.length;t++){var u=i.extraRowData[t].key;d[u]=m[s][i.extraRowData[t].dataPath]}}else d="";f={active:g,columns:[],disabled:h,expandable:c,extra_data:d?JSON.stringify(d):"",has_children:parseInt(m[s].children_count),id:m[s].id,path:m[s].path},q.enabledActions&&(f.actions=q.prepareActions(k,m[s]),f.actions.length>0&&(r=!0));for(var v=0;v<j.length;v++){b=j[v],e=0===v?"":b.headerString.value;var w=null;b.columnTemplate&&(w=b.columnTemplate.template),f.columns.push({column_template:w,expand_trigger:b.expandedViewTrigger,label:e,value:m[s][b.dataPath],width:b.size})}n.rows.push(f)}n.has_actions=r,a(n)})})},f.prototype.getDataMap=function(){return this.listDataMap},f.prototype.getIconList=function(){return this.iconList},f.prototype.getRequestArgs=function(){return this.listRequestArgs},f.prototype.getRowsSelector=function(){return this.rowsSelector},f.prototype.getRowsTemplate=function(){return this.rowsTemplate},f.prototype.getWebservice=function(){return this.webservice},f.prototype.loadHeaderStrings=function(b){var c=b.cols?b.cols:[],d=b.noResultsString?b.noResultsString:"",e=[];d.value||(b.noResultsString?e.push({component:d.component,key:d.key}):e.push({component:"totara_core",key:"noitems"}));for(var f=0;f<c.length;f++){var g=c[f].headerString;g.value||e.push({component:g.component,key:g.key})}return new Promise(function(c){return e.length?void a.get_strings(e).then(function(a){d.value||(b.noResultsString={value:a[0]},a.shift());for(var e=0;e<b.cols.length;e++)b.cols[e].headerString.value||(b.cols[e].headerString.value=a[0],a.shift());c(b)}):void c(b)})},f.prototype.prepareActions=function(a,b){var d,e=this,f=[];if("function"==typeof a){if(d=a(b),d&&!Array.isArray(d))return c.exception({message:"Expected action callback to return an Array."}),[];f=d}else{if(!Array.isArray(a))return c.exception({message:"Expected either an Array of callbacks or one callback for actions setting."}),[];if(!(a.length>0))return[];for(var g=0;g<a.length;g++){if("function"!=typeof a[g])return c.exception({message:"Expected array of callbacks for actions setting."}),[];var h=a[g],i=h(b);if("object"!=typeof i)return c.exception({message:"Expected object to be returned by the action callback"}),[];f.push(i)}}d=[];for(var j=0;j<f.length;j++){var k="",l=e.getIconList(),m=f[j];m.icon&&m.icon in l&&(k=l[m.icon]),d.push({disabled:!!m.disabled&&m.disabled,event_key:m.eventKey?m.eventKey:null,hidden:!!m.hidden&&m.hidden,icon:k,name:m.name?m.name:""})}return d},f.prototype.prepareListIcons=function(b){var d=this;return new Promise(function(e){if(!b)return void e();if(!b||"function"!=typeof b)return c.exception({message:"Expected callback for the icons setting."}),void e();var f=b();if(!Array.isArray(f))return c.exception({message:"Expected icons callback to return an array."}),void e();for(var g=[],h=[],i=0;i<f.length;i++)f[i].string&&f[i].component&&(g.push({key:f[i].string,component:f[i].component}),h.push(f[i].key));g.length>0&&a.get_strings(g).then(function(a){for(var b="",c=[],g=0;g<f.length;g++){var i=h.indexOf(f[g].key);i>=0&&(b=a[i]);var j=d.renderIcon(f[g].key,f[g].name,f[g].classes,b);c.push(j)}Promise.all(c).then(function(){e()})})})},f.prototype.renderIcon=function(a,c,d,e){var f=this;return new Promise(function(g){b.renderIcon(c,e,d).done(function(b){f.iconList[a]=b,g()})})},f.prototype.renderListContent=function(a){var c=this.widget,d=this;return new Promise(function(e){d.renderListCount(a.total).then(function(){d.formatListData(a).then(function(a){if(a.expandWebservice&&c.setAttribute("data-tw-list-webservice-expand",a.expandWebservice),a.expandWebserviceArgs&&c.setAttribute("data-tw-list-webservice-expand-args",JSON.stringify(a.expandWebserviceArgs)),a.expandTemplate&&c.setAttribute("data-tw-list-template-expand",a.expandTemplate),"append"===d.appendType){var f=d.getRowsSelector(),g=c.querySelectorAll(f),h=g[g.length-1];b.renderAppendByItem(d.getRowsTemplate(),a,c,f).then(function(){c.setAttribute("data-tw-list-selectioncheck",!0),d.paging&&d.paging.setContentChangeType("replace"),h.scrollIntoView(),e()})}else b.renderReplace(d.getRowsTemplate(),a,c).then(function(){b.runTemplateJS("");var a=c.firstElementChild;a&&a.scrollIntoView(!1),c.setAttribute("data-tw-list-selectioncheck",!0),e()})})})})},f.prototype.renderListCount=function(b){var c=this.counter;return new Promise(function(d){if(!c)return void d();var e=c.querySelector("[data-tw-list-count-num]"),f=1===b?"listitem":"listitemplural";a.get_string(f,"totara_core",b).then(function(a){e.setAttribute("data-tw-list-count-num",b),e.innerHTML=a,d()})})},f.prototype.removeItemFromList=function(a){var b=this;return new Promise(function(c){if(b.widget.setAttribute("data-tw-list-removerow",JSON.stringify(a)),b.counter){var d=parseInt(b.counter.querySelector("[data-tw-list-count-num]").innerHTML),e=parseInt(a.length);b.renderListCount(d-e).then(c)}else c()})},f.prototype.disableToggleLevel=function(){this.toggleLevel&&this.toggleLevel.setAttribute("data-tw-list-toggleLevel-disable","true")},f.prototype.resetToggleLevel=function(){this.toggleLevel&&this.toggleLevel.setAttribute("data-tw-list-toggleLevel-manual","current")},f.prototype.toggleSelectDisable=function(a){for(var b=this.widget.querySelectorAll("[data-tw-list-rowSelect"),c=0;c<b.length;c++)a?b[c].setAttribute("disabled",!0):b[c].closest(this.disabledItemClass)||b[c].removeAttribute("disabled");a?this.widget.querySelector("[data-tw-list-selectall]").setAttribute("disabled",!0):this.widget.querySelector("[data-tw-list-selectall]").removeAttribute("disabled")},f.prototype.setCounter=function(a){this.counter=a},f.prototype.setOrderBy=function(a){this.setRequestArg("order",a)},f.prototype.setParent=function(a){this.widget=a},f.prototype.setOrderByNode=function(a){this.orderBy=a},f.prototype.setEventListenerNode=function(a){this.eventListenerNode=a},f.prototype.setRequestArg=function(a,b){this.listRequestArgs[a]=b},f.prototype.setRequestArgs=function(a){"undefined"!=typeof a&&Object.assign(this.listRequestArgs,a)},f.prototype.setToggleLevelNode=function(a){this.toggleLevel=a},f.prototype.setWebservice=function(a){this.webservice=a},f.prototype.pagingEvents=function(a){var b=this;a.onChange=function(){b.update()},a.onChangeAppendType=function(a){b.appendType=a}},f.prototype.getUpdateRequestArgs=function(){var a={args:this.getRequestArgs(),callback:[this.renderListContent.bind(this)],methodname:this.getWebservice()};return this.paging&&(a=this.paging.extendRequestData(a)),a},f.prototype.update=function(){var a=this;return new Promise(function(b,c){a.onPreRequest(),e.getDataUpdate([a.getUpdateRequestArgs()]).then(function(){a.onPostRequest(),b()})["catch"](function(){a.onPostRequest(),c()})})},f.prototype.prepare=function(){var a=this;return new Promise(function(b){a.loadHeaderStrings(a.listDataMap).then(function(c){a.listDataMap=c,b()})})},f.prototype.load=function(){var a=this;return new Promise(function(b){a.prepare().then(function(){a.update().then(function(){b()})})})};var g=function(a,b){var e=a.querySelector("[data-tw-list-count]"),g=a.querySelector("[data-tw-list]"),h=a.querySelector("[data-tw-list-order]"),i=a.querySelector("[data-tw-paging]"),j=a.querySelector("[data-tw-list-toggleLevel]"),k=new f;return k.setParent(g),k.setEventListenerNode(a),i&&(k.paging=d.init(a),k.pagingEvents(k.paging)),b.map&&"object"==typeof b.map?(k.listDataMap=b.map,e&&k.setCounter(e),h&&k.setOrderByNode(h),j&&k.setToggleLevelNode(j),b.serviceArgs&&k.setRequestArgs(b.serviceArgs),k.propagatedListEvents(),k.setWebservice(b.service),k):(c.exception({message:"You need to provide a map object for the list"}),null)};return{init:g}});
define('totara_competency/basket', ["core/notification"],function(a){function b(a,b){this.basketKey=a,this.persistant=b}return b.prototype.getKey=function(){return this.basketKey},b.prototype.update=function(b,c){return"add"===b?this.add(c):"remove"===b?this.remove(c):"replace"===b?this.replace(c):(a.exception({fileName:"simple_basket.js",message:"Invalid basket action given, expecting either add, remove or replace",name:"Error on basket action"}),null)},b.prototype.isPersistent=function(){return this.persistant},b.prototype.copyFrom=function(a){var b=this;return new Promise(function(c){a.load().then(function(a){b.replace(a).then(function(a){c(a)})})})},b.prototype.moveFrom=function(a){var b=this;return new Promise(function(c){a.load().then(function(d){b.add(d).then(function(b){a["delete"]().then(function(){c(b)})})})})},b.prototype.add=function(b){var c="You need to implement the add() function of your basket";return a.exception({message:c}),Promise.reject(b)},b.prototype.remove=function(b){var c="You need to implement the remove() function of your basket";return a.exception({message:c}),Promise.reject(b)},b.prototype.replace=function(b){var c="You need to implement the replace() function of your basket";return a.exception({message:c}),Promise.reject(b)},b.prototype.load=function(){var b="You need to implement the load() function of your basket";return a.exception({message:b}),Promise.reject()},b.prototype["delete"]=function(){var b="You need to implement the delete() function of your basket";return a.exception({message:b}),Promise.reject()},b});
define('totara_competency/basket_list', ["core/ajax","totara_competency/filters","totara_competency/basket_manager","totara_competency/crumb_manager","totara_competency/action_list_manager","totara_competency/filter_manager","totara_competency/loader_manager","totara_competency/simple_basket","totara_competency/session_basket"],function(a,b,c,d,e,f,g,h,i){function j(){return this instanceof j?(this.basketManager=null,this.hideClass="tw-basketlist__hide",this.crumb=null,this.filters=null,this.loader=null,this.listParent=null,this.list=null,void(this.selectors=null)):new j}return j.prototype.setListParent=function(a){this.listParent=a.querySelector("[data-tw-basket-list]")},j.prototype.reset=function(){this.filters.clearFilters(),this.crumb&&(this.crumb.clearCrumbtrail(),this.crumb.setHeadingToTop()),this.selectors.clearFiltersRegionPanel(),this.selectors.clearPrimarySearch(),this.selectors.clearPrimaryTree(),this.list.disableToggleLevel()},j.prototype.updatePage=function(b){var c=this;return new Promise(function(d,e){a.getDataUpdate(b).then(function(){c.loader.hide(),d()})["catch"](function(){c.loader.hide(),e()})})},j.prototype.basketEvents=function(a){var b=this;a.onBasketClear=function(){b.loader.show(),b.basketManager.deleteAndRender().then(function(){a.onBasketHide(),b.loader.hide()})},a.onBasketHidden=function(){b.crumb&&(b.crumb.removeClass(b.hideClass),b.crumb.headingRemoveClass(b.hideClass)),a.load().then(function(){b.filters.removeFilter("ids"),b.filters.removeFilter("basket"),b.list.update()}),b.selectors.primarySearchRemoveClass(b.hideClass),b.selectors.primaryTreeRemoveClass(b.hideClass)},a.onBasketHide=function(){a.toggleExpandedView(),a.toggleShowBasketBtn(),b.reset(),b.list.enabledActions=!0,b.list.enabledHierarchy=!0,b.list.paging.resetPageNumber(),b.list.update()},a.onBasketShow=function(){a.toggleExpandedView(),a.toggleShowBasketBtn(),b.selectors.primarySearchToggleClass(b.hideClass),b.selectors.primaryTreeToggleClass(b.hideClass),b.crumb&&(b.crumb.toggleClass(b.hideClass),b.crumb.headingToggleClass(b.hideClass)),b.list.disableToggleLevel(),b.loader.show(),b.filters.clearFilters(),b.selectors.clearFiltersRegionPanel(),b.list.enabledActions=!1,b.list.enabledHierarchy=!1,b.list.paging.setPageNumber(0),a.getBasket()instanceof i?(b.filters.setFilter("basket",a.getBasketKey()),b.list.update()):a.load().then(function(a){b.filters.setFilter("ids",a),b.list.update()})},a.onBasketUpdate=function(a){b.list.selectedItems=a}},j.prototype.filterEvents=function(a){var b=this;a.onFiltersUpdate=function(){b.list.setRequestArg("filters",a.getFilters())}},j.prototype.listEvents=function(a){var b=this;a.onListHierarchyLevelChange=function(c){b.filters.clearFilters(),b.selectors.clearFiltersRegionPanel(),b.selectors.clearPrimarySearch(),b.filters.setFilter(c.detail.key,c.detail.val,c.detail.groupValues),b.crumb.setParentId(c.detail.val),a.resetToggleLevel(),b.loader.show(),b.updatePage([b.list.getUpdateRequestArgs(),b.crumb.updateCrumbAndHeader()])},a.onItemSelected=function(c){a.toggleSelectDisable(!0),b.basketManager.queueAdd(c)},a.onItemUnselected=function(c){a.toggleSelectDisable(!0),b.basketManager.queueRemove(c)},a.onItemUpdate=function(){b.basketManager.updateAndRender().then(function(){a.toggleSelectDisable(!1)})},a.onPreRequest=function(){b.loader.show()},a.onPostRequest=function(){b.loader.hide()}},j.prototype.selectorEvents=function(a){var b=this;a.onFilterRegionPanelAdd=function(a){b.filters.setFilter(a.detail.key,a.detail.val,a.detail.groupValues)},a.onFilterRegionPanelUpdate=function(){b.list.update()},a.onFilterRegionPanelReset=function(a){var c=a.detail.groupValues?a.detail.groupValues:"";b.filters.removeFilter(a.detail.key,c)},a.onPrimaryFilterSearchAdd=function(a){b.filters.setFilter(a.detail.key,a.detail.val,a.detail.groupValues)},a.onPrimaryFilterSearchUpdate=function(){b.list.update()},a.onPrimaryFilterSearchReset=function(a){var c=a.detail.groupValues?a.detail.groupValues:"";b.filters.removeFilter(a.detail.key,c)},a.onPrimaryFilterTreeAdd=function(a){b.filters.setFilter(a.detail.key,a.detail.val,a.detail.groupValues)},a.onPrimaryFilterTreeUpdate=function(){b.list.update()},a.onPrimaryFilterTreeReset=function(a){var c=a.detail.groupValues?a.detail.groupValues:"";b.filters.removeFilter(a.detail.key,c)}},j.prototype.initExtend=function(){},j.prototype.generateBasketKey=function(){return"simplebasket."+Math.floor(Math.random()*Math.floor(Number.MAX_SAFE_INTEGER)).toString(36)},j.prototype.init=function(a){var j=a.parent,k=a.basketKey+"Pause",l=this;return new Promise(function(m){M.util.js_pending(k),l.setListParent(j),l.loader=g.init(j),l.loader.show(),l.filters=new b,l.filterEvents(l.filters),a.list.defaultFilters&&(l.filters.setDefaults(a.list.defaultFilters),a.list.serviceArgs&&a.list.serviceArgs.filters?a.list.serviceArgs.filters=Object.assign(a.list.serviceArgs.filters,a.list.defaultFilters):(a.list.serviceArgs||(a.list.serviceArgs={}),a.list.serviceArgs.filters=a.list.defaultFilters));var n=null;a.basket?n=a.basket:(a.basketKey||(a.basketKey=l.generateBasketKey()),n="session"===a.basketType?new i(a.basketKey):new h(a.basketKey)),l.basketManager=c.init(j,n),l.basketEvents(l.basketManager),a.crumbtrail&&(l.crumb=d.init(j,a.crumbtrail)),a.list.map.hasCheckboxes=!0,l.list=e.init(j,a.list),l.listEvents(l.list),l.selectors=f.init(j),l.selectorEvents(l.selectors),l.initExtend(),m();var o=[l.list.prepare()];a.crumbtrail&&o.push(l.crumb.loadCrumbStrings()),Promise.all(o).then(function(){l.basketManager.loadAndRender().then(function(){l.updatePage([l.list.getUpdateRequestArgs()]),M.util.js_complete(k)})})})},j});
define('totara_competency/basket_manager', ["core/notification"],function(a){function b(){return this instanceof b?(this.basket=null,this.classBasketWide="tw-selectionBasket--wide",this.eventListener="totara_core/selection_basket",this.eventNode=null,this.widget=null,this.itemQueueAction="",void(this.itemQueue=[])):new b}b.prototype.bubbledEventsListener=function(){var a=this;this.eventNode.addEventListener(this.eventListener+":transition",function(b){"small"===b.detail.state&&a.onBasketHidden(),M.util.js_complete("basketTransition")}),this.eventNode.addEventListener(this.eventListener+":update",function(b){var c=b.detail.action;"show"===c?(M.util.js_pending("basketTransition"),a.onBasketShow()):"hide"===c?a.onBasketHide():"clear"===c&&a.onBasketClear()})},b.prototype.getBasketKey=function(){return this.basket.getKey()},b.prototype.getEventListener=function(){return this.eventListener},b.prototype.getWideClass=function(){return this.classBasketWide},b.prototype.onBasketClear=function(){},b.prototype.onBasketHidden=function(){},b.prototype.onBasketHide=function(){},b.prototype.onBasketShow=function(){},b.prototype.onBasketUpdate=function(){},b.prototype.getBasket=function(){return this.basket},b.prototype.setBasket=function(a){this.basket=a},b.prototype.toggleExpandedView=function(){this.widget.classList.toggle(this.classBasketWide)},b.prototype.toggleShowBasketBtn=function(){this.widget.classList.toggle("tw-selectionBasket__displayed")},b.prototype.renderBasket=function(a){var b,c=this.widget,d=this;return new Promise(function(e){c&&(b=a.length,c.setAttribute("data-tw-selectionbasket-countchange",b)),d.onBasketUpdate(a),e()})},b.prototype.setParent=function(a){this.widget=a},b.prototype.setParentEventNode=function(a){this.eventNode=a},b.prototype.queueAdd=function(a){return"add"!==this.itemQueueAction&&(this.itemQueue=[]),this.itemQueueAction="add",Array.isArray(a)?this.itemQueue=this.itemQueue.concat(a):this.itemQueue.push(a),this},b.prototype.queueReplace=function(a){return"replace"!==this.itemQueueAction&&(this.itemQueue=[]),this.itemQueueAction="replace",Array.isArray(a)?this.itemQueue=this.itemQueue.concat(a):this.itemQueue.push(a),this},b.prototype.queueRemove=function(a){return"remove"!==this.itemQueueAction&&(this.itemQueue=[]),this.itemQueueAction="remove",Array.isArray(a)?this.itemQueue=this.itemQueue.concat(a):this.itemQueue.push(a),this},b.prototype.updateAndRender=function(){var b=this.itemQueueAction,c=this.itemQueue,d=this;return""===b||0===c.length?(a.exception({message:"No item was queue to perform an action, have you forgotten to call add, remove or replace?"}),Promise.reject()):(d.itemQueue=[],d.itemQueueAction="",this.basket.update(b,c).then(function(a){return d.renderBasket(a)})["catch"](function(){a.exception({message:"An error occurred updating the basket."})}))},b.prototype["delete"]=function(){return this.basket["delete"]()["catch"](function(){a.exception({message:"An error occurred deleting the basket."})})},b.prototype.deleteAndRender=function(){var a=this;return this["delete"]().then(function(){return a.renderBasket([])})},b.prototype.loadAndRender=function(){var a=this;return this.load().then(function(b){return a.renderBasket(b)})},b.prototype.load=function(){return this.basket.load()["catch"](function(){a.exception({message:"An error occurred loading the basket."})})},b.prototype.isPersistent=function(){return this.basket.isPersistent()};var c=function(a,c){var d=a.querySelector("[data-tw-selectionBasket]"),e=new b;return e.setParent(d),e.setParentEventNode(a),e.setBasket(c),e.bubbledEventsListener(),e};return{init:c}});
define('totara_competency/create_assignments', ["totara_competency/basket_list","totara_competency/list_framework_hierarchy_events"],function(a,b){function c(){if(!(this instanceof c))return new c}c.prototype=new a,c.prototype.setExtendingFunctions=function(a){var b=this;a&&Object.keys(a).forEach(function(c){if(b[c])for(var d in a[c])a[c].hasOwnProperty(d)&&"function"==typeof a[c][d]&&(b[c][d]=a[c][d].bind(b))})},c.prototype.initExtend=function(){var a=this;b.init().then(function(b){a.setExtendingFunctions(b)})};var d=function(){return{cols:[{dataPath:"fullname",expandedViewTrigger:!0,headerString:{component:"totara_competency",key:"header_competency"}},{dataPath:"assignments_count",headerString:{component:"totara_competency",key:"assigned_user_groups"},size:"sm"},{columnTemplate:{template:"totara_competency/warning_message"},dataPath:"pathway_warning_message",headerString:{component:"totara_competency",key:"header_pathway_warning_message"}}],extraRowData:[{key:"framework",dataPath:"frameworkid"}],hasExpandedView:!0,hasHierarchy:!0}},e=function(a){return new Promise(function(b){var e=new c,f={basketKey:"totara_competency_create_assignment",basketType:"session",crumbtrail:{service:"totara_competency_competency_show",stringList:[{component:"totara_competency",key:"all_competencies"},{component:"totara_competency",key:"all_competencies_framework"}]},list:{map:d(),service:"totara_competency_competency_index"},parent:a};e.init(f).then(function(){b(e)})})};return{init:e}});
define('totara_competency/crumb_manager', ["core/str","core/templates"],function(a,b){function c(){return this instanceof c?(this.args={id:null,include:{crumbs:1}},this.eventListener="totara_core/crumbtrail",this.eventNode="",this.heading="",this.strings={levelTop:"",top:""},this.template="totara_competency/crumb_with_title_body",this.webservice=null,this.widget=null,void(this.stringList=[])):new c}c.prototype.bubbledEventsListener=function(){var a=this;this.eventNode.addEventListener(this.eventListener+":click",function(b){a.onCrumbtrailChange(b.detail)})},c.prototype.clearCrumbtrail=function(){this.widget&&(this.widget.innerHTML="")},c.prototype.formatCrumbData=function(a){return new Promise(function(b){b(a)})},c.prototype.getWebservice=function(){return this.webservice},c.prototype.onCrumbtrailChange=function(a){a.isTopLevel?this.onCrumbtrailChangeToTopLevel(a):this.onCrumbtrailChangeLevel(a)},c.prototype.onCrumbtrailChanged=function(){},c.prototype.onCrumbtrailChangeLevel=function(){},c.prototype.onCrumbtrailChangeToTopLevel=function(){},c.prototype.loadCrumbStrings=function(){var b=this;return new Promise(function(c){a.get_strings(b.stringList).then(function(a){b.strings.top=a[0],b.strings.levelTop=a[1],b.setHeadingToTop(),c()})})},c.prototype.renderCrumbtrail=function(a){var c=this;return new Promise(function(d){return c.widget&&a.crumbtrail?void c.formatCrumbData(a).then(function(a){b.renderReplace(c.template,a,c.widget).then(function(){d()})}):(c.clearCrumbtrail(),void d())})},c.prototype.renderLevelHeader=function(a){var b=a.fullname,c=this;return new Promise(function(a){b&&c.setHeading(b),a()})},c.prototype.setHeading=function(a){this.heading&&(this.heading.innerHTML=a)},c.prototype.setHeadingToTop=function(){this.heading&&(this.heading.innerHTML=this.strings.top)},c.prototype.setHeadingToLevelTop=function(){this.heading&&(this.heading.innerHTML=this.strings.levelTop)},c.prototype.setParentId=function(a){this.args.id=a},c.prototype.setParent=function(a){this.widget=a},c.prototype.setParentEventNode=function(a){this.eventNode=a},c.prototype.setHeadingNode=function(a){this.heading=a},c.prototype.setWebservice=function(a){this.webservice=a},c.prototype.toggleClass=function(a){this.widget.classList.toggle(a)},c.prototype.removeClass=function(a){this.widget.classList.remove(a)},c.prototype.headingToggleClass=function(a){this.heading&&this.heading.classList.toggle(a)},c.prototype.headingRemoveClass=function(a){this.heading&&this.heading.classList.remove(a)},c.prototype.updateCrumbAndHeader=function(){var a=this;return{args:a.args,callback:[a.renderCrumbtrail.bind(a),a.renderLevelHeader.bind(a),a.onCrumbtrailChanged],methodname:a.getWebservice()}};var d=function(a,b){var d=new c,e=a.querySelector("[data-tw-crumbtrailWithTitle]"),f=a.querySelector("[data-tw-crumbtrailWithTitle-heading]");return d.setParent(e),d.setParentEventNode(a),d.setHeadingNode(f),d.setWebservice(b.service),d.stringList=b.stringList,d.bubbledEventsListener(),d};return{init:d}});
define('totara_competency/crumb_with_title', [],function(){function a(){return this instanceof a?(this.eventKey=null,void(this.widget=null)):new a}a.prototype={events:function(){var a=this;this.widget.addEventListener("click",function(b){if(b.target&&b.target.closest("[data-tw-crumbtrailWithTitle-id]")){b.preventDefault();var c=b.target.closest("[data-tw-crumbtrailWithTitle-id]"),d=c.hasAttribute("data-tw-crumbtrailWithTitle-top-level"),e=c.getAttribute("data-tw-crumbtrailWithTitle-id"),f=c.getAttribute("data-tw-crumbtrailWithTitle-name");a.triggerEvent("click",{id:e,isTopLevel:d,name:f})}})},setEventKey:function(){this.eventKey=this.widget.getAttribute("data-tw-crumbtrailWithTitle-events")},setParent:function(a){this.widget=a},triggerEvent:function(a,b){var c=new CustomEvent(this.eventKey+":"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),d.setEventKey(),d.events(),c(d)})};return{init:b}});
define('totara_competency/edit_proficiency_value', ["core/str","core/modal_factory","core/modal_events","totara_competency/basket_list","core/ajax","core/notification","core/templates","core/webapi"],function(a,b,c,d,e,f,g,h){function i(){return this instanceof i?(this.scaleCache={},void(this.frameworkId=null)):new i}var j="[name=editProficiencyValue]",k="[name=editProficiencyValue]:checked";i.prototype=new d,i.prototype.customBubbledEventsListener=function(){var b=this;this.listParent.addEventListener(this.basketManager.getEventListener()+":customUpdate",function(){b.showModal(b.createValueSelectionModal()).then(function(c){if(c.confirmed){b.loader.show();var d,e=c.modal.getRoot().find(k),g=e.val(),h="remove"===g?null:g;d=1===b.list.selectedItems.length?a.get_string("edit_proficiency_value_by_assignment_updated_single","totara_competency"):a.get_string("edit_proficiency_value_by_assignment_updated","totara_competency",b.list.selectedItems.length);var i=b.updateMinProficiencyValues(h);Promise.all([d,i]).then(function(a){b.showNotification(a[0]),b.resetListAndBasket()})["catch"](f.exception)}})})},i.prototype.updateMinProficiencyValues=function(a){return h.call({operationName:"totara_competency_update_min_proficiency_override_for_assignments",variables:{input:{assignment_ids:this.list.selectedItems,scale_value_id:a}}})},i.prototype.showNotification=function(a){f.clearNotifications(),f.addNotification({message:a,type:"success"}),window.scrollTo(0,0)},i.prototype.resetListAndBasket=function(){var a=this;this.basketManager.deleteAndRender().then(function(){a.updatePage([a.list.getUpdateRequestArgs()])})},i.prototype.createValueSelectionModal=function(){var c=a.get_string("edit_proficiency_bulk_modal_title","totara_competency",this.list.selectedItems.length),d=this.loadCompetencyScale(),e=g.render("core/modal_backdrop",null),f=this;return Promise.all([c,d,e]).then(function(a){var c=a[0],d=a[1],e=g.render("totara_competency/edit_proficiency_value_modal",f.getModalTemplateData(d));return b.create({body:e,title:c,type:b.types.SAVE_CANCEL}).then(function(a){return a.disableSave(),a.getRoot().find(j).off().change(function(){a.enableSave()}),a})})},i.prototype.showModal=function(a){this.loader&&this.loader.show();var b=this;return a.then(function(a){return b.displayModal(a)})},i.prototype.createFrameworkChangeConfirmModal=function(){var c=a.get_strings([{key:"edit_proficiency_change_framework_warning",component:"totara_competency"},{key:"filter_select_competency_framework",component:"totara_competency"},{key:"confirm",component:"moodle"},{key:"cancel",component:"moodle"}]),d=g.render("core/modal_backdrop",null);return Promise.all([c,d]).then(function(a){var c=a[0];return b.create({body:c[0],title:c[1],type:b.types.CONFIRM},void 0,{yesstr:c[2],nostr:c[3]})})},i.prototype.loadCompetencyScale=function(){var a=this.frameworkId;if(this.scaleCache[a]){var b=this.scaleCache[a];return Promise.resolve(b)}var c=this;return h.call({operationName:"totara_competency_scale",variables:{framework_id:a}}).then(function(b){var d=b.totara_competency_scale;if(!d)throw new Error("No scale found for framework id "+a);return c.scaleCache[a]=d,d})},i.prototype.getModalTemplateData=function(a){var b=!1,c=a.values.sort(function(a,b){return b.sortorder-b.sortorder}).map(function(a){var c={id:a.id,name:a.name,isDefaultProficiency:!1};return!b&&a.proficient&&(c.isDefaultProficiency=!0,b=!0),c}).reverse();return{values:c}},i.prototype.displayModal=function(a){var b=a.getRoot(),d=this;return b.on(c.shown,function(){d.loader&&d.loader.hide()}),a.show(),new Promise(function(d){var e={confirmed:!0,modal:a};b.off(c.yes),b.on(c.yes,d.bind(a,e)),b.off(c.save),b.on(c.save,d.bind(a,e));var f={confirmed:!1,modal:a};b.off(c.no),b.on(c.no,d.bind(a,f)),b.off(c.cancel),b.on(c.cancel,d.bind(a,f)),b.off(c.hidden),b.on(c.hidden,d.bind(a,f))})},i.prototype.initExtend=function(){this.customBubbledEventsListener(),this.selectors.clearPrimaryTree=function(){},this.filters.clearFilters=function(){this.filters={framework:this.getFilter("framework")}};var a=this,b=this.filters.onFiltersUpdate.bind(this.filters);this.filters.onFiltersUpdate=function(){var c=this.getFilter("framework");this.frameworkId!==c&&(a.shouldShowConfirmFrameworkModal(c)?a.showConfirmFrameworkModal(c):a.frameworkId=c),b()}},i.prototype.shouldShowConfirmFrameworkModal=function(a){return!!a&&(this.frameworkId!==a&&this.list.selectedItems.length>0)},i.prototype.showConfirmFrameworkModal=function(a){var b=this;return this.showModal(b.createFrameworkChangeConfirmModal()).then(function(c){c.confirmed?(b.frameworkId=a,b.loadCompetencyScale(),b.basketManager.deleteAndRender()):(b.filters.setFilter("framework",b.frameworkId),b.selectors.setPrimaryTreeValue(b.frameworkId),b.list.update())})};var l=function(a){return{actions:a.actionsCallback,cols:[{dataPath:"competency_name",headerString:{component:"totara_competency",key:"header_competency"}},{dataPath:"assignment_type_name",headerString:{component:"totara_competency",key:"header_assignment_type"}},{dataPath:"user_group_name",headerString:{component:"totara_competency",key:"assigned_type_detail"}},{dataPath:"min_proficiency_value_name",headerString:{component:"totara_competency",key:"min_required_proficiency_value"}},{dataPath:"has_default_proficiency_value_override_yes_no",headerString:{component:"totara_competency",key:"default_proficiency_value_override_header"},size:"xs"}],extraRowData:[{key:"user_group_type",dataPath:"user_group_type"}],hasHierarchy:!1}},m=function(a){return new Promise(function(b){var c=new i,d={basketKey:"totara_competency_edit_proficiency_value",basketType:"simple",list:{map:l(c),service:"totara_competency_assignment_index"},parent:a};c.init(d).then(function(){c.createValueSelectionModal(),c.createFrameworkChangeConfirmModal(),b(c)})})};return{init:m}});
define('totara_competency/filters', [],function(){function a(){return this instanceof a?(this.filters={},void(this.defaults={})):new a}return a.prototype.clearFilters=function(){this.filters=this.defaults,this.onFiltersUpdate()},a.prototype.setDefaults=function(a){this.defaults=a,this.filters=a},a.prototype.getFilter=function(a){return this.filters[a]},a.prototype.getFilters=function(){return this.filters},a.prototype.hasFilter=function(a){return this.filters.hasOwnProperty(a)},a.prototype.onFiltersUpdate=function(){},a.prototype.removeFilter=function(a,b){b&&b.length>0?this.setFilter(a,b):delete this.filters[a],this.onFiltersUpdate()},a.prototype.setFilter=function(a,b,c){c&&(b=c),this.filters[a]=b,this.onFiltersUpdate()},a});
define('totara_competency/filter_manager', [],function(){function a(){return this instanceof a?(this.basketRequestArgs={action:"",basket:0,ids:[]},this.primarySearch=null,this.primaryTree=null,this.regionPanel=null,void(this.widget=null)):new a}a.prototype.bubbledEventsListener=function(){var a=this;this.primarySearch&&(this.primarySearch.addEventListener("totara_core/select_search_text:add",function(b){a.onPrimaryFilterSearchAdd(b)}),this.primarySearch.addEventListener("totara_core/select_search_text:changed",function(){a.onPrimaryFilterSearchUpdate()}),this.primarySearch.addEventListener("totara_core/select_search_text:remove",function(b){a.onPrimaryFilterSearchReset(b)})),this.primaryTree&&(this.primaryTree.addEventListener("totara_core/select_tree:add",function(b){a.onPrimaryFilterTreeAdd(b)}),this.primaryTree.addEventListener("totara_core/select_tree:changed",function(){a.onPrimaryFilterTreeUpdate()}),this.primaryTree.addEventListener("totara_core/select_tree:remove",function(b){a.onPrimaryFilterTreeReset(b)})),this.regionPanel&&(this.regionPanel.addEventListener("totara_core/select_region_panel:add",function(b){a.onFilterRegionPanelAdd(b)}),this.regionPanel.addEventListener("totara_core/select_region_panel:changed",function(){a.onFilterRegionPanelUpdate()}),this.regionPanel.addEventListener("totara_core/select_region_panel:remove",function(b){a.onFilterRegionPanelReset(b)}),this.regionPanel.addEventListener("totara_competency/select_region_panel_toggle:changed",function(b){var c=a.regionPanel.querySelector(b.detail.target);c.classList.toggle(b.detail.toggleClass)}))},a.prototype.onFilterRegionPanelAdd=function(){},a.prototype.onFilterRegionPanelUpdate=function(){},a.prototype.onFilterRegionPanelReset=function(){},a.prototype.onPrimaryFilterSearchAdd=function(){},a.prototype.onPrimaryFilterSearchUpdate=function(){},a.prototype.onPrimaryFilterSearchReset=function(){},a.prototype.onPrimaryFilterTreeAdd=function(){},a.prototype.onPrimaryFilterTreeUpdate=function(){},a.prototype.onPrimaryFilterTreeReset=function(){},a.prototype.clearFiltersRegionPanel=function(){this.regionPanel&&this.regionPanel.querySelector(".tw-selectRegionPanel").setAttribute("data-tw-selectorgroup-clear",!0)},a.prototype.clearPrimarySearch=function(){this.primarySearch&&this.primarySearch.querySelector("[data-tw-selectorgroup]").setAttribute("data-tw-selectorgroup-clear",!0)},a.prototype.clearPrimaryTree=function(){this.primaryTree&&this.primaryTree.querySelector("[data-tw-selectorgroup]").setAttribute("data-tw-selectorgroup-clear",!0)},a.prototype.setPrimaryTreeValue=function(a){this.primaryTree&&this.primaryTree.querySelector("[data-tw-selectorgroup]").setAttribute("data-tw-selector-manualset",a)},a.prototype.primarySearchToggleClass=function(a){this.primarySearch&&this.primarySearch.classList.toggle(a)},a.prototype.primarySearchRemoveClass=function(a){this.primarySearch&&this.primarySearch.classList.remove(a)},a.prototype.primaryTreeToggleClass=function(a){this.primaryTree&&this.primaryTree.classList.toggle(a)},a.prototype.primaryTreeRemoveClass=function(a){this.primaryTree&&this.primaryTree.classList.remove(a)},a.prototype.setPrimarySearch=function(a){this.primarySearch=a},a.prototype.setPrimaryTree=function(a){this.primaryTree=a},a.prototype.setRegionPanel=function(a){this.regionPanel=a};var b=function(b){var c=b.querySelector("[data-tw-filterRegionPanel]"),d=b.querySelector("[data-tw-basket-list-primaryFilterSearch]"),e=b.querySelector("[data-tw-basket-list-primaryFilterTree]"),f=new a;return d&&f.setPrimarySearch(d),e&&f.setPrimaryTree(e),c&&f.setRegionPanel(c),f.bubbledEventsListener(),f};return{init:b}});
define('totara_competency/linked_courses', ["core/str","core/templates","totara_competency/modal_list","core/ajax","core/notification","totara_competency/loader_manager"],function(a,b,c,d,e,f){function g(){return this instanceof g?(this.competencyID=0,this.courseAdderModal={},this.courses=[],this.initialCourses=[],this.existingCourses=[],this.iconList=[],this.loader=null,this.removedClass="tw-editLinkedCourses__list_removed",this.removedCourses=[],void(this.strings={})):new g}g.prototype={events:function(){var a=this;this.widget.addEventListener("click",function(b){if(b.target)if(b.target.closest("[data-tw-editLinkedCourses-save]"))b.preventDefault(),a.saveChanges();else if(b.target.closest("[data-tw-editLinkedCourses-adder]"))b.preventDefault(),a.courseAdderModal.show(a.getCourseIds());else if(b.target.closest("[data-linked-courses-checkbox]")){var c=b.target.closest("[data-linked-courses-checkbox]"),d=c.closest("[data-tw-list-row]").getAttribute("data-tw-list-row"),e=a.getCourseById(d);e.mandatory=c.checked}else if(b.target.closest("[data-tw-editLinkedCourses-cancel]")){b.preventDefault();var f=b.target.closest("[data-tw-editLinkedCourses-cancel]"),g=f.getAttribute("data-tw-editLinkedCourses-cancel");g&&(window.location.href=g)}}),this.widget.addEventListener("totara_core/lists:action",function(b){var c=b.detail.key,d=parseInt(b.detail.val);switch(document.querySelector("#user-notifications")&&e.clearNotifications(),c){case"deleteClicked":a.existingCourses.indexOf(d)>-1?a.removeSavedRow(d):(a.removeUnsavedRow(d),a.loader.show(),a.refreshRowsDisplay());break;case"undoDeleteClicked":a.undoRemoveSavedRow(d)}}),window.addEventListener("beforeunload",function(b){var c=a.haveLinkedCoursesChanged(),d=M.util.get_string("unsaved_changes_warning","totara_competency");if(c)return b.returnValue=d,d})},getRowData:function(a){var b,c,d;this.removedCourses.indexOf(a.id)>-1?(b={event_key:"undoDeleteClicked",icon:this.iconList.undo},c=this.strings.removedLinkedCourse,d=this.removedClass):b={event_key:"deleteClicked",icon:this.iconList["delete"]};var e={actions:[b],actions_width:"xxsm",aria_label:c||a.fullname,columns:[{value:a.fullname},{column_template:"totara_competency/edit_linkedcourse_rows_checkbox",label:this.strings.mandatory,width:"xsm"}],id:a.id,mandatory:a.mandatory,row_custom_class:d};return e},getCourseById:function(a){for(var b=0;b<this.courses.length;b++)if(this.courses[b].id==a)return this.courses[b];return null},getCourseIds:function(){return 0===this.courses.length?[]:this.courses.map(function(a){return a.id})},getLinkedCourses:function(){var a=this,b={args:{competency_id:this.competencyID},methodname:"totara_competency_get_linked_courses"};return a.existingCourses=[],new Promise(function(c){d.getData(b).then(function(b){a.courses=b.results.items,a.resetInitialCourses();for(var d=0;d<b.results.items.length;d++){var e=parseInt(b.results.items[d].id);a.existingCourses.push(e)}c()})})},getModalListData:function(){var a=this;return{key:"totara_competency_linked_courses",title:[{component:"totara_competency",key:"select_courses"}],list:{map:{cols:[{dataPath:"fullname",headerString:{key:"fullname",component:"totara_competency"}}]},service:"totara_competency_get_courses"},onSaved:function(b,c,d){var f=[];document.querySelector("#user-notifications")&&e.clearNotifications();for(var g=0;g<d.length;g++){var h=1,i=a.getCourseById(d[g].id);null!==i&&(h=i.mandatory),f.push({id:d[g].id,fullname:d[g].fullname,mandatory:h})}a.courses=f,a.loader.show(),a.refreshRowsDisplay()},primaryDropDown:{filterKey:"category",serviceLabelKey:"fullname",placeholderString:[{component:"totara_competency",key:"all_categories"}],service:"totara_competency_get_categories",serviceArgs:{}},primarySearch:{filterKey:"name",placeholderString:[{component:"totara_competency",key:"search_courses"}]}}},loadCourseModalList:function(){var a=this;return new Promise(function(b){c.adder(a.getModalListData()).then(function(c){a.courseAdderModal=c,b()})["catch"](function(a){e.exception({message:"Error adding course modal list adder"+a[0]+" "+a[1]})})})},loadIcons:function(){var a=[],c=this,d=[{classes:"tw-list__hover_warning",key:"delete",name:"remove",string:this.strings.removeLinkedCourse},{classes:"",key:"undo",name:"undo",string:this.strings.undoRemoveLinkedCourse}];return new Promise(function(e){for(var f=0;f<d.length;f++){var g=d[f];a.push(b.renderIcon(g.name,g.string,g.classes))}Promise.all(a).then(function(a){for(var b=0;b<d.length;b++)c.iconList[d[b].key]=a[b];e()})})},loadStrings:function(){var b=this,c=[{component:"totara_competency",key:"linked_courses_saved"},{component:"totara_competency",key:"mandatory"},{component:"core",key:"courses"},{component:"totara_competency",key:"remove_linked_course"},{component:"totara_competency",key:"removed_linked_course"},{component:"totara_competency",key:"undo_remove_linked_course"},{component:"totara_competency",key:"no_courses_linked_yet"},{component:"totara_competency",key:"unsaved_changes_warning"}];return new Promise(function(d,e){a.get_strings(c).then(function(a){b.strings={savedMsg:a[0],mandatory:a[1],courses:a[2],removeLinkedCourse:a[3],removedLinkedCourse:a[4],undoRemoveLinkedCourse:a[5],noResults:a[6]}}).then(function(){d()})["catch"](function(){e()})})},refreshRowsDisplay:function(){for(var a=this,c=this.widget.querySelector("[data-tw-list]"),d={has_actions:!0,noResultsText:this.strings.noResults,rows:[],row_header:{columns:[{value:this.strings.courses},{value:this.strings.mandatory,width:"xsm"}],header:!0}},e=0;e<this.courses.length;e++)d.rows.push(this.getRowData(this.courses[e]));b.renderReplace("totara_competency/lists_rows",d,c).then(function(){a.loader.hide()})},removeSavedRow:function(a){this.removedCourses.push(a),this.loader.show(),this.refreshRowsDisplay()},removeUnsavedRow:function(a){for(var b,c=0;c<this.courses.length;c++)if(b=this.courses[c].id,b===a){this.courses.splice(c,1);break}},saveChanges:function(){var a,b=this;for(b.loader.show(),document.querySelector("#user-notifications")&&e.clearNotifications(),a=0;a<b.removedCourses.length;a++){var c=b.removedCourses[a];b.removeUnsavedRow(c)}b.removedCourses=[];var f=[];for(a=0;a<b.courses.length;a++)f[a]={id:b.courses[a].id,mandatory:b.courses[a].mandatory};d.getData({args:{competency_id:b.competencyID,courses:f},methodname:"totara_competency_set_linked_courses"}).then(function(){b.getLinkedCourses().then(function(){b.refreshRowsDisplay(),b.loader.hide(),e.addNotification({message:b.strings.savedMsg,type:"success"})})})},setCompetency:function(){var a=this.widget.closest("[data-tw-editLinkedCourses-comp-id]");a&&(this.competencyID=a.getAttribute("data-tw-editLinkedCourses-comp-id"))},setParent:function(a){this.widget=a},undoRemoveSavedRow:function(a){var b=this.removedCourses.indexOf(a);b>-1&&this.removedCourses.splice(b,1),this.loader.show(),this.refreshRowsDisplay()},haveLinkedCoursesChanged:function(){if(this.courses.length!==this.initialCourses.length)return!0;var a=this.initialCourses;return this.courses.some(function(b,c){return b.id!==a[c].id||b.mandatory!==a[c].mandatory})},resetInitialCourses:function(){this.initialCourses=this.courses.map(function(a){return{id:a.id,mandatory:a.mandatory}})}};var h=function(a){return new Promise(function(b){var c=new g;c.setParent(a),c.setCompetency(),c.events(),c.loader=f.init(a),c.loader.show(),b(c),M.util.js_pending("linkedCourses"),Promise.all([c.loadStrings(),c.getLinkedCourses(),c.loadCourseModalList()]).then(function(){c.loadIcons().then(function(){c.refreshRowsDisplay(),M.util.js_complete("linkedCourses")})})})};return{init:h}});
define('totara_competency/lists', ["core/notification","core/templates","core/ajax"],function(a,b,c){function d(){return this instanceof d?(this.activeRowClass="tw-list__row_active",this.hoverRowClass="tw-list__row_hover",this.disabledBtnClass="tw-list__cell_action_btn_disabled",this.expandBoxTemplate="totara_competency/lists_expanded",this.expandedClass="tw-list__expanded_show",this.expandedClassRow="tw-list__row_expanded",this.expandContainerHtml="",this.expandID="",this.expandTemplate="",this.expandWebservice="",this.expandWebserviceArgs="",this.expandTemplateAttribute="data-tw-list-template-expand",this.expandWebserviceAttribute="data-tw-list-webservice-expand",this.expandWebserviceArgsAttribute="data-tw-list-webservice-expand-args",this.removeRowData="data-tw-list-removerow",this.selectionCheckData="data-tw-list-selectioncheck",this.stateLocked=!1,void(this.widget="")):new d}d.prototype={checkSelection:function(){var a=!0,b=this.widget.querySelectorAll("[data-tw-list-rowSelect]");if(b.length){for(var c=0;c<b.length;c++)b[c].checked===!1&&(a=!1);this.widget.querySelector("[data-tw-list-selectAll]").checked=a}},events:function(){var a,b="",c=this;this.widget.addEventListener("click",function(d){if(d.target)if(d.target.closest("[data-tw-list-row]")&&(a=d.target.closest("[data-tw-list-row]"),b=parseInt(a.getAttribute("data-tw-list-row"))),d.target.closest("[data-tw-list-selectAll]")){var e=d.target.closest("[data-tw-list-selectAll]"),f=!!e.checked;c.toggleSelectAll(f)}else if(d.target.closest("[data-tw-list-expandTrigger]")){d.preventDefault();var g=a.nextElementSibling;if(c.setExpandID(b),g&&g.hasAttribute("data-tw-list-expanded")){var h=!g.classList.contains(c.expandedClass);c.hideAllExpandedViews(),h&&(g.classList.add(c.expandedClass),a.classList.add(c.expandedClassRow))}else{if(c.stateLocked)return;c.stateLocked=!0,c.hideAllExpandedViews(),c.displayExpandContainer(a),a.classList.add(c.expandedClassRow)}}else if(d.target.closest("[data-tw-list-expandedClose]"))d.preventDefault(),c.hideAllExpandedViews();else if(d.target.closest("[data-tw-list-rowselect]")){var i=d.target.closest("[data-tw-list-rowselect]").checked,j=i?"add":"remove";c.toggleRowState(a,i),c.checkSelection(),c.triggerEvent(j,{extra:c.getExtraData(a),val:b}),c.triggerEvent("update",{})}else if(d.target.closest("[data-tw-list-hierarchyTrigger]"))d.preventDefault(),c.triggerEvent("hierarchyRequest",{extra:c.getExtraData(a),key:"parent",val:b});else if(d.target.closest("[data-tw-list-actionTrigger]")){d.preventDefault();var k=d.target.closest("[data-tw-list-actionTrigger]");if(k.classList.contains(c.disabledBtnClass))return;var l=k.getAttribute("data-tw-list-actionTrigger");c.triggerEvent("action",{extra:c.getExtraData(a),key:l,val:b})}}),this.widget.addEventListener("focusin",function(a){var b=a.target.closest("[data-tw-list-row]");b&&b.classList.add(c.hoverRowClass)}),this.widget.addEventListener("focusout",function(a){var b=a.target.closest("[data-tw-list-row]");b&&b.classList.remove(c.hoverRowClass)}),document.addEventListener("click",function(a){var b=c.widget.querySelector("."+c.expandedClass);if(b&&a.target){var d=a.target.closest("[data-tw-list-expandTrigger]"),e=a.target.closest("."+c.expandedClass);d||e||c.hideAllExpandedViews()}});var d=new MutationObserver(function(){c.widget.getAttribute(c.selectionCheckData)&&(c.checkSelection(),c.widget.removeAttribute(c.selectionCheckData))});d.observe(this.widget,{attributes:!0,attributeFilter:[c.selectionCheckData],subtree:!1});var e=new MutationObserver(function(){if(c.widget.getAttribute(c.removeRowData)){for(var a=JSON.parse(c.widget.getAttribute(c.removeRowData)),b=0;b<a.length;b++)c.removeRow(a[b]);c.widget.removeAttribute(c.removeRowData)}});e.observe(this.widget,{attributes:!0,attributeFilter:[c.removeRowData],subtree:!1});var f=new MutationObserver(function(a){for(var b=0;b<a.length;b++){var d=a[b].attributeName,e=a[b].target.getAttribute(d);switch(d){case c.expandTemplateAttribute:c.expandTemplate=e;break;case c.expandWebserviceAttribute:c.expandWebservice=e;break;case c.expandWebserviceArgsAttribute:c.expandWebserviceArgs=e}}});f.observe(this.widget,{attributes:!0,attributeFilter:[this.expandTemplateAttribute,this.expandWebserviceAttribute,this.expandWebserviceArgsAttribute],subtree:!1})},displayExpandContainer:function(c){var d=this,e=new Promise(function(c,e){return d.expandContainerHtml?void c():void b.render(d.expandBoxTemplate).done(function(a){d.expandContainerHtml=a,c()}).fail(function(b){a.exception(b),e()})});e.then(function(){c.insertAdjacentHTML("afterend",d.expandContainerHtml);var a=c.nextElementSibling,b=a.querySelector("[data-tw-list-expandedtarget]");a.classList.add(d.expandedClass),d.getExpandedViewContent(b)})},getExpandedViewContent:function(a){var d,e="",f=this;this.expandWebservice?(this.expandWebserviceArgs?(e=JSON.parse(this.expandWebserviceArgs),e.id=this.expandID):e={id:this.expandID},d=c.getData({args:e,methodname:this.expandWebservice})):d=Promise.resolve(!1),d.then(function(c){b.renderReplace(f.expandTemplate,c.results,a).then(function(){b.runTemplateJS(""),f.stateLocked=!1})})["catch"](function(){f.stateLocked=!1})},getExtraData:function(a){var b=a.getAttribute("data-tw-list-extraData");return b&&(b=JSON.parse(b)),b},hideAllExpandedViews:function(){for(var a=this.widget.querySelectorAll("."+this.expandedClass),b=this.widget.querySelectorAll("."+this.expandedClassRow),c=0;c<a.length;c++)a[c].classList.remove(this.expandedClass);for(var d=0;d<b.length;d++)b[d].classList.remove(this.expandedClassRow)},removeRow:function(a){var b=this.widget.querySelector('[data-tw-list-row="'+a+'"]');b.remove()},setExpandID:function(a){this.expandID=a},setExpandTemplate:function(){this.expandTemplate=this.widget.getAttribute(this.expandTemplateAttribute),this.expandWebservice=this.widget.getAttribute(this.expandWebserviceAttribute),this.expandWebserviceArgs=this.widget.getAttribute(this.expandWebserviceArgsAttribute)},setParent:function(a){this.widget=a},toggleRowState:function(a,b){b?(a.classList.add(this.activeRowClass),a.setAttribute("aria-selected",!0)):(a.classList.remove(this.activeRowClass),a.setAttribute("aria-selected",!1))},toggleSelectAll:function(a){for(var b,c=this.widget.querySelectorAll("[data-tw-list-rowSelect]:not([disabled])"),d=a?"add":"remove",e=!1,f="",g="",h=0;h<c.length;h++)f=c[h].closest("[data-tw-list-row]"),b=c[h].checked!==a,c[h].checked=a,this.toggleRowState(f,a),b&&(g=parseInt(f.getAttribute("data-tw-list-row")),e=!0,this.triggerEvent(d,{key:"ID",val:g}));e&&this.triggerEvent("update",{})},triggerEvent:function(a,b){var c=new CustomEvent("totara_core/lists:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)}};var e=function(a){return new Promise(function(b){var c=new d;c.setParent(a),c.setExpandTemplate(),c.events(),c.checkSelection(),b(c)})};return{init:e}});
define('totara_competency/lists_toggle_level', [],function(){function a(){return this instanceof a?(this.activeClass="tw-list__btn_active",this.disabledClass="tw-list__btn_disabled",this.eventKey="",this.manualDisable="data-tw-list-togglelevel-disable",this.manualSwitchState="data-tw-list-togglelevel-manual",void(this.widget="")):new a}a.prototype={clearAndDisableBtns:function(){var a=this.widget.querySelector("."+this.activeClass);a&&a.classList.remove(this.activeClass),this.widget.classList.add(this.disabledClass)},events:function(){var a=this;this.widget.addEventListener("click",function(b){if(b.preventDefault(),b.target){if(b.target.closest("."+a.disabledClass))return void b.preventDefault();if(b.target.closest("[data-tw-list-toggleLevel-type]")){var c=b.target,d=c.getAttribute("data-tw-list-toggleLevel-type");if(c.classList.contains(a.activeClass))return;a.toggleActive(c),a.triggerEvent("changed",{level:d})}}});var b=new MutationObserver(function(){"true"===a.widget.getAttribute(a.manualDisable)&&(a.clearAndDisableBtns(),a.widget.removeAttribute(a.manualDisable))});b.observe(this.widget,{attributes:!0,attributeFilter:[a.manualDisable],subtree:!1});var c=new MutationObserver(function(){if(a.widget.getAttribute(a.manualSwitchState)){var b,c=a.widget.getAttribute(a.manualSwitchState);b="all"===c?a.widget.querySelector('[data-tw-list-toggleLevel-type="all"]'):a.widget.querySelector('[data-tw-list-toggleLevel-type="current"]'),a.toggleActive(b),a.widget.removeAttribute(a.manualSwitchState)}});c.observe(this.widget,{attributes:!0,attributeFilter:[a.manualSwitchState],subtree:!1})},setEventKey:function(){this.eventKey=this.widget.getAttribute("data-tw-list-toggleLevel-events")},setParent:function(a){this.widget=a},toggleActive:function(a){var b=this.widget.querySelector("."+this.activeClass);b&&b.classList.remove(this.activeClass),this.widget.classList.remove(this.disabledClass),a.classList.add(this.activeClass)},triggerEvent:function(a,b){var c=new CustomEvent(this.eventKey+":"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),d.setEventKey(),d.events(),c(d)})};return{init:b}});
define('totara_competency/list_framework_hierarchy_events', [],function(){function a(){if(!(this instanceof a))return new a}a.prototype.getEvents=function(){return{crumb:{formatCrumbData:function(a){return a.custom_top_label=this.crumb.strings.levelTop,new Promise(function(b){b(a)})},onCrumbtrailChanged:function(a){var b=this.listParent.querySelector('[data-tw-selecttree-urlkey="framework"]');return new Promise(function(c){a.frameworkid>0&&b&&b.setAttribute("data-tw-selector-manualset",a.frameworkid),c()})},onCrumbtrailChangeLevel:function(a){var b=a.id,c=this.listParent.querySelector(".tw-selectRegionPanel");this.filters.clearFilters(),c&&c.setAttribute("data-tw-selectorgroup-clear",!0),this.loader.show(),this.filters.setFilter("parent",b),this.crumb.setParentId(b),this.list.resetToggleLevel(),this.loader.show(),this.updatePage([this.list.getUpdateRequestArgs(),this.crumb.updateCrumbAndHeader()])},onCrumbtrailChangeToTopLevel:function(a){var b=a.id,c=this.listParent.querySelector(".tw-selectRegionPanel"),d=this.listParent.querySelector('[data-tw-selecttree-urlkey="framework"]');this.filters.clearFilters(),c&&c.setAttribute("data-tw-selectorgroup-clear",!0),this.loader.show(),this.filters.setFilter("framework",b),this.filters.setFilter("parent",0),this.list.resetToggleLevel(),this.list.update(),this.crumb.setHeadingToLevelTop(),this.crumb.clearCrumbtrail(),b>0?d.setAttribute("data-tw-selector-manualset",b):d.setAttribute("data-tw-selectorgroup-clear",!0)}},list:{onListHierarchyLevelChangeExtend:function(a){var b=this.listParent.querySelector('[data-tw-selecttree-urlkey="framework"]');b.setAttribute("data-tw-selector-manualset",a.detail.extra.framework)},onHideSubLevelItems:function(){var a=this.filters.getFilter("path");this.filters.removeFilter("path"),this.filters.setFilter("parent",a),this.list.update()},onShowSubLevelItems:function(){var a=this.filters.getFilter("parent");this.filters.removeFilter("parent"),this.filters.setFilter("path",a),this.list.update()}},selectors:{onPrimaryFilterTreeUpdate:function(){var a,b=this.filters.getFilter("framework");this.loader.show(),this.filters.hasFilter("basket")&&(a=this.filters.getFilter("basket")),this.filters.clearFilters(),a&&(this.filters.setFilter("basket",a),this.list.enabledActions=!1,this.list.enabledHierarchy=!1),b?(this.list.resetToggleLevel(),this.filters.setFilter("framework",b),this.filters.setFilter("parent",0),this.crumb.setHeadingToLevelTop()):(this.list.disableToggleLevel(),this.crumb.setHeadingToTop()),this.selectors.clearPrimarySearch(),this.crumb.clearCrumbtrail(),this.list.update()}}}};var b=function(){return new Promise(function(b){var c=new a;b(c.getEvents())})};return{init:b}});
define('totara_competency/loader_manager', ["core/templates","core/notification"],function(a,b){function c(){return this instanceof c?(this.classOverlay="tw-loader__overlay",this.loadTarget="",void(this.loadText="[data-tw-loader-text]")):new c}c.prototype.show=function(){var b=this;this.loadTarget&&(this.loadTarget.classList.add(this.classOverlay),a.renderAppend("totara_competency/loader",null,this.loadTarget).then(function(){b.loadTarget.classList.contains(b.classOverlay)||b.hide()}))},c.prototype.hide=function(){var a,b=this.loadTarget.querySelectorAll(this.loadText);if(b)for(var c=0;c<b.length;c++)a=b[c],a.parentNode.removeChild(a);this.loadTarget&&this.loadTarget.classList.remove(this.classOverlay)},c.prototype.setLoadTarget=function(a){this.loadTarget=a};var d=function(a){if(!a||!a.parentElement||!a.parentElement.querySelector("[data-tw-loader-target]"))return b.exception({fileName:"loader_manager.js",message:"No loader target found",name:"Error initialising loader_manager"}),!1;var d=new c,e=a.parentElement.querySelector("[data-tw-loader-target]");return d.setLoadTarget(e),d};return{init:d}});
define('totara_competency/manage_assignments', ["core/str","core/modal_factory","core/modal_events","totara_competency/basket_list","core/ajax","core/notification","core/templates"],function(a,b,c,d,e,f,g){function h(){return this instanceof h?void(this.actionModals={}):new h}h.prototype=new d,h.prototype.customBubbledEventsListener=function(){var a=this;this.listParent.addEventListener(this.basketManager.getEventListener()+":customUpdate",function(b){var c="",d=b.detail.action,e="";switch(d){case"bulkActivate":c="activate";break;case"bulkDelete":c="delete";break;case"bulkArchive":c="archive",e="totara_competency/archive_bulk_modal"}var f=c+"_bulk",g=function(b){var d=a.getExtraDataForArchive(b);a.triggerBulkActionAndUpdatePage(c,d)};a.showConfirmationModal(f,g,e)})},h.prototype.customListEvents=function(){var a=this.list,b=this;a.onCustomAction=function(a){var c=null,d=a.detail.key,e=a.detail.val,f=a.detail.extra,g=null,h="";switch(d){case"activateClicked":c=g="activate","user"===f.user_group_type&&(g+="_individual");break;case"deleteClicked":c=g="delete",g=2==f.status?"delete_archived":"delete_draft","user"===f.user_group_type&&(g+="_individual");break;case"archiveClicked":c=g="archive",h="totara_competency/archive_modal","user"!==f.user_group_type&&(h="totara_competency/archive_modal_group",g+="_group")}var i=function(a){var d=b.getExtraDataForArchive(a);b.triggerActionAndUpdatePage(c,e,d)};b.showConfirmationModal(g,i,h)}},h.prototype.showConfirmationModal=function(c,d,e){var f=null,h=this,i=[{key:"action_"+c+"_modal_header",component:"totara_competency"}];h.loader&&h.loader.show(),""!==e?f=g.render(e,[]):i.push({key:"action_"+c+"_modal",component:"totara_competency"}),a.get_strings(i).then(function(a){var e=a[0],g=null!==f?f:a[1];h.actionModals[c]||(h.actionModals[c]=null);var i=h.actionModals[c];i?h.displayModal(i,d):b.create({body:g,title:e,type:b.types.CONFIRM}).done(function(a){h.actionModals[c]=a,h.displayModal(a,d)})})},h.prototype.displayModal=function(a,b){var d=a.getRoot(),e=this;d.off(c.yes),d.on(c.yes,b),d.on(c.shown,function(a){var b=a.target.querySelector("[data-tw-assigncomp-archive-modal-confirm]");b&&(b.checked=!1),e.loader&&e.loader.hide()}),a.show()},h.prototype.getExtraDataForArchive=function(a){var b=a.target.querySelector("[data-tw-assigncomp-archive-modal-confirm]"),c=!!b&&b.checked;return{continue_tracking:c}},h.prototype.triggerActionAndUpdatePage=function(a,b,c){"undefined"==typeof c&&(c={});var d=this;d.loader.show(),e.getData(this.triggerAction(a,null,b,c)).then(function(c){d.showActionConfirmation(a,c.results),"delete"===a?(d.list.removeItemFromList([b]),d.loader.show(),d.basketManager.queueRemove(b).updateAndRender().then(function(){d.loader.hide()})):d.list.update()})},h.prototype.triggerBulkActionAndUpdatePage=function(a,b){"undefined"==typeof b&&(b={});var c=this;c.loader.show(),c.basketManager.load().then(function(d){e.getData(c.triggerAction(a,c.basketManager.getBasketKey(),null,b)).then(function(b){c.showBulkActionConfirmation(a,b.results,d),c.loader.show(),c.basketManager.deleteAndRender().then(function(){c.updatePage([c.list.getUpdateRequestArgs()])})})})},h.prototype.showActionConfirmation=function(a,b){var c={affected:b.length},d=b.length>0?"success":"error";this.showNotification(d,"action_confirm_"+a+"_"+d,"totara_competency",c)},h.prototype.showBulkActionConfirmation=function(a,b,c){var d=c.length-b.length,e={affected:b.length,expected:c.length,skipped:d},f=b.length>0?"success":"warning",g="action_confirm_"+a+"_bulk";d>0&&(g+="_skipped"),this.showNotification(f,g,"totara_competency",e)},h.prototype.showNotification=function(b,c,d,e){"undefined"==typeof e&&(e={}),f.clearNotifications(),a.get_string(c,d,e).done(function(a){f.addNotification({message:a,type:b}),window.scrollTo(0,0)}).fail(f.exception)},h.prototype.triggerAction=function(a,b,c,d){return"undefined"==typeof d&&(d={}),{args:{action:a,basket:b,id:c,extra:d},callback:[],methodname:"totara_competency_assignment_action"}},h.prototype.actionsCallback=function(a){var b=[],c=parseInt(a.status);return 1!==c&&b.push({name:"delete",icon:"delete",eventKey:"deleteClicked",disabled:!1,hidden:!1}),1===c&&b.push({name:"archive",icon:"archive",eventKey:"archiveClicked",disabled:!1,hidden:!1}),0===c&&b.push({name:"activate",icon:"activate",eventKey:"activateClicked",disabled:!1,hidden:!1}),b},h.prototype.iconsCallback=function(){return[{key:"delete",name:"remove",string:"action_delete",component:"totara_competency",classes:"tw-list__hover_warning"},{key:"activate",name:"activate",string:"action_activate",component:"totara_competency"},{key:"archive",name:"archive",string:"action_archive",component:"totara_competency"}]},h.prototype.initExtend=function(){this.customListEvents(),this.customBubbledEventsListener()};var i=function(a){return{actions:a.actionsCallback,cols:[{dataPath:"competency_name",headerString:{component:"totara_competency",key:"header_competency"}},{dataPath:"assignment_type_name",headerString:{component:"totara_competency",key:"header_assignment_type"}},{dataPath:"user_group_name",headerString:{component:"totara_competency",key:"assigned_type_detail"}},{dataPath:"status_name",headerString:{component:"totara_competency",key:"header_status"},size:"sm"},{columnTemplate:{template:"totara_competency/warning_message"},dataPath:"pathway_warning_message",headerString:{component:"totara_competency",key:"header_pathway_warning_message"}}],extraRowData:[{key:"status",dataPath:"status"},{key:"user_group_type",dataPath:"user_group_type"}],hasHierarchy:!1,icons:a.iconsCallback}},j=function(a){return new Promise(function(b){var c=new h,d={basketKey:"totara_competency_manage_assignment",basketType:"session",list:{map:i(c),service:"totara_competency_assignment_index"},parent:a};c.init(d).then(function(){b(c)})})};return{init:j}});
define('totara_competency/modal_list', ["core/str","core/templates","core/modal_factory","core/ajax"],function(a,b,c,d){function e(){return this instanceof e?void(this.externalBasket=null):new e}e.prototype.getKey=function(){return this.settings.key},e.prototype.initExtend=function(){this.setExtendingFunctions(),this.propagatedModalEvents()},e.prototype.propagatedModalEvents=function(){var a=this.modal.getRoot(),b=this;a.on("modal-save-cancel:save",function(){var a=new Promise(function(a){"adder"===b.settings.mode?b.basketManager.load().then(function(c){0===c.length?a(b.list.disabledItems):b.externalBasket?b.externalBasket.add(c).then(function(b){a(b)}):a(c.concat(b.list.disabledItems))}):"selector"===b.settings.mode?b.externalBasket?b.externalBasket.copyFrom(b.basketManager.getBasket()).then(function(b){a(b)}):b.basketManager.load().then(function(b){a(b)}):a([])});a.then(function(a){var c={args:b.list.getRequestArgs(),methodname:b.list.getWebservice()};c.args.filters={ids:a},c.args.page=0,d.getData(c).then(function(c){var d=c.results.items;b.reset(),b.settings.onSaved&&b.settings.onSaved(b,a,d)})})}),a.on("modal:hidden",function(){b.basketManager&&b.basketManager.widget.classList.contains("tw-selectionBasket__displayed")&&(b.basketManager.onBasketHide(),b.basketManager.onBasketHidden()),b.basketManager&&b.basketManager["delete"](),b.reset(),b.settings.onClosed&&b.settings.onClosed()})},e.prototype.setExtendingFunctions=function(){var a=this,b=a.settings.events;b&&Object.keys(b).forEach(function(c){if(a[c])for(var d in a.settings.events[c])b[c].hasOwnProperty(d)&&"function"==typeof b[c][d]&&(a[c][d]=b[c][d].bind(a))})},e.prototype.show=function(a){"undefined"==typeof a&&(a=null);var b=this,c=new Promise(function(c){"adder"===b.settings.mode?b.basketManager["delete"]().then(function(){b.externalBasket&&null===a?b.externalBasket.load().then(function(a){b.list.disabledItems=a,c([])}):(b.list.disabledItems=a,c([]))}):"selector"===b.settings.mode?b.externalBasket&&null===a?b.basketManager.getBasket().copyFrom(b.externalBasket).then(function(a){c(a)}):b.basketManager.getBasket().replace(a).then(function(a){c(a)}):c()});c.then(function(a){b.loader.show(),"viewer"===b.settings.mode?b.list.update().then(function(){b.modal.show()}):b.basketManager.renderBasket(a).then(function(){return b.updatePage([b.list.getUpdateRequestArgs()])}).then(function(){b.modal.show()})})};var f=function(a){return new Promise(function(b,c){void 0===a.key?c('Required option "key" has not been defined'):void 0===a.list?c('Required option "list" has not been defined'):void 0===a.list.service?c('Required list option "service" has not been defined'):void 0===a.list.map||"object"!=typeof a.list.map?c('Required list option "map" must be defined & must be of type object'):void 0===a.title?c('Required option "title" has not been defined'):b()})},g=function(a){var b={has_paging:!0,modal_display:!0,has_count:!0};return"adder"!==a.mode&&"selector"!==a.mode||(b.crumbs=null,b.hasToggleSelection=!0,b.selection_basket=!0),a.expandable&&(b.expandTemplate=a.expandable.template,a.expandable.service&&(b.expandTemplateWebservice=a.expandable.service,a.expandable.args&&(b.expandTemplateWebserviceArgs=JSON.stringify(a.expandable.args)))),a.list.map.hasHierarchy&&(b.crumbtrail_template_name="totara_competency/crumb_with_title",b.has_crumbtrail=!0,b.has_level_toggle=a.levelToggle),new Promise(function(c){var d=[];a.title&&d.push(k(a.title)),a.primarySearch&&d.push(j(a.primarySearch)),a.primaryDropDown&&d.push(i(a.primaryDropDown)),Promise.all(d).then(function(a){for(var d=0;d<a.length;d++){var e=a[d];if("object"==typeof e)for(var f in e)b[f]=e[f]}c(b)})})},h=function(a){return new Promise(function(d){g(a).then(function(e){var f="viewer"===a.mode?c.types.DEFAULT:c.types.SAVE_CANCEL;b.render("totara_competency/basket_list",e).then(function(a){c.create({body:a,large:!0,title:e.title,type:f}).done(function(a){a.attachToDOM(),d(a)})})})})},i=function(b){return new Promise(function(c){var e=new Promise(function(c){b.placeholderString.value?c(b.placeholderString.value):a.get_string(b.placeholderString[0].key,b.placeholderString[0].component).then(c)});e.then(function(a){d.getData({args:b.serviceArgs,methodname:b.service}).then(function(d){var e=b.serviceLabelKey?b.serviceLabelKey:"name",f=[{active:!0,"default":!0,has_children:!1,name:a,key:""}];f=f.concat(d.results.items.map(function(a){return{active:!1,"default":!1,has_children:!1,key:a.id,name:a[e]}}));var g={primary_filter_tree:{active_name:a,flat_tree:!0,key:b.filterKey,options:f,parents_are_selectable:!0,partial:!0,show_border_box:!0,title_hidden:!0}};c(g)})})})},j=function(b){return new Promise(function(c){var d=new Promise(function(c){b.placeholderString.value?c(b.placeholderString.value):a.get_string(b.placeholderString[0].key,b.placeholderString[0].component).then(c)});d.then(function(a){var d={primary_filter_search:{key:b.filterKey,partial:!0,placeholder_show:!0,title:a,title_hidden:!0}};c(d)})})},k=function(b){return new Promise(function(c){var d=new Promise(function(c){b[0].value?c({title:b[0].value}):a.get_string(b[0].key,b[0].component).then(function(a){c({title:a})})});d.then(function(a){c(a)})})},l=function(a){return new Promise(function(b){h(a).then(function(c){var d=a.crumbtrail?a.crumbtrail:null,f={crumbtrail:d,list:a.list,parent:c.body[0]},g=new Promise(function(b){"adder"===a.mode||"selector"===a.mode?require(["totara_competency/basket_list"],function(a){b(a)}):require(["totara_competency/view_list"],function(a){b(a)})});g.then(function(d){Object.assign(d.prototype,e.prototype);var g=new d;g.modal=c,g.settings=a,a.externalBasket&&(g.externalBasket=a.externalBasket),g.init(f).then(function(){b(g)})})})})},m=function(a){return new Promise(function(b,c){a.mode="adder",f(a).then(function(){a.list.map.hasCheckboxes=!0,l(a).then(function(a){b(a)})},function(b){c([a.key,b])})})},n=function(a){return new Promise(function(b,c){a.mode="selector",f(a).then(function(){a.list.map.hasCheckboxes=!0,l(a).then(function(a){b(a)})},function(b){c([a.key,b])})})},o=function(a){return new Promise(function(b,c){a.mode="viewer",f(a).then(function(){a.list.map.hasCheckboxes=!1,l(a).then(function(a){b(a)})},function(b){c([a.key,b])})})};return{adder:m,selector:n,viewer:o}});
define('totara_competency/paging', [],function(){function a(){return this instanceof a?(this.eventKey="",void(this.widget="")):new a}a.prototype={events:function(){var a=this;this.widget.addEventListener("click",function(b){if(b.preventDefault(),b.target&&b.target.closest("[data-tw-paging-nextPage-trigger]")){var c=b.target.getAttribute("data-tw-paging-nextPage");a.triggerEvent("changed",{page:c,changeType:"append"})}})},setEventKey:function(){this.eventKey=this.widget.getAttribute("data-tw-paging-events")},setParent:function(a){this.widget=a},triggerEvent:function(a,b){var c=new CustomEvent(this.eventKey+":"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),d.setEventKey(),d.events(),c(d)})};return{init:b}});
define('totara_competency/paging_manager', ["core/templates"],function(a){function b(){return this instanceof b?(this.contentChangeType="replace",this.eventListener="totara_core/paging",this.eventNode="",this.page=1,this.template="totara_competency/paging_content",void(this.widget="")):new b}b.prototype.bubbledEventsListener=function(){var a=this;this.eventNode.addEventListener(this.eventListener+":changed",function(b){a.setPageNumber(b.detail.page),a.setContentChangeType(b.detail.changeType),a.onChange()})},b.prototype.extendRequestData=function(a){return a.args.page=this.getPageNumber(),a.callback.push(this.renderPaginationBtn.bind(this)),a},b.prototype.getContentChangeType=function(){return this.contentChangeType},b.prototype.getEventListener=function(){return this.eventListener},b.prototype.getPageNumber=function(){return this.page},b.prototype.onChange=function(){},b.prototype.onChangeAppendType=function(){},b.prototype.renderPaginationBtn=function(b){var c=this.widget,d=this;return new Promise(function(e){return c?void(b.next?a.renderReplace(d.template,b,c).then(function(){d.resetPageNumber(),e()}):(c.innerHTML="",b.page>0&&d.resetPageNumber(),e())):void e()})},b.prototype.resetPageNumber=function(){this.setPageNumber(1)},b.prototype.setContentChangeType=function(a){this.contentChangeType=a,this.onChangeAppendType(a)},b.prototype.setPageNumber=function(a){this.page=a},b.prototype.setParent=function(a){this.widget=a},b.prototype.setParentEventNode=function(a){this.eventNode=a};var c=function(a){var c=new b,d=a.querySelector("[data-tw-paging]");return c.setParent(d),c.setParentEventNode(a),c.bubbledEventsListener(),c};return{init:c}});
define('totara_competency/pathway_test', ["core/templates","core/notification"],function(a,b){function c(){return this instanceof c?(this.widget="",void(this.clearEvents=!1)):new c}c.prototype={events:function(){this.widget.addEventListener("click",function(a){!a.target})},bubbledEventsListener:function(){var a=this,b="totara_competency/pathway:";this.widget.addEventListener(b+"update",function(b){b.detail.key?b.detail.pathway?a.logEvent(b):a.showNotification("error",b.type+" event receved without detail",!0):a.showNotification("error",b.type+" event receved without key",!0)}),this.widget.addEventListener(b+"dirty",function(b){b.detail.key?a.logEvent(b):a.showNotification("error",b.type+" event receved without key",!0),a.clearEvents=!0})},setParent:function(a){this.widget=a},logEvent:function(a){var b='Received :"'+a.type+'".<br/>Detail  : <br/>'+JSON.stringify(a.detail)+"<br/><br/>";this.showNotification("success",b)},showNotification:function(a,c){this.clearEvents&&(b.clearNotifications(),this.clearEvents=!1),b.addNotification({message:c,type:a}),window.scrollTo(0,0)}};var d=function(a){return new Promise(function(b){var d=new c;d.setParent(a),d.events(),d.bubbledEventsListener(),b(d)})};return{init:d}});
define('totara_competency/save_assignments', ["core/str","core/templates","totara_competency/modal_list","totara_competency/list_framework_hierarchy_events","core/ajax","core/notification","totara_competency/loader_manager","core/modal_factory","totara_competency/session_basket"],function(a,b,c,d,e,f,g,h,i){function j(){return this instanceof j?(this.basketKeys={audiences:null,competencies:null,organisations:null,positions:null,users:null},this.baskets={audiences:null,competencies:null,organisations:null,positions:null,users:null},this.counts=null,this.competenciesCount=null,this.disabledBtnClass="tw-assignComp__btn_disabled",this.disabledViewerClass="tw-assignCompSave__disabled",this.hideClass="tw-assignCompSave__hidden",this.manageAssignmentsUrl=null,this.modalsData={audiences:"",organisations:"",positions:"",users:""},this.modalLists={},this.removingElement=!1,this.selectedModal=null,this.services={updateBasket:"totara_core_basket_update",createAssignments:"totara_competency_assignment_create_from_baskets",users:"totara_competency_user_index",audiences:"totara_competency_cohort_index",organisations:"hierarchy_organisation_index",positions:"hierarchy_position_index"},this.strings={},this.widget="",void(this.saveConfirmationModal=null)):new j}j.prototype.propagatedEvents=function(){var a=this.widget.querySelector("[data-tw-assignCompSave-tree]"),b=this;this.widget.addEventListener("click",function(a){if(a.target.closest("[data-tw-assignCompSave-remove-selected-group]")){a.preventDefault();var c=a.target.closest("[data-tw-assignCompSave-selected-row-id]");c&&b.removeSelectedGroup(c)}else if(a.target.closest("[data-tw-assignCompSave-browse-individuals]")){if(a.preventDefault(),a.target.closest("."+b.disabledViewerClass))return;b.modalLists.individual.show()}else a.target.closest("[data-tw-assignCompSave-save]")&&(a.preventDefault(),b.showSaveModal(a))}),a&&(a.addEventListener("totara_core/select_tree:add",function(a){b.selectedModal=a.detail.val}),a.addEventListener("totara_core/select_tree:changed",function(){var a=b.modalLists[b.selectedModal];a.show()}))},j.prototype.showSaveModal=function(){var c=this.getTotalCount(),d=this;c<1||a.get_string("save_modal_body","totara_competency",c*this.competenciesCount).then(function(a){var c={count_string:a};d.saveConfirmationModal?b.render("totara_competency/save_modal",c).then(function(a){d.saveConfirmationModal.setBody(a),d.saveConfirmationModal.show()}):h.create({body:b.render("totara_competency/save_modal",c),title:d.strings.confirmationHeader,type:h.types.CONFIRM}).done(function(a){d.saveConfirmationModal=a;var b=a.getRoot();b.on("modal-confirm:yes",function(a){var b=a.target.querySelector("[data-tw-assigncomp-save-modal-checkbox]").checked;d.createAssignments(b)}),b.on("modal:shown",function(a){var b=a.target.querySelector("[data-tw-assigncomp-save-modal-checkbox]");b&&(b.checked=!1)}),a.show()})})},j.prototype.initVariables=function(){var a=this.widget.dataset;this.manageAssignmentsUrl=this.widget.querySelector("[data-tw-assignCompSave-backBtn]").getAttribute("href"),this.competenciesCount=parseInt(a.competenciesCount),this.basketKeys={audiences:a.basketAudiences,competencies:a.basketCompetencies,organisations:a.basketOrganisations,positions:a.basketPositions,users:a.basketUsers},this.baskets={audiences:new i(this.basketKeys.audiences),competencies:new i(this.basketKeys.competencies),organisations:new i(this.basketKeys.organisations),positions:new i(this.basketKeys.positions),users:new i(this.basketKeys.users)},this.counts={audiences:parseInt(a.basketAudiencesCount),organisations:parseInt(a.basketOrganisationsCount),positions:parseInt(a.basketPositionsCount),users:parseInt(a.basketUsersCount)}},j.prototype.disableOverviewActions=function(){var a=this.widget.querySelector("[data-tw-assignCompSave-save]"),b=this.widget.querySelector("[data-tw-assignCompSave-browse-individuals]");a.classList.add(this.disabledBtnClass),b.classList.add(this.disabledViewerClass),a.setAttribute("aria-disabled",!0),b.setAttribute("aria-disabled",!0)},j.prototype.enableOverviewActions=function(){var a=this.widget.querySelector("[data-tw-assignCompSave-save]"),b=this.widget.querySelector("[data-tw-assignCompSave-browse-individuals]");a.classList.remove(this.disabledBtnClass),b.classList.remove(this.disabledViewerClass),a.setAttribute("aria-disabled",!1),b.setAttribute("aria-disabled",!1)},j.prototype.getTotalCount=function(){var a=0;for(var b in this.counts)this.counts.hasOwnProperty(b)&&(a+=parseInt(this.counts[b]));return a},j.prototype.createAssignments=function(a){var b=this;e.getData({args:{basket:b.basketKeys.competencies,status:a?1:0,usergroups:{cohort:b.basketKeys.audiences,organisation:b.basketKeys.organisations,position:b.basketKeys.positions,user:b.basketKeys.users}},methodname:b.services.createAssignments}).then(function(a){a.results&&0===a.results.length?window.location.reload():window.location.replace(b.manageAssignmentsUrl)})["catch"](function(){window.location.reload()})},j.prototype.setTypeCount=function(a,b){b&&(this.counts[a]=b.length?b.length:0)},j.prototype.updateTotalCount=function(){var a=this.getTotalCount(),b=this.widget.querySelector("[data-tw-assignCompSave-selected-empty]"),c=this.widget.querySelector("[data-tw-assignCompSave-selected-group-count]");c.innerHTML=a,a<1?(b.classList.remove(this.hideClass),this.disableOverviewActions()):(b.classList.add(this.hideClass),this.enableOverviewActions())},j.prototype.resetTreeList=function(){var a=this.widget.querySelector("[data-tw-assignCompSave-tree] [data-tw-selectorgroup]");a.setAttribute("data-tw-selectorgroup-clear",!0)},j.prototype.renderItems=function(a,c){var d=this.widget.querySelector('[data-tw-assignCompSave-selected-group="'+a+'"]'),e=this;return new Promise(function(f){return d?void b.render("totara_competency/save_selected_user_group_body",{basket:e.basketKeys[a],items:c,title:e.strings[a],type:a}).then(function(b){d.innerHTML=b,e.setTypeCount(a,c),e.updateTotalCount(),f()}):void f()})},j.prototype.removeSelectedGroup=function(a){if(!this.removingElement){this.removingElement=!0;var b,c=a.getAttribute("data-tw-assignCompSave-selected-row-id"),d=a.closest("[data-tw-assignCompSave-selected-group]"),e=this,f=a.getAttribute("data-tw-assignCompSave-selected-row-type");this.baskets[f].remove(c).then(function(){a.remove(),b=d.querySelectorAll("[data-tw-assignCompSave-selected-row-id]"),e.setTypeCount(f,b),e.updateTotalCount(),b.length||d.firstElementChild.classList.add(e.hideClass),e.removingElement=!1})["catch"](function(){e.removingElement=!1})}},j.prototype.getUserModalConfig=function(){var a=this;return new Promise(function(b){var c={externalBasket:a.baskets.users,key:"users",list:{map:{cols:[{dataPath:"display_name",headerString:{key:"fullnameuser",value:""}}]},service:"totara_competency_user_index"},onClosed:function(){a.resetTreeList()},onSaved:function(b,c,d){a.renderItems("users",d)},primarySearch:{filterKey:"text",placeholderString:[{component:"totara_core",key:"search"}]},title:[{component:"totara_core",key:"selectuserplural"}]};b(c)})},j.prototype.getAudienceModalConfig=function(){var a=this;return new Promise(function(b){var c={externalBasket:a.baskets.audiences,key:"audiences",list:{map:{cols:[{dataPath:"display_name",headerString:{component:"totara_cohort",key:"name"}}]},service:a.services.audiences},onClosed:function(){a.resetTreeList()},onSaved:function(b,c,d){a.renderItems("audiences",d)},primarySearch:{filterKey:"text",placeholderString:[{component:"totara_core",key:"search"}]},title:[{component:"totara_cohort",key:"selectcohorts"}]};b(c)})},j.prototype.getOrganisationModalConfig=function(){var a=this;return new Promise(function(b,c){d.init().then(function(c){var d={externalBasket:a.baskets.organisations,key:"organisations",crumbtrail:{service:"hierarchy_organisation_show",stringList:[{component:"totara_hierarchy",key:"hierarchy_list:organisation:all"},{component:"totara_hierarchy",key:"hierarchy_list:organisation:all_in_framework"}]},events:c,expandable:{args:{include:{crumbs:1}},service:"hierarchy_organisation_show",template:"totara_competency/hierarchy_expanded"},levelToggle:!0,list:{map:{cols:[{dataPath:"fullname",expandedViewTrigger:!0,headerString:{component:"totara_hierarchy",key:"organisation"}}],extraRowData:[{key:"framework",dataPath:"frameworkid"}],hasExpandedView:!0,hasHierarchy:!0},service:"hierarchy_organisation_index"},onClosed:function(){a.resetTreeList()},onSaved:function(b,c,d){a.renderItems("organisations",d)},primaryDropDown:{filterKey:"framework",placeholderString:[{component:"totara_hierarchy",key:"allframeworks"}],service:"hierarchy_organisation_framework_index",serviceArgs:{direction:"asc",filters:[],order:"sortorder",page:0},serviceLabelKey:"fullname"},primarySearch:{filterKey:"text",placeholderString:[{component:"totara_core",key:"search"}]},title:[{component:"totara_hierarchy",key:"hierarchy_list:organisation:select"}]};b(d)})["catch"](function(){c()})})},j.prototype.getPositionModalConfig=function(){var a=this;return new Promise(function(b,c){d.init().then(function(c){var d={externalBasket:a.baskets.positions,key:"positions",crumbtrail:{service:"hierarchy_position_show",stringList:[{component:"totara_hierarchy",key:"hierarchy_list:position:all"},{component:"totara_hierarchy",key:"hierarchy_list:position:all_in_framework"}]},events:c,expandable:{args:{include:{crumbs:1}},service:"hierarchy_position_show",template:"totara_competency/hierarchy_expanded"},levelToggle:!0,list:{map:{cols:[{dataPath:"fullname",expandedViewTrigger:!0,headerString:{component:"totara_hierarchy",key:"position"}}],extraRowData:[{key:"framework",dataPath:"frameworkid"}],hasExpandedView:!0,hasHierarchy:!0},service:"hierarchy_position_index"},onClosed:function(){a.resetTreeList()},onSaved:function(b,c,d){a.renderItems("positions",d)},primaryDropDown:{filterKey:"framework",placeholderString:[{component:"totara_hierarchy",key:"allframeworks"}],service:"hierarchy_position_framework_index",serviceArgs:{direction:"asc",filters:[],order:"sortorder",page:0},serviceLabelKey:"fullname"},primarySearch:{filterKey:"text",placeholderString:[{component:"totara_core",key:"search"}]},title:[{component:"totara_hierarchy",key:"hierarchy_list:position:select"}]};b(d)})["catch"](function(){c()})})},j.prototype.getIndividualsModalConfig=function(){var a=this;return new Promise(function(b){var c={key:"individual",list:{map:{cols:[{dataPath:"full_name",headerString:{component:"core",key:"fullnameuser"}},{columnTemplate:{template:"totara_competency/save_user_group_names"},dataPath:"user_group_names",headerString:{component:"totara_competency",key:"sort_user_group_name"}}]},service:"totara_competency_expand_user_groups_index",serviceArgs:{baskets:{cohort:a.basketKeys.audiences,organisation:a.basketKeys.organisations,position:a.basketKeys.positions,user:a.basketKeys.users}}},primarySearch:{filterKey:"name",placeholderString:[{component:"totara_core",key:"search"}]},title:[{component:"totara_competency",key:"browse_selected_user_groups"}]};b(c)})},j.prototype.setParent=function(a){this.widget=a},j.prototype.getModalData=function(){var a=this;return new Promise(function(b,c){Promise.all([a.getAudienceModalConfig(),a.getOrganisationModalConfig(),a.getPositionModalConfig(),a.getUserModalConfig(),a.getIndividualsModalConfig()]).then(function(c){a.modalsData.audiences=c[0],a.modalsData.organisations=c[1],a.modalsData.positions=c[2],a.modalsData.users=c[3],a.modalsData.individuals=c[4],b()})["catch"](function(){c()})})},j.prototype.getPageStrings=function(){var b=[],c=this;return b.push({component:"totara_cohort",key:"cohorts"},{component:"totara_core",key:"individualplural"},{component:"totara_hierarchy",key:"organisationplural"},{component:"totara_hierarchy",key:"positionplural"},{component:"totara_competency",key:"save_modal_header"}),new Promise(function(d){a.get_strings(b).then(function(a){c.strings.audiences=a[0],c.strings.users=a[1],c.strings.organisations=a[2],c.strings.positions=a[3],c.strings.selectedGroups=a[4],c.strings.confirmationHeader=a[5],d()})})},j.prototype.createModals=function(){var a=this,b=[c.adder(a.modalsData.audiences),c.adder(a.modalsData.organisations),c.adder(a.modalsData.positions),c.adder(a.modalsData.users),c.viewer(a.modalsData.individuals)];Promise.all(b).then(function(b){var c,d,e;for(c=0;c<b.length;c++)e=b[c],d=e.getKey(),a.modalLists[d]=e;var f=a.widget.querySelector("[data-tw-assignCompSave-tree] [data-tw-selectorgroup]");f.setAttribute("data-tw-selecttree-disabled","activate"),a.getTotalCount()>0&&a.enableOverviewActions(),a.loader.hide()})["catch"](function(a){f.exception({fileName:"save_assignments.js",message:a[0]+" modal: "+a[1],name:"Error adding modal"})})};var k=function(a){return new Promise(function(b){var c=new j;c.setParent(a),c.initVariables(),c.loader=g.init(a),c.loader.show(),c.propagatedEvents(),b(c),c.getPageStrings().then(function(){c.getModalData().then(function(){c.createModals()})})})};return{init:k}});
define('totara_competency/selection_basket', [],function(){function a(){return this instanceof a?(this.countChange="data-tw-selectionbasket-countchange",this.countRequired="data-tw-selectionBasket-countReq",this.disabledBtnsClass="tw-selectionBasket__btn_disabled",this.eventKey=null,this.emptyBasketClass="tw-selectionBasket__empty",this.expandedActionsClass="tw-selectionBasket__actions_group_active",this.wideBasketClass="tw-selectionBasket--wide",void(this.widget=null)):new a}a.prototype={constructor:a,events:function(){var a=this;this.widget.addEventListener("click",function(b){if(b.target){if(b.target.closest("."+a.disabledBtnsClass))return void b.preventDefault();var c,d;if(b.target.closest("[data-tw-selectionBasket-group-trigger]")){b.preventDefault();var e=b.target.closest("[data-tw-selectionBasket-group]");e.classList.toggle(a.expandedActionsClass)}else b.target.closest("[data-tw-selectionbasket-action]")?(b.preventDefault(),d=b.target.closest("[data-tw-selectionbasket-action]"),c=d.getAttribute("data-tw-selectionbasket-action"),a.hideExpandedList(),a.triggerEvent("update",{action:c})):b.target.closest("[data-tw-selectionbasket-customAction]")&&(d=b.target.closest("[data-tw-selectionbasket-customAction]"),c=d.getAttribute("data-tw-selectionbasket-customAction"),a.hideExpandedList(),a.triggerEvent("customUpdate",{action:c}))}}),this.widget.addEventListener("transitionend",function(b){"max-width"===b.propertyName&&(b.target.classList.contains(a.wideBasketClass)?a.triggerEvent("transition",{state:"large"}):a.triggerEvent("transition",{state:"small"}))}),document.addEventListener("click",function(b){var c=a.widget.querySelector("."+a.expandedActionsClass);c&&b.target&&!b.target.closest("."+a.expandedActionsClass)&&c.classList.toggle(a.expandedActionsClass)});var b=new MutationObserver(function(){if(a.widget.hasAttribute(a.countChange)){var b=parseInt(a.widget.getAttribute(a.countChange));b||(b=0),a.updateCount(b),a.widget.removeAttribute(a.countChange)}});b.observe(this.widget,{attributes:!0,attributeFilter:[a.countChange],subtree:!1})},hideExpandedList:function(){var a=this.widget.querySelector("."+this.expandedActionsClass);a&&a.classList.toggle(this.expandedActionsClass)},setEventKey:function(){this.eventKey=this.widget.getAttribute("data-tw-selectionBasket-events")},setParent:function(a){this.widget=a},triggerEvent:function(a,b){var c=new CustomEvent(this.eventKey+":"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)},updateBtnState:function(a){var b,c=this.widget.querySelectorAll("["+this.countRequired+"]"),d=this.widget.querySelector("."+this.disabledBtnsClass);if(d&&a)for(b=0;b<c.length;b++)c[b].classList.remove(this.disabledBtnsClass);else if(!d&&!a)for(b=0;b<c.length;b++)c[b].classList.add(this.disabledBtnsClass)},updateCount:function(a){var b=this.widget.querySelector("[data-tw-selectionbasket-count]");b.innerHTML=a,this.updateBtnState(a),0===a?this.widget.classList.add(this.emptyBasketClass):this.widget.classList.remove(this.emptyBasketClass)}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),d.setEventKey(),d.events(),c(d)})};return{init:b}});
define('totara_competency/select_region_panel_toggle', [],function(){function a(){return this instanceof a?(this.activeClass="tw-selectRegionPanelToggle__active",this.targetWidgetClass="tw-selectRegionPanel",this.toggleClass="tw-selectRegionPanel__hiddenOnSmall_show",void(this.widget=null)):new a}a.prototype={events:function(){var a=this;this.widget.addEventListener("click",function(b){b.preventDefault(),b.target&&b.target.closest("[data-tw-selectRegionPanelToggle-trigger]")&&a.toggleWidget()})},setParent:function(a){this.widget=a},toggleWidget:function(){this.widget.classList.toggle(this.activeClass),this.triggerEvent("changed",{target:"."+this.targetWidgetClass,toggleClass:this.toggleClass})},triggerEvent:function(a,b){var c=new CustomEvent("totara_competency/select_region_panel_toggle:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),d.events(),c(d)})};return{init:b}});
define('totara_competency/session_basket', ["totara_competency/basket","core/ajax"],function(a,b){function c(b){a.call(this,b,!0)}return c.prototype=Object.create(a.prototype),c.prototype.constructor=c,c.prototype.add=function(a){return this.doUpdate("add",a)},c.prototype.remove=function(a){return this.doUpdate("remove",a)},c.prototype.replace=function(a){return this.doUpdate("replace",a)},c.prototype.doUpdate=function(a,c){Array.isArray(c)||(c=[c]);var d=this;return new Promise(function(e){var f={args:{action:a,basket:d.basketKey,ids:c},methodname:"totara_core_basket_update"};b.getData(f).then(function(a){e(a.results.ids)})})},c.prototype.load=function(){var a=this;return new Promise(function(c){var d={args:{basket:a.basketKey},methodname:"totara_core_basket_show"};b.getData(d).then(function(a){c(a.results.ids)})})},c.prototype.copyFrom=function(d){var e=this;return d instanceof c?new Promise(function(a){var c={args:{options:{replace:!0},sourcebasket:d.getKey(),targetbasket:e.basketKey},methodname:"totara_core_basket_copy"};b.getData(c).then(function(b){a(b.results.ids)})}):a.prototype.copyFrom.call(e,d)},c.prototype.moveFrom=function(d){var e=this;return d instanceof c?new Promise(function(a){var c={args:{options:{deletesource:!0,replace:!0},sourcebasket:d.getKey(),targetbasket:e.basketKey},methodname:"totara_core_basket_copy"};b.getData(c).then(function(b){a(b.results.ids)})}):a.prototype.moveFrom.call(e,d)},c.prototype["delete"]=function(){var a=this;return new Promise(function(c){var d={args:{basket:a.basketKey},methodname:"totara_core_basket_delete"};b.getData(d).then(function(){c()})})},c});
define('totara_competency/simple_basket', ["totara_competency/basket"],function(a){function b(b){a.call(this,b,!1),this.basketItems=[]}return b.prototype=Object.create(a.prototype),b.prototype.constructor=b,b.prototype.add=function(a){Array.isArray(a)||(a=[a]);var b=this;return new Promise(function(c){b.basketItems=b.basketItems.concat(a),c(b.basketItems)})},b.prototype.remove=function(a){Array.isArray(a)||(a=[a]);var b=this;return new Promise(function(c){for(var d=0;d<a.length;d++)b.basketItems.splice(b.basketItems.indexOf(a[d]),1);c(b.basketItems)})},b.prototype.replace=function(a){Array.isArray(a)||(a=[a]);var b=this;return new Promise(function(c){b.basketItems=a,c(b.basketItems)})},b.prototype.load=function(){var a=this;return new Promise(function(b){b(a.basketItems)})},b.prototype["delete"]=function(){var a=this;return new Promise(function(b){a.basketItems=[],b()})},b});
define('totara_competency/test_lists', [],function(){function a(){if(!(this instanceof a))return new a}a.prototype.registerEventListeners=function(){var a=this;document.addEventListener("totara_core/lists:action",function(b){a.showNotification("info","'"+b.detail.key+"' action clicked for row with id '"+b.detail.val+"'"),"delete"===b.detail.key&&b.target.closest("[data-tw-list]").setAttribute("data-tw-list-removerow",JSON.stringify([b.detail.val]))}),document.addEventListener("totara_core/lists:hierarchyRequest",function(b){a.showNotification("info","hierarchy icon clicked for row with id '"+b.detail.val+"'")}),document.addEventListener("totara_core/lists:add",function(b){a.showNotification("info","selected row with id '"+b.detail.val+"'")}),document.addEventListener("totara_core/lists:remove",function(b){a.showNotification("info","deselected row with id '"+b.detail.val+"'")})},a.prototype.showNotification=function(a,b){require(["core/notification"],function(c){c.clearNotifications(),c.addNotification({message:b,type:a})})};var b=function(){return new Promise(function(b){var c=new a;c.registerEventListeners(),b(c)})};return{init:b}});
define('totara_competency/test_lists_manager', ["totara_competency/action_list_manager","totara_competency/loader_manager"],function(a,b){var c=function(a,b){require(["core/notification"],function(c){c.clearNotifications(),c.addNotification({message:b,type:a})})},d=function(a,b){a.onListHierarchyLevelChange=function(a){c("info","hierarchy level for item with id '"+a.detail.val+"' changed")},a.onListHierarchyLevelChangeExtend=function(a){c("info","extended hierarchy level for item with id '"+a.detail.val+"' changed")},a.onItemSelected=function(a){c("info","item with id '"+a+"' selected")},a.onItemUnselected=function(a){c("info","item with id '"+a+"' unselected")},a.onItemUpdate=function(){c("info","item got updated")},a.onPreRequest=function(){c("info","update pre request"),b.show()},a.onPostRequest=function(){c("info","update post request"),b.hide()},a.onCustomAction=function(a){c("info","action '"+a.detail.key+"' for id '"+a.detail.val+"' triggered")}},e=function(){return[{name:"delete",icon:"delete",eventKey:"deleteClicked",disabled:!1,hidden:!1},{name:"archive",icon:"archive",eventKey:"archiveClicked",disabled:!1,hidden:!1},{name:"activate",icon:"activate",eventKey:"activateClicked",disabled:!1,hidden:!1}]},f=function(){return[{key:"delete",name:"delete",string:"delete",component:"totara_core"},{key:"activate",name:"check",string:"activate",component:"totara_core"},{key:"archive",name:"archive",string:"archive",component:"totara_core"}]},g=function(a,b){return{actions:e,cols:[{dataPath:"column1",headerString:{value:"Column 1"},expandedViewTrigger:!0},{dataPath:"column2",headerString:{value:"Column 2"}},{dataPath:"column3",headerString:{value:"Column 3"}},{dataPath:"column4",headerString:{value:"Column 4"},size:"sm"}],extraRowData:[{key:"column4",dataPath:"column4"}],hasHierarchy:a>0,hasCheckboxes:b>0,hasExpandedView:!0,expandTemplate:"totara_competency/test_lists_expand",expandWebservice:"totara_core_test_lists_manager_show",icons:f}},h=function(c){var e="TestListManagerPause";return new Promise(function(f){M.util.js_pending(e);var h=c.getAttribute("data-tw-list-hasHierarchy"),i=c.getAttribute("data-tw-list-hasCheckboxes"),j={map:g(h,i),service:"totara_core_test_lists_manager",serviceArgs:{page:0}},k=a.init(c,j),l=b.init(c);d(k,l),k.load().then(function(){M.util.js_complete(e)}),f()})};return{init:h}});
define('totara_competency/view_list', ["totara_competency/filters","totara_competency/action_list_manager","totara_competency/filter_manager","totara_competency/loader_manager"],function(a,b,c,d){function e(){return this instanceof e?(this.hideClass="tw-basketlist__hide",this.filters=null,this.loader=null,this.selectors=null,this.listParent=null,void(this.list=null)):new e}return e.prototype.setListParent=function(a){this.listParent=a.querySelector("[data-tw-basket-list]")},e.prototype.reset=function(){this.filters.clearFilters(),this.selectors.clearFiltersRegionPanel(),this.selectors.clearPrimarySearch(),this.selectors.clearPrimaryTree()},e.prototype.filterEvents=function(a){var b=this;a.onFiltersUpdate=function(){b.list.setRequestArg("filters",a.getFilters())}},e.prototype.listEvents=function(a){var b=this;a.onPreRequest=function(){b.loader.show()},a.onPostRequest=function(){b.loader.hide()}},e.prototype.selectorEvents=function(a){var b=this;a.onFilterRegionPanelAdd=function(a){b.filters.setFilter(a.detail.key,a.detail.val,a.detail.groupValues)},a.onFilterRegionPanelUpdate=function(){b.list.update()},a.onFilterRegionPanelReset=function(a){var c=a.detail.groupValues?a.detail.groupValues:"";b.filters.removeFilter(a.detail.key,c)},a.onPrimaryFilterSearchAdd=function(a){b.filters.setFilter(a.detail.key,a.detail.val,a.detail.groupValues)},a.onPrimaryFilterSearchUpdate=function(){b.list.update()},a.onPrimaryFilterSearchReset=function(a){var c=a.detail.groupValues?a.detail.groupValues:"";b.filters.removeFilter(a.detail.key,c)},a.onPrimaryFilterTreeAdd=function(a){b.filters.setFilter(a.detail.key,a.detail.val,a.detail.groupValues)},a.onPrimaryFilterTreeUpdate=function(){b.list.update()},a.onPrimaryFilterTreeReset=function(a){var c=a.detail.groupValues?a.detail.groupValues:"";b.filters.removeFilter(a.detail.key,c)}},e.prototype.initExtend=function(){},e.prototype.init=function(e){var f=e.parent,g="viewerPause",h=this;return new Promise(function(i){M.util.js_pending(g),h.setListParent(f),h.loader=d.init(f),h.loader.show(),h.filters=new a,h.filterEvents(h.filters),e.list.defaultFilters&&(h.filters.setDefaults(e.list.defaultFilters),e.list.serviceArgs&&e.list.serviceArgs.filters?e.list.serviceArgs.filters=Object.assign(e.list.serviceArgs.filters,e.list.defaultFilters):(e.list.serviceArgs||(e.list.serviceArgs={}),e.list.serviceArgs.filters=e.list.defaultFilters)),h.list=b.init(f,e.list),h.listEvents(h.list),h.selectors=c.init(f),h.selectorEvents(h.selectors),h.initExtend(),i();var j=[h.list.prepare()];Promise.all(j).then(function(){h.list.update(),M.util.js_complete(g)})})},e});
define('totara_completioneditor/check_completion', ["jquery","core/str","core/yui"],function(a,b,c){function d(a,d){var e=[];e.push({key:"fixconfirmtitle",component:"totara_completioneditor"}),e.push({key:d,component:"totara_completioneditor"}),b.get_strings(e).done(function(b){c.use("moodle-core-notification-confirm",function(c){var d=new M.core.confirm({title:b[0],question:b[1],width:500});d.on("complete-yes",function(){window.location.href=a}),d.on("complete-no",function(a){a.preventDefault()}),d.show()})})}var e={init:function(b){a(".problemaggregation a").on("click",function(b){b.preventDefault(),d(a(this).attr("href"),"fixconfirmsome")}),a(".problemsolution a").on("click",function(b){b.preventDefault(),d(a(this).attr("href"),"fixconfirmone")})}};return e});
define('totara_completioneditor/edit_course_completion', ["jquery","core/str","core/notification"],function(a,b,c){var d={init:function(d){a(".deletecompletionhistorybutton").on("click",function(d){d.preventDefault();var e=a(this).attr("href"),f=[];f.push({key:"coursecompletionhistorydelete",component:"totara_completioneditor"}),f.push({key:"areyousure",component:"moodle"}),f.push({key:"yes",component:"moodle"}),f.push({key:"no",component:"moodle"}),b.get_strings(f).done(function(a){c.confirm(a[0],a[1],a[2],a[3],function(){window.location.href=e})})}),a(".deleteorphanedcritcomplbutton").on("click",function(d){d.preventDefault();var e=a(this).attr("href"),f=[];f.push({key:"coursecompletionorphanedcritcompldelete",component:"totara_completioneditor"}),f.push({key:"areyousure",component:"moodle"}),f.push({key:"yes",component:"moodle"}),f.push({key:"no",component:"moodle"}),b.get_strings(f).done(function(a){c.confirm(a[0],a[1],a[2],a[3],function(){window.location.href=e})})}),a(".deletecompletionlink").on("click",function(d){d.preventDefault();var e=a(this).attr("href"),f=[];f.push({key:"areyousure",component:"moodle"}),f.push({key:"coursecompletiondelete",component:"totara_completioneditor"}),f.push({key:"yes",component:"moodle"}),f.push({key:"no",component:"moodle"}),b.get_strings(f).done(function(a){c.confirm(a[0],a[1],a[2],a[3],function(){window.location.href=e})})})}};return d});
define('totara_completioneditor/form_element_confirm_action_button', ["jquery","totara_form/form","core/notification"],function(a,b,c){function d(a,c,e,f){return this instanceof d?(b.Element.apply(this,arguments),void(this.input=null)):new d(a,c,e,f)}return d.prototype=Object.create(b.Element.prototype),d.prototype.constructor=d,d.prototype.toString=function(){return"[object ConfirmActionButtonElement]"},d.prototype.init=function(b){var d=!0,e=a("#"+this.id);e.on("click",function(a){d===!0&&(a.preventDefault(),c.confirm(e.data("dialogtitle"),e.data("dialogmessage"),e.data("yesbuttonlabel"),e.data("nobuttonlabel"),function(){d=!1,e.click()},function(){d=!0}))}),b()},d});
define('totara_completionimport/select_evidence_type', ["core/ajax"],function(a){function b(b){var c=document.querySelector(".completionimport_evidencetype_customfields");if(c){if(!b||0==b)return void c.classList.add("hidden");M.util.js_pending("totara_coursecompletion_evidence_type_fields_"+b),a.call([{methodname:"totara_evidence_type_import_fields",args:{type_id:b}}])[0].then(function(a){if(!a.length)return void c.classList.add("hidden");var d=a.join(","),e=c.querySelectorAll(".felement.fstatic");e.length<2||(e[1].innerHTML=d,c.classList.remove("hidden"),M.util.js_complete("totara_coursecompletion_evidence_type_fields_"+b))})}}function c(){var a=document.getElementById("id_evidencetype");if(a){a.addEventListener("change",function(a){b(a.currentTarget.value)});var c=a.value;b(c)}}return{init:c}});
define('totara_contentmarketplace/disable', ["jquery","core/modal_factory","core/modal_events","core/str"],function(a,b,c,d){var e={};return e.init=function(){a(".tcm-disable, .tcm-enable").each(function(){var e=a(this),f=e.data("marketplace"),g=e.data("action")?e.data("action"):"disable",h="contentmarketplace_"+f,i=[{key:"warning"+g+"marketplace:title",component:h},{key:"warning"+g+"marketplace:body:html",component:h},{key:g,component:"totara_contentmarketplace"},{key:"cancel"}];d.get_strings(i).done(function(a){b.create({type:b.types.CONFIRM,title:a[0],body:a[1]},e,{yesstr:a[2],nostr:a[3]}).done(function(a){var b=a.getRoot();b.on(c.yes,function(){window.location=e.attr("href")})})})})},e});
define('totara_contentmarketplace/explorer', ["jquery","core/str","core/config","core/templates","core/modal_factory","core/modal_events","totara_contentmarketplace/filters"],function(a,b,c,d,e,f,g){var h="create-course",i={};return i.selector=null,i.haveQueriedOrSortedAtLeastOnce=!1,i.selected=[],i.totalResults=0,i.maxSelectAll=1e4,i.maxCreateCourse=100,i.warnCreateCourse=11,i.filters=null,i.lockId=0,i.createpagepath="",i.init=function(b){var c=this,d=a(b);this.selector=b,this.createpagepath=d.data("createpagepath"),this.marketplace=d.data("marketplace"),this.mode=d.data("mode"),this.mode===h&&a(".tcm-collection-tool",this.selector).hide(),this.category=d.data("category"),a(".tcm-sorting select",d).on("change",this,function(a){a.preventDefault(),a.data.sort()}),a(".tcm-search_query form",d).on("submit",this,function(a){a.preventDefault(),a.data.search()}),this.filters=new g(b,this.search.bind(this),this.marketplace,this.mode,this.category),a(".tcm-load-more button",d).on("click",this,function(a){a.preventDefault(),a.data.more()}),d.on("change",".tcm-thumbnail_selection input",this,function(b){b.preventDefault(),a(b.target).is(":checked")?c.addToSelection(a(b.target).val()):c.removeFromSelection(a(b.target).val())}),d.on("click",".tcm-thumbnail_selection label, .tcm-thumbnail_selection input",function(a){a.stopPropagation()}),d.on("click",".tcm-search-thumbnail",function(b){b.preventDefault();var d=a(this).find("input").val();c.showDetails(d)}),a(".tcm-search_selection_tools",d).on("click",".tcm-create-course.tcm-tool-enabled",this,function(a){a.preventDefault(),a.data.createCourse()}),a(".tcm-add-to-collection",d).on("click",this,function(a){a.preventDefault(),a.data.addToCollection()}),a(".tcm-remove-from-collection",d).on("click",this,function(a){a.preventDefault(),a.data.removeFromCollection()}),a(".tcm-select-all",d).on("click",this,function(a){a.preventDefault(),a.data.selectAll()}),a(".tcm-deselect-all",d).on("click",this,function(a){a.preventDefault(),a.data.deselectAll()}),this.search()},i.sort=function(){this.haveQueriedOrSortedAtLeastOnce=!0,this.search()},i.search=function(){var b,e,f=a(this.selector),g=this,i=this.lock();f.addClass("tcm-is-searching"),a(".tcm-search_result_summary",f).html(""),b=a(".tcm-search_query input",f).val().trim(),e={sesskey:c.sesskey,page:0,query:b,sort:a(".tcm-sorting select",f).val(),multivaluefilters:[],singlevaluefilters:[],marketplace:this.marketplace,category:this.category,mode:this.mode},this.haveQueriedOrSortedAtLeastOnce||""===b||(this.haveQueriedOrSortedAtLeastOnce=!0,e.isfirstquerywithdefaultsort=!0),a.each(this.filters.getValues(),function(a,b){b instanceof Array?e.multivaluefilters.push(a):e.singlevaluefilters.push(a),e["filter-"+a]=b}),this.data=e,a.post({url:c.wwwroot+"/totara/contentmarketplace/ajax/search.php",data:e}).done(function(b){g.totalResults=b.total,d.render("totara_contentmarketplace/results",b).done(function(c){g.checkLock(i)&&(c=a(c),a(".tcm-thumbnail_selection input",c).each(function(){g.selected.indexOf(a(this).val())>=0&&a(this).prop("checked",!0)}),a(".tcm-results").replaceWith(c),b.more?(a(".tcm-load-more",f).removeClass("tcm-load-more-loading"),a(".tcm-load-more button",f).prop("disabled",!1),a(".tcm-load-more",f).show()):a(".tcm-load-more",f).hide(),g.initResizeHandler())}),g.checkLock(i)&&g.filters.setCounts(b.filters),d.render("totara_contentmarketplace/result_summary",b).done(function(b){g.checkLock(i)&&(f.removeClass("tcm-is-searching"),a(".tcm-search_result_summary",f).replaceWith(b))}),a(".tcm-sorting select",f).val(b.sort),g.mode!==h&&("add"===b.selectionmode?(a(".tcm-add-to-collection",f).show(),a(".tcm-remove-from-collection",f).hide()):"remove"===b.selectionmode&&(a(".tcm-add-to-collection",f).hide(),a(".tcm-remove-from-collection",f).show()))})},i.more=function(){var b,e=a(this.selector),f=this,g=this.lock();a(".tcm-load-more",e).addClass("tcm-load-more-loading"),a(".tcm-load-more button",e).prop("disabled",!0),b=this.data,b.page+=1,a.post({url:c.wwwroot+"/totara/contentmarketplace/ajax/search.php",data:b}).done(function(b){d.render("totara_contentmarketplace/results",b).done(function(c){f.checkLock(g)&&(c=a(c),a(".tcm-thumbnail_selection input",c).each(function(){f.selected.indexOf(a(this).val())>=0&&a(this).prop("checked",!0)}),a("> div",c).appendTo(".tcm-results"),b.more?(a(".tcm-load-more",e).removeClass("tcm-load-more-loading"),a(".tcm-load-more button",e).prop("disabled",!1),a(".tcm-load-more",e).show()):a(".tcm-load-more",e).hide(),f.initResizeHandler())})})},i.addToSelection=function(a){var b=this.selected.indexOf(a);b<0&&this.selected.push(a),this.selection()},i.removeFromSelection=function(a){var b=this.selected.indexOf(a);b>-1&&this.selected.splice(b,1),this.selection()},i.selection=function(){var c=a(this.selector);if(this.selected.length>0){var d=this,e=this.selected.length,f=1===e?"itemselected":"itemselected_plural",g=a(".tcm-search_selection_status",c);b.get_string(f,"totara_contentmarketplace",e).done(function(b){d.selected.length===e&&(g.text(b),a(".tcm-search_selection_tools",c).css("visibility","visible"))})}else a(".tcm-search_selection_tools",c).css("visibility","hidden")},i.selectAll=function(){var b=this;b.totalResults>b.maxSelectAll?b.warningTooManySelectAll():(a.post({url:c.wwwroot+"/totara/contentmarketplace/ajax/select.php",data:this.data}).done(function(c){a(".tcm-select-all").siblings(".tcm-loading").css({visibility:"hidden"}),b.selected=b.selected.concat(c.selection.filter(function(a){return b.selected.indexOf(a)<0})),a(".tcm-thumbnail_selection input").each(function(){b.selected.indexOf(a(this).val())>=0&&a(this).prop("checked",!0)}),b.selection()}),a(".tcm-select-all").siblings(".tcm-loading").css({visibility:"visible"}))},i.deselectAll=function(){this.selected=[];var b=a(this.selector);a(".tcm-thumbnail_selection input:checked",b).prop("checked",!1),this.selection()},i.createCourse=function(){this.selected.length>this.maxCreateCourse?(this.disableCreateCourse(),this.warningCreateTooManyCourses()):this.selected.length>=this.warnCreateCourse?(this.disableCreateCourse(this.selected),this.warningCreateLotsOfCourses(this.openCreateCourseForm.bind(this,this.selected))):this.openCreateCourseForm(this.selected)},i.openCreateCourseForm=function(b){var d={category:this.category,selection:b,mode:this.mode};this.disableCreateCourse(),window.location=c.wwwroot+this.createpagepath+"?"+a.param(d)},i.addToCollection=function(){var b=this,d=a(b.selector);d.addClass("tcm-is-searching"),a(".tcm-search_selection_tools",d).css("visibility","hidden"),a(".tcm-search_result_summary",d).html(""),a.post({url:c.wwwroot+"/totara/contentmarketplace/ajax/update_collection.php",data:{sesskey:c.sesskey,selection:this.selected,action:"add",marketplace:this.marketplace}}).done(function(a){b.search()}),b.selected=[]},i.removeFromCollection=function(){var b=this,d=a(b.selector);d.addClass("tcm-is-searching"),a(".tcm-search_selection_tools",d).css("visibility","hidden"),a(".tcm-search_result_summary",d).html(""),a.post({url:c.wwwroot+"/totara/contentmarketplace/ajax/update_collection.php",data:{sesskey:c.sesskey,selection:this.selected,action:"remove",marketplace:this.marketplace}}).done(function(a){b.search()}),b.selected=[]},i.warningTooManySelectAll=function(){var a=[{key:"warningtoomanyselectall:title",component:"totara_contentmarketplace"},{key:"warningtoomanyselectall:body",component:"totara_contentmarketplace"}];b.get_strings(a).done(function(a){e.create({type:e.types.CANCEL,title:a[0],body:a[1]}).done(function(a){a.show()})})},i.warningCreateTooManyCourses=function(){var a=this,c=[{key:"warningcreatetoomanycourses:title",component:"totara_contentmarketplace"},{key:"warningcreatetoomanycourses:body",component:"totara_contentmarketplace"}];b.get_strings(c).done(function(b){e.create({type:e.types.CANCEL,title:b[0],body:b[1]}).done(function(b){var c=b.getRoot();c.on(f.hidden,a.enableCreateCourse),b.show()})})},i.warningCreateLotsOfCourses=function(a){var c=this,d=[{key:"warningcreatelotsofcourses:title",component:"totara_contentmarketplace"},{key:"warningcreatelotsofcourses:body",component:"totara_contentmarketplace",param:this.selected.length},{key:"createcourses",component:"totara_contentmarketplace",param:this.selected.length},{key:"cancel"}];b.get_strings(d).done(function(b){e.create({type:e.types.CONFIRM,title:b[0],body:b[1]},void 0,{yesstr:b[2],nostr:b[3]}).done(function(b){var d=b.getRoot();d.on(f.yes,a),d.on(f.hidden,c.enableCreateCourse),b.show()})})},i.enableCreateCourse=function(){a(".tcm-create-course").addClass("tcm-tool-enabled")},i.disableCreateCourse=function(){a(".tcm-create-course").removeClass("tcm-tool-enabled")},i.showDetails=function(b){var e=this;e.hideDetails(),a(".tcm-result").removeClass("tcm-details-target"),a("#selection-"+b).closest(".tcm-result").addClass("tcm-details-target");var f=this.data;f.id=b,a("#tcm-details-wrapper-actual").length||a(".tcm-details-wrapper").clone().insertAfter(".tcm-results").attr("id","tcm-details-wrapper-actual");var g=a("#tcm-details-wrapper-actual");if(a(".tcm-details-content").remove(),g.show(),a(".tcm-preloader").show(),e.positionDetails(),!e.isElementInViewport(g[0])){var h=g[0].getBoundingClientRect();window.scrollBy({top:h.bottom-window.innerHeight,behavior:"smooth"})}a.post({url:c.wwwroot+"/totara/contentmarketplace/ajax/fetch_details.php",data:f}).done(function(c){d.render("totara_contentmarketplace/details",c).done(function(c){b===a(".tcm-details-target").find("input").val()&&(a(".tcm-preloader").hide(),a(".tcm-details-content").remove(),a(c).insertAfter(".tcm-preloader"),a(".tcm-details-close").click(e.hideDetails),a(".tcm-create-course-button").click(function(){e.openCreateCourseForm([b])}))})})},i.positionDetails=function(){var b=a("#tcm-details-wrapper-actual"),c=a(".tcm-details-target",this.selector);if(b.length&&c.length){var d=c.offset().left+Math.round(c.width()/2);a(".tcm-details-pointer").offset({left:d});var e=c;c.hasClass("tcm-last")||(e=c.nextAll(".tcm-last:first")),b.detach().insertAfter(e)}},i.hideDetails=function(){a("#tcm-details-wrapper-actual",this.selector).remove(),a(".tcm-result").removeClass("tcm-details-target")},i.initResizeHandler=function(){var b=this;a(window).on("resize",function(){if(a(".tcm-result").length){var c=a("#tcm-details-wrapper-actual");c.length&&a("#tcm-details-wrapper-actual").hide();var d=a(".tcm-result:first",b.selector).position().left;a(".tcm-result",b.selector).removeClass("tcm-last"),a(".tcm-result").each(function(){if(a(this).position().left===d){var b=a(this).prev();b.hasClass("tcm-details-wrapper")&&(b=b.prev()),b.addClass("tcm-last")}}),a(".tcm-result:last").addClass("tcm-last"),c.length&&a("#tcm-details-wrapper-actual").show(),b.positionDetails()}}),a(window).trigger("resize")},i.isElementInViewport=function(a){var b=a.getBoundingClientRect();return b.top>=0&&b.left>=0&&b.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&b.right<=(window.innerWidth||document.documentElement.clientWidth)},i.lock=function(){return++this.lockId},i.checkLock=function(a){return this.lockId===a},i});
define('totara_contentmarketplace/filters', ["jquery","core/config"],function(a,b){function c(b,c,d,e){this.context=null,this.filters={},this.marketplace=null,this.category=null,this.populated=a.Deferred(),this.mode=null,this.init(b,c,d,e)}return c.prototype.init=function(b,c,d,e,f){var g=this,h=[];this.context=a(b+" .tcm-search-filters-wrapper"),this.marketplace=d,this.mode=e,this.category=f,a(".tcm-search-filter",this.context).each(function(){var d=a(this).data("filter-name"),e=a(this).data("filter-module"),f=a(this).data("filter-showcounts");h.push(g.initFilter(d,e,f,b+" .tcm-search-filter-name-"+d,c))}),a.when.apply(a,h).done(function(){g.fetchFilterSeeds().done(function(a){g.populateFilters(a)})})},c.prototype.setCounts=function(b){var c=this;this.populated.done(function(){a.each(b,function(a,b){c.filters[b.name].setCounts(b.values)})})},c.prototype.getValues=function(){var a={};for(var b in this.filters)a[b]=this.filters[b].getValue();return a},c.prototype.initFilter=function(b,c,d,e,f){var g=this,h=a.Deferred();return require([c],function(a){var c=new a(b,d,e,f);g.filters[c.name]=c,h.resolve()}),h.promise()},c.prototype.populateFilters=function(b){var c=this,d=[];a.each(b,function(a,b){d.push(c.filters[b.name].populate(b))}),a.when.apply(a,d).done(function(){c.populated.resolve(),a(".tcm-search-filters-loading",c.context).hide(),a(".tcm-search-filters",c.context).show()})},c.prototype.fetchFilterSeeds=function(){var c={sesskey:b.sesskey,marketplace:this.marketplace,category:this.category,mode:this.mode};return a.post({url:b.wwwroot+"/totara/contentmarketplace/ajax/filters.php",data:c})},c});
define('totara_contentmarketplace/filter_checkboxes_searchable', ["jquery","core/templates"],function(a,b){function c(a,b,c,d){this.name="",this.context=null,this.data={},this.selection=[],this.onFitler=null,this.showCounts=!1,this.init(a,b,c,d)}return c.prototype.init=function(b,c,d,e){this.name=b,this.showCounts=c,this.context=a(d),this.onFilter=e,this.context.on("keyup",".tcm-search-filter-term",this,function(a){"Escape"!==a.key&&setTimeout(function(){a.data.updateSearch()},1)}),this.context.on("focus",".tcm-search-filter-term",this,function(a){a.data.updateSearch(),a.data.showMenu()}),this.context.on("change",".tcm-checkbox-filter input",this,function(a){a.preventDefault(),a.data.onChange(a.currentTarget)})},c.prototype.populate=function(b){this.data=b.options,this.selection=[],a.isEmptyObject(b.options)&&this.context.hide()},c.prototype.showMenu=function(){a("body").on("keydown.tcm-filter-"+this.name,this,this.hideIfEscape),a("body").on("click.tcm-filter-"+this.name,this,this.hideIfOutside),a("body").on("focus.tcm-filter-"+this.name,"*",this,this.hideIfOutside),this.context.addClass("focused")},c.prototype.hideMenu=function(){a("body").off("keydown.tcm-filter-"+this.name),a("body").off("click.tcm-filter-"+this.name),a("body").off("focus.tcm-filter-"+this.name),this.context.removeClass("focused"),a(".tcm-search-filter-term",this.context).val(""),a(".tcm-search-filter-results",this.context).hide()},c.prototype.hideIfEscape=function(b){var c=b.data;"Escape"===b.key&&(a(".tcm-search-filter-term",c.context).trigger("blur"),c.hideMenu())},c.prototype.hideIfOutside=function(b){var c=b.data;a.contains(a(".tcm-search-filter-widget",c.context)[0],b.target)||c.hideMenu()},c.prototype.updateSearch=function(){var c,d,e=this,f=[];d=a(".tcm-search-filter-term",this.context).val(),d=d.trim().toLowerCase(),a.each(this.search(d),function(a,b){e.selection.indexOf(b)===-1&&f.push(e.data[b])}),0===f.length?a(".tcm-search-filter-results",e.context).hide():(c={results:f},b.render("totara_contentmarketplace/filter_checkboxes_searchable_results",c).done(function(b){a(".tcm-search-filter-results",e.context).html(b),a(".tcm-search-filter-results",e.context).show()}))},c.prototype.updateSelection=function(){var c,d=this,e=[],f=a.Deferred();return this.selection.forEach(function(a){var b=Object.assign({},d.data[a]);b.htmlid+="-selected",e.push(b)}),c={results:e},b.render("totara_contentmarketplace/filter_checkboxes_searchable_results",c).done(function(a){f.resolve(a)}),f.done(function(b){a(".tcm-search-filter-selection-wrapper",d.context).html(b)}),f.promise()},c.prototype.search=function(b){var c=this,d=new RegExp(c.escapeRegex(b),"i");return a.grep(Object.keys(c.data),function(a){return d.test(c.data[a].label)})},c.prototype.escapeRegex=function(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},c.prototype.onChange=function(b){var c=this,d=a(b).val(),e=a(b).is(":checked"),f=this.selection.indexOf(d);e?(f===-1&&this.selection.push(d),this.data[d].checked=!0):(f!==-1&&this.selection.splice(f,1),this.data[d].checked=!1);var g=this.updateSelection();this.onFilter(),e&&g.done(function(){var d;a(b).parent().hide(),d=0!==a(".tcm-search-filter-results .tcm-checkbox-filter:visible",c.context).length,a(".tcm-search-filter-results",c.context).toggle(d)})},c.prototype.getValue=function(){return this.selection},c.prototype.setCounts=function(b){if(this.showCounts){var c=this;for(var d in this.data)this.data[d].count="0";for(var d in b)d in this.data&&(this.data[d].count=b[d]);a(".tcm-filter-option-count",this.context).each(function(b,d){var e=a(d).data("value");a(d).text(c.data[e].count)})}},c});
define('totara_contentmarketplace/filter_radios', ["jquery","core/templates"],function(a,b){function c(a,b,c,d){this.name="",this.context=null,this.value=null,this.onFitler=null,this.showCounts=!1,this.init(a,b,c,d)}return c.prototype.init=function(b,c,d,e){this.name=b,this.showCounts=c,this.context=a(d),this.onFitler=e,this.context.on("change",".tcm-filter-radios input",this,function(a){a.preventDefault(),a.data.onFitler()})},c.prototype.populate=function(c){var d=this,e=a.Deferred();return 0===c.options.length?(this.context.hide(),e.resolve()):b.render("totara_contentmarketplace/filter_radios",c).done(function(b){a(".tcm-filter-input",d.context).append(b),e.resolve()}),e.promise()},c.prototype.getValue=function(){return a("input:checked",this.context).val()},c.prototype.setCounts=function(b){this.showCounts&&a(".tcm-filter-option-count",this.context).each(function(c,d){var e=a(d).data("value");a(d).text(b[e]||"0")})},c});
define('totara_core/accordion', ["core/templates"],function(a){function b(a){if(this.element=a,this.alwaysOpen="false"!==this.element.getAttribute("data-always-open"),this.allowMultiple="true"===this.element.getAttribute("data-allow-multiple"),this.alwaysOpen){var b=this.getOpenChildren();0===b.length&&this.toggleItem(this.getChildren()[0])}}function c(a){return new Promise(function(c){var d=new b(a);d.events(),c(d)})}return b.prototype.events=function(){var a=this,b=function(b){if(!b.target.closest("[data-accordion-noop]")){var c=b.target.closest(".totara_core__Accordion__item");c&&a.toggleItem(c)}};this.element.addEventListener("click",b),this.element.addEventListener("totara_core/accordion:open",function(b){var c=b.target.closest(".totara_core__Accordion__item"),d=b.originalEvent||b;a.toggleItem(c,!0,!!d.suppress)}),this.element.addEventListener("totara_core/accordion:close",function(b){var c=b.target.closest(".totara_core__Accordion__item"),d=b.originalEvent||b;a.toggleItem(c,!1,!!d.suppress)})},b.prototype.getChildren=function(){return this.element.querySelectorAll(".totara_core__Accordion__item")},b.prototype.getOpenChildren=function(){return this.element.querySelectorAll(".totara_core__Accordion__item:not(.collapsed)")},b.prototype.toggleItem=function(b,c,d){var e=!b.classList.contains("collapsed"),f=void 0===c?!e:c;if(!this.alwaysOpen||1!==this.getOpenChildren().length||!e){f&&!this.allowMultiple&&this.closeAllItems(),f?b.classList.remove("collapsed"):b.classList.add("collapsed"),b.querySelector(".totara_core__Accordion__item__header__icon").setAttribute("aria-expanded",f);var g=f?"totara_core|accordion-expanded":"totara_core|accordion-collapsed";a.renderIcon(g).then(function(a){b.querySelector(".totara_core__Accordion__item__header__icon").innerHTML=a}),d||(f?b.dispatchEvent(new CustomEvent("totara_core/accordion:opened",{bubbles:!0,detail:{elem:b}})):b.dispatchEvent(new CustomEvent("totara_core/accordion:closed",{bubbles:!0,detail:{elem:b}})))}},b.prototype.closeAllItems=function(){for(var b=this.getChildren(),c=0;c<b.length;c++){var d=b.item(c);d.classList.add("collapsed"),d.querySelector(".totara_core__Accordion__item__header__icon").setAttribute("aria-expanded",!1)}a.renderIcon("totara_core|accordion-collapsed").then(function(a){for(var c=0;c<b.length;c++){var d=b.item(c);d.classList.contains("collapsed")&&(d.querySelector(".totara_core__Accordion__item__header__icon").innerHTML=a)}})},{init:c}});
define('totara_core/datatable', ["jquery","core/str","core/config","totara_core/jquery.dataTables-lazy"],function(a,b,c){var d={init:function(d,e,f){var g=[];g.push({key:"datatable:sEmptyTable",component:"totara_core"}),g.push({key:"datatable:sInfo",component:"totara_core"}),g.push({key:"datatable:sInfoEmpty",component:"totara_core"}),g.push({key:"datatable:sInfoFiltered",component:"totara_core"}),g.push({key:"datatable:sInfoPostFix",component:"totara_core"}),g.push({key:"datatable:sInfoThousands",component:"totara_core"}),g.push({key:"datatable:sLengthMenu",component:"totara_core"}),g.push({key:"datatable:sLoadingRecords",component:"totara_core"}),g.push({key:"datatable:sProcessing",component:"totara_core"}),g.push({key:"datatable:sSearch",component:"totara_core"}),g.push({key:"datatable:sZeroRecords",component:"totara_core"}),g.push({key:"datatable:oPaginate:sFirst",component:"totara_core"}),g.push({key:"datatable:oPaginate:sLast",component:"totara_core"}),g.push({key:"datatable:oPaginate:sNext",component:"totara_core"}),g.push({key:"datatable:oPaginate:sPrevious",component:"totara_core"}),b.get_strings(g).done(function(b){for(var h=[],i=0;i<g.length;i++)h[g[i].key]=b[i];a(document).ready(function(){a("#datatable").dataTable({searchDelay:500,bProcessing:!0,bServerSide:!0,sPaginationType:"full_numbers",sAjaxSource:c.wwwroot+"/totara/"+d+"/lib/assign/ajax.php",fnServerParams:function(a){a.push({name:"module",value:d}),a.push({name:"suffix",value:e}),a.push({name:"itemid",value:f}),a.push({name:"sesskey",value:c.sesskey})},oLanguage:{sEmptyTable:h["datatable:sEmptyTable"],sInfo:h["datatable:sInfo"],sInfoEmpty:h["datatable:sInfoEmpty"],sInfoFiltered:h["datatable:sInfoFiltered"],sInfoPostFix:h["datatable:sInfoPostFix"],sInfoThousands:h["datatable:sInfoThousands"],sLengthMenu:h["datatable:sLengthMenu"],sLoadingRecords:h["datatable:sLoadingRecords"],sProcessing:h["datatable:sProcessing"],sSearch:h["datatable:sSearch"],sZeroRecords:h["datatable:sZeroRecords"],oPaginate:{sFirst:h["datatable:oPaginate:sFirst"],sLast:h["datatable:oPaginate:sLast"],sNext:h["datatable:oPaginate:sNext"],sPrevious:h["datatable:oPaginate:sPrevious"]}}})})})}};return d});
define('totara_core/grid', [],function(){function a(){return this instanceof a?(this.activeClass="tw-grid__item_active",void(this.widget="")):new a}a.prototype={constructor:a,events:function(){var a=this;this.widget.addEventListener("keypress",function(a){a.target.closest("[data-tw-grid-item-toggle]")&&!a.target.closest("[data-tw-catalogdetails]")&&(a.target.dispatchEvent(new MouseEvent("click",a)),a.preventDefault())}),this.widget.addEventListener("click",function(b){if(b.target&&b.target.closest("[data-tw-grid-item-toggle]")){b.preventDefault();var c=b.target.closest("[data-tw-grid-item]"),d=c.classList.contains(a.activeClass);if(a.unsetActive(),d)return void a.triggerEvent("remove",{});if("0"==this.getAttribute("data-core-enableactiveitem")){var e=c.childNodes[1].getAttribute("data-redirect-url");e.length>1&&(window.location.href=c.childNodes[1].getAttribute("data-redirect-url"))}else a.setActive(c)}})},setParent:function(a){this.widget=a},setActive:function(a){var b=a.getAttribute("data-tw-grid-item-ID");a.setAttribute("data-tw-grid-item-active",""),a.classList.add(this.activeClass),this.setVisibleView(),this.triggerEvent("add",{key:"id",val:b})},setVisibleView:function(){var a=this.widget.querySelector("[data-tw-grid-item-active]");a&&a.scrollIntoView(!1)},triggerEvent:function(a,b){var c=new CustomEvent("totara_core/grid:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)},unsetActive:function(){for(var a,b=this.widget.querySelectorAll("[data-tw-grid-item-active]"),c=0;c<b.length;c++)a=b[c],a.removeAttribute("data-tw-grid-item-active"),a.classList.remove(this.activeClass)}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),d.events(),c(d)})};return{init:b}});
define('totara_core/inline-edit', ["core/str"],function(a){function b(b){var c=this;this.element=b,this.allowEmpty="true"===this.element.getAttribute("data-inline-edit-allow-empty"),this.maxLength=this.element.getAttribute("data-inline-edit-max-length")||0,this.controller=this.element.querySelector("[data-inline-edit-control]"),this.target=this.element.querySelector("[data-inline-edit]");var d=this.element.querySelector("[data-inline-edit-input]");if(!d){var e=this.target.getAttribute("class")||"";this.target.insertAdjacentHTML("afterend",'<input class="'+e+'" data-inline-edit-input type="text">'),d=this.element.querySelector("[data-inline-edit-input]")}this.input=d,this.input.style.display="none";var f=this.element.querySelector("[data-inline-edit-tooltip]");f?d.setAttribute("aria-label",f.textContent):(this.target.insertAdjacentHTML("afterend",'<span data-inline-edit-tooltip class="totara_core__InlineEdit--tooltip"></span>'),f=this.element.querySelector("[data-inline-edit-tooltip]"),a.get_string("inlineedit:instructions","totara_core").done(function(a){f.textContent=a,c.tooltipText=a,d.setAttribute("aria-label",a)})),this.tooltip=f,this.tooltipText=f.textContent,this.tooltip.style.display="none",this.editing=!1}return b.prototype.events=function(){function a(a){a.preventDefault(),a.stopPropagation(),b.edit(),b.hideError()}var b=this;this.controller.addEventListener("mouseup",function(b){return a(b),!1}),this.controller.addEventListener("keyup",function(b){return"Enter"===b.key&&a(b),!1}),this.input.addEventListener("keyup",function(a){switch(a.key){case"Enter":b.save();break;case"Esc":case"Escape":b.cancel();break;case"Space":a.stopPropagation()}if(b.editing){var c=b.input.value.trim().length;b.allowEmpty||0!==c?b.maxLength>0&&c>=b.maxLength?b.showError("maxlength"):b.hideError():b.showError("noempty")}}),this.input.addEventListener("focusout",function(a){b.cancel()}),this.input.addEventListener("click",function(a){a.stopPropagation()})},b.prototype.edit=function(){this.editing||(this.input.value||(this.input.value=this.target.textContent.trim()),this.target.style.display="none",this.input.style.display="",this.tooltip.style.display="",this.input.focus(),this.controller.style.display="none",this.editing=!0,this.element.dispatchEvent(new CustomEvent("totara_core/inline-edit:edit",{bubbles:!0,detail:{controller:this,elem:this.element,input:this.input,target:this.target}})))},b.prototype.save=function(){if(this.editing){var a=this.input.value.trim();if(""===a&&!this.allowEmpty)return void this.cancel();if(a.length>this.maxLength&&this.maxLength>0)return void this.cancel();var b=!0;this.element.dispatchEvent(new CustomEvent("totara_core/inline-edit:save",{bubbles:!0,detail:{text:a,controller:this,elem:this.element,input:this.input,target:this.target,preventUpdate:function(){b=!1}}})),b&&(this.target.textContent=a),this.target.style.display="",this.input.style.display="none",this.tooltip.style.display="none",this.controller.style.display="",this.controller.focus(),this.editing=!1}},b.prototype.cancel=function(){this.editing&&(this.element.dispatchEvent(new CustomEvent("totara_core/inline-edit:cancel",{bubbles:!0,detail:{elem:this.element,controller:this}})),this.target.style.display="",this.input.style.display="none",this.tooltip.style.display="none",this.controller.style.display="",this.controller.focus(),this.editing=!1)},b.prototype.showError=function(a){this.showCustomError("inlineedit:"+a,"totara_core")},b.prototype.showCustomError=function(b,c){var d=this;this.error=b,a.get_string(b,c).done(function(a){d.error===b&&(d.tooltip.textContent=a,d.tooltip.classList.add("totara_core__InlineEdit--tooltip--error"),d.input.setAttribute("aria-label",a))})},b.prototype.hideError=function(){this.error="",this.tooltip.textContent=this.tooltipText,this.tooltip.classList.remove("totara_core__InlineEdit--tooltip--error")},{init:function(a){return new Promise(function(c){var d=new b(a);d.events(),c(d)})}}});
define('totara_core/list_toggle', ["core/sessionstorage"],function(a){function b(a){return this instanceof b?(this.activeClass="totara_core__myreports__itemstyletoggle__btn_active",this.storageKey="tw-myreports-switcher-state",this.widget=a,this.control=a.querySelector("[data-tw-switcher]"),this.targetClass=a.getAttribute("data-tw-target-class"),this.target=a.querySelector(a.getAttribute("data-tw-target")),this.setup(),void this.widget.classList.add("tw-list-toggle-loaded")):new b(a)}b.prototype={setup:function(){var b=a.get(this.storageKey);if(b){var c=this.widget.querySelector("[data-tw-trigger="+b+"]");if(c){if(c.classList.contains(this.activeClass))return;return void this.toggle(c)}}for(var d=this.widget.querySelectorAll("[data-tw-trigger]"),e=0;e<d.length;e++){var f=d[e].getAttribute("data-tw-trigger"),g=this.targetClass+"--"+f;this.target.classList.contains(g)&&d[e].classList.add(this.activeClass)}},events:function(){var a=this;this.control.addEventListener("click",function(b){if(b.preventDefault(),b.target&&b.target.closest("[data-tw-trigger]")){var c=b.target.closest("[data-tw-trigger]");if(c.classList.contains(a.activeClass))return;a.toggle(c)}})},toggle:function(b){for(var c,d=this.widget.querySelectorAll("[data-tw-trigger]"),e=0;e<d.length;e++)c=this.targetClass+"--"+d[e].getAttribute("data-tw-trigger"),this.target.classList.remove(c),d[e].classList.remove(this.activeClass);b.classList.add(this.activeClass),c=this.targetClass+"--"+b.getAttribute("data-tw-trigger"),this.target.classList.add(c),a.set(this.storageKey,b.getAttribute("data-tw-trigger"))}};var c=function(a){return new Promise(function(c){var d=new b(a);d.events(),c(d)})};return{init:c}});
define('totara_core/quickaccessmenu', ["core/str","core/popover_region_controller","core/ajax","core/templates","core/notification"],function(a,b,c,d,e){function f(a){b.call(this,a),this.element=a}function g(a){return new Promise(function(b){var c=new f(a);c.setupEvents(),b(c)})}return f.prototype=Object.create(b.prototype),f.prototype.updateButtonAriaLabel=function(){this.isMenuOpen()?a.get_string("quickaccessmenu:hidemenuwindow","totara_core").done(function(a){this.isMenuOpen()&&this.menuToggle.attr("aria-label",a)}.bind(this)):a.get_string("quickaccessmenu:showmenuwindow","totara_core").done(function(a){this.isMenuOpen()===!1&&this.menuToggle.attr("aria-label",a)}.bind(this))},f.prototype.setupEvents=function(){var a=this;this.root.one(this.events().menuOpened,function(){M.util.js_pending("totara_core--quickaccessmenu_content_loading"),c.call([{args:{userid:null},methodname:"totara_core_quickaccessmenu_get_user_menu"}])[0].then(function(a){return d.render("totara_core/quickaccessmenu_content",a)}).then(function(b){a.element.querySelector("#quickaccess-popover-content").innerHTML=b,a.element.querySelector("#quickaccess-popover-content").classList.remove("totara_core__QuickAccess_menu--loading"),a.element.querySelector("[data-quickaccessmenu-close-menu]").addEventListener("click",function(b){return b.preventDefault(),a.closeMenu(),!1}),a.checkLocation(),M.util.js_complete("totara_core--quickaccessmenu_content_loading")})["catch"](e.exception)}),document.body.classList.contains("ie11")&&(this.root.on(this.events().menuOpened,function(){document.body.style.overflowX="hidden"}),this.root.on(this.events().menuClosed,function(){document.body.style.overflowX=""}))},f.prototype.checkLocation=function(){var a=this.element.querySelector("#quickaccess-popover-content"),b=a.getBoundingClientRect();b.left<0||b.right>window.innerWidth?a.classList.add("totara_core__QuickAccess_menu--large"):a.classList.remove("totara_core__QuickAccess_menu--large")},{init:g}});
define('totara_core/quickaccesssettings', ["core/templates","core/str","core/ajax"],function(a,b,c){function d(a){this.element=a}function e(a){return new Promise(function(b){var c=new d(a);c.events(),b(c)})}return d.prototype.events=function(){function c(a){var c=a.detail.elem,d=a.detail.text;c.closest("[data-quickaccesssettings-item-key]")?(h.save("totara_core_quickaccessmenu_rename_item",{key:c.closest("[data-quickaccesssettings-item-key]").getAttribute("data-quickaccesssettings-item-key"),label:d}).fail(function(){window.location.reload()}),b.get_string("quickaccesssettings:itemlabel","totara_core").done(function(a){c.setAttribute("aria-label",a+" "+d)})):c.closest("[data-quickaccesssettings-group-key]")&&h.save("totara_core_quickaccessmenu_rename_group",{groupkey:c.closest("[data-quickaccesssettings-group-key]").getAttribute("data-quickaccesssettings-group-key"),groupname:d}).fail(function(){window.location.reload()})}function d(b){var c=b.detail,d=c.val,e=b.target.closest(".totara_core__QuickAccessSettings__group"),f=e.getAttribute("data-quickaccesssettings-group-key");h.save("totara_core_quickaccessmenu_add_item",{key:d,group:f}).done(function(b){a.render("totara_core/quickaccesssettings_item",b).done(function(b){var c=h.element.querySelector('[data-quickaccesssettings-item-key="'+d+'"]');c&&c.closest(".totara_core__QuickAccessSettings__item").remove();var f=e.querySelector(".totara_core__QuickAccessSettings__item-list");f.insertAdjacentHTML("beforeend",b),a.runTemplateJS()})}).fail(function(a){window.location.reload()});var g=new CustomEvent("totara_core/select_tree:set-active",{bubbles:!1});c.widget.dispatchEvent(g),c.widget.setAttribute("data-tw-selectorgroup-clear",!0)}function e(){h.save("totara_core_quickaccessmenu_add_group",{groupname:""}).done(function(b){a.render("totara_core/quickaccesssettings_group",b).done(function(b){var c=h.element.querySelector(".totara_core__QuickAccessSettings__group-list");c.insertAdjacentHTML("beforeend",b),a.runTemplateJS()})}).fail(function(){window.location.reload()})}var f,g,h=this;for(this.element.addEventListener("click",function(a){var b=a.target.closest("[data-quickaccesssettings-group-key]"),c=a.target.closest("[data-quickaccesssettings-item-key]"),d="";if(c){if(d=a.target.closest("[data-quickaccesssettings-item-action]"),null!==d)switch(d=d.getAttribute("data-quickaccesssettings-item-action")){case"moveup":j(c.previousElementSibling,c),a.preventDefault(),a.stopPropagation();break;case"movedown":j(c,c.nextElementSibling),a.preventDefault(),a.stopPropagation();break;case"delete":a.preventDefault(),a.stopPropagation(),h.save("totara_core_quickaccessmenu_remove_item",{key:c.getAttribute("data-quickaccesssettings-item-key")}).done(function(){c.remove()}).fail(function(){window.location.reload()})}}else if(b){if(d=a.target.closest("[data-quickaccesssettings-group-action]"),null!==d)switch(b.dispatchEvent(new CustomEvent("totara_core/accordion:close",{bubbles:!0})),d=d.getAttribute("data-quickaccesssettings-group-action")){case"moveup":i(b.previousElementSibling,b),a.preventDefault(),a.stopPropagation();break;case"movedown":i(b,b.nextElementSibling),a.preventDefault(),a.stopPropagation();break;case"delete":a.preventDefault(),h.save("totara_core_quickaccessmenu_remove_group",{groupkey:b.getAttribute("data-quickaccesssettings-group-key")}).done(function(){b.remove()}).fail(function(){window.location.reload()})}}else;},!0),this.element.addEventListener("totara_core/inline-edit:save",c),this.element.addEventListener("totara_core/select_tree:add",d),f=this.element.querySelectorAll("[data-quickaccesssettings-addgroup]"),g=0;g<f.length;g++)f.item(g).addEventListener("click",e);var i=function(a,b){if(a&&b){var c=b.getAttribute("data-quickaccesssettings-group-key"),d=a.getAttribute("data-quickaccesssettings-group-key");h.save("totara_core_quickaccessmenu_move_group_before",{key:c,beforekey:d}).done(function(){b.classList.add("totara_core__QuickAccessSettings__item-swap-up"),a.classList.add("totara_core__QuickAccessSettings__item-swap-down"),M.util.js_pending("totara_core-quickaccesssettings-reorder-item-swap-up"),setTimeout(function(){b.classList.remove("totara_core__QuickAccessSettings__item-swap-up"),a.classList.remove("totara_core__QuickAccessSettings__item-swap-down"),a.parentNode.insertBefore(b,a),M.util.js_complete("totara_core-quickaccesssettings-reorder-item-swap-up")},200)}).fail(function(){window.location.reload()})}},j=function(a,b){if(a&&b){var c=b.getAttribute("data-quickaccesssettings-item-key"),d=a.getAttribute("data-quickaccesssettings-item-key");h.save("totara_core_quickaccessmenu_move_item_before",{key:c,beforekey:d}).done(function(){b.classList.add("totara_core__QuickAccessSettings__item-swap-up"),a.classList.add("totara_core__QuickAccessSettings__item-swap-down"),M.util.js_pending("totara_core-quickaccesssettings-reorder-item-up"),setTimeout(function(){b.classList.remove("totara_core__QuickAccessSettings__item-swap-up"),a.classList.remove("totara_core__QuickAccessSettings__item-swap-down"),a.parentNode.insertBefore(b,a),M.util.js_complete("totara_core-quickaccesssettings-reorder-item-up")},200)}).fail(function(){window.location.reload()})}}},d.prototype.save=function(a,b){b.userid=0;var d=c.call([{methodname:a,args:b}])[0];return M.util.js_pending("totara_core-quickaccesssettings-save"),d.always(function(){M.util.js_complete("totara_core-quickaccesssettings-save")}),d},{init:e}});
define('totara_core/select_multi', [],function(){function a(){return this instanceof a?(this.activeClass="tw-selectMulti__link_active",this.activeSelector="data-tw-selector-active",this.clearSelector="data-tw-selectorgroup-clear",this.hideClass="tw-selectMulti__hidden",this.key="",void(this.widget="")):new a}a.prototype={constructor:a,add:function(a){var b=a.getAttribute("data-tw-selectMulti-optionKey"),c=a.querySelector("[data-tw-selectMulti-close]");a.classList.add(this.activeClass),a.setAttribute(this.activeSelector,!0),a.setAttribute("aria-selected",!0),c.classList.remove(this.hideClass),this.triggerEvent("add",{groupValues:this.getAllSelectedValues(),key:this.key,val:b})},clear:function(){for(var a=this.widget.querySelectorAll("["+this.activeSelector+"]"),b=0;b<a.length;b++)this.remove(a[b])},events:function(){var a=this;this.widget.addEventListener("click",function(b){if(b.preventDefault(),b.target&&b.target.closest("[data-tw-selectMulti-optionKey]")){var c=b.target.closest("[data-tw-selectMulti-optionKey]");c.getAttribute(a.activeSelector)?a.remove(c):a.add(c),a.triggerEvent("changed",{})}});var b=new MutationObserver(function(){"true"===a.widget.getAttribute(a.clearSelector)&&(a.clear(),a.widget.setAttribute(a.clearSelector,!1))});b.observe(this.widget,{attributes:!0,attributeFilter:[a.clearSelector],subtree:!1})},getAllSelectedValues:function(){for(var a,b=this.widget.querySelectorAll("["+this.activeSelector+"]"),c=[],d=0;d<b.length;d++)a=b[d].getAttribute("data-tw-selectMulti-optionKey"),c.push(a);return c},preset:function(){for(var a=this.widget.querySelectorAll("["+this.activeSelector+"]"),b=0;b<a.length;b++)this.triggerEvent("add",{groupValues:this.getAllSelectedValues(),key:this.key,val:a[b].getAttribute("data-tw-selectMulti-optionKey")})},remove:function(a){var b=a.getAttribute("data-tw-selectMulti-optionKey"),c=a.querySelector("[data-tw-selectMulti-close]");a.removeAttribute(this.activeSelector),a.setAttribute("aria-selected",!1),a.classList.remove(this.activeClass),c.classList.add(this.hideClass),this.triggerEvent("remove",{groupValues:this.getAllSelectedValues(),key:this.key,val:b})},setParent:function(a){this.widget=a},setWidgetKey:function(){this.key=this.widget.getAttribute("data-tw-selectMulti-key")},triggerEvent:function(a,b){var c=new CustomEvent("totara_core/select_multi:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),d.setWidgetKey(),d.preset(),d.events(),c(d)})};return{init:b}});
define('totara_core/select_region_panel', [],function(){function a(){return this instanceof a?(this.activeSelector="data-tw-selector-active",this.clearNode="",this.clearSelector="data-tw-selectorgroup-clear",this.hideClass="tw-selectRegionPanel__content_hidden",void(this.widget="")):new a}a.prototype={bubbledEventsListener:function(){var a="totara_core/select_multi",b="totara_core/select_search_text",c="totara_core/select_tree",d=this;this.widget.addEventListener(a+":add",function(a){d.triggerEvent("add",a.detail)}),this.widget.addEventListener(b+":add",function(a){d.triggerEvent("add",a.detail)}),this.widget.addEventListener(c+":add",function(a){d.triggerEvent("add",a.detail)}),this.widget.addEventListener(a+":changed",function(){d.regionChange()}),this.widget.addEventListener(b+":changed",function(){d.regionChange()}),this.widget.addEventListener(c+":changed",function(){d.regionChange()}),this.widget.addEventListener(a+":remove",function(a){d.triggerEvent("remove",a.detail)}),this.widget.addEventListener(b+":remove",function(a){d.triggerEvent("remove",a.detail)}),this.widget.addEventListener(c+":remove",function(a){d.triggerEvent("remove",a.detail)})},clear:function(){var a=this.widget.querySelectorAll("["+this.activeSelector+"]"),b=this;if(a.length){var c=new MutationObserver(function(){var a=b.widget.querySelectorAll("["+b.clearSelector+"=true]").length;a||(this.disconnect(),b.regionChange())});c.observe(this.widget,{attributes:!0,attributeFilter:[b.clearSelector],subtree:!0});for(var d=0;d<a.length;d++){var e=a[d].closest("[data-tw-selectorgroup]"),f=e.getAttribute(this.clearSelector);f&&"false"!==f||e.setAttribute(this.clearSelector,!0)}}},events:function(){var a=this;this.widget.addEventListener("click",function(b){b.preventDefault(),b.target&&b.target.closest("[data-tw-selectRegionPanel-clear]")&&a.clear()});var b=new MutationObserver(function(){"true"===a.widget.getAttribute(a.clearSelector)&&(a.clear(),a.widget.removeAttribute(a.clearSelector))});b.observe(this.widget,{attributes:!0,attributeFilter:[a.clearSelector],subtree:!1})},regionChange:function(){this.updateActiveCount(),this.triggerEvent("changed",{})},updateActiveCount:function(){var a=this.widget.querySelectorAll("["+this.activeSelector+"]").length,b=this.widget.querySelector("[data-tw-selectRegionPanel-clear]"),c=this.widget.querySelector("[data-tw-selectRegionPanel-count]");b&&(a>0?b.classList.remove(this.hideClass):b.classList.add(this.hideClass)),c&&(c.innerHTML=a,a>0?c.parentNode.classList.remove(this.hideClass):c.parentNode.classList.add(this.hideClass))},setParent:function(a){this.widget=a},triggerEvent:function(a,b){var c=new CustomEvent("totara_core/select_region_panel:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),d.bubbledEventsListener(),d.events(),d.updateActiveCount(),c(d)})};return{init:b}});
define('totara_core/select_region_primary', [],function(){function a(){return this instanceof a?void(this.widget=""):new a}a.prototype={bubbledEventsListener:function(){var a="totara_core/select_multi",b="totara_core/select_search_text",c="totara_core/select_tree",d=this;this.widget.addEventListener(a+":add",function(a){d.triggerEvent("add",a.detail)}),this.widget.addEventListener(b+":add",function(a){d.triggerEvent("add",a.detail)}),this.widget.addEventListener(c+":add",function(a){d.triggerEvent("add",a.detail)}),this.widget.addEventListener(a+":changed",function(){d.triggerEvent("changed",{})}),this.widget.addEventListener(b+":changed",function(){d.triggerEvent("changed",{})}),this.widget.addEventListener(c+":changed",function(){d.triggerEvent("changed",{})}),this.widget.addEventListener(a+":remove",function(a){d.triggerEvent("remove",a.detail)}),this.widget.addEventListener(b+":remove",function(a){d.triggerEvent("remove",a.detail)}),this.widget.addEventListener(c+":remove",function(a){d.triggerEvent("remove",a.detail)})},setParent:function(a){this.widget=a},triggerEvent:function(a,b){var c=new CustomEvent("totara_core/select_region_primary:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),d.bubbledEventsListener(),c(d)})};return{init:b}});
define('totara_core/select_search_text', [],function(){function a(){return this instanceof a?(this.activeSelector="data-tw-selector-active",this.clearSelector="data-tw-selectorgroup-clear",this.hideClass="tw-selectSearchText__hidden",this.searchTerm="",void(this.widget="")):new a}a.prototype={constructor:a,add:function(a){var b=this.widget.querySelector("[data-tw-selectSearchText-urlkey]"),c=b.getAttribute("data-tw-selectSearchText-urlkey"),d=b.parentNode.querySelector("[data-tw-selectSearchText-clear]");this.setSearchTerm(a),b.setAttribute(this.activeSelector,!0),d.classList.remove(this.hideClass),this.triggerEvent("add",{key:c,val:a})},clear:function(){var a=this.widget.querySelector("[data-tw-selectSearchText-urlkey]"),b=a.getAttribute("data-tw-selectSearchText-urlkey"),c=a.parentNode.querySelector("[data-tw-selectSearchText-clear]");this.setSearchTerm(""),a.removeAttribute(this.activeSelector),c.classList.add(this.hideClass),a.value="",this.triggerEvent("remove",{key:b,val:""})},events:function(){var a=this;this.widget.addEventListener("click",function(b){b.preventDefault(),b.target&&(b.target.closest("[data-tw-selectSearchText-trigger]")?a.valueCheck():b.target.closest("[data-tw-selectSearchText-clear]")&&(a.clear(),a.triggerEvent("changed",{})))}),this.widget.addEventListener("keydown",function(b){b.target.closest("[data-tw-selectSearchText-urlkey]")&&("Enter"!==b.key&&13!==b.which&&13!==b.keyCode||(b.preventDefault(),a.valueCheck()))});var b=new MutationObserver(function(){"true"===a.widget.getAttribute(a.clearSelector)&&(a.clear(),a.widget.setAttribute(a.clearSelector,!1))});b.observe(this.widget,{attributes:!0,attributeFilter:[a.clearSelector],subtree:!1})},preset:function(){var a=this.widget.querySelector("[data-tw-selectSearchText-urlkey]"),b=a.value;if(""===b&&a.getAttribute(this.activeSelector)===!0)this.clear(),this.triggerEvent("changed",{});else{if(""===b)return;this.setSearchTerm(b),this.add(b)}},setParent:function(a){this.widget=a},setSearchTerm:function(a){this.searchTerm=a},triggerEvent:function(a,b){var c=new CustomEvent("totara_core/select_search_text:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)},valueCheck:function(){var a=this.widget.querySelector("[data-tw-selectSearchText-urlkey]").value;this.searchTerm!==a&&(""===a?this.clear():this.add(a),this.triggerEvent("changed",{}))}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),d.preset(),d.events(),c(d)})};return{init:b}});
define('totara_core/select_tree', [],function(){function a(){return this instanceof a?(this.activeClass="tw-selectTree__active",this.activeSelector="data-tw-selector-active",this.clearSelector="data-tw-selectorgroup-clear",this.disabledClass="tw-selectTree--disabled",this.disabledSelector="data-tw-selecttree-disabled",this.hideClass="tw-selectTree__hidden",this.key="",this.keyboardClass="tw-selectTree__keyboard",this.manualSetSelected="data-tw-selector-manualset",this.repositionClass="tw-selectTree__reposition",this.widget="",void(this.visibility=!1)):new a}a.prototype={constructor:a,add:function(a){var b=a.getAttribute("data-tw-selectTree-urlVal"),c=a.getAttribute("data-tw-selectTree-label"),d=a.parentNode,e=d.hasAttribute("data-tw-selectTree-default");this.removeActive(),this.closeLists(),this.setCurrentLabel(c),d.classList.add(this.activeClass),e||d.setAttribute(this.activeSelector,""),this.expandActiveLists(d),this.setEventType(b)},closeLists:function(){for(var a=this.widget.querySelectorAll("[data-tw-selectTree-list]"),b=0;b<a.length;b++)if(!a[b].classList.contains(this.hideClass)){var c=a[b].previousElementSibling,d=c.querySelector("[data-tw-selectTree-toggle]");this.toggleTreeList(a[b],d)}},events:function(){var a=this;this.widget.addEventListener("click",function(b){if(b.preventDefault(),b.target&&!a.widget.classList.contains(a.disabledClass))if(b.target.closest("[data-tw-selectTree-trigger]"))a.toggleTree();else if(b.target.closest("[data-tw-selectTree-toggle]")){var c=b.target.closest("[data-tw-selectTree-toggle]"),d=c.parentNode.nextElementSibling;c.hasAttribute("data-tw-selecttree-label")&&(c=c.previousElementSibling),a.toggleTreeList(d,c)}else if(b.target.closest("[data-tw-selectTree-urlVal]")){var e=b.target.closest("[data-tw-selectTree-urlVal]");if(e.parentNode.classList.contains(a.activeClass))return;a.add(e),a.toggleTree(),a.triggerEvent("changed",{})}});var b=function(b){var c=a.widget.querySelector("[data-tw-selectTree-tree]");a.widget.contains(b.target)||c.classList.contains(a.hideClass)||a.toggleTree()};document.addEventListener("click",b),document.addEventListener("touchstart",b),this.widget.addEventListener("keydown",function(b){if(b.target){for(var c=0,d=a.widget.querySelectorAll(".tw-selectTree__list_row"),e=!1,f=0;f<d.length;++f)if(d[f]==document.activeElement.closest(".tw-selectTree__list_row")){c=f,e=!0;break}if(!e)for(var g=0;g<d.length;++g)if(d[g].classList.contains("tw-selectTree__active")){c=g;break}switch(a.widget.classList.add(a.keyboardClass),b.key){case"Enter":b.preventDefault(),b.target.click(),d[c].getElementsByClassName("tw-selectTree__list_row_link")[0].focus();break;case"Tab":var h=b.shiftKey?-1:1,i=b.shiftKey?0===c:c===d.length-1;if(i&&a.visibility)return void a.toggleTree();for(var j=!0,k=c+h;k<d.length&&k>=0;k+=h){var l=d[k].getElementsByClassName("tw-selectTree__list_row_link")[0];if(l&&0!==l.offsetHeight)return b.preventDefault(),j=!1,void l.focus()}j&&a.visibility&&a.toggleTree();break;case"ArrowUp":case"Up":if(b.preventDefault(),0===c)return;for(var m=c-1,n=m;n<d.length;++n){var o=d[m].getElementsByClassName("tw-selectTree__list_row_link")[0];if(o&&0!==o.offsetHeight)return void o.focus();m--}break;case"ArrowDown":case"Down":if(b.preventDefault(),c===d.length-1)return;for(var p=c+1;p<d.length;++p){var q=d[p].getElementsByClassName("tw-selectTree__list_row_link")[0];if(q&&0!==q.offsetHeight)return void q.focus()}break;case"ArrowLeft":case"Left":b.preventDefault();var r=d[c].getElementsByClassName("tw-selectTree__list_row_icon_expand")[0];r&&r.classList.contains("tw-selectTree__hidden")&&d[c].querySelector("[data-tw-selecttree-toggle]").click();break;case"ArrowRight":case"Right":b.preventDefault();var s=d[c].getElementsByClassName("tw-selectTree__list_row_icon_expanded")[0];s&&s.classList.contains("tw-selectTree__hidden")&&d[c].querySelector("[data-tw-selecttree-toggle]").click()}}});var c=new MutationObserver(function(){"true"===a.widget.getAttribute(a.clearSelector)&&(a.setToDefault(),a.widget.setAttribute(a.clearSelector,!1))});c.observe(this.widget,{attributes:!0,attributeFilter:[a.clearSelector],subtree:!1});var d=new MutationObserver(function(){var b=a.widget.getAttribute(a.manualSetSelected);if(b){var c=a.widget.querySelector('[data-tw-selectTree-urlVal="'+b+'"]');a.add(c)}});d.observe(this.widget,{attributes:!0,attributeFilter:[a.manualSetSelected],subtree:!1});var e=new MutationObserver(function(){"activate"===a.widget.getAttribute(a.disabledSelector)?(a.widget.classList.remove(a.disabledClass),a.widget.querySelector("[data-tw-selecttree-trigger]").setAttribute("aria-disabled",!1)):"disable"===a.widget.getAttribute(a.disabledSelector)&&(a.widget.classList.add(a.disabledClass),a.widget.querySelector("[data-tw-selecttree-trigger]").setAttribute("aria-disabled",!0)),a.widget.removeAttribute(a.disabledSelector)});e.observe(this.widget,{attributes:!0,attributeFilter:[a.disabledSelector],subtree:!1})},expandActiveLists:function(a){for(var b,c=!1;!c;)if(b=a.closest("[data-tw-selectTree-list]."+this.hideClass)){var d=b.previousElementSibling,e=d.querySelector("[data-tw-selectTree-toggle]");this.toggleTreeList(b,e)}else c=!0},preset:function(){var a=this.widget.querySelector("["+this.activeSelector+"]");if(a){var b=a.querySelector("[data-tw-selectTree-urlVal]"),c=b.getAttribute("data-tw-selectTree-urlVal");this.expandActiveLists(a),this.setEventType(c)}else{var d=this.widget.querySelector("[data-tw-selectTree-default] [data-tw-selectTree-urlVal]");if(d){var e=d.getAttribute("data-tw-selectTree-urlVal");e&&this.setEventType(e)}}},removeActive:function(){var a=this.widget.querySelectorAll("[data-tw-selectTree-tree] ["+this.activeSelector+"]"),b=this.widget.querySelector("[data-tw-selectTree-default]");b&&b.classList.remove(this.activeClass);for(var c=0;c<a.length;c++)a[c].classList.remove(this.activeClass),a[c].removeAttribute(this.activeSelector)},setCurrentLabel:function(a){var b=this.widget.querySelector("[data-tw-selectTree-current]");b.innerHTML=a},setEventType:function(a){a?this.triggerEvent("add",{key:this.key,val:a,widget:this.widget}):this.triggerEvent("remove",{key:this.key})},setKey:function(a){this.key=a},setParent:function(a){this.widget=a},setToDefault:function(){var a=this.widget.querySelector("[data-tw-selectTree-default] [data-tw-selectTree-urlVal]");if(this.removeActive(),this.closeLists(),a){var b=a.getAttribute("data-tw-selectTree-label"),c=a.getAttribute("data-tw-selectTree-urlVal"),d=a.parentNode;this.expandActiveLists(d),this.setCurrentLabel(b),d.classList.add(this.activeClass),this.setEventType(c)}else{var e=this.widget.querySelector("[data-tw-selecttree-callToActionLabel]");e&&this.setCurrentLabel(e.getAttribute("data-tw-selecttree-callToActionLabel"))}},toggleExpandIcons:function(a){var b=a.childNodes;b[0].classList.toggle(this.hideClass),b[1].classList.toggle(this.hideClass)},toggleTreeList:function(a,b){a.classList.toggle(this.hideClass),this.toggleExpandIcons(b);var c=a.classList.contains(this.hideClass)?"false":"true";b.setAttribute("aria-expanded",c)},toggleTree:function(){this.visibility=!this.visibility;var a=this.widget.querySelector("[data-tw-selectTree-tree]"),b=this.widget.querySelector("[data-tw-selectTree-trigger]");a.classList.remove(this.repositionClass),b.classList.toggle(this.activeClass),a.classList.toggle(this.hideClass);var c=a.getBoundingClientRect().right,d=document.documentElement.clientWidth;if(d<c&&a.classList.toggle(this.repositionClass),a.classList.contains(this.hideClass))a.setAttribute("aria-hidden","true"),this.widget.classList.remove(this.keyboardClass);else{a.setAttribute("aria-hidden","false");var e=a.querySelector("["+this.activeSelector+"] [data-tw-selectTree-label]"),f=e?e:a.querySelector("[data-tw-selectTree-default]");f&&(this.expandActiveLists(f),f.focus())}},triggerEvent:function(a,b){var c=new CustomEvent("totara_core/select_tree:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),d.setKey(b.getAttribute("data-tw-selectTree-urlkey")),d.preset(),d.events(),c(d)})};return{init:b}});
define('totara_core/toggle_filter_panel', [],function(){function a(){return this instanceof a?(this.activeClass="tw-toggleFilterPanel__active",this.fixedClass="tw-toggleFilterPanel__trigger_fixed",this.targetwidget=".tw-selectRegionPanel",this.toggleClass="tw-selectRegionPanel__hiddenOnSmall_show",void(this.widget="")):new a}a.prototype={constructor:a,events:function(){var a=this;this.widget.addEventListener("click",function(b){b.preventDefault(),b.target&&b.target.closest("[data-tw-toggleFilterPanel-trigger]")&&a.toggleWidget()}),this.setPositionFixedEvent=function(){var b=a.widget.querySelector("[data-tw-toggleFilterPanel-trigger]"),c=a.widget.parentNode,d=c.getBoundingClientRect().top,e=a.widget.offsetHeight,f=c.offsetHeight-e;d<0&&d>-f?b.classList.add(a.fixedClass):b.classList.remove(a.fixedClass)};var b=new MutationObserver(function(){if("false"!==a.widget.getAttribute("data-tw-toggleFilterPanel-addLabelContent")){var b=a.widget.getAttribute("data-tw-toggleFilterPanel-addLabelContent");a.widget.querySelector("[data-tw-toggleFilterPanel-extraContent]").innerHTML=b,a.widget.setAttribute("data-tw-toggleFilterPanel-addLabelContent",!1)}});b.observe(this.widget,{attributes:!0,attributeFilter:["data-tw-togglefilterpanel-addlabelcontent"],subtree:!1})},setParent:function(a){this.widget=a},setPositionFixed:function(){var a=this.widget.querySelector("[data-tw-toggleFilterPanel-trigger]");this.widget.classList.contains(this.activeClass)?window.addEventListener("scroll",this.setPositionFixedEvent,!0):(window.removeEventListener("scroll",this.setPositionFixedEvent,!0),a.classList.remove(this.fixedClass))},toggleWidget:function(){this.widget.classList.toggle(this.activeClass),this.setPositionFixed(),this.triggerEvent("changed",{targetwidget:this.targetwidget,toggleClass:this.toggleClass})},triggerEvent:function(a,b){var c=new CustomEvent("totara_core/toggle_filter_panel:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),d.events(),c(d)})};return{init:b}});
define('totara_core/totaranav', ["core/templates"],function(a){function b(){return this instanceof b?(this.widget="",void(this.itemExpandedClass="totaraNav--list_item_expanded")):new b}b.prototype={constructor:b,events:function(){var a=this;this.widget.addEventListener("click",function(b){if(b.target){if(b.target.closest("[data-tw-totaraNav-toggle]")||b.target.closest("[data-tw-totaranav-list-close]")){a.widget.querySelector("[data-tw-totaraNav-list]").classList.toggle("totaraNav_prim--list_showMobile"),a.widget.querySelector("[data-tw-totaraNav-list]").classList.toggle("totaraNav_prim--list_hideMobile");var c=a.widget.querySelector("[data-tw-totaraNav-toggle]").getAttribute("aria-expanded"),d="true"==c?"false":"true";return a.widget.querySelector("[data-tw-totaraNav-toggle]").setAttribute("aria-expanded",d),void(b.target.closest("[data-tw-totaraNav-toggle]")&&a.widget.querySelector("[data-tw-totaranav-list-close]").focus())}var e=b.target.closest("li");if(e&&e.hasAttribute("data-tw-totaraNav-hasChildren")){b.preventDefault();var f=e.classList.contains(a.itemExpandedClass);if(f)return void a.toggleExpandedList(e);var g=e.parentNode.closest("[data-tw-totaraNav-hasChildren]"),h=g?g:"";a.closeAllExpandedLists(h),a.toggleExpandedList(e)}}});for(var b=this.widget.querySelectorAll("[data-tw-totaranav-toplevelitem]"),c=0;c<b.length;c++)b[c].addEventListener("mouseenter",function(){var b=document.activeElement;b.classList.contains("totaraNav_prim--list_item_link")&&!b.parentNode.classList.contains(a.itemExpandedClass)&&b.blur()});this.widget.addEventListener("mouseleave",function(){var b=document.activeElement;b.closest("[data-tw-totaranav-item]")&&a.closeAllExpandedLists()}),window.innerWidth>991?(this.widget.addEventListener("keydown",function(b){if(b.target&&b.target.closest("[data-tw-totaraNav-item]")){var c=b.target.closest("[data-tw-totaraNav-item]"),d=b.target.closest("[data-tw-navExpand-list]");switch(b.key){case"ArrowDown":case"Down":b.preventDefault(),a.listItemKeyDown(c,d);break;case"ArrowLeft":case"Left":b.preventDefault(),a.listItemKeyLeft(c,d);break;case"ArrowRight":case"Right":b.preventDefault(),a.listItemKeyRight(c,d);break;case"ArrowUp":case"Up":b.preventDefault(),a.listItemKeyUp(c,d);break;case"Escape":case"Esc":a.listItemKeyEsc(c,d);break;case"Tab":b.shiftKey?a.listItemKeyTabBack(c):a.listItemKeyTab(c,d);break;case" ":case"Spacebar":b.preventDefault(),a.listItemKeySpace(c)}}}),window.addEventListener("click",function(b){b.target.closest("[data-tw-totaranav-item]")||a.closeAllExpandedLists()})):window.addEventListener("click",function(b){b.target.closest("[data-tw-totaraNav-list]")||b.target.closest("[data-tw-totaraNav-toggle]")||(a.widget.querySelector("[data-tw-totaraNav-list]").classList.remove("totaraNav_prim--list_showMobile"),a.widget.querySelector("[data-tw-totaraNav-list]").classList.add("totaraNav_prim--list_hideMobile"),a.widget.querySelector("[data-tw-totaraNav-toggle]").setAttribute("aria-expanded",!1))}),window.addEventListener("resize",function(){var b=function(){c=null;for(var b=a.widget.querySelector("[data-tw-totaraNav-list]"),d=a.widget.querySelectorAll(".totaraNav--icon_chevron"),e=0;e<d.length;e++)d[e].remove();window.innerWidth>991?(a.addExpandableIcons(),b.classList.remove("totaraNav_prim--list_hideMobile","totaraNav_prim--list_showMobile")):(a.addExpandableIcons(),b.classList.contains("totaraNav_prim--list_showMobile")||b.classList.add("totaraNav_prim--list_hideMobile"))};if(M.cfg.behatsiterunning)return void b();var c;c||(c=setTimeout(b,66))})},addExpandableIcons:function(){for(var a=this.widget.querySelectorAll("[data-tw-totaraNav-chevron]"),b=0;b<a.length;b++)this.toggleExpandableIcon(a[b].parentNode)},closeExpandedList:function(a){var b=a.querySelector("[aria-expanded]");a.classList.remove(this.itemExpandedClass),b.setAttribute("aria-expanded",!1),this.toggleExpandableIcon(b)},closeAllExpandedLists:function(a){for(var b=this.widget.querySelectorAll("."+this.itemExpandedClass),c=0;c<b.length;c++)a!==b[c]&&this.closeExpandedList(b[c])},listItemKeyDown:function(a,b){if(a.classList.contains(this.itemExpandedClass)){var c=a.querySelectorAll("[data-tw-navExpand-list]")[0];c.querySelectorAll("a")[0].focus()}else b&&a.nextElementSibling&&a.nextElementSibling.querySelector("a").focus()},listItemKeyEsc:function(a,b){if(b){var c=a.closest("."+this.itemExpandedClass);this.closeExpandedList(c),c.querySelector("a").focus()}},listItemKeyLeft:function(a,b){!b&&a.previousElementSibling&&(this.closeAllExpandedLists(),a.previousElementSibling.querySelector("a").focus())},listItemKeyRight:function(a,b){!b&&a.nextElementSibling&&(this.closeAllExpandedLists(),a.nextElementSibling.querySelector("a").focus())},listItemKeySpace:function(a){a.hasAttribute("data-tw-totaraNav-hasChildren")&&this.toggleExpandedList(a.closest("[data-tw-totaraNav-hasChildren]"))},listItemKeyTab:function(a,b){if(b&&!a.nextElementSibling&&!a.classList.contains(this.itemExpandedClass)){var c=a.parentNode.closest("[data-tw-totaranav-item]"),d=c.nextElementSibling,e=!c.parentNode.closest("[data-tw-totaranav-item]"),f=a.parentNode.closest("[data-tw-totaranav-toplevelitem]");!d||e?this.closeAllExpandedLists(""):d&&this.closeAllExpandedLists(f)}},listItemKeyTabBack:function(a){var b=a.classList.contains(this.itemExpandedClass);b&&this.closeExpandedList(a)},listItemKeyUp:function(a,b){b&&a.previousElementSibling?a.previousElementSibling.querySelector("a").focus():b&&!a.previousElementSibling&&(b.previousElementSibling.focus(),this.closeExpandedList(b.parentNode))},toggleExpandedList:function(a){a.classList.toggle(this.itemExpandedClass);var b=!!a.classList.contains(this.itemExpandedClass),c=a.querySelector("[aria-expanded]");c.setAttribute("aria-expanded",b),c.focus(),this.toggleExpandableIcon(c)},setParent:function(a){this.widget=a},toggleExpandableIcon:function(b){var c,d=b.querySelector("[data-tw-totaraNav-chevron]"),e=b.closest("[data-tw-totaraNav-topLevelItem]"),f=b.parentNode.hasAttribute("data-tw-totaraNav-topLevelItem");if(d.hasChildNodes()&&(c=d.querySelector("[data-flex-icon]").getAttribute("data-flex-icon")),f&&window.innerWidth>991||!e){if(c)return;c="nav-down"}else c="nav-expand"===c?"nav-expanded":"nav-expand";a.renderIcon(c,"","totaraNav--icon_chevron").done(function(a){d.innerHTML=a})}};var c=function(a){var c=new b;c.setParent(a),c.events(),c.addExpandableIcons()};return{init:c}});
define('totara_criteria/criterion_test', ["core/templates","core/notification"],function(a,b){function c(){return this instanceof c?(this.widget="",void(this.clearEvents=!1)):new c}c.prototype={events:function(){this.widget.addEventListener("click",function(a){!a.target})},bubbledEventsListener:function(){var a=this,b="totara_criteria/criterion:";this.widget.addEventListener(b+"update",function(b){b.detail.key?b.detail.criterion?a.logEvent(b):a.showNotification("error",b.type+" event receved without detail",!0):a.showNotification("error",b.type+" event receved without key",!0)}),this.widget.addEventListener(b+"dirty",function(b){b.detail.key?a.logEvent(b):a.showNotification("error",b.type+" event receved without key",!0),a.clearEvents=!0})},setParent:function(a){this.widget=a},logEvent:function(a){var b='Received :"'+a.type+'".<br/>Detail  : <br/>'+JSON.stringify(a.detail)+"<br/><br/>";this.showNotification("success",b)},showNotification:function(a,c){this.clearEvents&&(b.clearNotifications(),this.clearEvents=!1),b.addNotification({message:c,type:a}),window.scrollTo(0,0)}};var d=function(a){return new Promise(function(b){var d=new c;d.setParent(a),d.events(),d.bubbledEventsListener(),b(d)})};return{init:d}});
define('totara_customfield/field_location', ["jquery"],function(a){function b(b,c){function d(a,b){return c[a]&&"undefined"!==c[a]&&""!==c[a]?c[a]:b}this.google=b,this.clientid=d("clientid",!1),this.apikey=d("apikey",!1),this.fieldprefix=d("fieldprefix",""),this.fordisplay=d("fordisplay",!1),this.regionbias=d("regionbias",""),this.defaultzoomlevel=d("defaultzoomlevel",12),this.address="",this.location={lat:null,lng:null},this.view=null,this.map=null,this.marker=null,this.input_address=a("#id_"+this.fieldprefix+"address"),this.input_latitude=a("#"+this.fieldprefix+"latitude"),this.input_longitude=a("#"+this.fieldprefix+"longitude"),this.input_zoom=a("#"+this.fieldprefix+"zoom"),this.fieldset=null,this.fordisplay||this.wireDefinitionControls();var e=a("#"+this.fieldprefix+"room-location-view"),f=a("#"+this.fieldprefix+"location_map");if(f.length){if(!this.input_latitude.length)return void f.hide();if(this.location.lat=parseFloat(this.input_latitude.val()),!this.input_longitude.length)return void f.hide();this.location.lng=parseFloat(this.input_longitude.val()),this.fieldset=f.closest("fieldset.collapsible.collapsed"),this.fieldset.length&&(window.form_fieldset_expand=window.form_fieldset_expand||[],window.form_fieldset_expand.push({context:this,callback:this.fieldSetRefreshMap}),this.fieldset.attr("data-location-refresh-"+this.fieldprefix,"true")),this.input_zoom.length?this.location.zoom=parseInt(this.input_zoom.val()):this.location.zoom=this.defaultzoomlevel,this.input_address.length&&(this.address=this.input_address.val().trim()),e.length?"map"==e.val()?this.view=this.google.maps.MapTypeId.ROADMAP:"satellite"==e.val()?this.view=this.google.maps.MapTypeId.SATELLITE:this.view=this.google.maps.MapTypeId.HYBRID:this.view=this.google.maps.MapTypeId.ROADMAP,this.load_map()}}return b.prototype.fieldSetRefreshMap=function(b){this.map&&"true"===a(b).attr("data-location-refresh-"+this.fieldprefix)&&(a(b).attr("data-location-refresh-"+this.fieldprefix,"false"),this.google.maps.event.trigger(this.map,"resize"),this.location.lat=parseFloat(this.input_latitude.val()),this.location.lng=parseFloat(this.input_longitude.val()),this.map.panTo(this.location))},b.prototype.wireDefinitionControls=function(){var b=this,c=this.fordisplay,d=this.input_address,e=a("#id_"+this.fieldprefix+"addresslookup"),f=a('.radio_view[name="'+this.fieldprefix+'view"]'),g=a("#id_"+this.fieldprefix+"searchaddress_btn"),h=a("#id_"+this.fieldprefix+"useaddress_btn");g&&g.on("click",function(){b.address=e.val().trim(),b.geocode_address()}),e&&g&&(b.address=e.keydown(function(a){if(13===a.keyCode)return a.preventDefault(),g.click(),!1})),h&&h.on("click",function(){b.address=d.val().trim(),b.geocode_address()}),f&&f.on("change",function(){this.id.indexOf(b.fieldprefix)>-1&&(b.defaultzoomlevel=b.map.getZoom(),b.set_map_view(),b.load_map(c))})},b.prototype.set_map_view=function(){var b=this,c=a('.radio_view[name="'+this.fieldprefix+'view"]:checked');c.each(function(a,c){if(c.id.indexOf(b.fieldprefix)>-1)switch(c.value){case"hybrid":b.map.setMapTypeId(b.google.maps.MapTypeId.HYBRID),b.view=b.google.maps.MapTypeId.HYBRID;break;case"satellite":b.map.setMapTypeId(b.google.maps.MapTypeId.SATELLITE),b.view=b.google.maps.MapTypeId.SATELLITE;break;default:b.map.setMapTypeId(b.google.maps.MapTypeId.ROADMAP),b.view=b.google.maps.MapTypeId.ROADMAP}})},b.prototype.geocode_address=function(){var b=this,c=this.url_encode_address(this.address),d="https://maps.googleapis.com/maps/api/geocode/json?address="+c+"&region="+this.regionbias;M.util.js_pending("totara_customfield-location_search"),""!==c&&(this.clientid?d+="&client="+this.clientid:this.apikey&&(d+="&key="+this.apikey),a.ajax({url:d,type:"GET",success:function(c,d){"success"==d&&c.results.length>0?(b.address=c.results[0].formatted_address,b.location=c.results[0].geometry.location,b.load_map(),a("#fgroup_id_"+b.fieldprefix+"mapelements .felement .alert").hide(),M.util.js_complete("totara_customfield-location_search")):0===a("#fgroup_id_"+b.fieldprefix+"mapelements .felement .alert").length?require(["core/templates","core/str"],function(c,d){d.get_string("locationnotfound","totara_customfield").done(function(d){c.render("core/notification_error",{message:d}).done(function(c){a("#fgroup_id_"+b.fieldprefix+"mapelements .felement").prepend(c),M.util.js_complete("totara_customfield-location_search")})})}):(a("#fgroup_id_"+b.fieldprefix+"mapelements .felement .alert").show(),M.util.js_complete("totara_customfield-location_search"))},error:function(){window.console&&window.console.log&&window.console.log("Failed to load Google maps API.")}}))},b.prototype.get_zoom_level=function(){return parseInt(this.input_zoom.val())},b.prototype.load_map=function(a){if(a="undefined"!=typeof a?a:this.fordisplay,null!==this.location.lat){var b,c=this,d={center:this.location,zoomControl:!0,mapTypeControl:!1,scaleControl:!1,streetViewControl:!1,rotateControl:!1,mapTypeId:this.view,zoom:this.get_zoom_level()},e="";if(this.map=new this.google.maps.Map(document.getElementById(this.fieldprefix+"location_map"),d),a||this.set_map_view(),this.marker=new this.google.maps.Marker({position:this.location,map:this.map,draggable:!a}),this.input_latitude.val(this.location.lat),this.input_longitude.val(this.location.lng),a){if(!(null!==this.address&&this.address.length>0))return;e=this.address,b=new this.google.maps.InfoWindow({content:e}),this.marker.addListener("click",function(){b.open(c.map,c.marker)})}else this.marker.addListener("drag",function(a){c.input_latitude.val(a.latLng.lat()),c.input_longitude.val(a.latLng.lng())}),this.map.addListener("zoom_changed",function(a){c.input_zoom.val(c.map.getZoom())})}},b.prototype.url_encode_address=function(a){return encodeURI(a.replace(/\s+/g,"+"))},{init:function(a){M.util.js_pending("totara_customfield-location_init"),require(["totara_customfield/field_location_loader!"+a.mapparams],function(){new b(google,a),M.util.js_complete("totara_customfield-location_init")})}}});
define('totara_customfield/field_location_loader', function(){function a(){return b+=1}var b=0;return{load:function(b,c,d,e){var f,g,h;e.isBuild?d():(f="___location_callback"+a(),window[f]=d,g=document.createElement("script"),g.setAttribute("type","text/javascript"),g.setAttribute("async",!0),g.setAttribute("src","https://maps.google.com/maps/api/js?"+b+"&callback="+f),h=document.getElementsByTagName("script")[0],h.parentNode.insertBefore(g,h))}}});
define('totara_evidence/evidence_report', ["core/modal_factory","core/modal_events","core/ajax","core/str","core/notification","core/templates"],function(a,b,c,d,e,f){function g(f,g){k=!0;var i=f.getAttribute("data-evidence-"+g+"-actions");c.call([{methodname:"type"===g?"totara_evidence_type_data":"totara_evidence_item_info",args:{id:i}}])[0].then(function(c){var e="type"===g?c.fields.length:null;d.get_strings([{key:"confirm_delete_"+g,component:"totara_evidence",param:c.display_name},{key:"confirm_delete_"+g+"_body",component:"totara_evidence",param:e}]).then(function(d){return a.create({title:d[0],body:d[1],type:a.types.CONFIRM}).then(function(a){a.show(),k=!1,a.getRoot().on(b.yes,function(){h(c,g)})})})})["catch"](function(){d.get_string("error_notification_generic","totara_evidence").then(function(a){e.clearNotifications(),e.addNotification({message:a,type:"error"})})})}function h(a,b){M.util.js_pending("totara_evidence_delete_"+a.id),c.call([{methodname:"totara_evidence_"+b+"_delete",args:{id:a.id}}])[0].then(function(){M.util.js_complete("totara_evidence_delete_"+a.id),window.location.reload(!0)})["catch"](function(){d.get_string("error_notification_delete_"+b,"totara_evidence",a.display_name).then(function(c){e.addNotification({message:c,type:"error"}),M.util.js_complete("totara_evidence_"+b+"_delete_"+a.id)})})}function i(a,b){var g=a.getAttribute("data-evidence-type-actions");M.util.js_pending("totara_evidence_type_set_visibility_"+g),c.call([{methodname:"totara_evidence_type_set_visibility",args:{id:g,visible:b}}])[0].then(function(){c.call([{methodname:"totara_evidence_type_data",args:{id:g}}])[0].then(function(c){Promise.all([d.get_string("notification_type_"+(b?"visible":"hidden"),"totara_evidence",c.display_name),f.render("totara_evidence/type_list_actions",c)]).then(function(b){f.replaceNodeContents(a.parentElement,b[1]),e.clearNotifications(),e.addNotification({message:b[0],type:"success"}),M.util.js_complete("totara_evidence_type_set_visibility_"+g)})})})["catch"](function(){d.get_string("error_notification_generic","totara_evidence").then(function(a){e.clearNotifications(),e.addNotification({message:a,type:"error"})})})}function j(){document.querySelector("#region-main").addEventListener("click",function(a){k||(a.target.closest("[data-evidence-item-delete]")?(a.preventDefault(),g(a.target.closest("[data-evidence-item-actions]"),"item")):a.target.closest("[data-evidence-type-delete]")?(a.preventDefault(),g(a.target.closest("[data-evidence-type-actions]"),"type")):a.target.closest("[data-evidence-type-hide]")?(a.preventDefault(),i(a.target.closest("[data-evidence-type-actions]"),!1)):a.target.closest("[data-evidence-type-show]")&&(a.preventDefault(),i(a.target.closest("[data-evidence-type-actions]"),!0)))})}var k=!1;return{init:j}});
define('totara_evidence/evidence_select_type', ["jquery","core/templates","core/ajax","core/str","core/form-autocomplete","core/url"],function(a,b,c,d,e,f){function g(a,b){return b}function h(a,b,d,e){M.util.js_pending("totara_evidence_type_search_"+b),c.call([{methodname:"totara_evidence_type_search",args:{string:b.trim()}}])[0].then(function(a){d(a),M.util.js_complete("totara_evidence_type_search_"+b)})["catch"](e)}function i(a){M.util.js_pending("totara_evidence_type_details_"+a),c.call([{methodname:"totara_evidence_type_details",args:{type_id:a,user_id:document.querySelector("[data-user-id]").getAttribute("data-user-id")}}])[0].then(function(c){b.render("totara_evidence/_select_type_metadata",c).then(function(c){b.replaceNodeContents(document.querySelector("[data-type-metadata]"),c),document.querySelector("[data-type-submit]").setAttribute("data-type-id",a),document.querySelector("[data-type-infobox]").classList.remove("tw-evidence__hidden"),M.util.js_complete("totara_evidence_type_details_"+a)})})}function j(){d.get_string("select_type","totara_evidence").then(function(b){e.enhance("[data-type-autocomplete]",!1,"totara_evidence/evidence_select_type",b),a("[data-type-autocomplete]").change(function(a){i(a.currentTarget.value)}),document.querySelector("[data-type-buttons]").addEventListener("click",function(a){if(a.preventDefault(),a.target.closest("[data-type-submit]")){var b={typeid:a.target.getAttribute("data-type-id")};a.target.getAttribute("data-user-id")&&(b.user_id=a.target.getAttribute("data-user-id")),window.location.href=f.relativeUrl("/totara/evidence/create.php",b)}else a.target.closest("[data-type-cancel]")&&(document.querySelector("[data-type-infobox]").classList.add("tw-evidence__hidden"),location.reload())})})}return{init:j,processResults:g,transport:h}});
define('totara_evidence/evidence_type_details', ["core/modal_factory","core/modal_events","core/ajax"],function(a,b,c){var d=!1;return{init:function(b){b.addEventListener("click",function(e){if(!d){e.preventDefault();var f=b.getAttribute("data-evidence-type-details"),g=b.getAttribute("data-evidence-user-id");d=!0,M.util.js_pending("totara_evidence_type_show_details_"+f),c.call([{methodname:"totara_evidence_type_details",args:{type_id:f,user_id:g}}])[0].done(function(b){return a.create({title:b.name,body:b.description,type:a.types.CANCEL}).then(function(a){a.show(),d=!1,M.util.js_complete("totara_evidence_type_show_details_"+f)})})}})}}});
define('totara_form/clientaction_base', ["totara_form/form"],function(a){function b(c,d){this.form=d,this.target=d.getItemById(c.target),this.watchedIds=[],this.actionconfig=c,this.target||a.debug("Unable to find the target element #"+c.target,b,a.LOGLEVEL.error)}return b.prototype={checkState:function(){a.debug("A ClientAction does not override the checkState method.",this,a.LOGLEVEL.error)},getTarget:function(){return this.target},init:function(){},getCurrentState:function(){return null},getWatchedIds:function(){return this.watchedIds}},b});
define('totara_form/element_filemanager', ["core/yui","core/templates","core/str"],function(a,b,c){return M.totara_form=M.totara_form||{},M.totara_form.element_filemanager=M.totara_form.element_filemanager||{},M.totara_form.element_filemanager.templates=M.totara_form.element_filemanager.templates||{},M.totara_form.element_filemanager.init=function(a,b){var c=function(a){c.superclass.constructor.apply(this,arguments)};c.NAME="FileManager",c.ATTRS={options:{},lang:{}},a.extend(c,a.Base,{api:M.cfg.wwwroot+"/repository/draftfiles_ajax.php",menus:{},initializer:function(b){this.options=b,b.mainfile&&(this.enablemainfile=b.mainfile),this.client_id=b.client_id,this.currentpath="/",this.maxfiles=b.maxfiles,this.maxbytes=b.maxbytes,this.areamaxbytes=b.areamaxbytes,this.emptycallback=null,this.filepicker_options=b.filepicker?b.filepicker:{},this.filepicker_options.client_id=this.client_id,this.filepicker_options.context=b.context,this.filepicker_options.maxfiles=this.maxfiles,this.filepicker_options.maxbytes=this.maxbytes,this.filepicker_options.areamaxbytes=this.areamaxbytes,this.filepicker_options.env="filemanager",this.filepicker_options.itemid=b.itemid,b.filecount?this.filecount=b.filecount:this.filecount=0,this.filemanager=a.one("#filemanager-"+b.client_id),this.filemanager.hasClass("filemanager-container")||!this.filemanager.one(".filemanager-container")?this.dndcontainer=this.filemanager:(this.dndcontainer=this.filemanager.one(".filemanager-container"),this.dndcontainer.get("id")||this.dndcontainer.generateID()),this.filemanager.one(".fp-path-folder")&&(this.pathnode=this.filemanager.one(".fp-path-folder"),this.pathbar=this.pathnode.get("parentNode"),this.pathbar.removeChild(this.pathnode)),this.selectnode=a.Node.create(M.totara_form.element_filemanager.templates.fileselectlayout),this.selectnode.setAttribute("aria-live","assertive"),this.selectnode.setAttribute("role","dialog"),this.selectnode.generateID();var c="fm-dialog-label_"+this.selectnode.get("id");this.selectui=new M.core.dialogue({draggable:!0,headerContent:'<h3 id="'+c+'">'+M.util.get_string("edit","moodle")+"</h3>",bodyContent:this.selectnode,centered:!0,width:"480px",modal:!0,visible:!1}),a.one("#"+this.selectnode.get("id")).setAttribute("aria-labelledby",c),this.selectui.hide(),this.setup_select_file(),this.setup_buttons(),this.filemanager.one(".fp-content").on(["scroll","resize"],this.content_scrolled,this),this.viewmode=1,this.filemanager.all(".fp-vb-icons,.fp-vb-tree,.fp-vb-details").removeClass("checked"),this.filemanager.all(".fp-vb-icons").addClass("checked"),this.refresh(this.currentpath)},wait:function(){this.filemanager.addClass("fm-updating")},request:function(b,c){var d,e=this.api+"?action="+b.action,f={},g=this;if(b.scope&&(g=b.scope),f.sesskey=M.cfg.sesskey,f.client_id=this.client_id,f.filepath=this.currentpath,f.itemid=this.options.itemid?this.options.itemid:0,b.params)for(d in b.params)f[d]=b.params[d];var h={method:"POST",on:{complete:function(c,d,e){if(!d)return void(window.console.log&&window.console.log("IO FATAL"));var f=null;try{f=a.JSON.parse(d.responseText)}catch(h){return g.print_msg(M.util.get_string("invalidjson","repository"),"error"),void a.error(M.util.get_string("invalidjson","repository")+":\n"+d.responseText)}f&&f.tree&&g.set_current_tree&&g.set_current_tree(f.tree),b.callback(c,f,e)}},arguments:{scope:g},headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},data:build_querystring(f)};b.form&&(h.form=b.form),a.io(e,h),c&&this.wait()},filepicker_callback:function(a){this.filecount++,this.check_buttons(),this.refresh(this.currentpath),"undefined"!=typeof M.core_formchangechecker&&M.core_formchangechecker.set_form_changed()},check_buttons:function(){this.filecount>0?this.filemanager.removeClass("fm-nofiles"):this.filemanager.addClass("fm-nofiles"),this.filecount>=this.maxfiles&&this.maxfiles!=-1?this.filemanager.addClass("fm-maxfiles"):this.filemanager.removeClass("fm-maxfiles")},refresh:function(a){var b=this;this.currentpath=a,a?this.currentpath=a:a=this.currentpath,this.request({action:"list",scope:b,params:{filepath:a},callback:function(a,c,d){b.filecount=c.filecount,b.options=c,b.lazyloading={},b.check_buttons(),b.render(c)}},!0)},print_msg:function(b,c){var d=M.util.get_string("error","moodle");if("error"!=c&&(c="info",d=M.util.get_string("info","moodle")),!this.msg_dlg){this.msg_dlg_node=a.Node.create(M.totara_form.element_filemanager.templates.message);this.msg_dlg_node.generateID();this.msg_dlg=new M.core.dialogue({draggable:!0,bodyContent:this.msg_dlg_node,centered:!0,modal:!0,visible:!1}),this.msg_dlg_node.one(".fp-msg-butok").on("click",function(a){a.preventDefault(),this.msg_dlg.hide()},this)}this.msg_dlg.set("headerContent",d),this.msg_dlg_node.removeClass("fp-msg-info").removeClass("fp-msg-error").addClass("fp-msg-"+c),this.msg_dlg_node.one(".fp-msg-text").setContent(a.Escape.html(b)),this.msg_dlg.show()},is_disabled:function(){return null!==this.filemanager.ancestor(".fitem.disabled")},is_frozen:function(){return this.options.frozen||null!==this.filemanager.ancestor('[data-element-frozen="1"]')},setup_buttons:function(){var b=this.filemanager.one(".fp-btn-download"),c=this.filemanager.one(".fp-btn-mkdir"),d=this.filemanager.one(".fp-btn-add");this.is_frozen()?d&&d.hide():d.on("click",this.show_filepicker,this);var e=this.filemanager.one(".dndupload-arrow");e&&(this.is_frozen()?e.hide():e.on("click",this.show_filepicker,this)),this.options.subdirs&&!this.is_frozen()?c.on("click",function(b){if(b.preventDefault(),!this.is_disabled()&&!this.is_frozen()){var c=this,d=function(b){b.preventDefault();var d=a.one("#fm-newname-"+c.client_id).get("value");return d?void c.request({action:"mkdir",params:{filepath:c.currentpath,newdirname:d},callback:function(b,d,e){var f=d.filepath;c.mkdir_dialog.hide(),c.refresh(f),a.one("#fm-newname-"+c.client_id).set("value",""),"undefined"!=typeof M.core_formchangechecker&&M.core_formchangechecker.set_form_changed()}}):void c.mkdir_dialog.hide()},e=function(){var b=!1,d=a.one("#fm-newname-"+c.client_id).get("value");d.length>0&&(b=!0);var e=a.one("#fm-mkdir-butcreate-"+c.client_id);return e&&e.set("disabled",!b),b};if(!this.mkdir_dialog){var f=a.Node.create(M.totara_form.element_filemanager.templates.mkdir);this.mkdir_dialog=new M.core.dialogue({draggable:!0,bodyContent:f,centered:!0,modal:!0,visible:!1}),f.one(".fp-dlg-butcreate").set("id","fm-mkdir-butcreate-"+this.client_id).on("click",d,this),f.one("input").set("id","fm-newname-"+this.client_id).on("keydown",function(b){var c=a.bind(e,this)();c&&13===b.keyCode&&a.bind(d,this)(b)},this),f.one("#fm-newname-"+this.client_id).on(["keyup","change"],function(b){a.bind(e,this)()},this),f.one("label").set("for","fm-newname-"+this.client_id),f.all(".fp-dlg-butcancel").on("click",function(a){a.preventDefault(),this.mkdir_dialog.hide()},this),f.all(".fp-dlg-curpath").set("id","fm-curpath-"+this.client_id)}this.mkdir_dialog.show();for(var g=M.util.get_string("newfolder","repository");this.has_folder(g);)g=increment_filename(g,!0);a.one("#fm-newname-"+c.client_id).set("value",g),a.bind(e,this)(),a.one("#fm-newname-"+c.client_id).focus().select(),a.all("#fm-curpath-"+c.client_id).setContent(this.currentpath)}},this):(this.filemanager.addClass("fm-nomkdir"),c&&c.hide()),b.on("click",function(b){if(b.preventDefault(),!this.is_disabled()){var c=this,d=this.filemanager.one(".fp-img-downloading");"inline"!=d.getStyle("display")&&(d.setStyle("display","inline"),this.request({action:"downloaddir",scope:c,callback:function(b,d,e){var f=c.filemanager.one(".fp-img-downloading");if(f.setStyle("display","none"),d){c.refresh(d.filepath);var g=a.Node.create("<iframe></iframe>").setStyles({visibility:"hidden",width:"1px",height:"1px"});g.set("src",d.fileurl),a.one("body").appendChild(g)}else c.print_msg(M.util.get_string("draftareanofiles","repository"),"error")}}))}},this),this.filemanager.all(".fp-vb-icons,.fp-vb-tree,.fp-vb-details").on("click",function(a){a.preventDefault();var b=this.filemanager.one(".fp-viewbar");this.is_disabled()||b&&b.hasClass("disabled")||(this.filemanager.all(".fp-vb-icons,.fp-vb-tree,.fp-vb-details").removeClass("checked"),a.currentTarget.hasClass("fp-vb-tree")?this.viewmode=2:a.currentTarget.hasClass("fp-vb-details")?this.viewmode=3:this.viewmode=1,a.currentTarget.addClass("checked"),this.render(),this.filemanager.one(".fp-content").setAttribute("tabIndex","0"),this.filemanager.one(".fp-content").focus())},this)},show_filepicker:function(b){if(b.preventDefault(),!this.is_disabled()&&!this.is_frozen()){var c=this.filepicker_options;c.formcallback=this.filepicker_callback,c.magicscope=this,c.savepath=this.currentpath,M.core_filepicker.show(a,c)}},print_path:function(){var b=this.options.path;if(this.pathbar.setContent("").addClass("empty"),b&&0!==b.length&&2!=this.viewmode){for(var c=0;c<b.length;c++){var d=this.pathnode.cloneNode(!0);this.pathbar.appendChild(d),0===c&&d.addClass("first"),c===b.length-1&&d.addClass("last"),c%2?d.addClass("even"):d.addClass("odd"),d.one(".fp-path-folder-name").setContent(a.Escape.html(b[c].name)).on("click",function(a,b){a.preventDefault(),this.is_disabled()||this.refresh(b)},this,b[c].path)}this.pathbar.removeClass("empty")}},get_filepath:function(a){return a.path&&a.path.length?a.path[a.path.length-1].path:""},treeview_dynload:function(a,b){var c={};if(a.children)for(var d in a.children)c[a.children[d].path]=a.children[d];a.path&&"/"!=a.path||(a.fileinfo.filepath="/",a.fileinfo.type="folder",a.fileinfo.fullname=a.fileinfo.title,a.fileinfo.filename="."),this.request({action:"list",params:{filepath:a.path?a.path:""},scope:this,callback:function(d,e,f){var g,h=e.list,i=f.scope;if(2==i.viewmode&&a&&a.getChildrenEl()){null!==b&&(i.options=e,i.currentpath=a.path?a.path:"/"),a.highlight(!1),a.origlist=e.list?e.list:null,a.origpath=e.path?e.path:null,a.children=[];for(g in h)"folder"==h[g].type&&c[h[g].filepath]?(c[h[g].filepath].fileinfo=h[g],a.children[a.children.length]=c[h[g].filepath]):i.view_files([h[g]]);null===b?a.refresh():b(),i.content_scrolled()}}},!1)},content_scrolled:function(b){setTimeout(a.bind(function(){if(!this.processingimages){this.processingimages=!0;var a=this,b=this.filemanager.one(".fp-content"),c=b.getY(),d=b.getStylePx("height"),e=function(a){var b=a.getY()-c;return b<=d&&(b>=0||b+a.getStylePx("height")>=0)};a.lazyloading&&b.all("img").each(function(b){b.get("id")&&a.lazyloading[b.get("id")]&&e(b)&&b.setImgRealSrc(a.lazyloading)}),this.processingimages=!1}},this),200)},view_files:function(b){if(this.filemanager.removeClass("fm-updating").removeClass("fm-noitems"),null===b&&(!this.options.list||0===this.options.list.length)&&2!=this.viewmode)return void this.filemanager.addClass("fm-noitems");var c,d=null!==b?b:this.options.list;2==this.viewmode||3==this.viewmode?c=a.Node.create(M.totara_form.element_filemanager.templates.listfilename):(this.viewmode=1,c=a.Node.create(M.totara_form.element_filemanager.templates.iconfilename));var e={viewmode:this.viewmode,appendonly:null!==b,filenode:c,callbackcontext:this,callback:function(a,b){a.preventDefault&&a.preventDefault(),"folder"==b.type?this.refresh(b.filepath):this.select_file(b)},rightclickcallback:function(a,b){a.preventDefault&&a.preventDefault(),this.select_file(b)},classnamecallback:function(b){var c="";return"folder"!=b.type&&(b.type||b.filename)||(c+=" fp-folder"),(b.filename||b.filepath||b.path&&"/"!=b.path)&&(c+=" fp-hascontextmenu"),b.isref&&(c+=" fp-isreference"),b.refcount&&(c+=" fp-hasreferences"),b.originalmissing&&(c+=" fp-originalmissing"),1==b.sortorder&&(c+=" fp-mainfile"),a.Lang.trim(c)}};2==this.viewmode&&(e.dynload=!0,e.filepath=this.options.path,e.treeview_dynload=this.treeview_dynload,e.norootrightclick=!0,e.callback=function(a,b){b.fullname&&("folder"!=b.type?(a.node.parent&&a.node.parent.origpath&&(this.options.path=a.node.parent.origpath,this.options.list=a.node.parent.origlist,this.print_path()),this.currentpath=b.filepath,this.select_file(b)):(this.options.path=a.node.origpath,this.options.list=a.node.origlist,this.currentpath=b.filepath,this.print_path()))}),this.lazyloading||(this.lazyloading={}),this.filemanager.one(".fp-content").fp_display_filelist(e,d,this.lazyloading),this.content_scrolled()},populate_licenses_select:function(b){if(b){b.setContent("");var c=this.options.licenses;for(var d in c){var e=a.Node.create("<option/>").set("value",c[d].shortname).setContent(a.Escape.html(c[d].fullname));b.appendChild(e)}}},set_current_tree:function(b){var c=function(a,b){if(b&&b.children&&b.children.length)for(var d in b.children)a[a.length]=b.children[d].filepath,c(a,b.children[d])},d=["/"];c(d,b);var e=this.selectnode,f=e.one(".fp-path select");f.setContent("");for(var g in d)f.appendChild(a.Node.create("<option/>").set("value",d[g]).setContent(a.Escape.html(d[g])))},update_file:function(b){if(this.is_disabled()||this.frozen())return void this.selectui.hide();var c,d,e=this.selectnode,f=this.selectui.fileinfo,g=a.Lang.trim(e.one(".fp-saveas input").get("value")),h=g&&g!=f.fullname,i=e.one(".fp-path select"),j=i.get("selectedIndex"),k=i.get("options").item(j).get("value"),l=k!=this.get_parent_folder_name(f),m=a.Lang.trim(e.one(".fp-author input").get("value")),n=m!=a.Lang.trim(f.author),o=e.one(".fp-license select"),p=o.get("selectedIndex"),q=o.get("options").item(p).get("value"),r=q!=f.license,s={callback:this.update_file,callbackargs:[!0],scope:this};if("folder"==f.type){if(!g)return void this.print_msg(M.util.get_string("entername","repository"),"error");if(h||l){if(!b)return s.message=M.util.get_string("confirmrenamefolder","repository"),void this.show_confirm_dialog(s);c={filepath:f.filepath,newdirname:g,newfilepath:k},d="updatedir"}}else{if(!g)return void this.print_msg(M.util.get_string("enternewname","repository"),"error");if((h||l)&&!b&&f.refcount)return s.message=M.util.get_string("confirmrenamefile","repository",f.refcount),void this.show_confirm_dialog(s);(h||l||r||n)&&(c={filepath:f.filepath,filename:f.fullname,newfilename:g,newfilepath:k,newlicense:q,newauthor:m},d="updatefile")}return d?(e.addClass("loading"),void this.request({action:d,scope:this,params:c,callback:function(a,b,c){b.error?(e.removeClass("loading"),c.scope.print_msg(b.error,"error")):(c.scope.selectui.hide(),c.scope.refresh(b&&b.filepath?b.filepath:"/"),"undefined"!=typeof M.core_formchangechecker&&M.core_formchangechecker.set_form_changed())}})):void this.selectui.hide()},show_confirm_dialog:function(b){if(!this.confirm_dlg){this.confirm_dlg_node=a.Node.create(M.totara_form.element_filemanager.templates.confirmdialog);var c=this.confirm_dlg_node;c.generateID(),this.confirm_dlg=new M.core.dialogue({draggable:!0,bodyContent:c,centered:!0,modal:!0,visible:!1,buttons:{}});var d=function(a){var b=this.confirm_dlg.dlgopt;a.preventDefault(),this.confirm_dlg.hide(),b.callback&&(b.callbackargs?b.callback.apply(b.scope||this,b.callbackargs):b.callback.apply(b.scope||this))},e=function(a){a.preventDefault(),this.confirm_dlg.hide()};c.one(".fp-dlg-butconfirm").on("click",d,this),c.one(".fp-dlg-butcancel").on("click",e,this)}this.confirm_dlg.dlgopt=b,this.confirm_dlg_node.one(".fp-dlg-text").setContent(b.message),this.confirm_dlg.show()},setup_select_file:function(){var a=this.selectnode;a.all(".fp-saveas,.fp-path,.fp-author,.fp-license").each(function(a){a.all("label").set("for",a.one("input,select").generateID())}),this.populate_licenses_select(a.one(".fp-license select"));var b=a.one(".fp-file-update"),c=a.one(".fp-file-download"),d=a.one(".fp-file-delete"),e=a.one(".fp-file-zip"),f=a.one(".fp-file-unzip"),g=a.one(".fp-file-setmain"),h=a.all(".fp-file-cancel");this.is_frozen()?(b&&b.hide(),d&&d.hide(),e&&e.hide(),f&&f.hide(),g&&g.hide(),a.all("form input").each(function(){this.setAttribute("readonly","readonly")}),a.all("form select").each(function(){this.setAttribute("disabled","disabled")})):(b.on("click",function(a){a.preventDefault(),this.update_file()},this),a.all("form").on("keydown",function(a){13==a.keyCode&&(a.preventDefault(),this.update_file())},this),d.on("click",function(a){a.preventDefault();var b={},c={},d=this.selectui.fileinfo;b.scope=this,c.filepath=d.filepath,"folder"==d.type?(c.filename=".",b.message=M.util.get_string("confirmdeletefolder","repository")):(c.filename=d.fullname,d.refcount?b.message=M.util.get_string("confirmdeletefilewithhref","repository",d.refcount):b.message=M.util.get_string("confirmdeletefile","repository")),b.callbackargs=[c],b.callback=function(a){this.request({action:"delete",scope:this,params:a,callback:function(a,b,c){c.scope.filecount--,c.scope.refresh(b.filepath),"undefined"!=typeof M.core_formchangechecker&&M.core_formchangechecker.set_form_changed()}})},this.selectui.hide(),this.show_confirm_dialog(b)},this),e.on("click",function(b){b.preventDefault();var c={},d=this.selectui.fileinfo;"folder"==d.type&&(c.filepath=d.filepath,c.filename=".",a.addClass("loading"),this.request({action:"zip",scope:this,params:c,callback:function(a,b,c){c.scope.selectui.hide(),c.scope.refresh(b.filepath)}}))},this),f.on("click",function(b){b.preventDefault();var c={},d=this.selectui.fileinfo;"zip"==d.type&&(c.filepath=d.filepath,c.filename=d.fullname,a.addClass("loading"),this.request({action:"unzip",scope:this,params:c,callback:function(a,b,c){c.scope.selectui.hide(),c.scope.refresh(b.filepath)}}))},this),g.on("click",function(b){b.preventDefault();var c={},d=this.selectui.fileinfo;this.enablemainfile&&"folder"!=d.type&&(c.filepath=d.filepath,c.filename=d.fullname,a.addClass("loading"),this.request({action:"setmainfile",scope:this,params:c,callback:function(a,b,c){c.scope.selectui.hide(),c.scope.refresh(d.filepath)}}))},this)),c.on("click",function(a){a.preventDefault(),"folder"!=this.selectui.fileinfo.type&&(/iPad|iPhone|iPod/.test(navigator.userAgent)?window.open(this.selectui.fileinfo.url,"_blank"):window.location=this.selectui.fileinfo.url)},this),h.on("click",function(a){a.preventDefault(),this.selectui.hide()},this)},get_parent_folder_name:function(a){if("folder"!=a.type||a.filepath.length<a.fullname.length+1)return a.filepath;var b=a.filepath.substr(0,a.filepath.length-a.fullname.length-1),c=a.filepath.substr(a.filepath.length-a.fullname.length-2);return c=="/"+a.fullname+"/"?b:a.filepath},select_file:function(b){if(!this.is_disabled()){var c=this.selectnode;c.removeClass("loading").removeClass("fp-folder").removeClass("fp-file").removeClass("fp-zip").removeClass("fp-cansetmain"),"folder"==b.type||"zip"==b.type?c.addClass("fp-"+b.type):c.addClass("fp-file"),this.enablemainfile&&1!=b.sortorder&&"file"==b.type&&c.addClass("fp-cansetmain"),this.selectui.fileinfo=b,c.one(".fp-saveas input").set("value",b.fullname);var d=this.get_parent_folder_name(b);c.all(".fp-author input").set("value",b.author?b.author:""),c.all(".fp-license select option[selected]").set("selected",!1),c.all(".fp-license select option[value="+b.license+"]").set("selected",!0),c.all(".fp-path select option[selected]").set("selected",!1),c.all(".fp-path select option").each(function(a){a.get("value")==d&&a.set("selected",!0)}),this.is_frozen()?(c.all(".fp-author input").setAttribute("readonly","readonly"),c.all(".fp-license select").setAttribute("disabled","disabled")):(c.all(".fp-author input").setAttribute("readonly","folder"==b.type?"readonly":""),c.all(".fp-license select").setAttribute("disabled","folder"==b.type?"disabled":""));var e=["datemodified","datecreated","size","dimensions","original","reflist"];for(var f in e)if(c.one(".fp-"+e[f])){var g=b[e[f]+"_f"]?b[e[f]+"_f"]:b[e[f]]?b[e[f]]:"";"reflist"!==e[f]&&(g=a.Escape.html(g)),c.one(".fp-"+e[f]).addClassIf("fp-unknown",""+g=="").one(".fp-value").setContent(g)}var h=a.Node.create("<img/>").set("src",b.realthumbnail?b.realthumbnail:b.thumbnail).setStyle("maxHeight",""+(b.thumbnail_height?b.thumbnail_height:90)+"px").setStyle("maxWidth",""+(b.thumbnail_width?b.thumbnail_width:90)+"px");c.one(".fp-thumbnail").setContent("").appendChild(h),b.isref&&!b.original&&(c.one(".fp-original").removeClass("fp-unknown").addClass("fp-loading"),this.request({action:"getoriginal",scope:this,params:{filepath:b.filepath,filename:b.fullname},callback:function(d,e,f){var g=f.scope;g.selectui.fileinfo&&b&&g.selectui.fileinfo.filepath==b.filepath&&g.selectui.fileinfo.fullname==b.fullname&&(c.one(".fp-original").removeClass("fp-loading"),e.original?(b.original=e.original,c.one(".fp-original .fp-value").setContent(a.Escape.html(b.original))):c.one(".fp-original .fp-value").setContent(M.util.get_string("unknownsource","repository")))}},!1)),c.one(".fp-refcount").setContent(b.refcount?M.util.get_string("referencesexist","repository",b.refcount):""),b.refcount&&!b.reflist&&(c.one(".fp-reflist").removeClass("fp-unknown").addClass("fp-loading"),this.request({action:"getreferences",scope:this,params:{filepath:b.filepath,filename:b.fullname},callback:function(d,e,f){var g=f.scope;if(g.selectui.fileinfo&&b&&g.selectui.fileinfo.filepath==b.filepath&&g.selectui.fileinfo.fullname==b.fullname)if(c.one(".fp-reflist").removeClass("fp-loading"),e.references){b.reflist="";for(var h in e.references)b.reflist+="<li>"+a.Escape.html(e.references[h])+"</li>";c.one(".fp-reflist .fp-value").setContent(b.reflist)}else c.one(".fp-reflist .fp-value").setContent("")}},!1));var i=b.fullname,j=50;i.length>j&&(i=i.substring(0,j)+"...");var k=M.util.get_string("edit","moodle")+" "+i;a.one("#fm-dialog-label_"+c.get("id")).setContent(a.Escape.html(k)),this.selectui.show(),a.one("#"+c.get("id")).focus()}},render:function(){this.print_path(),this.view_files(null)},has_folder:function(a){var b;for(var c in this.options.list)if(b=this.options.list[c],"folder"==b.type&&b.fullname==a)return!0;return!1}});var d=a.one("#filemanager-"+b.client_id);d.removeClass("fm-loading").addClass("fm-loaded");var e=new c(b);if(!b.frozen){var f={filemanager:e,acceptedtypes:b.filepicker.accepted_types,clientid:b.client_id,author:b.author,maxfiles:b.maxfiles,maxbytes:b.maxbytes,areamaxbytes:b.areamaxbytes,itemid:b.itemid,repositories:e.filepicker_options.repositories,containerid:e.dndcontainer.get("id"),contextid:b.context.id};M.form_dndupload.init(a,f)}},{init_filemanager:function(b){var d=[];d.push({key:"edit",component:"moodle"}),d.push({key:"invalidjson",component:"repository"}),d.push({key:"error",component:"moodle"}),d.push({key:"info",component:"moodle"}),d.push({key:"newfolder",component:"repository"}),d.push({key:"invalidjson",component:"repository"}),d.push({key:"draftareanofiles",component:"repository"}),d.push({key:"entername",component:"repository"}),d.push({key:"confirmrenamefolder",component:"repository"}),d.push({key:"enternewname",component:"repository"}),d.push({key:"confirmrenamefile",component:"repository"}),d.push({key:"confirmdeletefolder",component:"repository"}),d.push({key:"confirmdeletefilewithhref",component:"repository"}),d.push({key:"confirmdeletefile",component:"repository"}),d.push({key:"unknownsource",component:"repository"}),d.push({key:"referencesexist",component:"repository"}),d.push({key:"unknownsource",component:"repository"}),d.push({key:"unknownsource",component:"repository"}),c.get_strings(d).done(function(){var c=["moodle-core-notification-dialogue","core_filepicker","base","io-base","node","json","core_dndupload","panel","resize-plugin","dd-plugin"];a.use(c,function(a){M.core_filepicker.set_templates(a,b.filepicker.fptemplates),b.filepicker.fptemplates=null,M.totara_form.element_filemanager.templates=b.fmtemplates,b.fmtemplates=null,M.totara_form.element_filemanager.init(a,b)})})}}});
define('totara_form/element_filepicker', ["core/yui"],function(a){return M.totara_form=M.totara_form||{},M.totara_form.element_filepicker=M.totara_form.element_filepicker||{},M.totara_form.element_filepicker.instances=M.totara_form.element_filepicker.instances||[],M.totara_form.element_filepicker.callback=function(a){var b='<div class="filepicker-container"><a href="'+a.url+'">'+a.file+"</a></div>";b+='<div class="dndupload-progressbars"></div>',M.totara_form.element_filepicker.Y.one("#file_info_"+a.client_id+" .filepicker-filename").setContent(b);var c=M.core_filepicker.instances[a.client_id].options.elementname;M.totara_form.element_filepicker.instances[c].fileadded=!0},M.totara_form.element_filepicker.init=function(a,b){M.totara_form.element_filepicker.Y=a,M.totara_form.element_filepicker.instances[b.elementname]={},M.totara_form.element_filepicker.instances[b.elementname].fileadded=!1,b.formcallback=M.totara_form.element_filepicker.callback,M.core_filepicker.instances[b.client_id]||M.core_filepicker.init(a,b),a.on("click",function(a,b){a.preventDefault(),null===this.ancestor(".fitem.disabled")&&M.core_filepicker.instances[b].show()},"#filepicker-button-"+b.client_id,null,b.client_id);var c=document.getElementById("filepicker-wrapper-"+b.client_id);c&&(c.style.display="");var d={clientid:b.client_id,acceptedtypes:b.accepted_types,author:b.author,maxfiles:-1,maxbytes:b.maxbytes,itemid:b.itemid,repositories:b.repositories,formcallback:b.formcallback,containerprefix:"#file_info_",containerid:"file_info_"+b.client_id,contextid:b.context.id};M.form_dndupload.init(a,d)},{init_filepicker:function(b){a.use(["core_filepicker","node","node-event-simulate","core_dndupload"],function(a){M.core_filepicker.set_templates(a,b.fptemplates),b.fptemplates=null,M.totara_form.element_filepicker.init(a,b)})}}});
define('totara_form/element_generic', ["totara_form/form"],function(a){function b(c,d,e,f){return this instanceof b?void a.Element.apply(this,arguments):new b(c,d,e,f)}return b.prototype=Object.create(a.Element.prototype),b.prototype.constructor=b,b.prototype.toString=function(){return"[object GenericElement]"},b.prototype.init=function(a){a()},b.prototype.getValue=function(){return null},b.prototype.showLoading=function(){},b.prototype.hideLoading=function(){},b});
define('totara_form/form', ["jquery","core/config","core/templates","core/notification"],function(a,b,c,d){function e(a){var b=new Promise(function(b){var c=document.getElementById(a),d=function(){"true"===c.getAttribute("data-totara_form-initialised")&&(e.disconnect(),b())},e=new MutationObserver(d);e.observe(c,{attributes:!0,attributeFilter:["data-totara_form-initialised"]})});return b}function f(a,b,c,d){return this instanceof f?(this.parent=a,this.type=b,this.id=c,void(this.node=d)):new f(a,b,c,d)}function g(){this.elements={}}function h(a,b,c){return this instanceof h?(f.call(this,a,"totara_form\\form\\group",b,c),void g.call(this)):new h(a,b,c)}function i(c){if(!(this instanceof i))return new i(c);["el"].forEach(function(a){if(!c.hasOwnProperty(a)){var b='Missing required config property "'+a+'"';throw new Error(b)}}),this.node=c.el;var d=this;require(["core/form_duplicate_prevent"],function(a){a.init(d.node)}),this.id=c.el.getAttribute("id"),this.clientActions=[],this.actionListeners=[],this.form=a(this.node),this.form.data("TotaraForm",this),this.form.attr("action")===b.wwwroot+"/totara/form/ajax.php"&&(k.debug("Form submission for "+this.id+" is being directed via ajaxSubmit",this,k.LOGLEVEL.info),this.form.on("submit.ajaxSubmit",a.proxy(function(a){a.preventDefault(),this.ajaxSubmit(this.form.find("input[type=submit]:focus"))},this))),g.call(this)}var j=!(!window.console||!b.hasOwnProperty("developerdebug"))&&b.developerdebug;f.prototype={toString:function(){return"[object Element]"},init:function(a){a()},getId:function(){return this.id},getType:function(){return this.type},getNode:function(){return this.node},getValue:function(){return null},compare:function(a){var b=this.getValue(),c=[b].concat(Array.prototype.slice.call(arguments));return i.prototype.compare.apply(null,c)},isEmpty:function(){var a=this.getValue();return null===a||""===a||0===a||a===[]||!!a.hasOwnProperty("isEmpty")&&a.isEmpty()},isHidden:function(){return null!==this.node.getAttribute("data-hidden")},setHidden:function(a){a?(k.debug("#"+this.id+" is now hidden",this,k.LOGLEVEL.debug),this.node.setAttribute("data-hidden","")):(k.debug("#"+this.id+" is no longer hidden",this,k.LOGLEVEL.debug),this.node.removeAttribute("data-hidden"))},changed:function(a){this.getForm().valueChanged(this.getId(),this.getValue())},disable:function(){return!!this.input&&(this.input.setAttribute("disabled",""),!0)},enable:function(){return!!this.input&&(this.input.removeAttribute("disabled"),!0)},isDisabled:function(){return this.input?null!==this.input.getAttribute("disabled"):null},isEnabled:function(){return this.input?null===this.input.getAttribute("disabled"):null},getForm:function(){var a=0,b=function(c){if(a++,a>10)throw"Coding error: element nesting is too deep!";return c.hasOwnProperty("parent")?b(c.parent):c};return b(this.parent)}},g.prototype={registerItem:function(a){j&&this.elements[a.getId()]&&k.debug("Item being registered already exists #"+a.getId(),g,k.LOGLEVEL.error),this.elements[a.getId()]=a},registerGroup:function(a,b){this.registerItem(a);var c=!0;if(j){var d=3e3;window.setTimeout(function(){c===!0&&k.debug("Element #"+a.getId()+" failed to call done() in "+d+"ms",a,k.LOGLEVEL.error)},d)}k.debug("Registered group #"+a.getId()+" of type "+a.getType(),a,k.LOGLEVEL.debug),a.init(function(){k.debug("Completed initialisation of #"+a.getId(),a,k.LOGLEVEL.debug),c=!1,b.resolve(a)})},registerElement:function(a,b){this.registerItem(a);var c=!0;if(j){var d=3e3;window.setTimeout(function(){c===!0&&k.debug("Element #"+a.getId()+" failed to call done() in "+d+"ms",a,k.LOGLEVEL.error)},d)}k.debug("Registered element #"+a.getId()+" of type "+a.getType(),a,k.LOGLEVEL.debug),a.init(function(){k.debug("Completed initialisation of #"+a.getId(),a,k.LOGLEVEL.debug),c=!1,b.resolve(a)})},filterItems:function(b,c,d){var e=[],f=[];if(void 0===d&&(d=0),d++,d>6)return k.debug("Filtering depth exceeds known limits, coding error!",this,k.LOGLEVEL.error),e;if(d>4&&k.debug("Filtering depth nearing limit, check you need this level of depth!",this,k.LOGLEVEL.warn),"function"!=typeof b)throw new Error("You must provide a filter function for filterItems()");for(var g in this.elements)if(this.elements.hasOwnProperty(g)){var i=this.elements[g];b(i)===!0&&(e[g]=i),c===!0&&i instanceof h&&(f=i.filterItems(b,!0,d),e=a.extend(e,f))}return e},getElements:function(a){return this.filterItems(function(a){return!(a instanceof h)&&a instanceof f},a)},getGroups:function(a){return this.filterItems(function(a){return a instanceof h},a)},getElementById:function(a){var b=this.getElements(!0);return b[a]},getGroupById:function(a){var b=this.getGroups(!0);return b[a]},getItemById:function(b){var c=a.extend(this.getElements(!0),this.getGroups(!0));return c[b]},map:function(a){var b=this.elements,c=[];for(var d in b)b.hasOwnProperty(d)&&c.push(a(b[d]));return c},disable:function(){return this.map(function(a){a.disable()}),this},enable:function(){return this.map(function(a){a.enable()}),this},isDisabled:function(){var a=this.map(function(a){return a.isDisabled()});return a.indexOf(!1)===-1},isEnabled:function(){var a=this.map(function(a){return a.isEnabled()});return a.indexOf(!1)===-1},isValid:function(){return this.getElements(!0).every(function(a){if("function"!=typeof a.isValid)return!0;var b=a.isValid();return b||"function"!=typeof a.displayError||a.displayError(),b})},toString:function(){return"[object ElementCollection]"},findItemNodes:function(b){var c=k.attributeIdentifiers.CLASSIFICATION+'="'+k.itemIdentifiers.ELEMENT+'"',d=k.getDataAttributeSelector(c),e=k.attributeIdentifiers.CLASSIFICATION+'="'+k.itemIdentifiers.GROUP+'"',f=k.getDataAttributeSelector(e),g=a(b),h=g.find([d,f].join(", ")).get();return h=Array.prototype.filter.call(h,function(b){return 0===a(b).parentsUntil(g,f).length})},getItemNodes:function(){return this.findItemNodes(this.node)},initGroup:function(b){var c,d,e=this,f={},g=k.attributeIdentifiers,i=a.Deferred();if([g.TYPE,g.ID,g.MODULE].forEach(function(a){f[a.split("-").pop()]=b.getAttribute(a)}),f.module)require([f.module],function(c){var d=new c(e,f.id,b),g=d.getItemNodes(),h=a.Deferred();e.registerGroup(d,h),h.done(function(){d.initItems(g).then(function(){i.resolve()},function(a){k.debug("Failed to initialise the items within a group of type "+f.module,e,k.LOGLEVEL.error),i.reject()})})});else{c=new h(this,f.id,b),d=c.getItemNodes();var j=a.Deferred();this.registerGroup(c,j),j.done(function(){c.initItems(d).done(function(){i.resolve()})})}return i.promise()},initElement:function(b){var c=this,d=a.Deferred(),e={},f=k.attributeIdentifiers;return[f.TYPE,f.ID,f.MODULE].forEach(function(a){e[a.split("-").pop()]=b.getAttribute(a)}),e.module||(e.module="totara_form/element_generic"),require([e.module],function(a){var f=new a(c,e.type,e.id,b);c.registerElement(f,d)}),d.promise()},initItems:function(b){var c=Array.prototype.map.call(b,function(a){return a.getAttribute(k.attributeIdentifiers.CLASSIFICATION)===k.itemIdentifiers.GROUP?this.initGroup(a):a.getAttribute(k.attributeIdentifiers.CLASSIFICATION)===k.itemIdentifiers.ELEMENT?this.initElement(a):void 0},this);return a.when.apply(a,c)}},h.prototype=Object.create(f.prototype),a.extend(h.prototype,g.prototype),h.prototype.constructor=h,h.prototype.toString=function(){return"[object Group]"},h.prototype.init=function(a){a()},i.prototype=Object.create(g.prototype),i.prototype.constructor=i,a.extend(i.prototype,{toString:function(){return"[object Form]"},initClientActions:function(b){var c=this,d=b.map(function(a){return c.initClientAction(a).done(function(a){c.clientActions.push(a)})});return a.when.apply(a,d).done(function(){c.checkAllClientActionStates()})},initClientAction:function(b){var c=this,d=a.Deferred(),e=this.convertTypeToModule(b.actionType);if(!e)throw new Error("Unknown action of type ["+b.actionType+"]");return require([e],function(a){a.init(b,c,function(a){d.resolve(a)})}),d.promise()},convertTypeToModule:function(a){var b=a.split("\\"),c=b[0],d=b.slice(1).join("_"),e=c+"/"+d;return k.debug("Found module to be ["+e+"] from type ["+a+"] by split.",i,k.LOGLEVEL.debug),e},checkModuleExists:function(a){return require.specified(a)},valueChanged:function(a){k.debug("Value of #"+a+" changed",this,k.LOGLEVEL.info),this.checkClientActionState(a)},checkClientActionState:function(a){var b=this.setFormWorking("checkaction");k.debug("Checking ClientActions on #"+a,this,k.LOGLEVEL.debug),this.clientActions.forEach(function(b){b.getWatchedIds().indexOf(a)!==-1&&b.checkState()}),b.resolve()},checkAllClientActionStates:function(){var a=this.setFormWorking("checkallactions");k.debug("Checking the state of all ClientActions",this,k.LOGLEVEL.debug);for(var b in this.clientActions)this.clientActions.hasOwnProperty(b)&&this.clientActions[b].checkState();a.resolve()},addActionListener:function(a){this.actionListeners.push(a)},callActionListener:function(a,b){for(var c in this.actionListeners)this.actionListeners.hasOwnProperty(c)&&this.actionListeners[c].hasOwnProperty(a)&&this.actionListeners[c][a].apply(this,b)},submit:function(){this.form.trigger("submit")},reload:function(a){this.ajaxSubmit(a,!0)},ajaxSubmit:function(c,d){d=d||!1,d?k.debug("Reloading form #"+this.id,this,k.LOGLEVEL.info):k.debug("Submitting form #"+this.id+" by AJAX",this,k.LOGLEVEL.info);var e=this.form.serializeArray(),f=a.Deferred(),g=this.setFormWorking("ajaxsubmit");return f.done(function(){g.resolve()}),void 0!==c&&e.push({name:c.attr("name"),value:c.val()}),d&&(e.push({name:"___tf_reload",value:1}),e.push({name:"___tf_original_action",value:this.form.attr("action")})),a.ajax({type:"POST",url:b.wwwroot+"/totara/form/ajax.php",data:e,context:this,success:function(a){this.ajaxSubmitHandler(f,a)},error:function(a,b,c){f.reject(a,b,c)},dataType:"json"}),f},ajaxSubmitHandler:function(b,e){var f=this;b.done(function(a,b){f.callActionListener(a,[f,b])}),"display"===e.formstatus?(k.debug("Displaying the form after an AJAX reload.",i,k.LOGLEVEL.info),c.render(e.templatename,e.templatedata).done(a.proxy(this.replaceFormContents,this),b.resolve(e.formstatus,e.templatedata.formid)).fail(d.exception)):"cancelled"===e.formstatus?(b.done(function(){k.debug("The form has been cancelled, the calling JS needs to do something.",i,k.LOGLEVEL.success)}),b.resolve(e.formstatus,e)):"submitted"===e.formstatus?(b.done(function(){k.debug("The form has been successfully submit, the calling JS needs to do something.",i,k.LOGLEVEL.success)}),b.resolve(e.formstatus,e.data)):(b.done(function(){k.debug("Unexpected reload result.",i,k.LOGLEVEL.error)}),b.resolve("unknown",e))},replaceFormContents:function(a,b){c.replaceNode(this.form,a,b),M.util.js_pending("totara_form-replaceform"),e(this.form.attr("id")).then(function(){M.util.js_complete("totara_form-replaceform")})},compare:function(b,c){if(null!==b&&!Array.isArray(b)&&("function"==typeof b||"object"==typeof b))return!1;var d,e,f,g=i.prototype.compare,h=Array.isArray(b),j=null;switch(c){case i.Operators.Equals:if(3!==arguments.length)return e=arguments.length,k.debug("Compare NotEquals expects 3 arguments, "+e+" given.",i,k.LOGLEVEL.error),j;if(d=arguments[2],Array.isArray(d))if(!h||b.length<d.length)j=!1;else{j=!0;for(f in d)if(d.hasOwnProperty(f)&&!a.inArray(d[f],b)){j=!1;break}}else if(h){for(f in b)if(b.hasOwnProperty(f)&&b[f].toString()===d.toString()){j=!0;break}}else null===b&&(b=""),j=b.toString()===d.toString();break;case i.Operators.Empty:j=null===b||b===!1||""===b.toString()||"0"===b.toString()||h&&0===b.length;break;case i.Operators.Filled:h?j=b.length>0:(null===b&&(b=""),b=b.toString().trim(),j=""!==b&&"false"!==b.toLowerCase()&&!/^[0]*$/.test(b));break;case i.Operators.NotEquals:if(3!==arguments.length)return e=arguments.length,k.debug("Compare NotEquals expects 3 arguments, "+e+" given.",i,k.LOGLEVEL.error),j;d=arguments[2],j=!g(b,i.Operators.Equals,d);break;case i.Operators.NotEmpty:j=!g(b,i.Operators.Empty);break;case i.Operators.NotFilled:j=!g(b,i.Operators.Filled);break;case i.Operators.In:if(3!==arguments.length)return e=arguments.length,k.debug("Compare In expects 3 arguments, "+e+" given.",i,k.LOGLEVEL.error),null;if(h){j=null;break}if(d=arguments[2],!Array.isArray(d)){j=null;break}j=!1;for(f in d)if(d.hasOwnProperty(f)&&d[f].toString()===b.toString()){j=!0;break}break;case i.Operators.NotIn:if(3!==arguments.length)return e=arguments.length,k.debug("Compare NotIn expects 3 arguments, "+e+" given.",i,k.LOGLEVEL.error),null;if(h){j=null;break}if(d=arguments[2],!Array.isArray(d)){j=null;break}j=!0;for(f in d)if(d.hasOwnProperty(f)&&d[f].toString()===b.toString()){j=!1;break}break;default:k.debug('Unknown comparison operator given: "'+c+'"',i,k.LOGLEVEL.error)}return j},submitHandler:function(b){var c=b.data.form;if(b.preventDefault(),c.isValid()){var d=a(b.target);d.unbind("submit",c.submitHandler),d.submit()}else k.debug("Failed validation, the responsible element should identify itself.",i,k.LOGLEVEL.warn)},setCustomValidation:function(){var b=a(this.node),c=this;c.node.setAttribute("novalidate",""),b.on("submit.working",{form:c},c.submitHandler)},setFormWorking:function(b){k.debug("Form working on "+b+' "'+this.id+'"',i,k.LOGLEVEL.debug);var c=a.Deferred(),d=this;return c.done(function(){d.setFormReady(b)}),M.util.js_pending("totaraForm_"+this.id+"_"+b),this.form&&this.form.on("submit.working",this.preventSubmissionOnSubmit),c},setFormReady:function(a){k.debug("Form ready after "+a+' "'+this.id+'"',i,k.LOGLEVEL.debug),this.form&&this.form.off("submit.working",this.preventSubmissionOnSubmit),M.util.js_complete("totaraForm_"+this.id+"_"+a)},preventSubmissionOnSubmit:function(a){a.preventDefault()},showLoading:function(){a(k.LOADING,this.node).length>0&&a(k.LOADING,this.node).show()},hideLoading:function(){a(k.LOADING,this.node).length>0&&a(k.LOADING,this.node).hide()}}),i.Operators={Equals:"equals",Empty:"empty",Filled:"filled",NotEquals:"notequals",NotEmpty:"notempty",NotFilled:"notfilled",In:"in",NotIn:"notin"};var k={Operators:i.Operators,Element:f,Group:h,forms:{},listenerQueue:{},itemIdentifiers:{FORM:"data-totara-form",ELEMENT:"element",GROUP:"group",INPUT:"data-totara-form-element-input",LOADING:".tf_loading_form"},attributeIdentifiers:{ID:"data-element-id",TYPE:"data-element-type",MODULE:"data-element-amd-module",CLASSIFICATION:"data-item-classification"},LOGLEVEL:{none:"none",debug:"debug",info:"info",success:"success",warn:"warn",error:"error"},getDataAttributeSelector:function(a){return"["+a+"]"},init:function(b){M.util.js_pending("totara-form-init"),k.debug("Initialising form #"+b.id,i,k.LOGLEVEL.info);var c=a("#"+b.id);if(0===c.length)throw new Error("Unable to find form #"+b.id);c=c[0],k.debug("Preventing form #"+b.id+" submission during bootstrapping",i,k.LOGLEVEL.debug);var d,e=new i({el:c}),f=b.actionsConfig,g=a.Deferred();this.forms[e.id]=e,this.listenerQueue.hasOwnProperty(e.id)&&e.addActionListener(this.listenerQueue[e.id]);var h=e.setFormWorking("init");if(d=e.getItemNodes(),0===d.length)throw new Error("Form [#"+this.id+"] must contain at least one element or group.");return e.initItems(d).then(function(){e.initClientActions(f).done(function(){g.resolve(e)})},function(a){k.debug("Failed to initialise items in form #"+b.id,i,k.LOGLEVEL.info)}),g.promise().done(function(a){var c=a.node;k.debug("Re-enabling submission of form #"+c.getAttribute("id"),i,k.LOGLEVEL.debug);var d=a.getElements(!0).some(function(a){return"function"==typeof a.isValid});d&&a.setCustomValidation(),c.setAttribute("data-totara_form-initialised",!0),h.resolve(),k.debug("Initialised form #"+b.id+".",i,k.LOGLEVEL.success),M.util.js_complete("totara-form-init")})},extend:function(b,c,d){return c&&"undefined"!==c||(c=function(){b.apply(this,arguments)}),c.prototype=Object.create(b.prototype),c.prototype.constructor=c,a.extend(c.prototype,d),c},load:function(f,g,h,j){var l=a.extend(h,{sesskey:b.sesskey,___tf_formclass:f,___tf_idsuffix:g}),m=a("#"+j),n=a.Deferred();return M.util.js_pending("totara_form-loading"),a.ajax({url:b.wwwroot+"/totara/form/ajax.php",data:l,context:this,success:function(b){"display"===b.formstatus?(k.debug("Displaying the form for the first time.",i,k.LOGLEVEL.debug),m.empty(),c.render(b.templatename,b.templatedata).done(function(d,f){c.replaceNodeContents(a("#"+j),d,f),e(b.templatedata.formid).then(function(){M.util.js_complete("totara_form-loading"),n.resolve("display",b.templatedata.formid)})}).fail(d.exception)):(k.debug("Unexpected form response",i,k.LOGLEVEL.warn),n.reject())},error:function(a,b,c){n.reject(a,b,c)},dataType:"json"}),n.promise()},getFormInstance:function(a){return this.forms.hasOwnProperty(a)?this.forms[a]:null},addActionListeners:function(a,b){var c=this.getFormInstance(a);null===c?this.listenerQueue[a]=b:c.addActionListener(b)},debug:function(a,b,c){if(j){if(!window.console.log.apply)return void(window.console.log&&window.console.log(a));c||(c=k.LOGLEVEL.none),a=b?b.prototype&&b.prototype.constructor&&b.prototype.constructor.name?"%cForm."+b.prototype.constructor.name+": %c"+a:b.constructor&&b.constructor.name?"%cForm."+b.constructor.name+": %c"+a:"%cForm: %c"+a:"%cForm: %c"+a;var d="#cb8bbe",e="#ae45a3";switch(c){case k.LOGLEVEL.debug:window.console.log.apply(window.console,[a,"color: "+d+"; font-style: italic; padding-left:2em;","color: #454545; font-style: italic;"]);break;case k.LOGLEVEL.error:window.console.log.apply(window.console,[a,"color: "+e+"; font-weight: bold;","color: #c74939;"]);break;case k.LOGLEVEL.warn:window.console.log.apply(window.console,[a,"color: "+e+"; font-weight: bold;","color: #c68c25;"]);break;case k.LOGLEVEL.success:window.console.log.apply(window.console,[a,"color: "+e+"; font-weight: bold;","color: #2da833;"]);break;case k.LOGLEVEL.info:window.console.log.apply(window.console,[a,"color: "+e+"; font-weight: bold;","color: #235aac;"]);break;default:window.console.log.apply(window.console,[a,"",""])}}}};return k});
define('totara_form/form_clientaction_hidden_if', ["totara_form/form","totara_form/clientaction_base"],function(a,b){var c=function(){this.comparisons=[],b.apply(this,arguments)};return c=a.extend(b,c,{init:function(){var b,d;if(this.actionconfig.comparisons)for(b in this.actionconfig.comparisons)this.actionconfig.comparisons.hasOwnProperty(b)&&(d=this.actionconfig.comparisons[b],this.watchedIds.push(d.element),d.element=this.form.getElementById(d.element),this.comparisons.push(d));a.debug("Registered HiddenIf with "+this.comparisons.length+" comparisons",c,a.LOGLEVEL.debug)},enforce:function(){a.debug("Enforcing HiddenIf rule on #"+this.target.getId(),this,a.LOGLEVEL.info),this.target.setHidden(!0)},cease:function(){a.debug("Ceasing enforcement of HiddenIf rule on #"+this.target.getId(),this,a.LOGLEVEL.info),this.target.setHidden(!1)},checkState:function(){var a,b,c,d,e=this.getCurrentState(),f=!1;for(a in this.comparisons)if(this.comparisons.hasOwnProperty(a)&&(b=this.comparisons[a],c=[b.operator].concat(b.options),d=b.element.compare.apply(b.element,c),d===!0)){f=!0;break}f?e||this.enforce():e&&this.cease()},getCurrentState:function(){return this.target.isHidden()}}),{init:function(a,b,d){var e=new c(a,b);e.init(),d(e)}}});
define('totara_form/form_clientaction_onchange_ajaxsubmit', ["jquery","totara_form/form","totara_form/clientaction_base","core/notification","core/str"],function(a,b,c,d,e){var f="totara_form/form_clientaction_onchange_ajaxsubmit",g=function(a){var c="undefined"!=typeof arguments[1]?arguments[1]:b.LOGLEVEL.debug;b.debug(a,h,c)},h=function(){c.apply(this,arguments),this.initialValues=[],this.ajaxSubmitTimeoutID=0,this.ajaxSubmitFormCallback=a.proxy(this.ajaxSubmitForm,this),this.ignoredValues=arguments[0].ignoredvalues||[],this.submitHandler=arguments[0].submithandler||!1};return h=b.extend(c,h,{init:function(){var a=this.form.getElementById(this.actionconfig.target);return"undefined"==typeof a?void g("Unable to retrieve the element with id "+this.actionconfig.target,b.LOGLEVEL.error):(this.getWatchedIds().push(this.actionconfig.target),this.initialValues[this.actionconfig.target]=a.getValue(),void g("Registered onchange_ajaxsubmit client action for "+this.actionconfig.target))},checkState:function(){var a=!1;this.ajaxSubmitTimeoutID&&this.cancelAjaxSubmitForm(),this.getWatchedIds().forEach(function(c){if(a!==!0){g("Checking "+c+" for onchange_ajaxsubmit");var d,e=this.form.getElementById(c);if("undefined"==typeof e)return void g("Unable to retrieve the element with id "+this.actionconfig.target,b.LOGLEVEL.error);d=e.getValue();var f=function(a,b){var c;if(Array.isArray(a)&&Array.isArray(b)){if(a.length!==b.length)return!1;for(c=0;c<b.length;c++)if(a[c]!==b[c])return!1;return!0}return a===b}(this.initialValues[c],d);f||(this.initialValues[c]=d,this.ignoredValues.indexOf(d.toString())===-1&&(e.showLoading(),a=!0))}},this),a&&(g("Onchange submit by ajax client action triggered for "+this.actionconfig.target),this.form.showLoading(),M.util.js_pending(f),this.ajaxSubmitTimeoutID=setTimeout(this.ajaxSubmitFormCallback,this.actionconfig.delay))},cancelAjaxSubmitForm:function(){g("Clearing onchange submit by ajax client action timeout for "+this.actionconfig.target),clearTimeout(this.ajaxSubmitTimeoutID),this.ajaxSubmitTimeoutID=0,M.util.js_complete(f)},ajaxSubmitForm:function(){g("Onchange submit by ajax client action occurring for "+this.actionconfig.target);var b=this.form.ajaxSubmit();this.submitHandler?this.submitHandler.apply(null,[this,b]):b.done(a.proxy(function(a,b){"submitted"===a?(g("Reloading the form to get an updated version after ajaxsubmit for "+this.actionconfig.target),this.form.reload()):e.get_strings([{key:"error",component:"error"},{key:"ok",component:"core"}]).done(function(a){d.alert(a[0],a[0],a[1])})},this)),b.done(function(){M.util.js_complete(f)}),this.ajaxSubmitTimeoutID=0},toString:function(){return"[object OnChangeAjaxSubmitAction]"}}),{init:function(a,b,c){var d=new h(a,b);d.init(),c(d)}}});
define('totara_form/form_clientaction_onchange_reload', ["jquery","totara_form/form","totara_form/clientaction_base"],function(a,b,c){var d="totara_form/form_clientaction_onchange_reload",e=function(a){var c="undefined"!=typeof arguments[1]?arguments[1]:b.LOGLEVEL.debug;b.debug(a,f,c)},f=function(){c.apply(this,arguments),this.initialValues=[],this.reloadTimeoutID=0,this.reloadFormCallback=a.proxy(this.reloadForm,this),this.ignoredValues=arguments[0].ignoredvalues||[]};return f=b.extend(c,f,{init:function(){var a=this.form.getElementById(this.actionconfig.target);return"undefined"==typeof a?void e("Unable to retrieve the element with id "+this.actionconfig.target,b.LOGLEVEL.error):(this.getWatchedIds().push(this.actionconfig.target),this.initialValues[this.actionconfig.target]=a.getValue(),void e("Registered onchange_reload client action for "+this.actionconfig.target))},checkState:function(){var a=!1;this.reloadTimeoutID&&this.cancelReloadForm(),this.getWatchedIds().forEach(function(c){if(a!==!0){e("Checking "+c+" for onchange_reload");var d,f=this.form.getElementById(c);if("undefined"==typeof f)return void e("Unable to retrieve the element with id "+this.actionconfig.target,b.LOGLEVEL.error);d=f.getValue();var g=function(a,b){var c;if(Array.isArray(a)&&Array.isArray(b)){if(a.length!==b.length)return!1;for(c=0;c<b.length;c++)if(a[c]!==b[c])return!1;return!0}return a===b}(this.initialValues[c],d);g||(this.initialValues[c]=d,this.ignoredValues.indexOf(d.toString())===-1&&(f.showLoading(),a=!0))}},this),a&&(e("Onchange reload client action triggered for "+this.actionconfig.target),this.form.showLoading(),M.util.js_pending(d),this.reloadTimeoutID=setTimeout(this.reloadFormCallback,this.actionconfig.delay))},cancelReloadForm:function(){e("Clearing onchange reload client action timeout for "+this.actionconfig.target),clearTimeout(this.reloadTimeoutID),this.reloadTimeoutID=0,M.util.js_complete(d)},reloadForm:function(){e("Onchange reload client action occurring for "+this.actionconfig.target),this.form.reload(),this.reloadTimeoutID=0,M.util.js_complete(d)},toString:function(){return"[object OnChangeReloadAction]"}}),{init:function(a,b,c){var d=new f(a,b);d.init(),c(d)}}});
define('totara_form/form_clientaction_onchange_submit', ["jquery","totara_form/form","totara_form/clientaction_base"],function(a,b,c){var d="totara_form/form_clientaction_onchange_submit",e=function(a){var c="undefined"!=typeof arguments[1]?arguments[1]:b.LOGLEVEL.debug;b.debug(a,f,c)},f=function(){c.apply(this,arguments),this.initialValues=[],this.submitTimeoutID=0,this.submitFormCallback=a.proxy(this.submitForm,this),this.ignoredValues=arguments[0].ignoredvalues||[]};return f=b.extend(c,f,{init:function(){var a=this.form.getElementById(this.actionconfig.target);return"undefined"==typeof a?void e("Unable to retrieve the element with id "+this.actionconfig.target,b.LOGLEVEL.error):(this.getWatchedIds().push(this.actionconfig.target),this.initialValues[this.actionconfig.target]=a.getValue(),void e("Registered onchange_submit client action for "+this.actionconfig.target))},checkState:function(){var c=!1;this.submitTimeoutID&&this.cancelSubmitForm(),this.getWatchedIds().forEach(function(a){if(c!==!0){e("Checking "+a+" for onchange_submit");var d,f=this.form.getElementById(a);if("undefined"==typeof f)return void e("Unable to retrieve the element with id "+this.actionconfig.target,b.LOGLEVEL.error);d=f.getValue();var g=function(a,b){var c;if(Array.isArray(a)&&Array.isArray(b)){if(a.length!==b.length)return!1;for(c=0;c<b.length;c++)if(a[c]!==b[c])return!1;return!0}return a===b}(this.initialValues[a],d);g||(this.initialValues[a]=d,this.ignoredValues.indexOf(d.toString())===-1&&(f.showLoading(),c=!0))}},this),c&&(e("Onchange submit client action triggered for "+this.actionconfig.target),this.form.showLoading(),M.util.js_pending(d),this.submitTimeoutID=setTimeout(this.submitFormCallback,this.actionconfig.delay),a(window).on("beforeunload",this.submitFormCallback))},cancelSubmitForm:function(){e("Clearing onchange submit client action timeout for "+this.actionconfig.target),clearTimeout(this.submitTimeoutID),this.submitTimeoutID=0,a(window).off("beforeunload",this.submitFormCallback),M.util.js_complete(d)},submitForm:function(){e("Onchange submit client action occurring for "+this.actionconfig.target),this.form.submit(),this.submitTimeoutID=0,a(window).off("beforeunload",this.submitFormCallback),M.util.js_complete(d)},toString:function(){return"[object OnChangeSubmitAction]"}}),{init:function(a,b,c){var d=new f(a,b);d.init(),c(d)}}});
define('totara_form/form_element_checkbox', ["jquery","totara_form/form"],function(a,b){function c(a,d,e,f){return this instanceof c?(b.Element.apply(this,arguments),void(this.input=null)):new c(a,d,e,f)}var d="totara_form-error-container",e="."+d,f=".tf_element",g=".tf_loading";return c.prototype=Object.create(b.Element.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object CheckboxElement]"},c.prototype.init=function(b){var c=a("#"+this.id);this.input=c,this.input.change(a.proxy(this.changed,this)),b()},c.prototype.getValue=function(){return this.input.is(":checked")?this.input.val():this.input.data("value-unchecked")},c.prototype.polyFillValidate=function(a){var b=this.input;b.prop("checked")?""!==b.val().trim()&&b.closest(f).find(e).remove():(a.preventDefault(),0===b.closest(f).find(e).length&&require(["core/templates","core/str","core/config"],function(a,c,d){c.get_string("required","core").done(function(c){var e={errors_has_items:!0,errors:[{message:c}]};a.render("totara_form/validation_errors",e,d.theme).done(function(a){b.parent().prepend(a)})})}))},c.prototype.showLoading=function(){this.input.siblings(g).show()},c.prototype.hideLoading=function(){this.siblings(g).hide()},c});
define('totara_form/form_element_checkboxes', ["jquery","totara_form/form"],function(a,b){function c(a,d,e,f){return this instanceof c?(b.Element.apply(this,arguments),this.container=null,void(this.inputs=null)):new c(a,d,e,f)}var d="totara_form-error-container",e="."+d;return c.prototype=Object.create(b.Element.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object CheckboxesElement]"},c.prototype.init=function(b){var c=a("#"+this.id+" input[type=checkbox]"),d=a(c[0]);if(this.container=a("#"+this.id),this.inputs=c,this.inputs.change(a.proxy(this.changed,this)),this.container.data("required")){var e='input[type="submit"]:not([formnovalidate])',f=this;c.each(function(){a(this).on("change",a.proxy(f.polyFillValidate,f))}),d.closest("form").find(e).click(a.proxy(this.polyFillValidate,this))}b()},c.prototype.getValue=function(){for(var b=[],c=0;c<this.inputs.length;c++){var d=a(this.inputs[c]);d.is(":checked")&&b.push(d.val())}return 0!==b.length&&b},c.prototype.polyFillValidate=function(b){var c=!1,d=this.container;this.inputs.each(function(b,d){a(d).prop("checked")&&(c=!0)}),c?(this.validationerroradded=!1,d.closest(".tf_element").find(e).remove()):(b.preventDefault(),this.validationerroradded||(this.validationerroradded=!0,require(["core/templates","core/str","core/config"],function(a,b,c){b.get_string("required","core").done(function(b){var e={errors_has_items:!0,errors:[{message:b}]};a.render("totara_form/validation_errors",e,c.theme).done(function(a){d.prepend(a)})})})))},c});
define('totara_form/form_element_datetime', ["jquery","totara_form/form"],function(a,b){function c(a,d,e,f){return this instanceof c?(b.Element.apply(this,arguments),void(this.input=null)):new c(a,d,e,f)}return c.prototype=Object.create(b.Element.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object DateTimeElement]"},c.prototype.init=function(b){var c=this.id,d=[];if(this.input=a("#"+c),this.input.change(a.proxy(this.changed,this)),!/Android|iPhone|iPad|iPod/i.test(navigator.userAgent)){this.input.attr("type","text");var e=a.Deferred();d.push(e),require(["totara_form/polyfill_date-lazy"],function(a){a.init(c,!0).then(function(){e.resolve()})})}a.when.apply(a,d).done(b)},c.prototype.getValue=function(){return this.input.val()},c});
define('totara_form/form_element_editor', ["jquery","totara_form/form"],function(a,b){function c(a,d,e,f){return this instanceof c?(b.Element.apply(this,arguments),void(this.input=null)):new c(a,d,e,f)}return c.prototype=Object.create(b.Element.prototype),c.constructor=c,c.prototype.toString=function(){return"[object Editor]"},c.prototype.init=function(b){this.input=a("#"+this.id),this.input.change(a.proxy(this.changed,this)),window.totara_form_editors=window.totara_form_editors||{},window.totara_form_editors[this.id]=this,b()},c.prototype.setValue=function(a){this.input.val(a),this.changed({})},c.prototype.getValue=function(){return this.input.val()},c});
define('totara_form/form_element_editor_atto', ["jquery","core/yui","core/str","totara_form/form"],function($,Y,core_strings,Form){function AttoElement(a,b,c,d){return this instanceof AttoElement?(Form.Element.apply(this,arguments),this.input=null,void(this.editor=null)):new AttoElement(a,b,c,d)}return AttoElement.prototype=Object.create(Form.Element.prototype),AttoElement.constructor=AttoElement,AttoElement.prototype.toString=function(){return"[object AttoElement]"},AttoElement.prototype.init=function(a){M.util.js_pending("totara_form_element_editor_atto");var b=this;this.input=$("#"+this.id),window.totara_form_editors=window.totara_form_editors||{},window.totara_form_editors[this.id]=this;var c=this.input.data("fptemplates"),d=this.input.data("jsmodules"),e=this.input.data("requiredstrings"),f=this.input.data("yuimodules");Y.use(["core_filepicker","node","node-event-simulate","core_dndupload"],function(a){M.core_filepicker.set_templates(a,c)}),M.yui.add_module(d),Y.applyConfig(YUI_config),core_strings.get_strings(e).done(function(){for(var a=0;a<f.length;a++)b.initYUIModules(f[a])}),a()},AttoElement.prototype.initYUIModules=function(yuimodule){var self=this;Y.use(yuimodule.modules,function(){var result=eval(yuimodule.functionstr);result&&self.setEditor(result)})},AttoElement.prototype.setEditor=function(a){if(this.editor=a,a.on("change",$.proxy(this.changed,this)),null!==this.input){var b=this.input.attr("required");"undefined"!=typeof b&&this.input.removeAttr("required")}},AttoElement.prototype.getValue=function(){return this.editor&&this.editor.updateOriginal(),this.input.val().toString()},AttoElement.prototype.setValue=function(a){this.input.val(a),this.editor&&this.editor.updateFromTextArea(),Form.debug("Atto editor value changed programmatically",this,Form.LOGLEVEL.info),this.changed({})},AttoElement.prototype.compare=function(a){var b,c=this.getValue(),d=null;switch(a){case Form.Operators.Equals:if(2!==arguments.length)return Form.debug("Compare Equals expects 2 arguments, "+arguments.length+" given.",this,Form.LOGLEVEL.warn),null;if(b=arguments[1],Array.isArray(b))return!1;d=c.toString()===b.toString()||this.stripValue(c)===b.toString();break;case Form.Operators.Empty:d=null===c||c===!1||""===c.toString()||"0"===c.toString()||""===this.stripValue(c);break;case Form.Operators.Filled:d=null!==c&&""!==c&&""!==this.stripValue(c);break;case Form.Operators.NotEquals:if(2!==arguments.length)return Form.debug("Compare NotEquals expects 2 arguments, "+arguments.length+" given.",this,Form.LOGLEVEL.warn),null;b=arguments[1],d=!this.compare(Form.Operators.Equals,b);break;case Form.Operators.NotEmpty:d=!this.compare(Form.Operators.Empty);break;case Form.Operators.NotFilled:d=!this.compare(Form.Operators.Filled);break;default:Form.debug('Element does not implement all comparisons: "'+a+'", asking the Form',this,Form.LOGLEVEL.warn);var e=[c].concat(Array.prototype.slice.call(arguments));d=Form.prototype.compare.apply(null,e)}return d},AttoElement.prototype.stripValue=function(a){return a.trim().replace(/^<p[^>]*>(.*)<\/p>$/g,"$1").replace(/<br ?\/?>/g,"").replace("&nbsp;","").trim()},AttoElement.prototype.isEmpty=function(){var a=this.getValue();return""===a||"<p></p>"===a},AttoElement.prototype.getObjectClass=function(a){if(a&&a.constructor){if(a.constructor.name)return a.constructor.name;if(a.constructor.toString){var b=a.constructor.toString().match(/function\s*(\w + )/);if(b&&2==b.length)return b[1]}}},AttoElement});
define('totara_form/form_element_email', ["jquery","totara_form/form_element_text"],function(a,b){function c(a,d,e,f){return this instanceof c?(b.apply(this,arguments),void(this.Name="Email")):new c(a,d,e,f)}return c.prototype=Object.create(b.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object EmailElement]"},c});
define('totara_form/form_element_filemanager', ["jquery","core/yui","totara_form/form"],function(a,b,c){function d(a,b,e,f){return this instanceof d?(c.Element.apply(this,arguments),void(this.input=null)):new d(a,b,e,f)}return d.prototype=Object.create(c.Element.prototype),d.prototype.constructor=d,d.prototype.toString=function(){return"[object FileManagerElement]"},d.prototype.init=function(b){this.input=a("#"+this.id);var d={};try{d=this.input.data("fmoptions")}catch(e){throw c.debug("Failed to pick up FileManager options from data attribute.",this,c.LOGLEVEL.error),e}return""===d?(c.debug("FileManager could not initialise, no options present.",this,c.LOGLEVEL.error),void b()):void require(["totara_form/element_filemanager"],function(a){a.init_filemanager(d),b()})},d});
define('totara_form/form_element_filepicker', ["jquery","core/yui","totara_form/form"],function(a,b,c){function d(a,b,e,f){return this instanceof d?(c.Element.apply(this,arguments),void(this.input=null)):new d(a,b,e,f)}return d.prototype=Object.create(c.Element.prototype),d.prototype.constructor=d,d.prototype.toString=function(){return"[object FilePickerElement]"},d.prototype.init=function(b){this.input=a("#"+this.id);var d={};try{d=this.input.data("fpoptions")}catch(e){throw c.debug("Failed to pick up FilePicker options from data attribute.",this,c.LOGLEVEL.error),e}return""===d?(c.debug("FilePicker initialisation skipped as it was frozen.",this,c.LOGLEVEL.error),void b()):void require(["totara_form/element_filepicker"],function(a){a.init_filepicker(d),b()})},d});
define('totara_form/form_element_hidden', ["totara_form/form_element_text"],function(a){function b(c,d,e,f){return this instanceof b?void a.apply(this,arguments):new b(c,d,e,f)}return b.prototype=Object.create(a.prototype),b.prototype.constructor=b,b.prototype.toString=function(){return"[object HiddenInput]"},b.prototype.Name="Hidden",b});
define('totara_form/form_element_multiselect', ["jquery","totara_form/form"],function(a,b){function c(a,d,e,f){return this instanceof c?(b.Element.apply(this,arguments),this.input=null,void(this.validationerroradded=!1)):new c(a,d,e,f)}var d="totara_form-error-container",e="."+d;return c.prototype=Object.create(b.Element.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object MultiSelect]"},c.prototype.init=function(b){var c=this.id,d=a("#"+c);this.input=d,this.input.change(a.proxy(this.changed,this)),b()},c.prototype.polyFillValidate=function(b){var c=!1,d=this.input;this.input.find("option").each(function(b,d){a(d).prop("selected")&&(c=!0)}),c?(this.validationerroradded=!1,d.closest(".tf_element").find(e).remove()):(b.preventDefault(),this.validationerroradded||(this.validationerroradded=!0,require(["core/templates","core/str","core/config"],function(a,b,c){b.get_string("required","core").done(function(b){var e={errors_has_items:!0,errors:[{message:b}]};a.render("totara_form/validation_errors",e,c.theme).done(function(a){d.parent().prepend(a)})})})))},c.prototype.getValue=function(){return this.input.val()},c});
define('totara_form/form_element_number', ["jquery","totara_form/form"],function(a,b){function c(a,d,e,f){return this instanceof c?(this.input=null,void b.Element.apply(this,arguments)):new c(a,d,e,f)}return c.prototype=Object.create(b.Element.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object NumberInputElement]"},c.prototype.init=function(b){this.input=a("#"+this.id),this.input.change(a.proxy(this.changed,this)),b()},c.prototype.getValue=function(){return this.input.val()},c});
define('totara_form/form_element_passwordunmask', ["jquery","totara_form/form"],function(a,b){function c(a,d,e,f){return this instanceof c?(this.input=null,this.unmaskinput=null,void b.Element.apply(this,arguments)):new c(a,d,e,f)}return String.prototype.repeat||(String.prototype.repeat=function(a){"use strict";if(null==this)throw new TypeError("can't convert "+this+" to object");var b=""+this;if(a=+a,a!=a&&(a=0),a<0)throw new RangeError("repeat count must be non-negative");if(a==1/0)throw new RangeError("repeat count must be less than infinity");if(a=Math.floor(a),0==b.length||0==a)return"";if(b.length*a>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");for(var c="";1==(1&a)&&(c+=b),a>>>=1,0!=a;)b+=b;return c}),c.prototype=Object.create(b.Element.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object PasswordUnmaskElement]"},c.prototype.init=function(b){var c,d=this.id,e=a("#"+d);this.input=e,this.unmaskinput=a("#"+d+"unmask"),this.wrap=this.input.parent(".wrap"),c=a('<input type="text" value="" class="inputmask" />'),this.input.attr("readonly")&&c.attr("readonly","readonly"),c.insertBefore("#"+d),this.mask=this.wrap.find(".inputmask"),this.updateMask(),this.mask.focus(function(a){e.focus()}),this.unmaskinput.change(a.proxy(this.unmask,this)),this.input.keyup(a.proxy(this.updateMask,this)),this.input.mouseup(),this.input.change(a.proxy(this.changed,this)),b()},c.prototype.updateMask=function(){this.mask.val("●".repeat(this.input.val().length))},c.prototype.unmask=function(){this.unmaskinput.is(":checked")?this.input.parents(".totara_form_element_passwordunmask").addClass("unmask-password"):this.input.parents(".totara_form_element_passwordunmask").removeClass("unmask-password")},c.prototype.getValue=function(){return this.input?this.input.val():null},c});
define('totara_form/form_element_radios', ["jquery","totara_form/form"],function(a,b){function c(a,d,e,f){return this instanceof c?(b.Element.apply(this,arguments),this.container=null,this.inputs=null,void(this.validationerroradded=!1)):new c(a,d,e,f)}var d="totara_form-error-container",e="."+d;return c.prototype=Object.create(b.Element.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object RadiosElement]"},c.prototype.init=function(b){var c=this.id,d=a("#"+c),e=a("#"+c+" input[type=radio]");this.container=d,this.inputs=e,this.inputs.change(a.proxy(this.changed,this)),b()},c.prototype.polyFillValidate=function(b){var c=!1,d=this.container;this.inputs.each(function(b,d){a(d).prop("checked")&&(c=!0)}),c?(this.validationerroradded=!1,d.closest(".tf_element").find(e).remove()):(b.preventDefault(),this.validationerroradded||(this.validationerroradded=!0,require(["core/templates","core/str","core/config"],function(a,b,c){b.get_string("required","core").done(function(b){var e={errors_has_items:!0,errors:[{message:b}]};a.render("totara_form/validation_errors",e,c.theme).done(function(a){d.prepend(a)})})})))},c.prototype.getValue=function(){for(var b=0;b<this.inputs.length;b++){var c=a(this.inputs[b]);if(c.is(":checked"))return c.val()}return!1},c.prototype.showLoading=function(){a(this.inputs).filter(":checked").siblings(".tf_loading").show()},c.prototype.hideLoading=function(){this.inputs.siblings(".tf_loading").hide()},c});
define('totara_form/form_element_select', ["jquery","totara_form/form"],function(a,b){function c(a,d,e,f){return this instanceof c?(b.Element.apply(this,arguments),this.input=null,void(this.validationerroradded=!1)):new c(a,d,e,f)}var d="totara_form-error-container",e="."+d;return c.prototype=Object.create(b.Element.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object SelectElement]"},c.prototype.init=function(b){this.input=a("#"+this.id),this.input.change(a.proxy(this.changed,this)),b()},c.prototype.polyFillValidate=function(b){var c=!1,d=this.input;d.find("option").each(function(b,d){a(d).prop("selected")&&""!==a(d).val()&&(c=!0)}),c?(this.validationerroradded=!1,d.closest(".tf_element").find(e).remove()):(b.preventDefault(),this.validationerroradded||(this.validationerroradded=!0,require(["core/templates","core/str","core/config"],function(a,b,c){b.get_string("required","core").done(function(b){var e={errors_has_items:!0,errors:[{message:b}]};a.render("totara_form/validation_errors",e,c.theme).done(function(a){d.parent().prepend(a)})})})))},c.prototype.getValue=function(){return this.input.val()},c.prototype.showLoading=function(){this.input.siblings(".tf_loading").show()},c.prototype.hideLoading=function(){this.siblings(".tf_loading").hide()},c});
define('totara_form/form_element_static_html', ["jquery","totara_form/element_generic"],function(a,b){function c(a,d,e,f){return this instanceof c?void b.apply(this,arguments):new c(a,d,e,f)}return c.prototype=Object.create(b.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object StaticHTML]"},c.prototype.Name="StaticHTML",c});
define('totara_form/form_element_tel', ["jquery","totara_form/form_element_text"],function(a,b){function c(a,d,e,f){return this instanceof c?void b.apply(this,arguments):new c(a,d,e,f)}return c.prototype=Object.create(b.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object TelElement]"},c.prototype.Name="Tel",c.prototype.isValid=function(){return this.getValue().match(/d+/)},c});
define('totara_form/form_element_text', ["jquery","totara_form/form"],function(a,b){function c(a,d,e,f){return this instanceof c?(b.Element.apply(this,arguments),void(this.input=null)):new c(a,d,e,f)}return c.prototype=Object.create(b.Element.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object TextElement]"},c.prototype.init=function(b){this.input=a("#"+this.id),this.input.change(a.proxy(this.changed,this)),b()},c.prototype.getValue=function(){return this.input.val()},c.prototype.isEmpty=function(){var a=this.getValue();return""===a.toString().trim()||!!a.hasOwnProperty("isEmpty")&&a.isEmpty()},c.prototype.compare=function(a){var c,d=this.getValue();switch(a){case b.Operators.Equals:return 2!==arguments.length?(b.debug("Compare Equals expects 2 arguments, "+arguments.length+" given.",this,b.LOGLEVEL.warn),null):(c=arguments[1],!Array.isArray(c)&&d.toString().trim()===c.toString().trim());case b.Operators.Empty:return this.isEmpty();case b.Operators.Filled:return d=d.toString().trim(),""!==d&&"false"!==d.toLowerCase()&&!/^[0]*$/.test(d);case b.Operators.NotEquals:return 2!==arguments.length?(b.debug("Compare NotEquals expects 2 arguments, "+arguments.length+" given.",this,b.LOGLEVEL.warn),null):(c=arguments[1],!this.compare(b.Operators.Equals,c));case b.Operators.NotEmpty:return!this.isEmpty();case b.Operators.NotFilled:return!this.compare(b.Operators.Filled);default:b.debug('Element does not implement all comparisons: "'+a+'", asking the Form',this,b.LOGLEVEL.warn);var e=[d].concat(arguments);return b.Element.prototype.compare.apply(this,e)}},c});
define('totara_form/form_element_textarea', ["jquery","totara_form/form_element_text"],function(a,b){function c(a,d,e,f){return this instanceof c?void b.apply(this,arguments):new c(a,d,e,f)}return c.prototype=Object.create(b.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object TextAreaElement]"},c.prototype.Name="Textarea",c});
define('totara_form/form_element_url', ["totara_form/form_element_text"],function(a){function b(c,d,e,f){return this instanceof b?void a.apply(this,arguments):new b(c,d,e,f)}return b.prototype=Object.create(a.prototype),b.prototype.constructor=b,b.prototype.toString=function(){return"[object URLElement]"},b.prototype.Name="URL",b});
define('totara_form/form_element_utc10date', ["jquery","totara_form/form"],function(a,b){function c(a,d,e,f){return this instanceof c?(b.Element.apply(this,arguments),void(this.input=null)):new c(a,d,e,f)}return c.prototype=Object.create(b.Element.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object UTC10Date]"},c.prototype.init=function(b){var c=this.id,d=[];if(this.input=a("#"+c),this.input.change(a.proxy(this.changed,this)),!/Android|iPhone|iPad|iPod/i.test(navigator.userAgent)){var e=a.Deferred();this.input.attr("type","text"),d.push(e),require(["totara_form/polyfill_date-lazy"],function(a){a.init(c,!1).done(function(){e.resolve()})})}a.when.apply(a,d).done(b)},c.prototype.getValue=function(){return this.input.val()},c});
define('totara_form/form_element_yesno', ["totara_form/form_element_radios"],function(a){function b(c,d,e,f){return this instanceof b?void a.apply(this,arguments):new b(c,d,e,f)}return b.prototype=Object.create(a.prototype),b.prototype.constructor=b,b.prototype.toString=function(){return"[object YesNoElement]"},b.prototype.Name="YesNo",b});
define('totara_form/form_group_section', ["jquery","totara_form/form","core/str","core/templates"],function(a,b,c,d){function e(a,c,d){return this instanceof e?(b.Group.call(this,a,c,d),this.fieldset=null,this.legend=null,this.input=null,void(this.link=null)):new e(a,c,d)}return e.prototype=Object.create(b.Group.prototype),e.prototype.constructor=e,e.prototype.toString=function(){return"[object SectionGroup]"},e.prototype.init=function(b){if(this.fieldset=a("#"+this.id),this.legend=a("#"+this.id+" legend.tf_section_legend"),this.input=a("#"+this.id+" input.tf_section_collapsible"),!this.fieldset.hasClass("collapsed")&&!this.fieldset.hasClass("collapsible"))return void b();var c=this;this.fieldset.hasClass("collapsed")?(this.legend.html('<a href="#" role="button" aria-expanded="false">'+this.legend.html()+"</a>"),d.renderIcon("collapsed").done(function(a){c.fieldset.hasClass("collapsed")&&(c.legend.find(".flex-icon").remove(),c.legend.prepend(a))})):(this.legend.html('<a href="#" role="button" aria-expanded="true">'+this.legend.html()+"</a>"),d.renderIcon("expanded").done(function(a){c.fieldset.hasClass("collapsible")&&(c.legend.find(".flex-icon").remove(),c.legend.prepend(a))})),this.link=a("#"+this.id+" legend.tf_section_legend a"),this.link.click(a.proxy(this.toggleCollapsed,this)),e.instances.push(this),e.instancecount++,2===e.instancecount&&e.addExpandAll(this.getForm()),b()},e.prototype.toggleCollapsed=function(a){a.preventDefault(),this.fieldset.hasClass("collapsed")?this.expand():this.collapse()},e.prototype.expand=function(){b.debug("Expanding section "+this.legend.text(),this,b.LOGLEVEL.debug),this.fieldset.removeClass("collapsed"),this.fieldset.addClass("collapsible"),this.link.attr("aria-expanded","true"),this.input.val(1);var a=this;d.renderIcon("expanded").done(function(b){a.fieldset.hasClass("collapsible")&&(a.legend.find(".flex-icon").remove(),a.legend.prepend(b))})},e.prototype.collapse=function(){b.debug("Collapsing section "+this.legend.text(),this,b.LOGLEVEL.debug),this.fieldset.addClass("collapsed"),this.fieldset.removeClass("collapsible"),this.link.attr("aria-expanded","false"),this.input.val(0);var a=this;d.renderIcon("collapsed").done(function(b){a.fieldset.hasClass("collapsed")&&(a.legend.find(".flex-icon").remove(),a.legend.prepend(b))})},e.getValue=function(){return null},e.instancecount=0,e.instances=[],e.expandallcontrol=null,e.addExpandAll=function(f){b.debug("Adding expand/collapse all for sections",this,b.LOGLEVEL.info);var g='<div class="collapsible-actions form-section-expandall-control">';g+='<a href="#" class="collapseexpand" role="button" aria-controls="">&nbsp;-&nbsp;</a>',g+="</div>",f.form.prepend(g),e.expandallcontrol=a(".form-section-expandall-control"),a.when(c.get_string("expandall"),d.renderIcon("collapsed")).done(function(a,b){e.expandallcontrol.find("a").html(b+a)}),e.expandallcontrol.click(a.proxy(this.toggleAll,this)),e.expandallcontrol.data("state","expand")},e.toggleAll=function(b){b.preventDefault();var f,g,h=e.expandallcontrol,i=h.data("state"),j=h.find("a"),k="expand"===i;for(f=0;f<e.instances.length;f++)g=e.instances[f],k?g.expand():g.collapse();k?(h.data("state","collapse"),j.addClass("collapse-all"),a.when(c.get_string("collapseall","core"),d.renderIcon("expanded")).done(function(a,b){j.hasClass("collapse-all")&&j.html(b+a)})):(h.data("state","expand"),j.removeClass("collapse-all"),a.when(c.get_string("expandall","core"),d.renderIcon("collapsed")).done(function(a,b){j.hasClass("collapse-all")||j.html(b+a)}))},e});
define('totara_form/form_group_wizard', ["jquery","totara_form/form","core/templates"],function(a,b){function c(a,d,e){return this instanceof c?(b.Group.apply(this,arguments),void(this.node=e)):new c(a,d,e)}return c.prototype=Object.create(b.Group.prototype),c.constructor=c,c.prototype.toString=function(){return"[object Wizard]"},c.prototype.init=function(b){var c,d=this.getForm(),e=a(this.node),f=e.attr("data-element-id"),g=a("#"+f).attr("data-element-name"),h='[name="'+g+'__changestage"]',i=a(h),j=this,k=a("#"+f+" .tf_wizard_progress"),l="cancelled";a(d.node).on("click",'[name="changestage"]',function(b){b.preventDefault(),c=a(this).data("jump-to-stage"),j.changeStage(d,i,c)}),a(d.node).on("click",'[name="submitbutton"]',function(a){a.preventDefault(),d.submit()}),a(d.node).on("click",'[name="cancelbutton"]',function(a){a.preventDefault(),i.val(l),d.submit()}),k.on("click",".tf_wizard_progress_bar_item",function(b){b.preventDefault(),a(this).hasClass("tf_wizard_progress_bar_item_jumpable")&&(c=a(this).data("jump-to-stage"),j.changeStage(d,i,c))}),b()},c.prototype.changeStage=function(a,b,c){b.val(c),a.reload()},c});
define('totara_hierarchy/competency_item', ["jquery","core/config","core/str"],function(a,b,c){var d=function(){},e=function(e,f){c.get_string("assignrelatedcompetencies","totara_hierarchy").done(function(a){var c=b.wwwroot+"/totara/hierarchy/prefix/competency/related/";totaraMultiSelectDialog("related",a,c+"find.php?sesskey="+b.sesskey+"&id="+e,c+"save.php?sesskey="+b.sesskey+"&id="+e+"&deleteexisting=1&add=")}),d.prototype=new totaraDialog_handler_treeview_multiselect,d.prototype._update=function(b){this._dialog.hide(),a(".noitems-"+this._title).remove();var c=a(b).find("#list-evidence"),d=a("#list-evidence");d.length?d.replaceWith(c):a("div#evidence-list-container").append(c)};var g=b.wwwroot+"/totara/hierarchy/prefix/competency/evidenceitem/",h=g+"add.php?sesskey="+b.sesskey+"&competency="+e+"&type=coursecompletion&instance=0&deleteexisting=1&update=",i={},j=new d;j.baseurl=g;var k=[];k.push({key:"save",component:"totara_core"}),k.push({key:"cancel",component:"moodle"}),k.push({key:"assigncoursecompletions",component:"totara_hierarchy"}),c.get_strings(k).done(function(a){for(var b=[],c=0;c<k.length;c++)b[k[c].key]=a[c];i[b.save]=function(){j._save(h)},i[b.cancel]=function(){j._cancel()},totaraDialogs.evidence=new totaraDialog("evidence","show-evidence-dialog",{buttons:i,title:"<h2>"+b.assigncoursecompletions+"</h2>"},g+"edit.php?id="+e,j)})};return{item:function(b,c){var d=a.Deferred();d.done(function(){e(b,c)}),window.dialogsInited?d.resolve():(a.isArray(window.dialoginits)||(window.dialoginits=[]),window.dialoginits.push(d.resolve))},template:function(d){var e=a.Deferred();e.done(function(){var a=b.wwwroot+"/totara/hierarchy/prefix/competency/template/";c.get_string("assignnewcompetency","competency").done(function(b){totaraMultiSelectDialog("assignment","<h2>"+b+"</h2>",a+"find_competency.php?templateid="+d,a+"save_competency.php?templateid="+d+"&deleteexisting=1&add=")})}),window.dialogsInited?e.resolve():(a.isArray(window.dialoginits)||(window.dialoginits=[]),window.dialoginits.push(e.resolve))}}});
define('totara_hierarchy/hierarchyitems', ["jquery","core/config"],function(a,b){var c={init:function(b){var d=".list-linkedcompetencies .linktype, #list-evidence .linktype, #list-coursecompetency .menulinktype";a(document).on("change",d,function(){c._update_linktype(b,a(this).data("id"),a(this).val())})},_update_linktype:function(c,d,e){var f={type:c,c:d,sesskey:b.sesskey,t:e};a.get(b.wwwroot+"/totara/plan/update-linktype.php",f)}};return c});
define('totara_hierarchy/mygoals', ["jquery","core/config"],function(a,b){var c={init_company:function(b,d){a("#companygoals").on("change",".company_scalevalue_selector",function(){c._update_goal(b,d,a(this).data("goalid"),a(this).val())})},init_personal:function(b,d){a("#personalgoals").on("change",".personal_scalevalue_selector",function(){c._update_goal(b,d,a(this).data("goalid"),a(this).val())})},init_single_personal:function(b,d){a("#page-totara-hierarchy-prefix-goal-item-view .personal_scalevalue_selector").change(function(){c._update_goal(b,d,a(this).data("goalid"),a(this).val())})},_update_goal:function(c,d,e,f){var g={scope:d,sesskey:b.sesskey,goalitemid:e,userid:c,scalevalueid:f};a.get(b.wwwroot+"/totara/hierarchy/prefix/goal/update-scalevalue.php",g)}};return c});
define('totara_job/job_management_listing', ["core/notification","core/str","core/webapi"],function(a,b,c){function d(b,c){var d=this;this.userid=b,this.container=c,this.container.setAttribute("data-enhanced","true"),this.container.addEventListener("click",function(b){if(b.target){var c,e,f,h=b.target.closest("a[data-action]");if(h){if(b.preventDefault(),b.stopPropagation(),e=h.closest("li"),!e)return void a.alert("Could not find clicked job list item");if(f=e.querySelector("a.editjoblink"),!f)return void a.alert("Could not find clicked job list item link");if(c=f.dataset.id,!c)return void a.alert("Could not find clicked job assignment id");switch(h.dataset.action){case g.up:d.moveAssignmentUp(c);break;case g.down:d.moveAssignmentDown(c);break;case g.deleteItem:d.confirmDelete(c);break;default:a.alert("No valid action found")}}}})}const e="totara_job",f={getAssignment:"totara_job_assignment",deleteAssignment:"totara_job_delete_assignment",sortAssignments:"totara_job_sort_assignments"},g={up:"up",down:"down",deleteItem:"delete"},h={containers:function(a){return document.querySelectorAll('[data-enhance="job-management-listing"][data-enhanced="false"][data-userid="'+a+'"]')},jobListItem:function(b,c){var d,e=b.querySelector('ul a.editjoblink[data-id="'+c+'"]');return e?(d=e.closest("li"),d?d:(a.alert("Could not find job list item"),!1)):(a.alert("Could not find job list item link"),!1)},moveJobItemUp:function(a,b,c){var d=h.jobListItem(a,b),e=d.closest("ul"),f=d.previousElementSibling;null!==e&&null!==f&&(e.insertBefore(d,f),c=c===!0||"current"===c?d:f,c.classList.add("highlight"),setTimeout(function(){c.classList.remove("highlight")},500))},itemIds:function(a){var b=[],c=a.querySelectorAll("ul.joblist > li > a"),d=0;for(d=0;d<c.length;d++)b.push(c[d].dataset.id);return b},itemIndex:function(a,b){return b.findIndex(function(b){return b.toString()===a.toString()})}};return d.prototype.userid=null,d.prototype.container=null,d.prototype.confirmDelete=function(d){var g=this;M.util.js_pending(f.getAssignment),c.call({operationName:f.getAssignment,variables:{assignmentid:d}}).then(function(c){var h=c[f.getAssignment],i=[{key:"deletejobassignment",component:e,param:null,lang:null},{key:"confirmdeletejobassignment",component:e,param:h.fullname,lang:null},{key:"yesdelete",component:"totara_core",param:null,lang:null},{key:"cancel",component:"core",param:null,lang:null}];h.staffcount&&h.tempstaffcount?(i.push({key:"warningstaffaffectednote",component:e,param:null,lang:null}),i.push({key:"warningallstafftypeassigned",component:e,param:{countstaffassigned:h.staffcount,counttempstaffassigned:h.tempstaffcount},lang:null})):h.staffcount?i.push({key:"warningstaffassigned",component:e,param:h.staffcount,lang:null}):h.tempstaffcount&&i.push({key:"warningtempstaffassigned",component:e,param:h.tempstaffcount,lang:null}),b.get_strings(i).done(function(b){var c=b[1];b[4]&&(c+="\n"+b[4]),b[5]&&(c+="\n"+b[5]),a.confirm(b[0],c,b[2],b[3],function(){g.deleteAssignment(d)}),setTimeout(function(){M.util.js_complete(f.getAssignment)},100)})})},d.prototype.deleteAssignment=function(a){var b=this;M.util.js_pending(f.deleteAssignment),c.call({operationName:f.deleteAssignment,variables:{userid:this.userid,assignmentid:a}}).then(function(){var c=h.jobListItem(b.container,a);c.parentElement.removeChild(c),b.container.setAttribute("data-jobcount",h.itemIds(b.container).length),M.util.js_complete(f.deleteAssignment)},function(){M.util.js_complete(f.deleteAssignment)})},d.prototype.moveAssignmentUp=function(a){var b=this,c=h.itemIds(this.container),d=h.itemIndex(a,c)-1;d<0||(c.splice(d,2,a.toString(),c[d]),this.sortAssignments(c,function(){h.moveJobItemUp(b.container,a,!0)}))},d.prototype.moveAssignmentDown=function(a){var b,c=this,d=h.itemIds(this.container),e=h.itemIndex(a,d);e>=d.length||(b=d[e+1],d.splice(e,2,b,a.toString()),this.sortAssignments(d,function(){h.moveJobItemUp(c.container,b,!1)}))},d.prototype.sortAssignments=function(a,b){M.util.js_pending(f.sortAssignments),c.call({operationName:f.sortAssignments,variables:{userid:this.userid,assignmentids:a}}).then(function(){b(),M.util.js_complete(f.sortAssignments)},function(){M.util.js_complete(f.sortAssignments)})},{init:function(a){var b=h.containers(a),c=0;for(c=0;c<b.length;c++)new d(a,b[c])}}});
define('totara_msteams/config_tab', ["core/ajax","core/log","core/templates"],function(a,b,c){function d(a){var b="totara_msteams:config_tab:";return b+=1===arguments.length?a:Array.prototype.reduce.call(arguments,function(a,b){return a+":"+b}),M.util.js_pending(b),function(){M.util.js_complete(b)}}function e(a,b){var c,d="totara_msteams:config_tab:debounce:"+ ++g;return function(){var e=this,f=arguments,g=function(){c=null,a.apply(e,f),M.util.js_complete(d)};c?clearTimeout(c):M.util.js_pending(d),c=setTimeout(g,b||0)}}function f(a){this._init(a)}var g=0;return function(){function a(a){var b=getComputedStyle(a);return["height","marginTop","marginBottom","paddingTop","paddingBottom"].reduce(function(a,c){return a+parseFloat(b[c])},0)}function b(a){return null===a?"":a.getAttribute(g.URL)}function d(a){return null===a?"":a.getAttribute(g.TITLE)}var e={TAB:9,ENTER:13,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40},f={LOADING:"totara_msteams_form__list--loading",LIST_ITEM:"totara_msteams_form__list__item",LIST_ITEM_ACTIVE:"totara_msteams_form__list__item--active",DOT_LIST_ITEM:".totara_msteams_form__list__item",DOT_LIST_ITEM_EMPTY:".totara_msteams_form__list__item--empty",DOT_LIST_SPINNER:".totara_msteams_form__list__spinner"},g={URL:"data-url",TITLE:"data-title"},h=0;this._init=function(a){this.el=a,this.el.addEventListener("scroll",this._onScroll.bind(this)),this.el.addEventListener("focus",this._onFocus.bind(this)),this.el.addEventListener("mousedown",this._onMouseDown.bind(this)),this.el.addEventListener("keydown",this._onKeyDown.bind(this)),this._id=++h,this._request=0,this._more=!1,this._loadingMore=!1,this._selectedItem=null,this._searchText="",this._timerClear=null,this._fetchLimit=10,this._calcLimit(),this.refresh()},this.getSelectedUrl=function(){return b(this._selectedItem)},this.getSelectedTitle=function(){return d(this._selectedItem)},this.refresh=function(a,b){"undefined"==typeof a&&(a=0),"undefined"==typeof b&&(b=this._fetchLimit),this._clearIncrementalSearchState(),0===a&&Array.prototype.forEach.call(this.el.querySelectorAll(f.DOT_LIST_ITEM_EMPTY),function(a){a.parentNode.removeChild(a)});var c=this._getAllItems(),d=c.indexOf(this._selectedItem);d!==-1&&d>=a&&this._selectItem(null,!1),a<c.length&&c.splice(a).forEach(function(a){a.parentNode.removeChild(a)}),this.el.classList.add(f.LOADING),this._loadingMore=!1,this._fireEventLoad(a,b)},this._calcLimit=function(){var b=document.createElement("li");b.className=f.LIST_ITEM,this.el.appendChild(b);var c=a(b);this.el.removeChild(b),c<=0?this._fetchLimit=10:this._fetchLimit=Math.ceil(this.el.clientHeight/c*1.25)+1},this._selectFirstItem=function(){var a=this._getAllItems();this._selectItem(a.length?a[0]:null,!0)},this._selectLastItem=function(){var a=this._getAllItems();this._selectItem(a.length?a[a.length-1]:null,!0)},this._getAllItems=function(){return Array.prototype.slice.apply(this.el.querySelectorAll(f.DOT_LIST_ITEM))},this._selectItem=function(a,b){if(a!==this._selectedItem){b&&this._clearIncrementalSearchState();var c=null;if(this._getAllItems().forEach(function(b){b===a?(b.classList.add(f.LIST_ITEM_ACTIVE),b.setAttribute("aria-selected",!0),c=a):(b.classList.remove(f.LIST_ITEM_ACTIVE),b.removeAttribute("aria-selected"))}),this._selectedItem=c,c){if(this.el.setAttribute("aria-activedescendant",c.id),this.el.scrollHeight>this.el.clientHeight){var d=this.el.scrollTop+this.el.clientHeight,e=c.offsetTop+c.offsetHeight;e>d?this.el.scrollTop=e-this.el.clientHeight:c.offsetTop<this.el.scrollTop&&(this.el.scrollTop=c.offsetTop)}}else this.el.removeAttribute("aria-activedescendant");this._fireEventChange(c)}},this._updateCallback=function(a){var b=this;return new Promise(function(d){var e=function(c){var e=document.createElement("ul");e.innerHTML=c;for(var g=b.el.querySelector(f.DOT_LIST_SPINNER),h=0,i=e.querySelectorAll(f.DOT_LIST_ITEM+","+f.DOT_LIST_ITEM_EMPTY),j=i.length;h<j;h++)b.el.insertBefore(i[h],g);b._getAllItems().forEach(function(a,c){a.id="msteams_listbox_"+b._id+"_"+c}),b._more=a.more,b._loadingMore=!1,b.el.classList.remove(f.LOADING),d()};c.render("totara_msteams/listbox_items",a).done(e)})},this._fireEventLoad=function(a,b){var c=++this._request,d=new CustomEvent("listbox:requestitems",{bubbles:!0,detail:{update:function(a){return c===this._request?this._updateCallback(a):Promise.resolve()}.bind(this),from:a,limit:b}});this.el.dispatchEvent(d)},this._fireEventChange=function(a){var c={target:a};Object.defineProperties(c,{url:{get:function(){return b(a)}},title:{get:function(){return d(a)}}});var e=new CustomEvent("listbox:change",{bubbles:!0,detail:c});this.el.dispatchEvent(e)},this._onScroll=function(){if(this._more&&!this._loadingMore){var a=this.el.scrollTop+this.el.clientHeight,b=this.el.scrollHeight;if(b-10<=a){this._loadingMore=!0,this.el.classList.add(f.LOADING);var c=this.el.querySelector(f.DOT_LIST_SPINNER);this.el.scrollTop=c.offsetTop+c.offsetHeight-this.el.clientHeight,this._fireEventLoad(this._getAllItems().length,this._fetchLimit)}}},this._onFocus=function(){null===this._selectedItem&&this._selectFirstItem()},this._onMouseDown=function(a){if(a.buttons%2!==0){var b=a.target.closest(f.DOT_LIST_ITEM);b&&this._selectItem(b,!0)}},this._onKeyDown=function(a){var b=a.which||a.keyCode;switch(b){case e.HOME:return a.preventDefault(),void this._selectFirstItem();case e.END:return a.preventDefault(),void this._selectLastItem();case e.DOWN:case e.UP:return a.preventDefault(),void this._onKeyUpOrDown(a);case e.ESCAPE:return a.preventDefault(),void this._clearIncrementalSearchState()}if(1===(""+a.key).length){a.preventDefault();var c=this._incrementalSearchItem(a.key);null!==c&&this._selectItem(c,!1)}},this._onKeyUpOrDown=function(a){var b=this._getAllItems(),c=b.indexOf(this._selectedItem);c!==-1&&(c=a.keyCode==e.UP?Math.max(0,c-1):Math.min(b.length-1,c+1),this._selectItem(b[c],!0))},this._incrementalSearchItem=function(a){var b=this._getAllItems(),c=b.indexOf(this._selectedItem);this._searchText+=a,this._initiateTimer(),c!==-1&&1!==this._searchText.length||++c;for(var e=0,f=b.length,g=this._searchText.toUpperCase();e<f;e++){var h=b[(c+e)%f],i=d(h).toUpperCase();if(0===i.indexOf(g))return h}return null},this._initiateTimer=function(){var a=this;this._timerClear&&clearTimeout(this._timerClear),a._timerClear=setTimeout(function(){a._timerClear=null,a._searchText=""},700)},this._clearIncrementalSearchState=function(){this._timerClear&&(clearTimeout(this._timerClear),this._timerClear=null),this._searchText=""}}.call(f.prototype),{form:null,name:null,search:null,list:null,inList:!1,debug:!1,init:function(a){var b=this,e=d("init");return new Promise(function(d){function g(){c.render("totara_msteams/config_tab",a.context).done(function(g,h){var i=document.getElementById(a.id);i.innerHTML=g,c.runTemplateJS(h).then(function(){b.form=i.querySelector(".totara_msteams__config"),b.form.addEventListener("listbox:change",b._onChange.bind(b)),b.form.addEventListener("listbox:requestitems",b._onRequestItems.bind(b)),b.name=document.getElementById(a.context.name.id),b.name.addEventListener("input",b._onNameInput.bind(b)),b.search=document.getElementById(a.context.search.id),b.search.addEventListener("input",b._onSearchInput.bind(b)),b.list=new f(document.getElementById(a.context.list.idlist)),setTimeout(function(){var a=i.querySelector("[autofocus]");a&&a.focus(),e()},1),d()})})}microsoftTeams.initialize(g)})},_onSearchInput:e(function(){this.list.refresh()},400),_onNameInput:function(){this.inList||this._update()},_onChange:function(a){this.name.value=a.detail.title,this.inList=!0;var b=new CustomEvent("input",{bubbles:!0});this.name.dispatchEvent(b),this.inList=!1,this._update()},_onRequestItems:function(c){var e=d("requestItems"),f=a.call([{methodname:"totara_msteams_search_catalog",args:{query:this.search.value,from:c.detail.from,limit:c.detail.limit}}],!0,!0);f[0].then(function(a){c.detail.update(a).then(e)["catch"](function(a){b.error(a)})}).fail(function(a){b.error(a)})},_update:function(){var a=null,b=this.name.value;if(b){var e=this.list.getSelectedUrl();e&&0===e.indexOf(M.cfg.wwwroot)&&(a={contentUrl:M.cfg.wwwroot+"/totara/msteams/tabs/customtab.php?url="+encodeURIComponent(e),websiteUrl:e,suggestedTabName:b})}if(a){var f=this;microsoftTeams.settings.setValidityState(!0),microsoftTeams.settings.registerOnSaveHandler(function(b){var e=d("update");c.render("totara_msteams/spinner",{}).done(function(c){f.form.innerHTML=c,microsoftTeams.settings.setSettings(a),b.notifySuccess(),e()})})}else microsoftTeams.settings.setValidityState(!1)}}});
define('totara_msteams/input', [],function(){return{init:function(a){function b(){a.classList.add("totara_msteams--validated"),a.classList.toggle("totara_msteams--valid",!!d.value.length)}function c(a){var c=a.target.closest(".totara_msteams_form__input__field__control");c===d&&b()}var d=a.querySelector(".totara_msteams_form__input__field__control");return a.addEventListener("input",c),a.addEventListener("focusout",c),Promise.resolve()}}});
define('totara_plan/component', ["jquery","core/config"],function(a,b){var c={config:{},totaraDialog_handler_preRequisite:null,currentReq:null,init:function(b){b&&("string"==typeof b&&(b=a.parseJSON(b)),c.config=b),c.add_handlers(),c.totaraDialog_handler_preRequisite=function(){};const d="initialise_component_totara_dialog";var e=function(){c.totaraDialog_handler_preRequisite.prototype=new totaraDialog_handler_treeview_multiselect,c.totaraDialog_handler_preRequisite.prototype._update=function(a){this._dialog.hide(),c.totara_totara_plan_update(a)},M.util.js_complete(d)};M.util.js_pending(d),window.dialogsInited?e():(window.dialoginits=window.dialoginits||[],window.dialoginits.push(e))},add_handlers:function(){var d=this;jQuery("table.dp-plan-component-items input, table.dp-plan-component-items select").change(function(){var e={updatesettings:"1",ajax:"1",sesskey:b.sesskey,page:c.config.page};e[a(this).attr("name")]=a(this).val();var f=d.currentReq=a.post(b.wwwroot+"/totara/plan/component.php?id="+c.config.plan_id+"&c="+c.config.component_name+"&page="+c.config.page,e).done(function(a){d.currentReq===f&&c.totara_totara_plan_update(a)})})},totara_totara_plan_update:function(b){a(".noitems-assign"+c.config.component_name).remove();var d=a(b).find("table.dp-plan-component-items"),e=a(b).filter(".plan_box"),f=a(b).filter(".paging")[0],g=a("form#dp-component-update table.dp-plan-component-items"),h=a(b).filter("span.noitems-assign"+c.config.component_name),i=a("div#dp-component-update-submit");h.length?(a("form#dp-component-update div#dp-component-update-table").append(h),g.empty(),i.hide()):g.length?(g.replaceWith(d),i.show()):(a("form#dp-component-update div#dp-component-update-table").append(d),i.show()),a("div.plan_box").replaceWith(e),a(".paging").replaceWith(f),c.add_handlers(),require(["core/str"],function(a){a.get_string("datepickerlongyeardisplayformat","totara_core").done(function(a){M.totara_core.build_datepicker(null,"[id^=duedate_"+c.config.component_name+"]",a)})})}};return c});
define('totara_plan/components_competency_find', ["jquery","core/str","totara_plan/component","core/config","core/notification"],function(a,b,c,d,e){return{init:function(f,g,h){c.init({plan_id:f,page:g,component_name:h});const i="initialise_competency_find_dialog";var j=function(){var g=function(){this.baseUrl="",this.standardButtons={},this.continueButtons={},this.continuesaveButtons={}};g.prototype=new c.totaraDialog_handler_preRequisite,g._open=function(){var a=comp_update_allowed?this.continueButtons:this.standardButtons;this._dialog.dialog.dialog("option","buttons",a)},g.prototype._continue=function(c){const d=a(".selected > div > span",this._container),f=this._get_ids(d).join(",");return f?void this._dialog._request(c+f,{object:this,method:"_continueRender"}):void b.get_string("error:nocompetency","totara_program").done(function(a){e.alert("",a)})},g.prototype._continueRender=function(a){if("NOCOURSES"===a.substring(0,9)){const b=this.continueskipurl+a.substr(10);return this._dialog._request(b,{object:this,method:"_update"}),!1}return this._dialog.dialog.dialog("option","buttons",this.continuesaveButtons),!0},totaraDialog_handler.prototype._continueSave=function(b){const c=a("form",g._container).serialize();this._dialog._request(b+c,{object:this,method:"_update"})};const h=d.wwwroot+"/totara/plan/components/competency/",j=h+"confirm.php?sesskey="+d.sesskey+"&id="+f+"&update=",k=h+"update.php?sesskey="+d.sesskey+"&id="+f+"&update=",l=k+"id="+f+"&update=",m=h+"update.php?",n=new g;n.baseurl=h,n.continueskipurl=l;const o=[{key:"save",component:"totara_core"},{key:"cancel",component:"moodle"},{key:"continue",component:"moodle"},{key:"addcompetencys",component:"totara_plan"}];b.get_strings(o).done(function(a){const b=a[0],c=a[1],d=a[2];n.standardButtons[b]=function(){n._save(k)},n.standardButtons[c]=function(){n._cancel()},n.continueButtons[d]=function(){n._continue(j)},n.continueButtons[c]=function(){n._cancel()},n.continuesaveButtons[b]=function(){n._continueSave(m)},n.continuesaveButtons[c]=function(){n._cancel()},totaraDialogs.evidence=new totaraDialog("assigncompetencies","show-competency-dialog",{buttons:comp_update_allowed?n.continueButtons:n.standardButtons,title:"<h2>"+a[3]+"</h2>"},h+"find.php?id="+f,n),M.util.js_complete(i)})};M.util.js_pending(i),window.dialogsInited?j():(window.dialoginits=window.dialoginits||[],window.dialoginits.push(j))}}});
define('totara_plan/components_course_find', ["core/config","core/str","totara_plan/component"],function(a,b,c){return{init:function(d,e,f){const g=a.wwwroot+"/totara/plan/components/course/",h=g+"update.php?sesskey="+a.sesskey+"&id="+d+"&update=";c.init({plan_id:d,page:e,component_name:f});const i="initialise_course_find_dialog";var j=function(){const a=new c.totaraDialog_handler_preRequisite;a.baseurl=g;const e={},f=[{key:"save",component:"totara_core"},{key:"cancel",component:"moodle"},{key:"addcourses",component:"totara_plan"}];b.get_strings(f).done(function(b){e[b[0]]=function(){a._save(h)},e[b[1]]=function(){a._cancel()},totaraDialogs.evidence=new totaraDialog("assigncourses","show-course-dialog",{buttons:e,title:"<h2>"+b[2]+"</h2>"},g+"find.php?id="+d,a),M.util.js_complete(i)})};M.util.js_pending(i),window.dialogsInited?j():(window.dialoginits=window.dialoginits||[],window.dialoginits.push(j))}}});
define('totara_plan/components_program_find', ["core/config","core/str","totara_plan/component"],function(a,b,c){return{init:function(d,e,f){const g=a.wwwroot+"/totara/plan/components/program/",h=g+"update.php?sesskey="+a.sesskey+"&id="+d+"&update=";c.init({plan_id:d,page:e,component_name:f});const i="initialise_program_find_dialog";var j=function(){const a=new c.totaraDialog_handler_preRequisite;a.baseurl=g;const e={},f=[{key:"save",component:"totara_core"},{key:"cancel",component:"moodle"},{key:"addprograms",component:"totara_plan"}];b.get_strings(f).done(function(b){e[b[0]]=function(){a._save(h)},e[b[1]]=function(){a._cancel()},totaraDialogs.evidence=new totaraDialog("assignprograms","show-program-dialog",{buttons:e,title:"<h2>"+b[2]+"</h2>"},g+"find.php?id="+d,a),M.util.js_complete(i)})};M.util.js_pending(i),window.dialogsInited?j():(window.dialoginits=window.dialoginits||[],window.dialoginits.push(j))}}});
define('totara_plan/templates', ["jquery"],function(a){var b={templates:{},totaraDialog_handler_preRequisite:null,init:function(c){c&&(this.templates=c),a("select#id_templateid").change(function(){var c=a(this),d=c.val();a("input#id_name").val(b.templates[d].fullname);var e=b.templates[d].enddate;a("#id_enddate_day").val(e.mday),a("#id_enddate_month").val(e.mon),a("#id_enddate_year").val(e.year)})}};return b});
define('totara_program/assignments', ["core/ajax","core/templates","core/config","core/notification","core/str"],function(a,b,c,d,e){function f(a){var b=this;this.node=a,this.assignments=[],this.categories=[],this.recent=!1,this.searchTerm="",this.strings={},this.dialog=null,this.baseURL=c.wwwroot+"/totara/program/assignment/",this.programId=parseInt(a.getAttribute("data-totara_program-id"),10),this.iscertif="1"===a.getAttribute("data-totara_program-iscertif"),this.canupdate="1"===a.getAttribute("data-totara_program-canupdate"),this.typeid=0,this.actualduedatesdialog=null,this.config={COMPLETION_EVENT_ENROLLMENT_DATE:"6",COMPLETION_EVENT_FIRST_LOGIN:"1",COMPLETION_EVENT_NONE:"0",COMPLETION_TIME_NOT_SET:"-1",CONDENSED_LIMIT:5},this.addOptions=[],M.util.js_pending("totara_program--assignments-strings"),this.stringsPromise=new Promise(function(a){var d=b.iscertif?"totara_certification":"totara_program",f=[{component:"totara_program",key:"ok"},{component:"totara_program",key:"remove"},{component:"totara_program",key:"cancel"},{component:"totara_program",key:"setduedate"},{component:"totara_program",key:"completioncriteria"},{component:d,key:"addorganisationstoprogram"},{component:d,key:"addpositionstoprogram"},{component:d,key:"addcohortstoprogram"},{component:d,key:"addindividualstoprogram"},{component:d,key:"addmanagerstoprogram"}];e.get_strings(f).done(function(d){b.strings.ok=d[0],b.strings.remove=d[1],b.strings.cancel=d[2],b.strings.setduedate=d[3],b.strings.completioncriteria=d[4],b.addOptions[1]={name:"organisations",url:"find_hierarchy.php?type=organisation",text:d[5],notificationKey:"assignmentsaddedorgainisation"},b.addOptions[2]={name:"positions",url:"find_hierarchy.php?type=position",text:d[6],notificationKey:"assignmentsaddedposition"},b.addOptions[3]={name:"cohorts",url:"find_cohort.php?sesskey="+c.sesskey,text:d[7],notificationKey:"assignmentsaddedaudience"},b.addOptions[5]={name:"individuals",url:"find_individual.php?",text:d[8],notificationKey:"assignmentsaddedindividual"},b.addOptions[6]={name:"managers",url:"find_manager_hierarchy.php?",text:d[9],notificationKey:"assignmentsaddedposition"},M.util.js_complete("totara_program--assignments-strings"),a()})}),M.util.js_pending("totara_program--assignments-dialogs"),this.dialogPromise=new Promise(function(a){window.dialogsInited?(a(),M.util.js_complete("totara_program--assignments-dialogs")):(window.dialoginits=window.dialoginits||[],window.dialoginits.push(function(){a(),M.util.js_complete("totara_program--assignments-dialogs")}))})}function g(a){return new Promise(function(b){var c=new f(a);c.events(),b(c)})}return f.prototype.events=function(){var a=this;this.node.addEventListener("totara_core/select_search_text:add",function(b){a.searchTerm=b.detail.val}),this.node.addEventListener("totara_core/select_search_text:remove",function(b){a.searchTerm=b.detail.val}),this.node.addEventListener("totara_core/select_search_text:changed",a.filter.bind(a)),this.node.addEventListener("totara_core/select_region_panel:add",function(b){switch(b.detail.key){case"recent":a.recent=!0;break;case"type":a.categories=b.detail.groupValues}}),this.node.addEventListener("totara_core/select_region_panel:remove",function(b){switch(b.detail.key){case"recent":a.recent=!1;break;case"type":a.categories=b.detail.groupValues}}),this.node.addEventListener("totara_core/select_region_panel:changed",a.filter.bind(a)),this.node.addEventListener("change",function(b){if("totara_program-assignment--add-users"===b.target.id&&(b.preventDefault(),a.startAdd(b.target.value)),"update-below"===b.target.getAttribute("data-totara_program__assignments--action")){b.preventDefault();var c=b.target.closest("[data-totara_program__assignment-id]"),d=c.getAttribute("data-totara_program__assignment-id"),e=0;switch(c.classList.add("totara_program__assignments__loading"),b.target.tagName.toLowerCase()){case"input":e=b.target.checked?1:0;break;case"select":e=b.target.value}a.updateBelow(d,e)}}),this.node.addEventListener("click",function(b){var c=b.target.closest("[data-totara_program__assignments--action]");if(null!==c){var d=b.target.closest("[data-totara_program__assignment-id]"),e=parseInt(d.getAttribute("data-totara_program__assignment-id"),10);switch(c.getAttribute("data-totara_program__assignments--action")){case"delete":b.preventDefault(),a.deleteAssignment(e);break;case"change-due-date":b.preventDefault(),a.startChangeDuedate(e);break;case"remove-due-date":b.preventDefault(),a.removeDueDate(e);break;case"view-actual-dates":b.preventDefault(),a.viewActualDates(e)}}}),document.addEventListener("click",function(b){var c=b.target.closest(".moodle-dialogue-content .embeddedshortname_program_assignment_duedates a, .moodle-dialogue-content .embeddedshortname_cert_assignment_duedates a");c&&c.getAttribute("href")&&(b.preventDefault(),M.util.js_pending("totara_program--assignments-view-duedates-change"),fetch(c.getAttribute("href"),{credentials:"same-origin",method:"get"}).then(function(a){return a.text()}).then(function(b){a.actualduedatesdialog.set("bodyContent",b),M.util.js_complete("totara_program--assignments-view-duedates-change")})["catch"](d.exception))})},f.prototype.deleteAssignment=function(c){var f=this,g=this.node.querySelector('[data-totara_program__assignment-id="'+c+'"]'),h=g.querySelector(".totara_program__assignments__row-name").innerText;g.classList.add("totara_program__assignments__loading"),M.util.js_pending("totara_program--assignments-delete-assignment");var i=new Promise(function(a){e.get_string("removeassignmentconfirmation","totara_program").done(a)});Promise.all([i,this.stringsPromise]).then(function(i){M.util.js_complete("totara_program--assignments-delete-assignment"),d.confirm("",i[0],f.strings.remove,f.strings.cancel,function(){a.call([{methodname:"totara_program_assignment_delete",args:{assignment_id:c}}])[0].then(function(a){if(a.success){g.remove(),f._clearNotifications();var c=f.iscertif?"totara_certification":"totara_program";e.get_string("removedfromprogram",c,h).done(function(a){d.addNotification({message:a,type:"success",closebutton:!0,announce:!0})})}f._updateStatus(a.status),0===f.node.querySelectorAll(".totara_program__assignments__results__table tbody tr").length&&b.render("totara_program/assignment__no-results").done(function(a,c){f.node.querySelector(".totara_program__assignments__results").innerHTML=a,b.runTemplateJS(c)})}).fail(d.exception)},function(){g.classList.remove("totara_program__assignments__loading")})})["catch"](d.exception)},f.prototype.filter=function(){var c=this,e={categories:this.categories,term:this.searchTerm,recent:this.recent,program_id:this.programId},f=this.node.querySelector(".totara_program__assignments__results");f.classList.add("totara_program__assignments__loading"),a.call([{methodname:"totara_program_assignment_filter",args:e}])[0].then(function(a){return a.toomany?b.render("totara_program/assignment__too-many"):0===a.count?b.render("totara_program/assignment__no-results"):(a.canupdate=c.canupdate,b.render("totara_program/assignment_table",a))}).then(function(a,d){c.categories===e.categories&&c.term===e.searchTerm&&c.recent===e.recent&&(f.innerHTML=a,b.runTemplateJS(d),f.classList.remove("totara_program__assignments__loading"))}).fail(d.exception)},f.prototype.startChangeDuedate=function(b){var c=this,f=new Promise(function(a){var b=[{component:"totara_core",key:"datepickerlongyeardisplayformat"},{component:"totara_program",key:"chooseitem"},{component:"moodle",key:"none"},{component:"totara_hierarchy",key:"selected"}];e.get_strings(b).done(a)});M.util.js_pending("totara_program--assignments-change-duedates"),Promise.all([f,this.stringsPromise,this.dialogPromise]).then(function(f){var g={dateFormat:f[0][0],chooseitem:f[0][1],none:f[0][2]},h=function(){var a=new totaraDialog_handler_treeview_singleselect("instance","instancetitle"),b=this,d={};this.save=function(){document.getElementById("instance").value=document.getElementById("treeview_selected_val_"+this.handler._title).value,document.getElementById("instancetitle").innerHTML=document.getElementById("treeview_selected_text_"+this.handler._title).innerText,b.hide()},this.clear=function(){document.getElementById("instance").value=0,document.getElementById("instancetitle").value=""},d[c.strings.ok]=b.save.bind(b),d[c.strings.cancel]=a._cancel.bind(a);var e=' <span id="treeview_currently_selected_span_completion-event-dialog" style="display:none">(<label for="treeview_selected_text_completion-event-dialog">'+f[0][3]+':&nbsp</label><em><span id="treeview_selected_text_completion-event-dialog"></span></em>)</span><input type="hidden" id="treeview_selected_val_completion-event-dialog" name="treeview_selected_val_completion-event-dialog" value=""/>';totaraDialog.call(this,"completion-event-dialog","unused2",{buttons:d,title:"<h2>"+g.chooseitem+e+"</h2>"},"unused2",a)};totaraDialogs.completionevent=new h;var i=function(){};i.prototype=new totaraDialog_handler,i.prototype.first_load=function(){var f=this._dialog.dialog[0],h=this;M.totara_core.build_datepicker(null,'input[name="completiontime"]',g.dateFormat),f.querySelector(".fixeddate").addEventListener("click",function(){var g=f.querySelector(".completiontime").value,i=f.querySelector(".completiontimehour").value,j=f.querySelector(".completiontimeminute").value;M.util.js_pending("totara_program--assignments-change-duedates-fixed"),new Promise(function(a,b){e.get_string("datepickerlongyearregexjs","totara_core").then(function(c){var d=new RegExp(c);d.test(g)===!1?b():a()})}).then(function(){var d={assignment_id:b,duedate:g,hour:i,minute:j};a.call([{methodname:"totara_program_assignment_set_fixed_due_date",args:d}])[0].then(function(a){c._changeDuedate(b,a),h._dialog.hide(),M.util.js_complete("totara_program--assignments-change-duedates-fixed")})})["catch"](function(){e.get_string("datepickerlongyearplaceholder","totara_core").then(function(a){return M.util.js_complete("totara_program--assignments-change-duedates-fixed"),e.get_string("pleaseentervaliddate","totara_program",a)}).then(function(a){d.alert("",a,c.strings.ok)})})}),f.querySelector(".relativeeventtime").addEventListener("click",function(){var g=f.querySelector("#timeamount").value,i=f.querySelector("#eventtype").value,j=""===f.querySelector("#instance").value?0:f.querySelector("#instance").value,k=/^\d{1,3}$/;if(k.test(g)===!1)e.get_string("pleaseentervalidunit","totara_program").done(function(a){d.alert("",a,c.strings.ok)});else if(0==j&&i!=c.config.COMPLETION_EVENT_FIRST_LOGIN&&i!=c.config.COMPLETION_EVENT_ENROLLMENT_DATE)e.get_string("pleasepickaninstance","totara_program").done(function(a){d.alert("",a,c.strings.ok)});else{var l={assignment_id:b,num:f.querySelector("#timeamount").value,period:f.querySelector("#timeperiod").value,event:f.querySelector("#eventtype").value,eventinstanceid:j};a.call([{methodname:"totara_program_assignment_set_relative_due_date",args:l}])[0].then(function(a){c._changeDuedate(b,a),h._dialog.hide()}).fail(d.exception)}})},i.prototype.every_load=function(){var a=this._dialog.dialog[0],b=a.querySelector('[name="event"]'),c=a.querySelector('[name="eventinstancename"]');b&&(a.querySelector('[name="eventtype"]').value=b.value),c&&(a.querySelector("#instancetitle").innerText=c.value)};var j={};j[c.strings.cancel]=function(){c.dialog.hide()};var k="set_completion.php?programid="+c.programId+"&assignmentid="+b;c.dialog=new totaraDialog("completion-dialog",null,{buttons:j,title:"<h2>"+c.strings.completioncriteria+"</h2>"},c.baseURL+k,new i),c.dialog.open(),document.getElementById("completion-dialog").style.height="175px",M.util.js_complete("totara_program--assignments-change-duedates")})["catch"](d.exception)},f.prototype._changeDuedate=function(a,c){var d=this,e=this.node.querySelector('[data-totara_program__assignment-id="'+a+'"]'),f={canupdate:this.canupdate,duedate:c.duedate,duedateupdatable:c.duedateupdatable},g={actualduedate:c.actualduedate};this._updateStatus(c.status),e.classList.add("totara_program__assignments__loading");var h=b.render("totara_program/assignment__due_date",f).then(function(a){e.querySelector(".totara_program__assignments__row-duedate").innerHTML=a});b.render("totara_program/assignment__actual_date",g).then(function(a){return e.querySelector(".totara_program__assignments__row-actual-duedate").innerHTML=a,h}).then(function(){e.classList.remove("totara_program__assignments__loading")}),d.updateSuccess(a)},f.prototype.removeDueDate=function(b){var c=this;a.call([{methodname:"totara_program_assignment_remove_due_date",args:{assignment_id:b}}])[0].then(function(a){c._changeDuedate(b,a)})},f.prototype.viewActualDates=function(a){var b=this,e=c.wwwroot+"/totara/program/assignment/duedates_report.php?programid="+b.programId+"&assignmentid="+a;M.util.js_pending("totara_program--assignments-view-duedates"),fetch(e,{credentials:"same-origin",method:"get"}).then(function(a){return a.text()}).then(function(a){b.actualduedatesdialog&&(b.actualduedatesdialog.destroy(),b.actualduedatesdialog=null),b.actualduedatesdialog=new M.core.dialogue({headerContent:null,bodyContent:a,width:900,centered:!0,modal:!0,render:!0}).show(),M.util.js_complete("totara_program--assignments-view-duedates")})["catch"](d.exception)},f.prototype.startAdd=function(a){var b=this;""!==a&&(this.typeid=a,M.util.js_pending("totara_program--assignments-addItems"),Promise.all([this.stringsPromise,this.dialogPromise]).then(function(){var c={};c[b.strings.ok]=function(){b.addAssignments()},c[b.strings.cancel]=function(){b.dialog.hide()};var d=new totaraDialog_handler_treeview_multiselect,e=b.addOptions[a].url+"&programid="+b.programId;b.dialog=new totaraDialog("add-assignment-dialog-"+a,null,{buttons:c,title:"<h2>"+b.addOptions[a].text+"</h2>"},b.baseURL+e,d),b.dialog.open(),M.util.js_complete("totara_program--assignments-addItems"),b.node.querySelector("#totara_program-assignment--add-users").value=""}))},f.prototype.addAssignments=function(){for(var c=this.dialog.handler._container.get(0).querySelectorAll(".selected > div > span.clickable"),f=[],g=this,h=0;h<c.length;h++){var i,j=c[h];j.getAttribute("data-jaid")?i=parseInt(j.getAttribute("data-jaid"),10):(i=j.id.split("_"),i=i[i.length-1],i=parseInt(i,10)),f.indexOf(i)===-1&&f.push(i)}f.length>0?(M.util.js_pending("totara_program--assignments-addingItems"),g.dialog.showLoading(),new Promise(function(b,c){a.call([{methodname:"totara_program_assignment_create",args:{programid:g.programId,typeid:g.typeid,items:f}}])[0].done(b).fail(c)}).then(function(a){var c=g._updateStatus(a.status),f=new Promise(function(b){g._clearNotifications(),a.items.length<g.config.CONDENSED_LIMIT?a.items.forEach(function(a){var c=g.iscertif?"totara_certification":"totara_program";e.get_string("assignmentadded",c,a.name).done(function(a){d.addNotification({message:a,type:"success",closebutton:!0,announce:!0}),b()})}):e.get_string(g.addOptions[g.typeid].notificationKey,"totara_program",a.items.length).done(function(a){d.addNotification({message:a,type:"success",closebutton:!0,announce:!0}),b()})}),h=new Promise(function(c,d){var e=a.items.filter(function(a){var b,c=0===g.categories.length;return(!g.searchTerm||a.name.toLowerCase().indexOf(g.searchTerm.toLowerCase())!==-1)&&(b=g.categories.some(function(b){return parseInt(b,10)===a.type_id}),c||b)});if(0===e.length)return void c();if(g.node.getElementsByClassName("totara_program__assignments__results-too-many").length>0)return void c();var f=g.node.querySelectorAll("[data-totara_program__assignment]");if(e.length+f.length>100)return void b.render("totara_program/assignment__too-many").done(function(a,d){g.node.querySelector(".totara_program__assignments__results").innerHTML=a,b.runTemplateJS(d),c()});if(g.node.getElementsByClassName("totara_program__assignments__results-no-results").length>0){var h={items:e,canupdate:g.canupdate};b.render("totara_program/assignment_table",h).done(function(a,d){g.node.querySelector(".totara_program__assignments__results").innerHTML=a,b.runTemplateJS(d),c()})}else{var i=e.map(function(a){return new Promise(function(c){a.canupdate=g.canupdate,b.render("totara_program/assignment__table__row",a).done(c)})});Promise.all(i).then(function(a){var b="";a.forEach(function(a){b+=a}),g.node.querySelector(".totara_program__assignments__results__table tbody").insertAdjacentHTML("beforeend",b),c()})["catch"](d)}});return Promise.all([c,f,h])}).then(function(){g.dialog.hide(),M.util.js_complete("totara_program--assignments-addingItems")})["catch"](d.exception)):this.dialog.hide()},f.prototype.updateBelow=function(b,c){var e=this;a.call([{methodname:"totara_program_assignment_set_include_children",args:{assignmentid:b,value:c}}])[0].done(function(a){var c=e.node.querySelector('[data-totara_program__assignment-id="'+b+'"]');e._updateStatus(a.status),e.updateSuccess(b),c.querySelector("[data-totara_program__assignments--learnercount]").innerHTML=a.numusers,c.classList.remove("totara_program__assignments__loading")}).fail(d.exception)},f.prototype.updateSuccess=function(a){var b='[data-totara_program__assignment-id="'+a+'"] .totara_program__assignments__row-name',c=this.node.querySelector(b).textContent;this._clearNotifications(),e.get_string("individualassignmentupdated","totara_program",c).done(function(a){d.addNotification({message:a,type:"success",closebutton:!0,announce:!0})})},f.prototype._updateStatus=function(a){var d=a.exception_count,f=document.querySelector("#program-assignments .tabtree li:last-child"),g=new Promise(function(a){e.get_string("exceptions","totara_program",d).done(function(b){d===parseInt(f.getAttribute("data-totara_program-exception_count"),10)&&(f.querySelector("a").innerText=b),a()})}),h={message:a.status_string,extraclasses:"notifynotice",announce:!0,closebutton:!1},i=new Promise(function(c){b.render("core/notification_"+a.state,h).done(function(a,d){document.querySelector("[data-totara_program--notification]").innerHTML=a,b.runTemplateJS(d),c()})});return f.setAttribute("data-totara_program-exception_count",d),d>0?(f.classList.remove("disabled"),f.querySelector("a").setAttribute("href",c.wwwroot+"/totara/program/exceptions.php?id="+this.programId)):(f.classList.add("disabled"),f.querySelector("a").removeAttribute("href")),Promise.all([g,i])},f.prototype._clearNotifications=function(){document.getElementById("user-notifications").innerHTML=""},{init:g}});
define('totara_program/check_completion', ["jquery","core/str","core/config","core/yui"],function(a,b,c,d){function e(a,b){var c=new M.core.confirm({title:M.util.get_string("fixconfirmtitle","totara_program"),question:M.util.get_string(b,"totara_program"),width:500});c.on("complete-yes",function(){window.location.href=a}),c.on("complete-no",function(a){a.preventDefault()}),c.show()}var f={init:function(b){d.use("moodle-core-notification-confirm",function(b){a(".problemaggregation a").on("click",function(b){b.preventDefault(),e(a(this).attr("href"),"fixconfirmsome")}),a(".problemsolution a").on("click",function(b){b.preventDefault(),e(a(this).attr("href"),"fixconfirmone")})})}};return f});
define('totara_program/management', [],function(){return{init_autosubmit:function(a){var b=document.getElementById(a);b.addEventListener("change",function(a){a.preventDefault(),b.closest("form").submit()})}}});
define('totara_reportbuilder/chartjs', ["core/chartjs"],function(a){function b(b){var c=b.getContext("2d"),d=JSON.parse(b.dataset.reportOptions);this.chart=new a(c,d)}function c(a){return new Promise(function(c){var d=new b(a);c(d)})}return{init:c}});
define('totara_reportbuilder/create', ["core/templates","core/webapi","core/flex_icon","core/config","core/str","core/notification"],function(a,b,c,d,e,f){function g(b){if(!(this instanceof g))return new g;var d=this;this.widget=b,this.gridContainer=b.querySelector("[data-tw-report-create-container]"),this.loadContainer=b.querySelector("[data-tw-report-create-load]"),this.loadButton=this.loadContainer.innerHTML,this.tiles=[],this.stringPromise=e.get_strings([{key:"template",component:"totara_reportbuilder"},{key:"reportsourcepill",component:"totara_reportbuilder"}]).then(function(a){return d.strings={template:a[0],reportsource:a[1]},d.strings})["catch"](f.exception);var i=["graphicons/report_tile_image_column","graphicons/report_tile_image_line","graphicons/report_tile_image_bar","graphicons/report_tile_image_pie","graphicons/report_tile_image_scatter","graphicons/report_tile_image_area","graphicons/report_tile_image_donut","graphicons/report_tile_image_progress","graphicons/report_tile_image_nograph"].map(function(a){return c.getIconData(a,"totara_core",{alt:""})});this.graphPromises=Promise.all(i).then(function(a){return d.graphIcons={column:a[0],line:a[1],bar:a[2],pie:a[3],scatter:a[4],area:a[5],doughnut:a[6],progress:a[7],none:a[8]},d.graphIcons})["catch"](f.exception),this.filters=[],this.search="",this.currentIndex=0,this.currentRequest=null,this.loadingSpinner=a.render("totara_reportbuilder/loading_overlay",{}),this.loadRecords(h)}var h=20;g.prototype={constructor:g,events:function(){var a=this;this.widget.querySelector("[data-tw-report-create-container]").addEventListener("click",function(b){if(b.target.matches("[data-tw-create-report-create]"))return b.preventDefault(),void a.createReport(b.target)}),this.loadContainer.addEventListener("click",function(b){if(b.target.matches("button")){var c=a.displayLoadingSpinner(a.loadContainer,!0);b.preventDefault(),a.loadRecords(h,c)}}),this.widget.addEventListener("totara_core/grid:add",function(b){a.openDetails(b)}),this.widget.addEventListener("totara_core/select_multi:add",function(b){a.filters.push(b.detail.val),a.updateFilters()}),this.widget.addEventListener("totara_core/select_multi:remove",function(b){a.filters.splice(a.filters.indexOf(b.detail.val),1),a.updateFilters()}),this.widget.addEventListener("totara_core/select_search_text:add",function(b){a.search=b.detail.val,a.updateFilters()}),this.widget.addEventListener("totara_core/select_search_text:remove",function(b){a.search="",a.updateFilters()}),this.widget.addEventListener("totara_core/toggle_filter_panel:changed",function(b){var c=a.widget.querySelector(b.detail.targetwidget);c.classList.toggle(b.detail.toggleClass),a.updateFilters()})},openDetails:function(c){var d=c.detail.val.split("-"),e=d[0],g=d[1],h=this.widget.querySelector('[data-tw-grid-item-ID="'+c.detail.val+'"]');if(h){c.preventDefault();var i=h.querySelector("[data-tw-report-create-details]");if(i&&""!==i.innerHTML){this.displayLoadingSpinner(i);var j="totara_reportbuilder_"+g;M.util.js_pending("totara_reportbuilder-create--open_details"),b.call({operationName:j,variables:{key:e}}).then(function(b){var c=b[j],d=[];return c.defaultcolumns.forEach(function(a){if(0===d.length)d.push({groupName:a.type,values:[a.name]});else{var b=d.filter(function(b){return b.groupName==a.type});b.length?b[0].values.push(a.name):d.push({groupName:a.type,values:[a.name]})}}),c.defaultcolumns=d,a.render("totara_reportbuilder/details",c)}).then(function(a){i.innerHTML=a,M.util.js_complete("totara_reportbuilder-create--open_details")})["catch"](f.exception)}}},createReport:function(a){var c=d.wwwroot+a.getAttribute("data-tw-create-report-create"),e=a.closest("[data-tw-grid-item]"),g=e.getAttribute("data-tw-grid-item-ID").split("-"),h="",i={key:g[0]};h="template"===g[1]?"totara_reportbuilder_create_report_from_template":"totara_reportbuilder_create_report",M.util.js_pending("totara_reportbuilder-create--createReport"),b.call({operationName:h,variables:i}).then(function(a){var b=a[h];window.location.href=c+="?id="+b})["catch"](f.exception)},loadRecords:function(c,d){var g=this,h="totara_reportbuilder_creation_sources",i=this.tiles;M.util.js_pending("totara_reportbuilder-create--loadRecords");var j=b.call({operationName:h,variables:{start:this.currentIndex,limit:c,label:this.filters,search:this.search}});g.request=j,Promise.all([j,this.stringPromise,this.graphPromises]).then(function(b){var f=b[0],j=b[1],k=b[2],l=f[h];l.templates.forEach(function(a){i.push({template_name:"totara_reportbuilder/create_report_tile",template_data:{title:a.fullname,classname:a.key,type:"template",primary_label:a.label,secondary_label:j.template,template:"totara_reportbuilder/create_report_tile",graphimagetemplate:k[a.graph].template,graphimagedata:k[a.graph].context,itemid:a.key+"-template"}})}),l.sources.forEach(function(a){i.push({template_name:"totara_reportbuilder/create_report_tile",template_data:{title:a.fullname,classname:a.key.replace("rb_source_",""),type:"source",primary_label:a.label,secondary_label:j.reportsource,template:"totara_reportbuilder/create_report_tile",graphimagetemplate:k.none.template,graphimagedata:k.none.context,itemid:a.key.replace("rb_source_","")+"-source"}})}),i.length<l.totalcount?g.currentIndex+=c:g.currentIndex=0;var m=a.render("totara_core/grid",{tiles:i,single_column:!1}),n=e.get_string("xrecords","totara_reportbuilder",i.length);return Promise.all([m,n,d])}).then(function(b){return j!==g.currentRequest?"":(0===g.currentIndex?g.loadContainer.setAttribute("data-tw-report-create-disabled",!0):g.loadContainer.removeAttribute("data-tw-report-create-disabled"),g.widget.querySelector("[data-totara_reportbuilder-create_report-results_count]").innerHTML=b[1],g.gridContainer.innerHTML=b[0],g.currentIndex=g.gridContainer.querySelectorAll("[data-tw-grid-item]").length,g.widget.setAttribute("data-tw-report-create-loaded",!0),g.loadContainer.innerHTML=g.loadButton,g.tiles=i,a.runTemplateJS())}).then(function(){M.util.js_complete("totara_reportbuilder-create--loadRecords")})["catch"](f.exception),this.currentRequest=j},updateFilters:function(){var a=this.displayLoadingSpinner(this.gridContainer,!0);this.currentIndex=0,this.tiles=[],this.loadRecords(h,a)},displayLoadingSpinner:function(a,b){return this.loadingSpinner.then(function(c){(b||""===a.innerHTML.trim())&&(a.innerHTML=c)})}};var i=function(a){return new Promise(function(b){var c=new g(a);c.events(),b(c)})};return{init:i}});
define('totara_reportbuilder/filter_dialogs', ["jquery","core/config","core/str"],function(a,b,c){var d=function(b){var c=a(this).attr("name");"undefined"!=typeof c&&(c=c.substr(0,c.length-3),"0"===a(this).val()?(a("#show-"+c+"-dialog").addClass("disabled"),a("#show-"+c+"-dialog").prop("disabled",!0),a("#show-"+c+"-dialog").removeAttr("href"),a('*[data-filtername="'+c+'"] a').addClass("disabled"),a('*[data-filtername="'+c+'"] a').prop("disabled",!0),a('*[data-filtername="'+c+'"] a').removeAttr("href")):(a("#show-"+c+"-dialog").removeClass("disabled"),a("#show-"+c+"-dialog").prop("disabled",!1),a("#show-"+c+"-dialog").attr("href","#"),a('*[data-filtername="'+c+'"] a').removeClass("disabled"),a('*[data-filtername="'+c+'"] a').prop("disabled",!1),a('*[data-filtername="'+c+'"] a').attr("href","#")))},e={waitingitems:[],reportid:0,init:function(b,c,d,f,g){e.waitingitems.push({filter:b,value:c,hierarchytype:d,name:f}),e.reportid=g,window.dialogsInited?this.rb_init_filter_dialogs():(a.isArray(window.dialoginits)||(window.dialoginits=[]),1===this.waitingitems.length&&window.dialoginits.push(this.rb_init_filter_dialogs))},rb_init_filter_dialogs:function(){var b=a.extend(!0,[],e.waitingitems);e.waitingitems=[],a.each(b,function(){switch(this.filter){case"hierarchy":e.rb_load_hierarchy_filters(this);break;case"badge":e.rb_load_badge_filters(this);break;case"jobassign_multi":e.rb_load_jobassign_multi_filters();case"hierarchy_multi":e.rb_load_hierarchy_multi_filters();break;case"cohort":e.rb_load_cohort_filters();break;case"category":e.rb_load_category_filters();break;case"course_multi":e.rb_load_course_multi_filters()}}),a(document).on("click",".multiselect-selected-item a",function(b){b.preventDefault();var c=a(this).parents("div.multiselect-selected-item"),d=c.data("filtername"),e=c.data("id"),f=a("input[name="+d+"]"),g=f.val(),h=g.split(","),i=a.grep(h,function(a){return a!=e}),j=i.join(",");f.val(j),c.remove()})},rb_load_hierarchy_filters:function(d){if(d.name)var e="input#show-"+d.name+"-dialog";else var e="input";switch(d.hierarchytype){case"org":a(e+".rb-filter-choose-org").each(function(){var e=a(this).attr("id");e=e.substr(5,e.length-12);var f=b.wwwroot+"/totara/hierarchy/prefix/organisation/assign/";c.get_string("chooseorganisation","totara_hierarchy").done(function(a){totaraSingleSelectDialog(e,a+d.value,f+"find.php?",e,e+"title")}),"0"===a("select[name="+e+"_op]").val()&&(a("input[name="+e+"_rec]").prop("disabled",!0),a("#show-"+e+"-dialog").prop("disabled",!0))});break;case"pos":a(e+".rb-filter-choose-pos").each(function(){var e=a(this).attr("id");e=e.substr(5,e.length-12);var f=b.wwwroot+"/totara/hierarchy/prefix/position/assign/";c.get_string("chooseposition","totara_hierarchy").done(function(a){totaraSingleSelectDialog(e,a+d.value,f+"position.php?",e,e+"title")}),"0"===a("select[name="+e+"_op]").val()&&(a("input[name="+e+"_rec]").prop("disabled",!0),a("#show-"+e+"-dialog").prop("disabled",!0))});break;case"comp":a(e+".rb-filter-choose-comp").each(function(){var e=a(this).attr("id");e=e.substr(5,e.length-12);var f=b.wwwroot+"/totara/hierarchy/prefix/competency/assign/";c.get_string("selectcompetency","totara_hierarchy").done(function(a){totaraSingleSelectDialog(e,a+d.value,f+"find.php?",e,e+"title")}),"0"===a("select[name="+e+"_op]").val()&&(a("input[name="+e+"_rec]").prop("disabled",!0),a("#show-"+e+"-dialog").prop("disabled",!0))})}},rb_load_jobassign_multi_filters:function(){var e=this;a("div.rb-man-add-link a").each(function(){var f=a(this).attr("id");f=f.substr(5,f.length-12),d.call(a("#id_"+f+"_op")),a(document).on("change","#id_"+f+"_op",d);var g=b.wwwroot+"/totara/job/assignfilter/manager/";c.get_string("choosemanplural","totara_reportbuilder").done(function(a){totaraMultiSelectDialogRbFilter(f,a,g+"find.php?reportid="+e.reportid,g+"save.php?reportid="+e.reportid+"&filtername="+f+"&ids=")})}),a("div.rb-app-add-link a").each(function(){var f=a(this).attr("id");f=f.substr(5,f.length-12),d.call(a("#id_"+f+"_op")),a(document).on("change","#id_"+f+"_op",d);var g=b.wwwroot+"/totara/job/assignfilter/appraiser/";c.get_string("chooseappplural","totara_reportbuilder").done(function(a){totaraMultiSelectDialogRbFilter(f,a,g+"find.php?reportid="+e.reportid,g+"save.php?reportid="+e.reportid+"&filtername="+f+"&ids=")})})},rb_load_hierarchy_multi_filters:function(){var e=this;a("div.rb-org-add-link a").each(function(){var f=a(this).attr("id");f=f.substr(5,f.length-12),d.call(a("#id_"+f+"_op")),a(document).on("change","#id_"+f+"_op",d);var g=b.wwwroot+"/totara/hierarchy/prefix/organisation/assignfilter/";c.get_string("chooseorgplural","totara_reportbuilder").done(function(a){totaraMultiSelectDialogRbFilter(f,a,g+"find.php?reportid="+e.reportid,g+"save.php?filtername="+f+"&ids=")})}),a("div.rb-pos-add-link a").each(function(){var f=a(this).attr("id");f=f.substr(5,f.length-12),d.call(a("#id_"+f+"_op")),a(document).on("change","#id_"+f+"_op",d);var g=b.wwwroot+"/totara/hierarchy/prefix/position/assignfilter/";c.get_string("chooseposplural","totara_reportbuilder").done(function(a){totaraMultiSelectDialogRbFilter(f,a,g+"find.php?reportid="+e.reportid,g+"save.php?filtername="+f+"&ids=")})}),a("div.rb-comp-add-link a").each(function(){var e=a(this).attr("id");e=e.substr(5,e.length-12),d.call(a("#id_"+e+"_op")),a(document).on("change","#id_"+e+"_op",d);var f=b.wwwroot+"/totara/hierarchy/prefix/competency/assignfilter/";c.get_string("choosecompplural","totara_reportbuilder").done(function(a){totaraMultiSelectDialogRbFilter(e,a,f+"find.php?",f+"save.php?filtername="+e+"&ids=")})})},rb_load_cohort_filters:function(){a("div.rb-cohort-add-link a").each(function(){var d=a(this).attr("id");d=d.substr(5,d.length-12);var e=b.wwwroot+"/totara/reportbuilder/ajax/";c.get_string("choosecohorts","totara_cohort").done(function(a){totaraMultiSelectDialogRbFilter(d,a,e+"find_cohort.php?sesskey="+b.sesskey,e+"save_cohort.php?sesskey="+b.sesskey+"&filtername="+d+"&ids=")})})},rb_load_badge_filters:function(d){a("div.rb-badge-add-link a").each(function(){var e=a(this).attr("id");e=e.substr(5,e.length-12);var f=b.wwwroot+"/totara/reportbuilder/ajax/";c.get_string("choosebadges","badges").done(function(a){totaraMultiSelectDialogRbFilter(e,a,f+"find_badge.php?reportid="+d.value+"&sesskey="+b.sesskey,f+"save_badge.php?filtername="+e+"&sesskey="+b.sesskey+"&ids=")})})},rb_load_category_filters:function(){a(document).on("change","#id_course_category-path_op",function(b){b.preventDefault();var c=a(this).attr("name");c=c.substr(0,c.length-3),"0"===a(this).val()?(a("input[name="+c+"_rec]").prop("disabled",!0),a("#show-"+c+"-dialog").prop("disabled",!0)):(a("input[name="+c+"_rec]").prop("disabled",!1),a("#show-"+c+"-dialog").prop("disabled",!1))}),a("input.rb-filter-choose-category").each(function(){var d=a(this).attr("id");d=d.substr(5,d.length-12);var e=b.wwwroot+"/totara/reportbuilder/ajax/filter/category/";c.get_string("choosecatplural","totara_reportbuilder").done(function(a){totaraMultiSelectDialogRbFilter(d,a,e+"find.php?sesskey="+b.sesskey,e+"save.php?filtername="+d+"&sesskey="+b.sesskey+"&ids=")}),"0"===a("select[name="+d+"_op]").val()&&(a("input[name="+d+"_rec]").prop("disabled",!0),a("#show-"+d+"-dialog").prop("disabled",!0))})},rb_load_course_multi_filters:function(){a(document).on("change","#id_course-id_op",function(b){b.preventDefault();var c=a(this).attr("name");c=c.substr(0,c.length-3),"0"===a(this).val()?(a("input[name="+c+"_rec]").prop("disabled",!0),a("#show-"+c+"-dialog").prop("disabled",!0)):(a("input[name="+c+"_rec]").prop("disabled",!1),a("#show-"+c+"-dialog").prop("disabled",!1))}),a("input.rb-filter-choose-course").each(function(){var d=a(this).attr("id");d=d.substr(5,d.length-12);var e=b.wwwroot+"/totara/reportbuilder/ajax/filter/course_multi/";c.get_string("coursemultiitemchoose","totara_reportbuilder").done(function(a){totaraMultiSelectDialogRbFilter(d,a,e+"find.php?sesskey="+b.sesskey,e+"save.php?filtername="+d+"&sesskey="+b.sesskey+"&ids=")}),"0"===a("select[name="+d+"_op]").val()&&(a("input[name="+d+"_rec]").prop("disabled",!0),a("#show-"+d+"-dialog").prop("disabled",!0))})}};return e});
define('totara_reportbuilder/instantfilter', ["jquery","core/config","core/templates"],function(a,b,c){var d={xhr:null,init:function(){a(".rb-sidebar input:not(.ignoredirty), .rb-sidebar select").change(function(b){try{var e=a(this).parents("form").attr("id");M.form.updateFormState(e)}catch(f){}d.xhr&&d.xhr.abort(),0===a(b.target).siblings(".instantfilterwait").length&&c.renderIcon("loading","loading","instantfilterwait").done(function(c){a(c).insertAfter(a(b.target).parent().children().last())}),d.xhr=d.refresh_results()})},split_search:function(a){var b={};if(void 0===a||a.length<1)return b;for(var c=a.slice(1).split("&"),d=0;d<c.length;d++){var e=c[d].split("="),f=decodeURIComponent(e[0]).replace(/\+/g," "),g=decodeURIComponent(e[1]).replace(/\+/g," ");void 0===b[f]&&(b[f]=[]),b[f].push(g)}return b},remove_param:function(a,b){return a[b]&&delete a[b],a},build_search:function(a){var b="?";for(var c in a)for(var d=0;d<a[c].length;d++)b+="?"==b?"":"&",b+=encodeURIComponent(c)+"="+encodeURIComponent(a[c][d]);return b},refresh_results:function(c){var e=window.location.search,f=d.split_search(e);return f=d.remove_param(f,"spage"),f=d.remove_param(f,"ssort"),f=d.remove_param(f,"sid"),f=d.remove_param(f,"clearfilters"),e=d.build_search(f),a.post(b.wwwroot+"/totara/reportbuilder/ajax/instantreport.php"+e,a(".rb-sidebar").serialize()).done(function(b){var d=a(".instantfilterwait");d.siblings(".sr-only").remove(),d.remove(),a(".rb-display-table-container").replaceWith(a(b).find(".rb-display-table-container")),a(".rb-record-count").text(a(b).find(".rb-record-count").text()),a(".rb-report-svggraph").replaceWith(a(b).find(".rb-report-svggraph")),a(".rb-report-pdfgraph").replaceWith(a(b).find(".rb-report-pdfgraph")),a(b).find(".rb-sidebar.mform label").each(function(b,c){var d=a(c);d.attr("for")&&a('label[for="'+d.attr("for")+'"]').html(d.html())}),c&&c()})}};return d});
define('totara_reportbuilder/report', ["core/webapi"],function(a){function b(a){this.element=a,this.id=a.getAttribute("data-report-id")}function c(a){return new Promise(function(c){var d=new b(a);d.events(),c(d)})}return b.prototype.events=function(){var a=this;this.element.addEventListener("totara_core/inline-edit:save",function(b){b.detail.preventUpdate(),a.save(b.detail.text).then(function(a){var c=document.createElement("textarea");c.innerHTML=a,b.detail.target.innerText=c.value})["catch"](function(a){a.message&&a.message.indexOf("Internal server error")&&(b.detail.controller.edit(),b.detail.controller.showCustomError("err_required","form"))})})},b.prototype.save=function(b){var c=a.call({operationName:"totara_reportbuilder_update_report_title",variables:{reportid:this.id,title:b}}).then(function(a){return a.totara_reportbuilder_update_report_title});return M.util.js_pending("totara_reportbuilder-title-save"),c.then(function(){M.util.js_complete("totara_reportbuilder-title-save")}),c},{init:c}});
define('totara_reportbuilder/resizer', ["core/yui"],function(a){var b=function(a){this.node=a,this.blockNode=a.closest("[data-instanceid]"),this.blockNode&&(this.blockinstanceid=this.blockNode.getAttribute("data-instanceid")),this.addEvents(),this.checkResize()};return b.prototype={node:null,blockNode:null,blockinstanceid:-1,resizePending:!1,addEvents:function(){var a=this;if(window.addEventListener("resize",this.checkResize.bind(this)),this.addDockListeners(),document.body.classList.contains("editing")){var b=function(b){b.filter(function(a){return"childList"===a.type&&a.target.hasAttribute("data-blockregion")}).forEach(function(b){b.addedNodes.forEach(function(b){b.id=="inst"+a.blockinstanceid&&a.checkResize()})})},c=new MutationObserver(b);c.observe(document.body,{attributes:!1,childList:!0,subtree:!0})}},addDockListeners:function(){var b=this;a.use("moodle-core-dock",function(){var a=M.core.dock.get();a.on("dock:resizepanelcomplete",function(){var a=document.querySelector("#dock .block_current_learning");a&&b.checkResize()}),a.on("dock:itemremoved",function(){var a=document.getElementById("inst"+b.blockinstanceid);a&&b.checkResize()})})},checkResize:function(){this.resizePending||(this.resizePending=!0,setTimeout(this.doResize.bind(this),50))},doResize:function(){var a=parseInt(getComputedStyle(this.node).width,10),b=Math.floor(a/214)||1,c=this.node.querySelectorAll(".rb-chartjs__chart");if(b=Math.min(c.length,b),this.node.setAttribute("data-items-per-row",b),1===b&&this.node.firstElementChild){var d=getComputedStyle(this.node.firstElementChild);if(d.maxWidth===d.width){var e=getComputedStyle(this.node).width,f=(parseInt(e,10)-parseInt(d.width,10))/2;c.forEach(function(a){a.style.marginLeft=f+"px",a.style.marginRight=f+"px"})}else c.forEach(function(a){a.style.marginLeft="",a.style.marginRight=""})}this.resizePending=!1}},{init:function(a){var c=new b(a);Promise.resolve(c)}}});
define('totara_reportedcontent/report', ["core/webapi","core/modal_factory","core/modal_events"],function(a,b,c){var d={approveContent:"totara_reportedcontent_approve_review",removeContent:"totara_reportedcontent_remove_review"},e=function(a,b){document.querySelector("#reportedcontent-actions-"+a+" .actions").style.display="none",document.querySelector("#reportedcontent-actions-"+a+" .loading").style.display="none",document.querySelector("#reportedcontent-actions-"+a+" .status-"+b).style.display="block"},f=function(a,b){var c=document.querySelector("#reportedcontent-time-reviewed-"+a);c&&(c.textContent=b)},g=function(a){document.querySelector("#reportedcontent-actions-"+a+" .loading").style.display="block",document.querySelector("#reportedcontent-actions-"+a+" .actions").style.display="none"},h=function(){var h=document.querySelector('table[data-source="rb_source_reportedcontent"]');if(h){var i=function(b,c){M.util.js_pending(b),g(c),a.call({operationName:b,variables:{review_id:c}}).then(function(a){e(c,a.review.status),f(c,a.review.time_reviewed_description),M.util.js_complete(b)})},j=function(a){var e=a.target||void 0;if(e&&"BUTTON"===e.tagName){var f=e.getAttribute("data-report")||null,g=e.getAttribute("data-action")||null;f&&g&&("approve"===g?i(d.approveContent,f):"remove"===g&&b.create({type:b.types.CONFIRM,title:e.getAttribute("data-modal-title"),body:e.getAttribute("data-modal-content")},void 0,{yesstr:e.getAttribute("data-yes"),nostr:e.getAttribute("data-no")}).done(function(a){a.getRoot().on(c.yes,function(){i(d.removeContent,f)}),a.show()}))}};h.addEventListener("click",j)}};return{init:h}});
define('totara_topic/report_actions', ["core/modal_factory","core/modal_events"],function(a,b){function c(a){return this instanceof c?void(this.moduleElement=a):new c(a)}return c.prototype={constructor:c,listenToDelete:function(c,d){var e=this.moduleElement.querySelector(c),f=this.moduleElement.querySelector(d),g=this;e&&f&&e.addEventListener("click",function(c){var d=g.moduleElement.getAttribute("data-has-usage");c.preventDefault();var e=new Promise(function(c){return 0==d||0==d?void c():void a.create({type:a.types.CONFIRM,title:g.moduleElement.getAttribute("data-modal-title"),body:g.moduleElement.getAttribute("data-confirm-message")},void 0,{yesstr:g.moduleElement.getAttribute("data-yes-string"),nostr:g.moduleElement.getAttribute("data-no-string")}).done(function(a){var d=a.getRoot();d.on(b.yes,function(){a.hide(),c()}),a.show()})});e.then(function(){f.submit()})})}},{init:function(a){var b=new c(a);b.listenToDelete(".tw-reportActions__deleteIcon",".tw-reportActions__deleteForm")}}});
define('totara_userdata/item_select', ["jquery","core/str"],function(a,b){var c=function(c,d){var e=[{key:"selectall",component:"core"},{key:"deselectall",component:"core"}];b.get_strings(e).done(function(b){var e="tfiid_"+c+"_totara_userdata_form_"+d+"_type_edit",f=a('[data-element-id="'+e+'"] .totara_form_element_static_html'),g='<a href="#" class="select">'+b[0]+'</a> / <a href="#" class="deselect">'+b[1]+"</a>";f.append(g),f.on("click",".select",function(b){b.preventDefault(),a('[data-item-classification="group"] input[type="checkbox"]').prop("checked",!0)}),f.on("click",".deselect",function(b){b.preventDefault(),a('[data-item-classification="group"] input[type="checkbox"]').prop("checked",!1)})})};return{init:c}});
define('tool_sitepolicy/form_element_consent_statement', ["jquery","totara_form/form","core/templates"],function(a,b){function c(a,d,e,f){return this instanceof c?(b.Element.apply(this,arguments),void(this.input=null)):new c(a,d,e,f)}return c.prototype=Object.create(b.Element.prototype),c.constructor=c,c.prototype.toString=function(){return"[object ConsentStatement]"},c.prototype.init=function(b){var c=this.getForm(),d=a(this.getNode()),e=d.find('input[data-rel="addstatement"]'),f=d.find('input[data-rel="removestatement"]'),g=a("#"+this.id).attr("data-element-name"),h=a(d.find('input[name="'+g+'__addstatement"]')),i=this;e.on("click",function(){h.val(1),c.reload()}),f.on("click",function(b){M.util.js_pending("tool_sitepolicy-consent_statement_removal"),b.preventDefault();var c,d=a(this),e=a(d.closest('div[data-rel="statement-block"]')),f=a(e.find('input[name="'+g+"__removedstatement["+d.data("index")+']"]'));c=i.delete_confirm(b,function(){f.val(1),e.addClass("hidden"),e.find("input[required]").removeAttr("required")}),c.done(function(){M.util.js_complete("tool_sitepolicy-consent_statement_removal")})}),b()},c.prototype.delete_confirm=function(b,c){var d=a.Deferred();return require(["core/modal_factory","core/modal_events","core/str"],function(e,f,g){var h=[{key:"deleteconsentconfirmtitle",component:"tool_sitepolicy"},{key:"deleteconsentconfirmbody",component:"tool_sitepolicy"}],i=g.get_strings(h);i.done(function(g){var h={type:e.types.CONFIRM,title:g[0],body:g[1]},i=e.create(h,a(b));i.done(function(a){var b=a.getRoot();b.on(f.yes,c),b.on(f.shown,d.resolve),a.show()})})}),d.promise()},c});
define('tool_sitepolicy/translationform', ["jquery"],function(a){var b={init:function(){var b=a("#tfiid_preview_tool_sitepolicy_form_translationform").val();"1"==b&&(a("#tf_fid_tool_sitepolicy_form_translationform").prev("h2").hide(),a(".totara_form-required_note").hide()),a("#tfiid_previewbutton_tool_sitepolicy_form_translationform").on("click",function(b){a("#tfiid_preview_tool_sitepolicy_form_translationform").val("1")}),a("#tfiid_continuebutton_tool_sitepolicy_form_translationform").on("click",function(b){b.preventDefault(),a("#tfiid_preview_tool_sitepolicy_form_translationform").val(""),a("#tfiid_preview_tool_sitepolicy_form_translationform").trigger("change"),a("#tf_fid_tool_sitepolicy_form_translationform").prev("h2").show(),a(".totara_form-required_note").show()})}};return b});
define('tool_sitepolicy/versionform', ["jquery"],function(a){var b={init:function(){var b=a("#tfiid_preview_tool_sitepolicy_form_versionform").val();"1"==b&&(a("#tf_fid_tool_sitepolicy_form_versionform").prev("h2").hide(),a(".totara_form-required_note").hide()),a("#tfiid_previewbutton_tool_sitepolicy_form_versionform").on("click",function(b){a("#tfiid_preview_tool_sitepolicy_form_versionform").val("1")}),a("#tfiid_continuebutton_tool_sitepolicy_form_versionform").on("click",function(b){b.preventDefault(),a("#tfiid_preview_tool_sitepolicy_form_versionform").val(""),a("#tfiid_preview_tool_sitepolicy_form_versionform").trigger("change"),a("#tf_fid_tool_sitepolicy_form_versionform").prev("h2").show(),a(".totara_form-required_note").show()})}};return b});
define('tool_templatelibrary/display', ["jquery","core/ajax","core/log","core/notification","core/templates","core/config","core/str"],function(a,b,c,d,e,f,g){var h=function(a,b){if(!a)return!1;var c="@template "+b,d=0,e=[];if(e=a.match(/{{!([\s\S]*?)}}/g),null!==e)for(d=0;d<e.length;d++){var f=e[d],g=f.indexOf(c);if(g!==-1){var h=g+c.length+1;return f=f.substr(h,f.length-2-h)}}return!1},i=function(b,i,j){g.get_string("templateselected","tool_templatelibrary",b).done(function(b){a('[data-region="displaytemplateheader"]').text(b)}).fail(d.exception);var k=h(i,b);k===!1&&(k=h(j,b)),k&&(i=k),a('[data-region="displaytemplatesource"]').text(i);var l=i.match(/Example context \(json\):([\s\S]*)/),m=!1;if(l){var n=l[1].trim();n=n.replace(/__WWWROOT__/g,f.wwwroot),n=n.replace(/__THEME__/g,f.theme);try{m=a.parseJSON(n)}catch(o){c.debug("Could not parse json example context for template."),c.debug(o)}}m?e.render(b,m).done(function(b,c){e.replaceNodeContents(a('[data-region="displaytemplateexample"]'),b,c)}).fail(d.exception):g.get_string("templatehasnoexample","tool_templatelibrary").done(function(b){a('[data-region="displaytemplateexample"]').text(b)}).fail(d.exception)},j=function(c){var e=c.split("/"),g=e.shift(),h=e.shift(),j=b.call([{methodname:"core_output_load_template",args:{component:g,template:h,themename:f.theme}},{methodname:"tool_templatelibrary_load_canonical_template",args:{component:g,template:h}}],!0,!1);a.when.apply(a,j).done(function(a,b){i(c,a,b)}).fail(d.exception)};return a('[data-region="list-templates"]').on("click","[data-templatename]",function(b){var c=a(this).data("templatename");b.preventDefault(),j(c)}),{}});
define('tool_templatelibrary/search', ["jquery","core/ajax","core/log","core/notification","core/templates","core/config"],function(a,b,c,d,e,f){var g=function(b){e.render("tool_templatelibrary/search_results",{templates:b}).done(function(b,c){e.replaceNode(a('[data-region="searchresults"]'),b,c)}).fail(d.exception)},h=function(c){var e=a('[data-field="component"]').val(),f=a('[data-field="search"]').val();document.location.hash=f,b.call([{methodname:"tool_templatelibrary_list_templates",args:{component:e,search:f,themename:c},done:g,fail:d.exception}],!0,!1)},i=null,j=function(a,b){null!==i&&window.clearTimeout(i),i=window.setTimeout(function(){a(),i=null},b)},k=function(){j(h.bind(this,f.theme),400)};return a('[data-region="list-templates"]').on("change",'[data-field="component"]',k),a('[data-region="list-templates"]').on("input",'[data-field="search"]',k),a('[data-field="search"]').val(document.location.hash.replace("#","")),h(f.theme),{}});
define('tool_usertours/managesteps', ["jquery","core/str","core/notification"],function(a,b,c){var d={removeStep:function(d){d.preventDefault(),b.get_strings([{key:"confirmstepremovaltitle",component:"tool_usertours"},{key:"confirmstepremovalquestion",component:"tool_usertours"},{key:"yes",component:"moodle"},{key:"no",component:"moodle"}]).done(function(b){c.confirm(b[0],b[1],b[2],b[3],a.proxy(function(){window.location=a(this).attr("href")},d.currentTarget))})},setup:function(){a("body").delegate('[data-action="delete"]',"click",d.removeStep)}};return{setup:d.setup}});
define('tool_usertours/managetours', ["jquery","core/ajax","core/str","core/notification"],function(a,b,c,d){var e={removeTour:function(b){b.preventDefault(),c.get_strings([{key:"confirmtourremovaltitle",component:"tool_usertours"},{key:"confirmtourremovalquestion",component:"tool_usertours"},{key:"yes",component:"moodle"},{key:"no",component:"moodle"}]).done(function(c){d.confirm(c[0],c[1],c[2],c[3],a.proxy(function(){window.location=a(this).attr("href")},b.currentTarget))})},setup:function(){a("body").delegate('[data-action="delete"]',"click",e.removeTour)}};return{setup:e.setup}});
!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define('tool_usertours/popper', b):a.Popper=b()}(this,function(){"use strict";function a(a){var b=a.offsetParent,c=b&&b.nodeName;return c&&"BODY"!==c&&"HTML"!==c?b:window.document.documentElement}function b(a,b){if(1!==a.nodeType)return[];var c=window.getComputedStyle(a,null);return b?c[b]:c}function c(a){return"HTML"===a.nodeName?a:a.parentNode||a.host}function d(a){if(!a||["HTML","BODY","#document"].indexOf(a.nodeName)!==-1)return window.document.body;var e=b(a),f=e.overflow,g=e.overflowX,h=e.overflowY;return/(auto|scroll)/.test(f+h+g)?a:d(c(a))}function e(a){var d=a.nodeName;return"BODY"!==d&&"HTML"!==d&&("fixed"===b(a,"position")||e(c(a)))}function f(b){var c=a(b),d=e(c);return d?"fixed":"absolute"}function g(a,b){var c="x"===b?"Left":"Top",d="Left"===c?"Right":"Bottom";return Number(a["border"+c+"Width"].split("px")[0])+Number(a["border"+d+"Width"].split("px")[0])}function h(a){var c=navigator.appVersion.indexOf("MSIE 10")!==-1,d=void 0;if(c)try{d=a.getBoundingClientRect()}catch(e){d={}}else d=a.getBoundingClientRect();var f={left:d.left,top:d.top,right:d.right,bottom:d.bottom,width:d.right-d.left,height:d.bottom-d.top};if("HTML"===a.nodeName&&c){var h=window.document.documentElement,i=h.scrollTop,j=h.scrollLeft;f.top-=i,f.bottom-=i,f.left-=j,f.right-=j}var k=d.width-(a.clientWidth||d.right-d.left),l=d.height-(a.clientHeight||d.bottom-d.top);if(k||l){var m=b(a);k-=g(m,"x"),l-=g(m,"y")}return f.right-=k,f.width-=k,f.bottom-=l,f.height-=l,f}function i(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",c="top"===b?"scrollTop":"scrollLeft",d=a.nodeName;if("BODY"===d||"HTML"===d){var e=window.document.documentElement,f=window.document.scrollingElement||e;return f[c]}return a[c]}function j(a,b){var c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],d=i(b,"top"),e=i(b,"left"),f=c?-1:1;return a.top+=d*f,a.bottom+=d*f,a.left+=e*f,a.right+=e*f,a}function k(c,e){var f=arguments.length>2&&void 0!==arguments[2]&&arguments[2],g=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=d(e),k=h(c),l=h(e),m={top:k.top-l.top,left:k.left-l.left,bottom:k.top-l.top+k.height,right:k.left-l.left+k.width,width:k.width,height:k.height};f&&!g?m=j(m,i,!0):a(c).contains(i)&&"BODY"!==i.nodeName&&(m=j(m,e));var n=b(e),o=Number(n.borderTopWidth.split("px")[0]),p=Number(n.borderLeftWidth.split("px")[0]);return m.top-=o,m.bottom-=o,m.left-=p,m.right-=p,m}function l(){var a=window.document.body,b=window.document.documentElement;return{height:Math.max(a.scrollHeight,a.offsetHeight,b.clientHeight,b.scrollHeight,b.offsetHeight),width:Math.max(a.scrollWidth,a.offsetWidth,b.clientWidth,b.scrollWidth,b.offsetWidth)}}function m(a){var b=void 0;if("HTML"===a.nodeName){var c=l(),d=c.width,e=c.height;b={width:d,height:e,left:0,top:0}}else b={width:a.offsetWidth,height:a.offsetHeight,left:a.offsetLeft,top:a.offsetTop};return b.right=b.left+b.width,b.bottom=b.top+b.height,b}function n(b){var c=m(b);if("HTML"!==b.nodeName){var d=a(b),e=n(d),f={width:c.offsetWidth,height:c.offsetHeight,left:c.left+e.left,top:c.top+e.top,right:c.right-e.right,bottom:c.bottom-e.bottom};return f}return c}function o(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",e=d(a),f=i(e,b);return["BODY","HTML"].indexOf(e.nodeName)===-1?f+o(c(e),b):f}function p(b,g,h){var i={top:0,left:0},j=a(b);if("viewport"===h){var m=n(j),p=m.left,q=m.top,r=window.document.documentElement,s=r.clientWidth,t=r.clientHeight;if("fixed"===f(b))i.right=s,i.bottom=t;else{var u=o(b,"left"),v=o(b,"top");i={top:0-q,right:s-p+u,bottom:t-q+v,left:0-p}}}else{var w=void 0;if(w="scrollParent"===h?d(c(b)):"window"===h?window.document.body:h,"BODY"===w.nodeName){var x=l(),y=x.height,z=x.width;i.right=z,i.bottom=y}else i=k(w,j,e(b))}return i.left+=g,i.top+=g,i.right-=g,i.bottom-=g,i}function q(a,b,c){if(a.indexOf("auto")===-1)return a;var d=p(c,0,"scrollParent"),e={top:b.top-d.top,right:d.right-b.right,bottom:d.bottom-b.bottom,left:b.left-d.left},f=Object.keys(e).sort(function(a,b){return e[b]-e[a]})[0],g=a.split("-")[1];return f+(g?"-"+g:"")}function r(a){var b=!1,c=0,d=document.createElement("span"),e=new MutationObserver(function(){a(),b=!1});return e.observe(d,{attributes:!0}),function(){b||(b=!0,d.setAttribute("x-index",c),c+=1)}}function s(a){var b=!1;return function(){b||(b=!0,setTimeout(function(){b=!1,a()},_))}}function t(a,b){return Array.prototype.find?a.find(b):a.filter(b)[0]}function u(a,b,c){if(Array.prototype.findIndex)return a.findIndex(function(a){return a[b]===c});var d=t(a,function(a){return a[b]===c});return a.indexOf(d)}function v(a){return ga({},a,{right:a.left+a.width,bottom:a.top+a.height})}function w(a){var b=window.getComputedStyle(a),c=parseFloat(b.marginTop)+parseFloat(b.marginBottom),d=parseFloat(b.marginLeft)+parseFloat(b.marginRight),e={width:a.offsetWidth+d,height:a.offsetHeight+c};return e}function x(a){var b={left:"right",right:"left",bottom:"top",top:"bottom"};return a.replace(/left|right|bottom|top/g,function(a){return b[a]})}function y(a,b,c,d){d=d.split("-")[0];var e=w(b),f={position:a,width:e.width,height:e.height},g=["right","left"].indexOf(d)!==-1,h=g?"top":"left",i=g?"left":"top",j=g?"height":"width",k=g?"width":"height";return f[h]=c[h]+c[j]/2-e[j]/2,d===i?f[i]=c[i]-e[k]:f[i]=c[x(i)],f}function z(b,c,d){var e="fixed"===b.position,f=b.isParentTransformed,g=a(e&&f?d:c);return k(d,g,e,f)}function A(a){for(var b=[!1,"ms","webkit","moz","o"],c=a.charAt(0).toUpperCase()+a.slice(1),d=0;d<b.length-1;d++){var e=b[d],f=e?""+e+c:a;if("undefined"!=typeof window.document.body.style[f])return f}return null}function B(a){var b={};return a&&"[object Function]"===b.toString.call(a)}function C(a,b){return a.some(function(a){var c=a.name,d=a.enabled;return d&&c===b})}function D(a,b,c){var d=t(a,function(a){var c=a.name;return c===b});return!!d&&a.some(function(a){return a.name===c&&a.enabled&&a.order<d.order})}function E(a){return""!==a&&!isNaN(parseFloat(a))&&isFinite(a)}function F(a){return"BODY"!==a.nodeName&&("none"!==b(a,"transform")||(c(a)?F(c(a)):a))}function G(a,b){return window.removeEventListener("resize",b.updateBound),b.scrollParents.forEach(function(a){a.removeEventListener("scroll",b.updateBound)}),b.updateBound=null,b.scrollParents=[],b.scrollElement=null,b.eventsEnabled=!1,b}function H(a,b,c){var d=void 0===c?a:a.slice(0,u(a,"name",c));return d.forEach(function(a){a.enabled&&B(a["function"])&&(b=a["function"](b,a))}),b}function I(a,b){Object.keys(b).forEach(function(c){var d=b[c];d!==!1?a.setAttribute(c,b[c]):a.removeAttribute(c)})}function J(a,b){Object.keys(b).forEach(function(c){var d="";["width","height","top","right","bottom","left"].indexOf(c)!==-1&&E(b[c])&&(d="px"),a.style[c]=b[c]+d})}function K(a,b,c,e){var f="BODY"===a.nodeName,g=f?window:a;g.addEventListener(b,c,{passive:!0}),f||K(d(g.parentNode),b,c,e),e.push(g)}function L(a,b,c,e){c.updateBound=e,window.addEventListener("resize",c.updateBound,{passive:!0});var f=d(a);return K(f,"scroll",c.updateBound,c.scrollParents),c.scrollElement=f,c.eventsEnabled=!0,c}function M(a,b){var c={position:a.offsets.popper.position},d={"x-placement":a.placement},e=Math.round(a.offsets.popper.left),f=Math.round(a.offsets.popper.top),g=A("transform");return b.gpuAcceleration&&g?(c[g]="translate3d("+e+"px, "+f+"px, 0)",c.top=0,c.left=0,c.willChange="transform"):(c.left=e,c.top=f,c.willChange="top, left"),J(a.instance.popper,ga({},c,a.styles)),I(a.instance.popper,ga({},d,a.attributes)),a.offsets.arrow&&J(a.arrowElement,a.offsets.arrow),a}function N(a,b,c,d,e){var f=z(e,b,a);return c.placement=q(c.placement,f,b),b.setAttribute("x-placement",c.placement),c}function O(a,b){if(!D(a.instance.modifiers,"arrow","keepTogether"))return console.warn("WARNING: `keepTogether` modifier is required by arrow modifier in order to work, be sure to include it before `arrow`!"),a;var c=b.element;if("string"==typeof c){if(c=a.instance.popper.querySelector(c),!c)return a}else if(!a.instance.popper.contains(c))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),a;var d=a.placement.split("-")[0],e=v(a.offsets.popper),f=a.offsets.reference,g=["left","right"].indexOf(d)!==-1,h=g?"height":"width",i=g?"top":"left",j=g?"left":"top",k=g?"bottom":"right",l=w(c)[h];f[k]-l<e[i]&&(a.offsets.popper[i]-=e[i]-(f[k]-l)),f[i]+l>e[k]&&(a.offsets.popper[i]+=f[i]+l-e[k]);var m=f[i]+f[h]/2-l/2,n=m-v(a.offsets.popper)[i];return n=Math.max(Math.min(e[h]-l,n),0),a.arrowElement=c,a.offsets.arrow={},a.offsets.arrow[i]=n,a.offsets.arrow[j]="",a}function P(a){return"end"===a?"start":"start"===a?"end":a}function Q(a,b){if(C(a.instance.modifiers,"inner"))return a;if(a.flipped&&a.placement===a.originalPlacement)return a;var c=p(a.instance.popper,b.padding,b.boundariesElement),d=a.placement.split("-")[0],e=x(d),f=a.placement.split("-")[1]||"",g=[];return g="flip"===b.behavior?[d,e]:b.behavior,g.forEach(function(h,i){if(d!==h||g.length===i+1)return a;d=a.placement.split("-")[0],e=x(d);var j=v(a.offsets.popper),k=a.offsets.reference,l=Math.floor,m="left"===d&&l(j.right)>l(k.left)||"right"===d&&l(j.left)<l(k.right)||"top"===d&&l(j.bottom)>l(k.top)||"bottom"===d&&l(j.top)<l(k.bottom),n=l(j.left)<l(c.left),o=l(j.right)>l(c.right),p=l(j.top)<l(c.top),q=l(j.bottom)>l(c.bottom),r="left"===d&&n||"right"===d&&o||"top"===d&&p||"bottom"===d&&q,s=["top","bottom"].indexOf(d)!==-1,t=!!b.flipVariations&&(s&&"start"===f&&n||s&&"end"===f&&o||!s&&"start"===f&&p||!s&&"end"===f&&q);(m||r||t)&&(a.flipped=!0,(m||r)&&(d=g[i+1]),t&&(f=P(f)),a.placement=d+(f?"-"+f:""),a.offsets.popper=y(a.instance.state.position,a.instance.popper,a.offsets.reference,a.placement),a=H(a.instance.modifiers,a,"flip"))}),a}function R(a){var b=v(a.offsets.popper),c=a.offsets.reference,d=a.placement.split("-")[0],e=Math.floor,f=["top","bottom"].indexOf(d)!==-1,g=f?"right":"bottom",h=f?"left":"top",i=f?"width":"height";return b[g]<e(c[h])&&(a.offsets.popper[h]=e(c[h])-b[i]),b[h]>e(c[g])&&(a.offsets.popper[h]=e(c[g])),a}function S(a,b){var c=a.placement,d=a.offsets.popper,e=void 0;return E(b.offset)?e=[b.offset,0]:(e=b.offset.split(" "),e=e.map(function(b,d){var e=b.match(/(\d*\.?\d*)(.*)/),f=+e[1],g=e[2],h=c.indexOf("right")!==-1||c.indexOf("left")!==-1;1===d&&(h=!h);var i=h?"height":"width";if(0===g.indexOf("%")){var j=void 0;switch(g){case"%p":j=a.offsets.popper;break;case"%":case"$r":default:j=a.offsets.reference}var k=v(j),l=k[i];return l/100*f}if("vh"===g||"vw"===g){var m=void 0;return m="vh"===g?Math.max(document.documentElement.clientHeight,window.innerHeight||0):Math.max(document.documentElement.clientWidth,window.innerWidth||0),m/100*f}return"px"===g?+f:+b})),a.placement.indexOf("left")!==-1?(d.top+=e[0],d.left-=e[1]||0):a.placement.indexOf("right")!==-1?(d.top+=e[0],d.left+=e[1]||0):a.placement.indexOf("top")!==-1?(d.left+=e[0],d.top-=e[1]||0):a.placement.indexOf("bottom")!==-1&&(d.left+=e[0],d.top+=e[1]||0),a}function T(b,c){var d=c.boundariesElement||a(b.instance.popper),e=p(b.instance.popper,c.padding,d);c.boundaries=e;var f=c.priority,g=v(b.offsets.popper),h={primary:function(a){var b=g[a];return g[a]<e[a]&&!c.escapeWithReference&&(b=Math.max(g[a],e[a])),fa({},a,b)},secondary:function(a){var b="right"===a?"left":"top",d=g[b];return g[a]>e[a]&&!c.escapeWithReference&&(d=Math.min(g[b],e[a]-("right"===a?g.width:g.height))),fa({},b,d)}};return f.forEach(function(a){var b=["left","top"].indexOf(a)!==-1?"primary":"secondary";g=ga({},g,h[b](a))}),b.offsets.popper=g,b}function U(a){var b=a.placement,c=b.split("-")[0],d=b.split("-")[1];if(d){var e=a.offsets.reference,f=v(a.offsets.popper),g=["bottom","top"].indexOf(c)!==-1,h=g?"left":"top",i=g?"width":"height",j={start:fa({},h,e[h]),end:fa({},h,e[h]+e[i]-f[i])};a.offsets.popper=ga({},f,j[d])}return a}function V(a){if(!D(a.instance.modifiers,"hide","preventOverflow"))return console.warn("WARNING: preventOverflow modifier is required by hide modifier in order to work, be sure to include it before hide!"),a;var b=a.offsets.reference,c=t(a.instance.modifiers,function(a){return"preventOverflow"===a.name}).boundaries;if(b.bottom<c.top||b.left>c.right||b.top>c.bottom||b.right<c.left){if(a.hide===!0)return a;a.hide=!0,a.attributes["x-out-of-boundaries"]=""}else{if(a.hide===!1)return a;a.hide=!1,a.attributes["x-out-of-boundaries"]=!1}return a}function W(a){var b=a.placement,c=b.split("-")[0],d=v(a.offsets.popper),e=v(a.offsets.reference),f=["left","right"].indexOf(c)!==-1,g=["top","left"].indexOf(c)===-1;return d[f?"left":"top"]=e[b]-(g?d[f?"width":"height"]:0),a.placement=x(b),a.offsets.popper=v(d),a}for(var X=["native code","[object MutationObserverConstructor]"],Y=function(a){return X.some(function(b){return(a||"").toString().indexOf(b)>-1})},Z="undefined"!=typeof window,$=["Edge","Trident","Firefox"],_=0,aa=0;aa<$.length;aa+=1)if(Z&&navigator.userAgent.indexOf($[aa])>=0){_=1;break}var ba=Z&&Y(window.MutationObserver),ca=ba?r:s,da=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},ea=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),fa=function(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a},ga=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},ha={computeAutoPlacement:q,debounce:ca,findIndex:u,getBordersSize:g,getBoundaries:p,getBoundingClientRect:h,getClientRect:v,getOffsetParent:a,getOffsetRect:m,getOffsetRectRelativeToCustomParent:k,getOuterSizes:w,getParentNode:c,getPopperOffsets:y,getPosition:f,getReferenceOffsets:z,getScroll:i,getScrollParent:d,getStyleComputedProperty:b,getSupportedPropertyName:A,getTotalScroll:o,getWindowSizes:l,includeScroll:j,isFixed:e,isFunction:B,isModifierEnabled:C,isModifierRequired:D,isNative:Y,isNumeric:E,isTransformed:F,removeEventListeners:G,runModifiers:H,setAttributes:I,setStyles:J,setupEventListeners:L},ia={shift:{order:100,enabled:!0,"function":U},offset:{order:200,enabled:!0,"function":S,offset:0},preventOverflow:{order:300,enabled:!0,"function":T,priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,"function":R},arrow:{order:500,enabled:!0,"function":O,element:"[x-arrow]"},flip:{order:600,enabled:!0,"function":Q,behavior:"flip",padding:5,boundariesElement:"viewport"},inner:{order:700,enabled:!1,"function":W},hide:{order:800,enabled:!0,"function":V},applyStyle:{order:900,enabled:!0,gpuAcceleration:!0,"function":M,onLoad:N}},ja={placement:"bottom",eventsEnabled:!0,onCreate:function(){},onUpdate:function(){},modifiers:ia},ka=function(){function a(b,c){var d=this,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};da(this,a),this.scheduleUpdate=function(){return requestAnimationFrame(d.update)},this.update=ca(this.update.bind(this)),this.options=ga({},a.Defaults,e),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=b.jquery?b[0]:b,this.popper=c.jquery?c[0]:c,this.modifiers=Object.keys(a.Defaults.modifiers).map(function(b){return ga({name:b},a.Defaults.modifiers[b])}),this.modifiers=this.modifiers.map(function(a){var b=e.modifiers&&e.modifiers[a.name]||{};return ga({},a,b)}),e.modifiers&&(this.options.modifiers=ga({},a.Defaults.modifiers,e.modifiers),Object.keys(e.modifiers).forEach(function(b){if(void 0===a.Defaults.modifiers[b]){var c=e.modifiers[b];c.name=b,d.modifiers.push(c)}})),this.state.position=f(this.reference),this.modifiers=this.modifiers.sort(function(a,b){return a.order-b.order}),this.modifiers.forEach(function(a){a.enabled&&B(a.onLoad)&&a.onLoad(d.reference,d.popper,d.options,a,d.state)}),this.state.isParentTransformed=F(this.popper.parentNode),this.update();var g=this.options.eventsEnabled;g&&this.enableEventListeners(),this.state.eventsEnabled=g}return ea(a,[{key:"update",value:function(){if(!this.state.isDestroyed){var a={instance:this,styles:{},attributes:{},flipped:!1,offsets:{}};this.state.position=f(this.reference),J(this.popper,{position:this.state.position}),a.offsets.reference=z(this.state,this.popper,this.reference),a.placement=q(this.options.placement,a.offsets.reference,this.popper),a.originalPlacement=this.options.placement,a.offsets.popper=y(this.state,this.popper,a.offsets.reference,a.placement),a=H(this.modifiers,a),this.state.isCreated?this.options.onUpdate(a):(this.state.isCreated=!0,this.options.onCreate(a))}}},{key:"destroy",value:function(){return this.state.isDestroyed=!0,C(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.left="",this.popper.style.position="",this.popper.style.top="",this.popper.style[A("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}},{key:"enableEventListeners",value:function(){this.state.eventsEnabled||(this.state=L(this.reference,this.options,this.state,this.scheduleUpdate))}},{key:"disableEventListeners",value:function(){this.state.eventsEnabled&&(window.cancelAnimationFrame(this.scheduleUpdate),this.state=G(this.reference,this.state))}}]),a}();return ka.Utils=ha,ka.placements=["auto","auto-start","auto-end","top","top-start","top-end","right","right-start","right-end","bottom","bottom-start","bottom-end","left","left-start","left-end"],ka.Defaults=ja,ka});
!function(a,b){"function"==typeof define&&define.amd?define('tool_usertours/tour', ["jquery","./popper"],function(c,d){return a.Tour=b(c,d)}):"object"==typeof module&&module.exports?module.exports=b(require("jquery"),require("popper.js")):a.Tour=b(a.$,a.Popper)}(this,function(a,b){"use strict";function c(a){this.init(a)}var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};return c.prototype.tourName,c.prototype.storageKey,c.prototype.storage,c.prototype.originalConfiguration,c.prototype.listeners,c.prototype.eventHandlers,c.prototype.steps,c.prototype.currentStepNode,c.prototype.currentStepNumber,c.prototype.currentStepPopper,c.prototype.currentStepConfig,c.prototype.templateContent,c.prototype.init=function(a){this.eventHandlers={},this.reset(),this.originalConfiguration=a||{},this.configure.apply(this,arguments);try{this.storage=window.sessionStorage,this.storageKey="tourstate_"+this.tourName}catch(b){this.storage=!1,this.storageKey=""}return this},c.prototype.reset=function(){return this.hide(),this.eventHandlers=[],this.resetStepListeners(),this.originalConfiguration={},this.steps=[],this.currentStepNumber=0,this},c.prototype.configure=function(a){var b=this;return"object"===("undefined"==typeof a?"undefined":d(a))&&("undefined"!=typeof a.tourName&&(this.tourName=a.tourName),a.eventHandlers&&!function(){var c=void 0;for(c in a.eventHandlers)a.eventHandlers[c].forEach(function(a){this.addEventHandler(c,a)},b)}(),this.resetStepDefaults(!0),"object"===d(a.steps)&&(this.steps=a.steps),"undefined"!=typeof a.template&&(this.templateContent=a.template)),this.checkMinimumRequirements(),this},c.prototype.checkMinimumRequirements=function(){if(!this.tourName)throw new Error("Tour Name required");if(!this.steps||!this.steps.length)throw new Error("Steps must be specified")},c.prototype.resetStepDefaults=function(a){return"undefined"==typeof a&&(a=!0),this.stepDefaults={},a&&"undefined"!=typeof this.originalConfiguration.stepDefaults?this.setStepDefaults(this.originalConfiguration.stepDefaults):this.setStepDefaults({}),this},c.prototype.setStepDefaults=function(b){return this.stepDefaults||(this.stepDefaults={}),a.extend(this.stepDefaults,{element:"",placement:"top",delay:0,moveOnClick:!1,moveAfterTime:0,orphan:!1,direction:1},b),this},c.prototype.getCurrentStepNumber=function(){return parseInt(this.currentStepNumber,10)},c.prototype.setCurrentStepNumber=function(a){if(this.currentStepNumber=a,this.storage)try{this.storage.setItem(this.storageKey,a)}catch(b){b.code===DOMException.QUOTA_EXCEEDED_ERR&&this.storage.removeItem(this.storageKey)}},c.prototype.getNextStepNumber=function(a){"undefined"==typeof a&&(a=this.getCurrentStepNumber());for(var b=a+1;b<=this.steps.length;){if(this.isStepPotentiallyVisible(this.getStepConfig(b)))return b;b++}return null},c.prototype.getPreviousStepNumber=function(a){"undefined"==typeof a&&(a=this.getCurrentStepNumber());for(var b=a-1;b>=0;){if(this.isStepPotentiallyVisible(this.getStepConfig(b)))return b;b--}return null},c.prototype.isLastStep=function(a){var b=this.getNextStepNumber(a);return null===b},c.prototype.isFirstStep=function(a){var b=this.getPreviousStepNumber(a);return null===b},c.prototype.isStepPotentiallyVisible=function(a){return!!a&&(!!this.isStepActuallyVisible(a)||(!("undefined"==typeof a.orphan||!a.orphan)||!("undefined"==typeof a.delay||!a.delay)))},c.prototype.isStepActuallyVisible=function(a){if(!a)return!1;var b=this.getStepTarget(a);return!!(b&&b.length&&b.is(":visible"))&&!!b.length},c.prototype.next=function(){return this.gotoStep(this.getNextStepNumber())},c.prototype.previous=function(){return this.gotoStep(this.getPreviousStepNumber(),-1)},c.prototype.gotoStep=function(a,b){if(a<0)return this.endTour();var c=this.getStepConfig(a);return null===c?this.endTour():this._gotoStep(c,b)},c.prototype._gotoStep=function(a,b){if(!a)return this.endTour();if("undefined"!=typeof a.delay&&a.delay&&!a.delayed)return a.delayed=!0,window.setTimeout(this._gotoStep.bind(this),a.delay,a,b),this;if(!a.orphan&&!this.isStepActuallyVisible(a)){var c=b==-1?"getPreviousStepNumber":"getNextStepNumber";return this.gotoStep(this[c](a.stepNumber),b)}return this.hide(),this.fireEventHandlers("beforeRender",a),this.renderStep(a),this.fireEventHandlers("afterRender",a),this},c.prototype.getStepConfig=function(b){if(null===b||b<0||b>=this.steps.length)return null;var c=this.normalizeStepConfig(this.steps[b]);return c=a.extend(c,{stepNumber:b})},c.prototype.normalizeStepConfig=function(b){return"undefined"!=typeof b.reflex&&"undefined"==typeof b.moveAfterClick&&(b.moveAfterClick=b.reflex),"undefined"!=typeof b.element&&"undefined"==typeof b.target&&(b.target=b.element),"undefined"!=typeof b.content&&"undefined"==typeof b.body&&(b.body=b.content),b=a.extend({},this.stepDefaults,b),b=a.extend({},{attachTo:b.target,attachPoint:"after"},b),b.attachTo&&(b.attachTo=a(b.attachTo).first()),b},c.prototype.getStepTarget=function(b){return b.target?a(b.target):null},c.prototype.fireEventHandlers=function(a,b){return"undefined"==typeof this.eventHandlers[a]?this:(this.eventHandlers[a].forEach(function(a){a.call(this,b)},this),this)},c.prototype.addEventHandler=function(a,b){return"undefined"==typeof this.eventHandlers[a]&&(this.eventHandlers[a]=[]),this.eventHandlers[a].push(b),this},c.prototype.processStepListeners=function(b){if(this.listeners.push({node:this.currentStepNode,args:["click",'[data-role="next"]',a.proxy(this.next,this)]},{node:this.currentStepNode,args:["click",'[data-role="previous"]',a.proxy(this.previous,this)]},{node:this.currentStepNode,args:["click",'[data-role="end"]',a.proxy(this.endTour,this)]},{node:a('[data-flexitour="backdrop"]'),args:["click",a.proxy(this.hide,this)]},{node:a("body"),args:["click",a.proxy(function(b){this.currentStepNode.is(b.target)||0!==a(b.target).closest('[data-role="flexitour-step"]').length||this.hide()},this)]},{node:a("body"),args:["keydown",a.proxy(this.handleKeyDown,this)]}),b.moveOnClick){var c=this.getStepTarget(b);this.listeners.push({node:c,args:["click",a.proxy(function(b){0===a(b.target).parents('[data-flexitour="container"]').length&&window.setTimeout(a.proxy(this.next,this),500)},this)]})}return this.listeners.forEach(function(a){a.node.on.apply(a.node,a.args)}),this},c.prototype.resetStepListeners=function(){return this.listeners&&this.listeners.forEach(function(a){a.node.off.apply(a.node,a.args)}),this.listeners=[],this},c.prototype.renderStep=function(b){this.currentStepConfig=b,this.setCurrentStepNumber(b.stepNumber);var c=a(this.getTemplateContent());return c.find('[data-placeholder="title"]').html(b.title),c.find('[data-placeholder="body"]').html(b.body),this.isFirstStep(b.stepNumber)?c.find('[data-role="previous"]').prop("disabled",!0):c.find('[data-role="previous"]').prop("disabled",!1),this.isLastStep(b.stepNumber)?c.find('[data-role="next"]').prop("disabled",!0):c.find('[data-role="next"]').prop("disabled",!1),c.find('[data-role="previous"]').attr("role","button"),c.find('[data-role="next"]').attr("role","button"),c.find('[data-role="end"]').attr("role","button"),b.template=c,this.addStepToPage(b),this.processStepListeners(b),this},c.prototype.getTemplateContent=function(){return a(this.templateContent).clone()},c.prototype.addStepToPage=function(c){var d=(c.template,a('<span data-flexitour="container"></span>').html(c.template).hide()),e=a("body, html").stop(!0,!0);if(this.isStepActuallyVisible(c)){var f=this.getStepTarget(c);f.data("flexitour","target");var g=this.calculateZIndex(f);g&&(c.zIndex=g+1),c.zIndex&&d.css("zIndex",c.zIndex+1),this.positionBackdrop(c),a(document.body).append(d),this.currentStepNode=d,this.currentStepNode.css({top:0,left:0}),e.animate({scrollTop:this.calculateScrollTop(c)}).promise().then(function(){this.positionStep(c),this.revealStep(c)}.bind(this))}else c.orphan&&(c.isOrphan=!0,c.attachTo=a("body").first(),c.attachPoint="append",this.positionBackdrop(c),d.addClass("orphan"),a(document.body).append(d),this.currentStepNode=d,this.currentStepNode.offset(this.calculateStepPositionInPage()),this.currentStepNode.css("position","fixed"),this.currentStepPopper=new b(a("body"),this.currentStepNode[0],{removeOnDestroy:!0,placement:c.placement+"-start",arrowElement:'[data-role="arrow"]',modifiers:{hide:{enabled:!1},applyStyle:{onLoad:null,enabled:!1}}}),this.revealStep(c));return this},c.prototype.revealStep=function(b){return this.currentStepNode.fadeIn("",a.proxy(function(){this.announceStep(b),this.currentStepNode.focus(),window.setTimeout(a.proxy(function(){this.currentStepNode&&this.currentStepNode.focus()},this),100)},this)),this},c.prototype.announceStep=function(a){var b="tour-step-"+this.tourName+"-"+a.stepNumber;this.currentStepNode.attr("id",b);var c=this.currentStepNode.find('[data-placeholder="body"]').first();c.attr("id",b+"-body"),c.attr("role","document");var d=this.currentStepNode.find('[data-placeholder="title"]').first();d.attr("id",b+"-title"),d.attr("aria-labelledby",b+"-body"),this.currentStepNode.attr("role","dialog"),this.currentStepNode.attr("tabindex",0),this.currentStepNode.attr("aria-labelledby",b+"-title"),this.currentStepNode.attr("aria-describedby",b+"-body");var e=this.getStepTarget(a);return e&&(e.attr("tabindex")||e.attr("tabindex",0),e.data("original-describedby",e.attr("aria-describedby")).attr("aria-describedby",b+"-body")),this.accessibilityShow(a),this},c.prototype.handleKeyDown=function(b){var c="a[href], link[href], [draggable=true], [contenteditable=true], :input:enabled, [tabindex], button:enabled";switch(b.keyCode){case 27:this.endTour();break;case 9:(function(){if(this.currentStepConfig.hasBackdrop){var d=a(document.activeElement),e=this.getStepTarget(this.currentStepConfig),f=a(c),g=a('span[data-flexitour="container"]'),h=void 0;e&&(f=f.filter(function(a,b){return null!=e&&(e.has(b).length||g.has(b).length||e.is(b)||g.is(b))})),f.each(function(a,b){if(d.is(b))return h=a,!1});var i=void 0,j=void 0,k=void 0;if(void 0!=h){var l=1;b.shiftKey&&(l=-1),i=h;do i+=l,j=a(f[i]);while(j.length&&j.is(":disabled")||j.is(":hidden"));j.length?(k=j.closest(e).length,k=k||j.closest(this.currentStepNode).length):k=!1}k?j.focus():b.shiftKey?this.currentStepNode.find(c).last().focus():this.currentStepConfig.isOrphan?this.currentStepNode.focus():e.focus(),b.preventDefault()}}).call(this)}},c.prototype.startTour=function(a){if(this.storage&&"undefined"==typeof a){var b=this.storage.getItem(this.storageKey);if(b){var c=parseInt(b,10);c<=this.steps.length&&(a=c)}}return"undefined"==typeof a&&(a=this.getCurrentStepNumber()),this.fireEventHandlers("beforeStart",a),this.gotoStep(a),this.fireEventHandlers("afterStart",a),this},c.prototype.restartTour=function(){return this.startTour(0)},c.prototype.endTour=function(){if(this.fireEventHandlers("beforeEnd"),this.currentStepConfig){var a=this.getStepTarget(this.currentStepConfig);a&&(a.attr("tabindex")||a.attr("tabindex","-1"),a.focus())}return this.hide(!0),this.fireEventHandlers("afterEnd"),this},c.prototype.hide=function(b){if(this.fireEventHandlers("beforeHide"),this.currentStepNode&&this.currentStepNode.length&&(this.currentStepNode.hide(),this.currentStepPopper&&this.currentStepPopper.destroy()),this.currentStepConfig){var c=this.getStepTarget(this.currentStepConfig);c&&(c.data("original-labelledby")&&c.attr("aria-labelledby",c.data("original-labelledby")),c.data("original-describedby")&&c.attr("aria-describedby",c.data("original-describedby")),c.data("original-tabindex")&&c.attr("tabindex",c.data("tabindex"))),this.currentStepConfig=null}var d=0;if(b&&(d=400),a('[data-flexitour="step-background"]').remove(),a('[data-flexitour="step-backdrop"]').removeAttr("data-flexitour"),a('[data-flexitour="backdrop"]').fadeOut(d,function(){a(this).remove()}),this.currentStepNode&&this.currentStepNode.length){var e=this.currentStepNode.attr("id");if(e){var f='[aria-describedby="'+e+'-body"]';a(f).removeAttr("tabindex"),a(f).removeAttr("aria-describedby")}}return this.resetStepListeners(),this.accessibilityHide(),this.fireEventHandlers("afterHide"),this.currentStepNode=null,this.currentStepPopper=null,this},c.prototype.show=function(){var a=this.getCurrentStepNumber();return this.gotoStep(a)},c.prototype.getStepContainer=function(){return a(this.currentStepNode)},c.prototype.calculateScrollTop=function(b){var c=a(window).scrollTop(),d=a(window).height(),e=this.getStepTarget(b);return c="top"===b.placement?e.offset().top-d/2:"bottom"===b.placement?e.offset().top+e.height()-d/2:e.height()<=.8*d?e.offset().top-(d-e.height())/2:e.offset().top-.2*d,c=Math.max(0,c),c=Math.min(a(document).height()-d,c),Math.ceil(c)},c.prototype.calculateStepPositionInPage=function(){var b=a(window).height(),c=this.currentStepNode.height(),d=a(window).width(),e=this.currentStepNode.width();return{top:Math.ceil((b-c)/2),left:Math.ceil((d-e)/2)}},c.prototype.positionStep=function(c){var d=this.currentStepNode;if(!d||!d.length)return this;var e=void 0;switch(c.placement){case"left":e=["left","right","top","bottom"];break;case"right":e=["right","left","top","bottom"];break;case"top":e=["top","bottom","right","left"];break;case"bottom":e=["bottom","top","right","left"];break;default:e="flip"}var f=this.getStepTarget(c),g={placement:c.placement+"-start",removeOnDestroy:!0,modifiers:{flip:{behaviour:e},arrow:{element:'[data-role="arrow"]'}},onCreate:function(a){h(a)},onUpdate:function(a){h(a)}},h=function(b){var c=b.placement.split("-")[0],d=["left","right"].indexOf(c)!==-1,e=b.instance.popper.querySelector('[data-role="arrow"]'),f=a(b.instance.popper.querySelector('[data-role="flexitour-step"]'));if(d){var g=parseFloat(window.getComputedStyle(e).height),h=parseFloat(window.getComputedStyle(e).top),i=parseFloat(window.getComputedStyle(b.instance.popper).height),j=parseFloat(window.getComputedStyle(b.instance.popper).top),k=parseFloat(f.css("borderTopWidth")),l=2*parseFloat(f.css("borderTopLeftRadius")),m=h+g/2,n=i+j-k-l,o=j+k+l;if(m>=n||m<=o){var p=0;p=m>i/2?n-g:o+g,a(e).css("top",p)}}else{var q=parseFloat(window.getComputedStyle(e).width),r=parseFloat(window.getComputedStyle(e).left),s=parseFloat(window.getComputedStyle(b.instance.popper).width),t=parseFloat(window.getComputedStyle(b.instance.popper).left),u=parseFloat(f.css("borderTopWidth")),v=2*parseFloat(f.css("borderTopLeftRadius")),w=r+q/2,x=s+t-u-v,y=t+u+v;if(w>=x||w<=y){var z=0;z=w>s/2?x-q:y+q,a(e).css("left",z)}}},i=a('[data-flexitour="step-background"]');return i.length&&(f=i),this.currentStepPopper=new b(f,d[0],g),this},c.prototype.positionBackdrop=function(b){if(b.backdrop){this.currentStepConfig.hasBackdrop=!0;var c=a('<div data-flexitour="backdrop"></div>');if(b.zIndex?"append"===b.attachPoint?b.attachTo.append(c):c.insertAfter(b.attachTo):a("body").append(c),this.isStepActuallyVisible(b)){var d=a('<div data-flexitour="step-background"></div>'),e=this.getStepTarget(b),f=10,g=e;f&&(g=a("body")),e.css("backgroundColor",this.calculateInherittedBackgroundColor(e));var h={top:e.position().top-f,left:e.position().left-f,width:e.outerWidth()+f+f,height:e.outerHeight()+f+f,backgroundColor:this.calculateInherittedBackgroundColor(g)};b.zIndex||(h.left=e.offset().left-f,h.top=e.offset().top-f),e.offset().left<f&&(h.width=e.outerWidth()+e.offset().left+f,h.left=e.offset().left),e.offset().top<f&&(h.height=e.outerHeight()+e.offset().top+f,h.top=e.offset().top),d.css(h);var i=e.css("borderRadius");i&&i!==a("body").css("borderRadius")&&d.css("borderRadius",i);var j=this.calculatePosition(e);"fixed"===j?d.css("top",0):"absolute"===j&&d.css("position","fixed");var k=d.clone();k.css({backgroundColor:c.css("backgroundColor"),opacity:c.css("opacity")}),k.attr("data-flexitour","step-background-fader"),b.zIndex?"append"===b.attachPoint?b.attachTo.append(d):(k.insertAfter(b.attachTo),d.insertAfter(b.attachTo)):(a("body").append(k),a("body").append(d)),e.attr("data-flexitour","step-backdrop"),b.zIndex&&(c.css("zIndex",b.zIndex),d.css("zIndex",b.zIndex+1),e.css("zIndex",b.zIndex+2)),k.fadeOut("2000",function(){a(this).remove()})}}return this},c.prototype.calculateZIndex=function(b){for(b=a(b);b.length&&b[0]!==document;){var c=b.css("position");if("absolute"===c||"relative"===c||"fixed"===c){var d=parseInt(b.css("zIndex"),10);if(!isNaN(d)&&0!==d)return d}b=b.parent()}return 0},c.prototype.calculateInherittedBackgroundColor=function(b){var c=a("<div>").hide();a("body").append(c);var d=c.css("backgroundColor");for(c.remove(),b=a(b);b.length&&b[0]!==document;){var e=b.css("backgroundColor");if(e!==d)return e;b=b.parent()}return null},c.prototype.calculatePosition=function(b){for(b=a(b);b.length&&b[0]!==document;){var c=b.css("position");if("static"!==c)return c;b=b.parent()}return null},c.prototype.accessibilityShow=function(){var b="data-has-hidden",c="aria-hidden",d=function(a){var d=a.data("flexitour");if(d)switch(d){case"container":case"target":return}var e=a.attr(c);e||(a.attr(b,!0),a.attr(c,!0))};this.currentStepNode.siblings().each(function(b,c){d(a(c))}),this.currentStepNode.parentsUntil("body").siblings().each(function(b,c){d(a(c))})},c.prototype.accessibilityHide=function(){var b="data-has-hidden",c="aria-hidden",d=function(a){var d=a.attr(b);"undefined"!=typeof d&&(a.removeAttr(b),a.removeAttr(c))};a("["+b+"]").each(function(b,c){d(a(c))})},"object"===("undefined"==typeof exports?"undefined":d(exports))&&(module.exports=c),c});
define('tool_usertours/usertours', ["core/ajax","tool_usertours/tour","jquery","core/templates","core/str","core/log","core/notification"],function(a,b,c,d,e,f,g){var h={tourId:null,currentTour:null,context:null,init:function(a,b,d){h.tourId&&h.context||(h.tourId=a,h.context=d,"undefined"==typeof b&&(b=!0),b&&h.fetchTour(a),h.addResetLink(),c("body").on("click",'[data-action="tool_usertours/resetpagetour"]',function(a){a.preventDefault(),h.resetTourState(h.tourId)}))},fetchTour:function(b){M.util.js_pending("admin_usertour_fetchTour"+b),c.when(a.call([{methodname:"tool_usertours_fetch_and_start_tour",args:{tourid:b,context:h.context,pageurl:window.location.href}}])[0],d.render("tool_usertours/tourstep",{})).then(function(a,c){if(1==a.showtour)return h.startBootstrapTour(b,c[0],a.tourconfig)}).always(function(){M.util.js_complete("admin_usertour_fetchTour"+b)}).fail(g.exception)},addResetLink:function(){var a;a=c(c(".tool_usertours-resettourcontainer").length?".tool_usertours-resettourcontainer":c(".logininfo").length?".logininfo":c("footer").length?"footer":"body"),d.render("tool_usertours/resettour",{}).done(function(b,c){d.appendNodeContents(a,b,c)})},startBootstrapTour:function(a,c,d){return h.currentTour&&(d.onEnd=null,h.currentTour.endTour(),delete h.currentTour),d.eventHandlers={afterEnd:[h.markTourComplete],beforeRender:[h.suspendZIndex],afterRender:[h.markStepShown],afterHide:[h.resetZIndex]},d.tourName=d.name,delete d.name,d.template=c,d.steps=d.steps.map(function(a){return"undefined"!=typeof a.element&&(a.target=a.element,delete a.element),"undefined"!=typeof a.reflex&&(a.moveOnClick=!!a.reflex,delete a.reflex),"undefined"!=typeof a.content&&(a.body=a.content,delete a.content),a}),h.currentTour=new b(d),h.currentTour.startTour()},suspendZIndex:function(){document.body.childNodes.forEach(function(a){a.style&&(a.style.zIndex="auto")})},resetZIndex:function(){document.body.childNodes.forEach(function(a){a.style&&(a.style.zIndex="")})},markStepShown:function(b){var d=this.getStepConfig(this.getCurrentStepNumber());this.isLastStep(this.stepNumber)?(b.template.find('[data-role="next"]').removeClass("btn-primary").addClass("btn-default"),b.template.find('[data-role="end"]').addClass("btn-primary").removeClass("btn-default")):(b.template.find('[data-role="next"]').addClass("btn-primary").removeClass("btn-default"),b.template.find('[data-role="end"]').removeClass("btn-primary").addClass("btn-default")),c.when(a.call([{methodname:"tool_usertours_step_shown",args:{tourid:h.tourId,context:h.context,pageurl:window.location.href,stepid:d.stepid,stepindex:this.getCurrentStepNumber()}}])[0]).fail(f.error)},markTourComplete:function(){var b=this.getStepConfig(this.getCurrentStepNumber());c.when(a.call([{methodname:"tool_usertours_complete_tour",args:{tourid:h.tourId,context:h.context,pageurl:window.location.href,stepid:b.stepid,stepindex:this.getCurrentStepNumber()}}])[0]).fail(f.error)},resetTourState:function(b){c.when(a.call([{methodname:"tool_usertours_reset_tour",args:{tourid:b,context:h.context,pageurl:window.location.href}}])[0]).then(function(a){a.startTour&&h.fetchTour(a.startTour)}).fail(g.exception)}};return{init:h.init,resetTourState:h.resetTourState}});
define('container_course/enrolment_banner', ["core/config","core/ajax"],function(a,b){function c(a){return new Promise(function(c){var d=a.querySelector(".tw-containerCourse-enrolmentBanner__enrolButton");if(d){var e=d.getAttribute("data-course-id");d.addEventListener("click",function(a){return a.preventDefault(),d.href.includes("enrol/index.php")?void(window.location.href=d.href):void b.call([{methodname:"container_course_process_non_interactive_enrol",args:{course_id:e}}],!0,!0)[0].then(function(a){a&&(window.location.href=d.href)})})}c()})}return{init:c}});
define('theme_kineo/back_to_top', ["jquery"],function(a){return{init:function(){var b=300,c=1200,d=700,e=a(".linkToTop-top");a(window).scroll(function(){a(this).scrollTop()>b?e.addClass("linkToTop-is-visible"):e.removeClass("linkToTop-is-visible linkToTop-fade-out"),a(this).scrollTop()>c&&e.addClass("linkToTop-fade-out")}),e.on("click",function(b){b.preventDefault(),a("body,html").animate({scrollTop:0},d)})}}});
define('theme_kineo/block_edit_hook', ["jquery","select2"],function(a,b){return{customAppearance:!1,showcase:!1,init:function(){var b=this;b.customAppearance=a('select[name="cs_custom_appearance[]"]'),b.showcase=a(".custom-appearance-showcase"),b.customAppearance&&(b.customAppearance&&(b.customAppearance.select2({templateSelection:function(a){return a.element.parentElement.getAttribute("label")+": "+a.text},templateResult:function(b){return b.element&&"colour"===b.element.getAttribute("data-type")?a('<span class="'+b.element.getAttribute("data-class")+'"></span>').text(b.text):b.text},allowClear:!0,placeholder:"",width:"50%"}),b.customAppearance.on("select2:selecting",function(a){var c=a.params.data||a.params.args.data,d=b.customAppearance.select2("data"),e=d.filter(function(a){return a.element.parentElement.label!==c.element.parentElement.label}).map(function(a){return a.element.value});b.customAppearance.val(e)}),b.customAppearance.on("select2:select select2:unselect",function(a){b.setClasses()})),b.setClasses())},setClasses:function(){this.showcase.removeClass().addClass("custom-appearance-showcase "+this.customAppearance.select2("data").map(function(a){return a.id}).join(" "))}}});
define('theme_kineo/copy_custom_image_path', [],function(){return{init:function(){const a=document.querySelector(".custom-image-table");a&&a.addEventListener("click",function(a){if("custom-image-path"===a.target.className){document.querySelectorAll(".custom-image-path").forEach(function(a){a.classList.remove("on-click-highlight")}),a.target.classList.add("on-click-highlight");var b=a.target.textContent;if(navigator&&navigator.clipboard)return void navigator.clipboard.writeText(b);var c=document.createElement("textarea");c.value=a.target.textContent,document.body.appendChild(c),c.select(),document.execCommand("copy"),document.body.removeChild(c)}})}}});
define('theme_kineo/theme', [],function(){return{init:function(){var a={header:document.querySelector(".totaraNav"),paddingOffset:10,paddingOffsetMeasurement:"px"};return!(!this.elementExists(a.header)||"fixed"!==this.getElementStyle(a.header,"position"))&&(this.setBodyPadding(a.header,a.paddingOffset,a.paddingOffsetMeasurement),void window.addEventListener("resize",function(){this.setBodyPadding(a.header,a.paddingOffset,a.paddingOffsetMeasurement)}.bind(this)))},elementExists:function(a){return"undefined"!=typeof a&&null!==a},getElementStyle:function(a,b){return window.getComputedStyle(a).getPropertyValue(b)},setBodyPadding:function(a,b,c){var d=parseInt(this.getElementStyle(a,"height")),e=document.querySelector("body").classList.contains("path-login")?0:parseInt(b),f=c.toString();document.querySelector("body").setAttribute("style","padding-top: "+(d+e)+f)}}});
define('theme_legacy/bootstrap', ["jquery","core/log"],function(a,b){function c(){var a=document.createElement("bootstrap"),b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var c in b)if(void 0!==a.style[c])return{end:b[c]};return!1}function d(b){return this.each(function(){var c=a(this),d=c.data("bs.alert");d||c.data("bs.alert",d=new v(this)),"string"==typeof b&&d[b].call(c)})}function e(b){return this.each(function(){var c=a(this),d=c.data("bs.button"),e="object"==typeof b&&b;d||c.data("bs.button",d=new x(this,e)),"toggle"==b?d.toggle():b&&d.setState(b)})}function f(b){return this.each(function(){var c=a(this),d=c.data("bs.carousel"),e=a.extend({},y.DEFAULTS,c.data(),"object"==typeof b&&b),f="string"==typeof b?b:e.slide;d||c.data("bs.carousel",d=new y(this,e)),"number"==typeof b?d.to(b):f?d[f]():e.interval&&d.pause().cycle()})}function g(b){var c,d=b.attr("data-target")||(c=b.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,"");return a(document).find(d)}function h(b){return this.each(function(){var c=a(this),d=c.data("bs.collapse"),e=a.extend({},A.DEFAULTS,c.data(),"object"==typeof b&&b);!d&&e.toggle&&/show|hide/.test(b)&&(e.toggle=!1),d||c.data("bs.collapse",d=new A(this,e)),"string"==typeof b&&d[b]()})}function i(b){var c=b.attr("data-target");c||(c=b.attr("href"),c=c&&/#[A-Za-z]/.test(c)&&c.replace(/.*(?=#[^\s]*$)/,""));var d="#"!==c?a(document).find(c):null;return d&&d.length?d:b.parent()}function j(b){b&&3===b.which||(a(B).remove(),a(C).each(function(){var c=a(this),d=i(c),e={relatedTarget:this};d.hasClass("open")&&(b&&"click"==b.type&&/input|textarea/i.test(b.target.tagName)&&a.contains(d[0],b.target)||(d.trigger(b=a.Event("hide.bs.dropdown",e)),b.isDefaultPrevented()||(c.attr("aria-expanded","false"),d.removeClass("open").trigger(a.Event("hidden.bs.dropdown",e)))))}))}function k(b){return this.each(function(){var c=a(this),d=c.data("bs.dropdown");d||c.data("bs.dropdown",d=new D(this)),"string"==typeof b&&d[b].call(c)})}function l(b,c){return this.each(function(){var d=a(this),e=d.data("bs.modal"),f=a.extend({},E.DEFAULTS,d.data(),"object"==typeof b&&b);e||d.data("bs.modal",e=new E(this,f)),"string"==typeof b?e[b](c):f.show&&e.show(c)})}function m(b,c){var d=b.nodeName.toLowerCase();if(a.inArray(d,c)!==-1)return a.inArray(d,G)===-1||Boolean(b.nodeValue.match(J)||b.nodeValue.match(K));for(var e=a(c).filter(function(a,b){return b instanceof RegExp}),f=0,g=e.length;f<g;f++)if(d.match(e[f]))return!0;return!1}function n(b,c,d){if(0===b.length)return b;if(d&&"function"==typeof d)return d(b);if(!document.implementation||!document.implementation.createHTMLDocument)return b;var e=document.implementation.createHTMLDocument("sanitization");e.body.innerHTML=b;for(var f=a.map(c,function(a,b){return b}),g=a(e.body).find("*"),h=0,i=g.length;h<i;h++){var j=g[h],k=j.nodeName.toLowerCase();if(a.inArray(k,f)!==-1)for(var l=a.map(j.attributes,function(a){return a}),n=[].concat(c["*"]||[],c[k]||[]),o=0,p=l.length;o<p;o++)m(l[o],n)||j.removeAttribute(l[o].nodeName);else j.parentNode.removeChild(j)}return e.body.innerHTML}function o(b){return this.each(function(){var c=a(this),d=c.data("bs.tooltip"),e="object"==typeof b&&b;!d&&/destroy|hide/.test(b)||(d||c.data("bs.tooltip",d=new L(this,e)),"string"==typeof b&&d[b]())})}function p(b){return this.each(function(){var c=a(this),d=c.data("bs.popover"),e="object"==typeof b&&b;!d&&/destroy|hide/.test(b)||(d||c.data("bs.popover",d=new M(this,e)),"string"==typeof b&&d[b]())})}function q(b,c){this.$body=a(document.body),this.$scrollElement=a(a(b).is(document.body)?window:b),this.options=a.extend({},q.DEFAULTS,c),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",a.proxy(this.process,this)),this.refresh(),this.process()}function r(b){return this.each(function(){var c=a(this),d=c.data("bs.scrollspy"),e="object"==typeof b&&b;d||c.data("bs.scrollspy",d=new q(this,e)),"string"==typeof b&&d[b]()})}function s(b){return this.each(function(){var c=a(this),d=c.data("bs.tab");d||c.data("bs.tab",d=new N(this)),"string"==typeof b&&d[b]()})}function t(b){return this.each(function(){var c=a(this),d=c.data("bs.affix"),e="object"==typeof b&&b;d||c.data("bs.affix",d=new O(this,e)),"string"==typeof b&&d[b]()})}a(".h1").hide(),b.debug("Bootstrap AMD initialised"),a.fn.emulateTransitionEnd=function(b){var c=!1,d=this;a(this).one("bsTransitionEnd",function(){c=!0});var e=function(){c||a(d).trigger(a.support.transition.end)};return setTimeout(e,b),this},a(function(){a.support.transition=c(),a.support.transition&&(a.event.special.bsTransitionEnd={bindType:a.support.transition.end,delegateType:a.support.transition.end,handle:function(b){if(a(b.target).is(this))return b.handleObj.handler.apply(this,arguments)}})});var u='[data-dismiss="alert"]',v=function(b){a(b).on("click",u,this.close)};v.VERSION="3.4.1",v.TRANSITION_DURATION=150,v.prototype.close=function(b){function c(){f.detach().trigger("closed.bs.alert").remove()}var d=a(this),e=d.attr("data-target");e||(e=d.attr("href"),e=e&&e.replace(/.*(?=#[^\s]*$)/,"")),e="#"===e?[]:e;var f=a(document).find(e);b&&b.preventDefault(),f.length||(f=d.closest(".alert")),f.trigger(b=a.Event("close.bs.alert")),b.isDefaultPrevented()||(f.removeClass("in"),a.support.transition&&f.hasClass("fade")?f.one("bsTransitionEnd",c).emulateTransitionEnd(v.TRANSITION_DURATION):c())};var w=a.fn.alert;a.fn.alert=d,a.fn.alert.Constructor=v,a.fn.alert.noConflict=function(){return a.fn.alert=w,this},a(document).on("click.bs.alert.data-api",u,v.prototype.close);var x=function(b,c){this.$element=a(b),this.options=a.extend({},x.DEFAULTS,c),this.isLoading=!1};x.VERSION="3.4.1",x.DEFAULTS={loadingText:"loading..."},x.prototype.setState=function(b){var c="disabled",d=this.$element,e=d.is("input")?"val":"html",f=d.data();b+="Text",null==f.resetText&&d.data("resetText",d[e]()),setTimeout(a.proxy(function(){d[e](null==f[b]?this.options[b]:f[b]),"loadingText"==b?(this.isLoading=!0,d.addClass(c).attr(c,c).prop(c,!0)):this.isLoading&&(this.isLoading=!1,d.removeClass(c).removeAttr(c).prop(c,!1))},this),0)},x.prototype.toggle=function(){var a=!0,b=this.$element.closest('[data-toggle="buttons"]');if(b.length){var c=this.$element.find("input");"radio"==c.prop("type")?(c.prop("checked")&&(a=!1),b.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==c.prop("type")&&(c.prop("checked")!==this.$element.hasClass("active")&&(a=!1),this.$element.toggleClass("active")),c.prop("checked",this.$element.hasClass("active")),a&&c.trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")};var w=a.fn.button;a.fn.button=e,a.fn.button.Constructor=x,a.fn.button.noConflict=function(){return a.fn.button=w,this},a(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(b){var c=a(b.target).closest(".btn");e.call(c,"toggle"),a(b.target).is('input[type="radio"], input[type="checkbox"]')||(b.preventDefault(),c.is("input,button")?c.trigger("focus"):c.find("input:visible,button:visible").first().trigger("focus"))}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(b){a(b.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(b.type))});var y=function(b,c){this.$element=a(b),this.$indicators=this.$element.find(".carousel-indicators"),this.options=c,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",a.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",a.proxy(this.pause,this)).on("mouseleave.bs.carousel",a.proxy(this.cycle,this))};y.VERSION="3.4.1",y.TRANSITION_DURATION=600,y.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},y.prototype.keydown=function(a){if(!/input|textarea/i.test(a.target.tagName)){switch(a.which){case 37:this.prev();break;case 39:this.next();break;default:return}a.preventDefault()}},y.prototype.cycle=function(b){return b||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(a.proxy(this.next,this),this.options.interval)),this},y.prototype.getItemIndex=function(a){return this.$items=a.parent().children(".item"),this.$items.index(a||this.$active)},y.prototype.getItemForDirection=function(a,b){var c=this.getItemIndex(b),d="prev"==a&&0===c||"next"==a&&c==this.$items.length-1;if(d&&!this.options.wrap)return b;var e="prev"==a?-1:1,f=(c+e)%this.$items.length;return this.$items.eq(f)},y.prototype.to=function(a){var b=this,c=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(a>this.$items.length-1||a<0))return this.sliding?this.$element.one("slid.bs.carousel",function(){b.to(a)}):c==a?this.pause().cycle():this.slide(a>c?"next":"prev",this.$items.eq(a))},y.prototype.pause=function(b){return b||(this.paused=!0),this.$element.find(".next, .prev").length&&a.support.transition&&(this.$element.trigger(a.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},y.prototype.next=function(){if(!this.sliding)return this.slide("next")},y.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},y.prototype.slide=function(b,c){var d=this.$element.find(".item.active"),e=c||this.getItemForDirection(b,d),f=this.interval,g="next"==b?"left":"right",h=this;if(e.hasClass("active"))return this.sliding=!1;var i=e[0],j=a.Event("slide.bs.carousel",{relatedTarget:i,direction:g});if(this.$element.trigger(j),!j.isDefaultPrevented()){if(this.sliding=!0,f&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var k=a(this.$indicators.children()[this.getItemIndex(e)]);k&&k.addClass("active")}var l=a.Event("slid.bs.carousel",{relatedTarget:i,direction:g});return a.support.transition&&this.$element.hasClass("slide")?(e.addClass(b),"object"==typeof e&&e.length&&e[0].offsetWidth,d.addClass(g),e.addClass(g),d.one("bsTransitionEnd",function(){e.removeClass([b,g].join(" ")).addClass("active"),d.removeClass(["active",g].join(" ")),h.sliding=!1,setTimeout(function(){h.$element.trigger(l)},0)}).emulateTransitionEnd(y.TRANSITION_DURATION)):(d.removeClass("active"),e.addClass("active"),this.sliding=!1,this.$element.trigger(l)),f&&this.cycle(),this}};var w=a.fn.carousel;a.fn.carousel=f,a.fn.carousel.Constructor=y,a.fn.carousel.noConflict=function(){return a.fn.carousel=w,this};var z=function(b){var c=a(this),d=c.attr("href");d&&(d=d.replace(/.*(?=#[^\s]+$)/,""));var e=c.attr("data-target")||d,g=a(document).find(e);if(g.hasClass("carousel")){var h=a.extend({},g.data(),c.data()),i=c.attr("data-slide-to");i&&(h.interval=!1),f.call(g,h),i&&g.data("bs.carousel").to(i),b.preventDefault()}};a(document).on("click.bs.carousel.data-api","[data-slide]",z).on("click.bs.carousel.data-api","[data-slide-to]",z),a(window).on("load",function(){a('[data-ride="carousel"]').each(function(){var b=a(this);f.call(b,b.data())})});var A=function(b,c){this.$element=a(b),this.options=a.extend({},A.DEFAULTS,c),this.$trigger=a('[data-toggle="collapse"][href="#'+b.id+'"],[data-toggle="collapse"][data-target="#'+b.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};A.VERSION="3.4.1",A.TRANSITION_DURATION=350,A.DEFAULTS={toggle:!0},A.prototype.dimension=function(){var a=this.$element.hasClass("width");return a?"width":"height"},A.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var b,c=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(c&&c.length&&(b=c.data("bs.collapse"),b&&b.transitioning))){var d=a.Event("show.bs.collapse");if(this.$element.trigger(d),!d.isDefaultPrevented()){c&&c.length&&(h.call(c,"hide"),b||c.data("bs.collapse",null));var e=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[e](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var f=function(){this.$element.removeClass("collapsing").addClass("collapse in")[e](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!a.support.transition)return f.call(this);var g=a.camelCase(["scroll",e].join("-"));this.$element.one("bsTransitionEnd",a.proxy(f,this)).emulateTransitionEnd(A.TRANSITION_DURATION)[e](this.$element[0][g])}}}},A.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var b=a.Event("hide.bs.collapse");if(this.$element.trigger(b),!b.isDefaultPrevented()){var c=this.dimension();this.$element[c](this.$element[c]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var d=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return a.support.transition?void this.$element[c](0).one("bsTransitionEnd",a.proxy(d,this)).emulateTransitionEnd(A.TRANSITION_DURATION):d.call(this)}}},A.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},A.prototype.getParent=function(){return a(document).find(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(a.proxy(function(b,c){var d=a(c);this.addAriaAndCollapsedClass(g(d),d)},this)).end()},A.prototype.addAriaAndCollapsedClass=function(a,b){var c=a.hasClass("in");a.attr("aria-expanded",c),b.toggleClass("collapsed",!c).attr("aria-expanded",c)};var w=a.fn.collapse;a.fn.collapse=h,a.fn.collapse.Constructor=A,a.fn.collapse.noConflict=function(){return a.fn.collapse=w,this},a(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(b){var c=a(this);c.attr("data-target")||b.preventDefault();var d=g(c),e=d.data("bs.collapse"),f=e?"toggle":c.data();h.call(d,f)});var B=".dropdown-backdrop",C='[data-toggle="dropdown"]',D=function(b){a(b).on("click.bs.dropdown",this.toggle)};D.VERSION="3.4.1",D.prototype.toggle=function(b){var c=a(this);if(!c.is(".disabled, :disabled")){var d=i(c),e=d.hasClass("open");if(j(),!e){"ontouchstart"in document.documentElement&&!d.closest(".navbar-nav").length&&a(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(a(this)).on("click",j);var f={relatedTarget:this};if(d.trigger(b=a.Event("show.bs.dropdown",f)),b.isDefaultPrevented())return;c.trigger("focus").attr("aria-expanded","true"),d.toggleClass("open").trigger(a.Event("shown.bs.dropdown",f))}return!1}},D.prototype.keydown=function(b){if(/(38|40|27|32)/.test(b.which)&&!/input|textarea/i.test(b.target.tagName)){var c=a(this);if(b.preventDefault(),b.stopPropagation(),!c.is(".disabled, :disabled")){var d=i(c),e=d.hasClass("open");if(!e&&27!=b.which||e&&27==b.which)return 27==b.which&&d.find(C).trigger("focus"),c.trigger("click");var f=" li:not(.disabled):visible a",g=d.find(".dropdown-menu"+f);if(g.length){var h=g.index(b.target);38==b.which&&h>0&&h--,40==b.which&&h<g.length-1&&h++,~h||(h=0),g.eq(h).trigger("focus")}}}};var w=a.fn.dropdown;a.fn.dropdown=k,a.fn.dropdown.Constructor=D,a.fn.dropdown.noConflict=function(){return a.fn.dropdown=w,this},a(document).on("click.bs.dropdown.data-api",j).on("click.bs.dropdown.data-api",".dropdown form",function(a){a.stopPropagation()}).on("click.bs.dropdown.data-api",C,D.prototype.toggle).on("keydown.bs.dropdown.data-api",C,D.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",D.prototype.keydown);var E=function(b,c){this.options=c,this.$body=a(document.body),this.$element=a(b),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.fixedContent=".navbar-fixed-top, .navbar-fixed-bottom",this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,a.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};E.VERSION="3.4.1",E.TRANSITION_DURATION=300,E.BACKDROP_TRANSITION_DURATION=150,E.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},E.prototype.toggle=function(a){return this.isShown?this.hide():this.show(a)},E.prototype.show=function(b){var c=this,d=a.Event("show.bs.modal",{relatedTarget:b});this.$element.trigger(d),this.isShown||d.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',a.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){c.$element.one("mouseup.dismiss.bs.modal",function(b){a(b.target).is(c.$element)&&(c.ignoreBackdropClick=!0)})}),this.backdrop(function(){var d=a.support.transition&&c.$element.hasClass("fade");c.$element.parent().length||c.$element.appendTo(c.$body),c.$element.show().scrollTop(0),c.adjustDialog(),d&&c.$element[0].offsetWidth,c.$element.addClass("in"),c.enforceFocus();var e=a.Event("shown.bs.modal",{relatedTarget:b});d?c.$dialog.one("bsTransitionEnd",function(){c.$element.trigger("focus").trigger(e)}).emulateTransitionEnd(E.TRANSITION_DURATION):c.$element.trigger("focus").trigger(e)}))},E.prototype.hide=function(b){b&&b.preventDefault(),b=a.Event("hide.bs.modal"),this.$element.trigger(b),this.isShown&&!b.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),a(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),a.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",a.proxy(this.hideModal,this)).emulateTransitionEnd(E.TRANSITION_DURATION):this.hideModal())},E.prototype.enforceFocus=function(){a(document).off("focusin.bs.modal").on("focusin.bs.modal",a.proxy(function(a){document===a.target||this.$element[0]===a.target||this.$element.has(a.target).length||this.$element.trigger("focus")},this))},E.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",a.proxy(function(a){27==a.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},E.prototype.resize=function(){this.isShown?a(window).on("resize.bs.modal",a.proxy(this.handleUpdate,this)):a(window).off("resize.bs.modal")},E.prototype.hideModal=function(){var a=this;this.$element.hide(),this.backdrop(function(){a.$body.removeClass("modal-open"),a.resetAdjustments(),a.resetScrollbar(),a.$element.trigger("hidden.bs.modal")})},E.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},E.prototype.backdrop=function(b){var c=this,d=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var e=a.support.transition&&d;if(this.$backdrop=a(document.createElement("div")).addClass("modal-backdrop "+d).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",a.proxy(function(a){return this.ignoreBackdropClick?void(this.ignoreBackdropClick=!1):void(a.target===a.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),e&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!b)return;e?this.$backdrop.one("bsTransitionEnd",b).emulateTransitionEnd(E.BACKDROP_TRANSITION_DURATION):b()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var f=function(){c.removeBackdrop(),b&&b()};a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",f).emulateTransitionEnd(E.BACKDROP_TRANSITION_DURATION):f()}else b&&b()},E.prototype.handleUpdate=function(){this.adjustDialog()},E.prototype.adjustDialog=function(){var a=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&a?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!a?this.scrollbarWidth:""})},E.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},E.prototype.checkScrollbar=function(){var a=window.innerWidth;if(!a){var b=document.documentElement.getBoundingClientRect();a=b.right-Math.abs(b.left)}this.bodyIsOverflowing=document.body.clientWidth<a,this.scrollbarWidth=this.measureScrollbar()},E.prototype.setScrollbar=function(){var b=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"";var c=this.scrollbarWidth;this.bodyIsOverflowing&&(this.$body.css("padding-right",b+c),a(this.fixedContent).each(function(b,d){var e=d.style.paddingRight,f=a(d).css("padding-right");a(d).data("padding-right",e).css("padding-right",parseFloat(f)+c+"px")}))},E.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad),a(this.fixedContent).each(function(b,c){var d=a(c).data("padding-right");a(c).removeData("padding-right"),c.style.paddingRight=d?d:""})},E.prototype.measureScrollbar=function(){var a=document.createElement("div");a.className="modal-scrollbar-measure",this.$body.append(a);var b=a.offsetWidth-a.clientWidth;return this.$body[0].removeChild(a),b};var w=a.fn.modal;a.fn.modal=l,a.fn.modal.Constructor=E,a.fn.modal.noConflict=function(){return a.fn.modal=w,this},a(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(b){var c=a(this),d=c.attr("href"),e=c.attr("data-target")||d&&d.replace(/.*(?=#[^\s]+$)/,""),f=a(document).find(e),g=f.data("bs.modal")?"toggle":a.extend({remote:!/#/.test(d)&&d},f.data(),c.data());c.is("a")&&b.preventDefault(),f.one("show.bs.modal",function(a){a.isDefaultPrevented()||f.one("hidden.bs.modal",function(){c.is(":visible")&&c.trigger("focus")})}),l.call(f,g,this)});var F=["sanitize","whiteList","sanitizeFn"],G=["background","cite","href","itemtype","longdesc","poster","src","xlink:href"],H=/^aria-[\w-]*$/i,I={"*":["class","dir","id","lang","role",H],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},J=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,K=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+/]+=*$/i,L=function(a,b){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",a,b)};L.VERSION="3.4.1",L.TRANSITION_DURATION=150,L.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0},sanitize:!0,sanitizeFn:null,whiteList:I},L.prototype.init=function(b,c,d){if(this.enabled=!0,this.type=b,this.$element=a(c),this.options=this.getOptions(d),this.$viewport=this.options.viewport&&a(document).find(a.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var e=this.options.trigger.split(" "),f=e.length;f--;){var g=e[f];if("click"==g)this.$element.on("click."+this.type,this.options.selector,a.proxy(this.toggle,this));else if("manual"!=g){var h="hover"==g?"mouseenter":"focusin",i="hover"==g?"mouseleave":"focusout";this.$element.on(h+"."+this.type,this.options.selector,a.proxy(this.enter,this)),this.$element.on(i+"."+this.type,this.options.selector,a.proxy(this.leave,this))}}this.options.selector?this._options=a.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},L.prototype.getDefaults=function(){return L.DEFAULTS},L.prototype.getOptions=function(b){var c=this.$element.data();for(var d in c)c.hasOwnProperty(d)&&a.inArray(d,F)!==-1&&delete c[d];return b=a.extend({},this.getDefaults(),c,b),b.delay&&"number"==typeof b.delay&&(b.delay={show:b.delay,hide:b.delay}),b.sanitize&&(b.template=n(b.template,b.whiteList,b.sanitizeFn)),b},L.prototype.getDelegateOptions=function(){var b={},c=this.getDefaults();return this._options&&a.each(this._options,function(a,d){c[a]!=d&&(b[a]=d)}),b},L.prototype.enter=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);return c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),b instanceof a.Event&&(c.inState["focusin"==b.type?"focus":"hover"]=!0),c.tip().hasClass("in")||"in"==c.hoverState?void(c.hoverState="in"):(clearTimeout(c.timeout),c.hoverState="in",c.options.delay&&c.options.delay.show?void(c.timeout=setTimeout(function(){"in"==c.hoverState&&c.show()},c.options.delay.show)):c.show())},L.prototype.isInStateTrue=function(){for(var a in this.inState)if(this.inState[a])return!0;return!1},L.prototype.leave=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);if(c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),b instanceof a.Event&&(c.inState["focusout"==b.type?"focus":"hover"]=!1),!c.isInStateTrue())return clearTimeout(c.timeout),c.hoverState="out",c.options.delay&&c.options.delay.hide?void(c.timeout=setTimeout(function(){"out"==c.hoverState&&c.hide()},c.options.delay.hide)):c.hide()},L.prototype.show=function(){var b=a.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(b);var c=a.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(b.isDefaultPrevented()||!c)return;var d=this,e=this.tip(),f=this.getUID(this.type);this.setContent(),e.attr("id",f),this.$element.attr("aria-describedby",f),this.options.animation&&e.addClass("fade");var g="function"==typeof this.options.placement?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement,h=/\s?auto?\s?/i,i=h.test(g);i&&(g=g.replace(h,"")||"top"),e.detach().css({top:0,left:0,display:"block"}).addClass(g).data("bs."+this.type,this),this.options.container?e.appendTo(a(document).find(this.options.container)):e.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var j=this.getPosition(),k=e[0].offsetWidth,l=e[0].offsetHeight;if(i){var m=g,n=this.getPosition(this.$viewport);g="bottom"==g&&j.bottom+l>n.bottom?"top":"top"==g&&j.top-l<n.top?"bottom":"right"==g&&j.right+k>n.width?"left":"left"==g&&j.left-k<n.left?"right":g,e.removeClass(m).addClass(g)}var o=this.getCalculatedOffset(g,j,k,l);this.applyPlacement(o,g);var p=function(){var a=d.hoverState;d.$element.trigger("shown.bs."+d.type),d.hoverState=null,"out"==a&&d.leave(d)};a.support.transition&&this.$tip.hasClass("fade")?e.one("bsTransitionEnd",p).emulateTransitionEnd(L.TRANSITION_DURATION):p()}},L.prototype.applyPlacement=function(b,c){var d=this.tip(),e=d[0].offsetWidth,f=d[0].offsetHeight,g=parseInt(d.css("margin-top"),10),h=parseInt(d.css("margin-left"),10);isNaN(g)&&(g=0),isNaN(h)&&(h=0),b.top+=g,b.left+=h,a.offset.setOffset(d[0],a.extend({using:function(a){d.css({top:Math.round(a.top),left:Math.round(a.left)})}},b),0),d.addClass("in");var i=d[0].offsetWidth,j=d[0].offsetHeight;"top"==c&&j!=f&&(b.top=b.top+f-j);var k=this.getViewportAdjustedDelta(c,b,i,j);k.left?b.left+=k.left:b.top+=k.top;var l=/top|bottom/.test(c),m=l?2*k.left-e+i:2*k.top-f+j,n=l?"offsetWidth":"offsetHeight";d.offset(b),this.replaceArrow(m,d[0][n],l)},L.prototype.replaceArrow=function(a,b,c){this.arrow().css(c?"left":"top",50*(1-a/b)+"%").css(c?"top":"left","")},L.prototype.setContent=function(){var a=this.tip(),b=this.getTitle();this.options.html?(this.options.sanitize&&(b=n(b,this.options.whiteList,this.options.sanitizeFn)),a.find(".tooltip-inner").html(b)):a.find(".tooltip-inner").text(b),a.removeClass("fade in top bottom left right")},L.prototype.hide=function(b){function c(){"in"!=d.hoverState&&e.detach(),d.$element&&d.$element.removeAttr("aria-describedby").trigger("hidden.bs."+d.type),b&&b()}var d=this,e=a(this.$tip),f=a.Event("hide.bs."+this.type);if(this.$element.trigger(f),!f.isDefaultPrevented())return e.removeClass("in"),a.support.transition&&e.hasClass("fade")?e.one("bsTransitionEnd",c).emulateTransitionEnd(L.TRANSITION_DURATION):c(),this.hoverState=null,this},L.prototype.fixTitle=function(){var a=this.$element;(a.attr("title")||"string"!=typeof a.attr("data-original-title"))&&a.attr("data-original-title",a.attr("title")||"").attr("title","")},L.prototype.hasContent=function(){return this.getTitle()},L.prototype.getPosition=function(b){b=b||this.$element;var c=b[0],d="BODY"==c.tagName,e=c.getBoundingClientRect();null==e.width&&(e=a.extend({},e,{width:e.right-e.left,height:e.bottom-e.top}));var f=window.SVGElement&&c instanceof window.SVGElement,g=d?{top:0,left:0}:f?null:b.offset(),h={scroll:d?document.documentElement.scrollTop||document.body.scrollTop:b.scrollTop()},i=d?{width:a(window).width(),height:a(window).height()}:null;return a.extend({},e,h,i,g)},L.prototype.getCalculatedOffset=function(a,b,c,d){return"bottom"==a?{top:b.top+b.height,left:b.left+b.width/2-c/2}:"top"==a?{top:b.top-d,left:b.left+b.width/2-c/2}:"left"==a?{top:b.top+b.height/2-d/2,left:b.left-c}:{top:b.top+b.height/2-d/2,left:b.left+b.width}},L.prototype.getViewportAdjustedDelta=function(a,b,c,d){var e={top:0,left:0};if(!this.$viewport)return e;var f=this.options.viewport&&this.options.viewport.padding||0,g=this.getPosition(this.$viewport);if(/right|left/.test(a)){var h=b.top-f-g.scroll,i=b.top+f-g.scroll+d;h<g.top?e.top=g.top-h:i>g.top+g.height&&(e.top=g.top+g.height-i)}else{var j=b.left-f,k=b.left+f+c;j<g.left?e.left=g.left-j:k>g.right&&(e.left=g.left+g.width-k)}return e},L.prototype.getTitle=function(){var a,b=this.$element,c=this.options;return a=b.attr("data-original-title")||("function"==typeof c.title?c.title.call(b[0]):c.title)},L.prototype.getUID=function(a){do a+=~~(1e6*Math.random());while(document.getElementById(a));return a},L.prototype.tip=function(){if(!this.$tip&&(this.$tip=a(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},L.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},L.prototype.enable=function(){this.enabled=!0},L.prototype.disable=function(){this.enabled=!1},L.prototype.toggleEnabled=function(){this.enabled=!this.enabled},L.prototype.toggle=function(b){var c=this;b&&(c=a(b.currentTarget).data("bs."+this.type),c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c))),b?(c.inState.click=!c.inState.click,c.isInStateTrue()?c.enter(c):c.leave(c)):c.tip().hasClass("in")?c.leave(c):c.enter(c)},L.prototype.destroy=function(){var a=this;clearTimeout(this.timeout),this.hide(function(){a.$element.off("."+a.type).removeData("bs."+a.type),a.$tip&&a.$tip.detach(),a.$tip=null,a.$arrow=null,a.$viewport=null,a.$element=null})},L.prototype.sanitizeHtml=function(a){return n(a,this.options.whiteList,this.options.sanitizeFn)};var w=a.fn.tooltip;a.fn.tooltip=o,a.fn.tooltip.Constructor=L,a.fn.tooltip.noConflict=function(){return a.fn.tooltip=w,this};var M=function(a,b){this.init("popover",a,b)};if(!a.fn.tooltip)throw new Error("Popover requires tooltip.js");M.VERSION="3.4.1",M.DEFAULTS=a.extend({},a.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'
}),M.prototype=a.extend({},a.fn.tooltip.Constructor.prototype),M.prototype.constructor=M,M.prototype.getDefaults=function(){return M.DEFAULTS},M.prototype.setContent=function(){var a=this.tip(),b=this.getTitle(),c=this.getContent();if(this.options.html){var d=typeof c;this.options.sanitize&&(b=this.sanitizeHtml(b),"string"===d&&(c=this.sanitizeHtml(c))),a.find(".popover-title").html(b),a.find(".popover-content").children().detach().end()["string"===d?"html":"append"](c)}else a.find(".popover-title").text(b),a.find(".popover-content").children().detach().end().text(c);a.removeClass("fade top bottom left right in"),a.find(".popover-title").html()||a.find(".popover-title").hide()},M.prototype.hasContent=function(){return this.getTitle()||this.getContent()},M.prototype.getContent=function(){var a=this.$element,b=this.options;return a.attr("data-content")||("function"==typeof b.content?b.content.call(a[0]):b.content)},M.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var w=a.fn.popover;a.fn.popover=p,a.fn.popover.Constructor=M,a.fn.popover.noConflict=function(){return a.fn.popover=w,this},q.VERSION="3.4.1",q.DEFAULTS={offset:10},q.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},q.prototype.refresh=function(){var b=this,c="offset",d=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),a.isWindow(this.$scrollElement[0])||(c="position",d=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var b=a(this),e=b.data("target")||b.attr("href"),f=/^#./.test(e)&&a(e);return f&&f.length&&f.is(":visible")&&[[f[c]().top+d,e]]||null}).sort(function(a,b){return a[0]-b[0]}).each(function(){b.offsets.push(this[0]),b.targets.push(this[1])})},q.prototype.process=function(){var a,b=this.$scrollElement.scrollTop()+this.options.offset,c=this.getScrollHeight(),d=this.options.offset+c-this.$scrollElement.height(),e=this.offsets,f=this.targets,g=this.activeTarget;if(this.scrollHeight!=c&&this.refresh(),b>=d)return g!=(a=f[f.length-1])&&this.activate(a);if(g&&b<e[0])return this.activeTarget=null,this.clear();for(a=e.length;a--;)g!=f[a]&&b>=e[a]&&(void 0===e[a+1]||b<e[a+1])&&this.activate(f[a])},q.prototype.activate=function(b){this.activeTarget=b,this.clear();var c=this.selector+'[data-target="'+b+'"],'+this.selector+'[href="'+b+'"]',d=a(c).parents("li").addClass("active");d.parent(".dropdown-menu").length&&(d=d.closest("li.dropdown").addClass("active")),d.trigger("activate.bs.scrollspy")},q.prototype.clear=function(){a(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var w=a.fn.scrollspy;a.fn.scrollspy=r,a.fn.scrollspy.Constructor=q,a.fn.scrollspy.noConflict=function(){return a.fn.scrollspy=w,this},a(window).on("load.bs.scrollspy.data-api",function(){a('[data-spy="scroll"]').each(function(){var b=a(this);r.call(b,b.data())})});var N=function(b){this.element=a(b)};N.VERSION="3.4.1",N.TRANSITION_DURATION=150,N.prototype.show=function(){var b=this.element,c=b.closest("ul:not(.dropdown-menu)"),d=b.data("target");if(d||(d=b.attr("href"),d=d&&d.replace(/.*(?=#[^\s]*$)/,"")),!b.parent("li").hasClass("active")){var e=c.find(".active:last a"),f=a.Event("hide.bs.tab",{relatedTarget:b[0]}),g=a.Event("show.bs.tab",{relatedTarget:e[0]});if(e.trigger(f),b.trigger(g),!g.isDefaultPrevented()&&!f.isDefaultPrevented()){var h=a(document).find(d);this.activate(b.closest("li"),c),this.activate(h,h.parent(),function(){e.trigger({type:"hidden.bs.tab",relatedTarget:b[0]}),b.trigger({type:"shown.bs.tab",relatedTarget:e[0]})})}}},N.prototype.activate=function(b,c,d){function e(){f.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),b.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),g?(b[0].offsetWidth,b.addClass("in")):b.removeClass("fade"),b.parent(".dropdown-menu").length&&b.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),d&&d()}var f=c.find("> .active"),g=d&&a.support.transition&&(f.length&&f.hasClass("fade")||!!c.find("> .fade").length);f.length&&g?f.one("bsTransitionEnd",e).emulateTransitionEnd(N.TRANSITION_DURATION):e(),f.removeClass("in")};var w=a.fn.tab;a.fn.tab=s,a.fn.tab.Constructor=N,a.fn.tab.noConflict=function(){return a.fn.tab=w,this};var z=function(b){b.preventDefault(),s.call(a(this),"show")};a(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',z).on("click.bs.tab.data-api",'[data-toggle="pill"]',z);var O=function(b,c){this.options=a.extend({},O.DEFAULTS,c);var d=this.options.target===O.DEFAULTS.target?a(this.options.target):a(document).find(this.options.target);this.$target=d.on("scroll.bs.affix.data-api",a.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",a.proxy(this.checkPositionWithEventLoop,this)),this.$element=a(b),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};O.VERSION="3.4.1",O.RESET="affix affix-top affix-bottom",O.DEFAULTS={offset:0,target:window},O.prototype.getState=function(a,b,c,d){var e=this.$target.scrollTop(),f=this.$element.offset(),g=this.$target.height();if(null!=c&&"top"==this.affixed)return e<c&&"top";if("bottom"==this.affixed)return null!=c?!(e+this.unpin<=f.top)&&"bottom":!(e+g<=a-d)&&"bottom";var h=null==this.affixed,i=h?e:f.top,j=h?g:b;return null!=c&&e<=c?"top":null!=d&&i+j>=a-d&&"bottom"},O.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(O.RESET).addClass("affix");var a=this.$target.scrollTop(),b=this.$element.offset();return this.pinnedOffset=b.top-a},O.prototype.checkPositionWithEventLoop=function(){setTimeout(a.proxy(this.checkPosition,this),1)},O.prototype.checkPosition=function(){if(this.$element.is(":visible")){var b=this.$element.height(),c=this.options.offset,d=c.top,e=c.bottom,f=Math.max(a(document).height(),a(document.body).height());"object"!=typeof c&&(e=d=c),"function"==typeof d&&(d=c.top(this.$element)),"function"==typeof e&&(e=c.bottom(this.$element));var g=this.getState(f,b,d,e);if(this.affixed!=g){null!=this.unpin&&this.$element.css("top","");var h="affix"+(g?"-"+g:""),i=a.Event(h+".bs.affix");if(this.$element.trigger(i),i.isDefaultPrevented())return;this.affixed=g,this.unpin="bottom"==g?this.getPinnedOffset():null,this.$element.removeClass(O.RESET).addClass(h).trigger(h.replace("affix","affixed")+".bs.affix")}"bottom"==g&&this.$element.offset({top:f-b-e})}};var w=a.fn.affix;a.fn.affix=t,a.fn.affix.Constructor=O,a.fn.affix.noConflict=function(){return a.fn.affix=w,this},a(window).on("load",function(){a('[data-spy="affix"]').each(function(){var b=a(this),c=b.data();c.offset=c.offset||{},null!=c.offsetBottom&&(c.offset.bottom=c.offsetBottom),null!=c.offsetTop&&(c.offset.top=c.offsetTop),t.call(b,c)})})});
define('theme_roots/bootstrap', ["jquery","core/log"],function(a,b){function c(){var a=document.createElement("bootstrap"),b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var c in b)if(void 0!==a.style[c])return{end:b[c]};return!1}function d(b){return this.each(function(){var c=a(this),d=c.data("bs.alert");d||c.data("bs.alert",d=new v(this)),"string"==typeof b&&d[b].call(c)})}function e(b){return this.each(function(){var c=a(this),d=c.data("bs.button"),e="object"==typeof b&&b;d||c.data("bs.button",d=new x(this,e)),"toggle"==b?d.toggle():b&&d.setState(b)})}function f(b){return this.each(function(){var c=a(this),d=c.data("bs.carousel"),e=a.extend({},y.DEFAULTS,c.data(),"object"==typeof b&&b),f="string"==typeof b?b:e.slide;d||c.data("bs.carousel",d=new y(this,e)),"number"==typeof b?d.to(b):f?d[f]():e.interval&&d.pause().cycle()})}function g(b){var c,d=b.attr("data-target")||(c=b.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,"");return a(document).find(d)}function h(b){return this.each(function(){var c=a(this),d=c.data("bs.collapse"),e=a.extend({},A.DEFAULTS,c.data(),"object"==typeof b&&b);!d&&e.toggle&&/show|hide/.test(b)&&(e.toggle=!1),d||c.data("bs.collapse",d=new A(this,e)),"string"==typeof b&&d[b]()})}function i(b){var c=b.attr("data-target");c||(c=b.attr("href"),c=c&&/#[A-Za-z]/.test(c)&&c.replace(/.*(?=#[^\s]*$)/,""));var d="#"!==c?a(document).find(c):null;return d&&d.length?d:b.parent()}function j(b){b&&3===b.which||(a(B).remove(),a(C).each(function(){var c=a(this),d=i(c),e={relatedTarget:this};d.hasClass("open")&&(b&&"click"==b.type&&/input|textarea/i.test(b.target.tagName)&&a.contains(d[0],b.target)||(d.trigger(b=a.Event("hide.bs.dropdown",e)),b.isDefaultPrevented()||(c.attr("aria-expanded","false"),d.removeClass("open").trigger(a.Event("hidden.bs.dropdown",e)))))}))}function k(b){return this.each(function(){var c=a(this),d=c.data("bs.dropdown");d||c.data("bs.dropdown",d=new D(this)),"string"==typeof b&&d[b].call(c)})}function l(b,c){return this.each(function(){var d=a(this),e=d.data("bs.modal"),f=a.extend({},E.DEFAULTS,d.data(),"object"==typeof b&&b);e||d.data("bs.modal",e=new E(this,f)),"string"==typeof b?e[b](c):f.show&&e.show(c)})}function m(b,c){var d=b.nodeName.toLowerCase();if(a.inArray(d,c)!==-1)return a.inArray(d,G)===-1||Boolean(b.nodeValue.match(J)||b.nodeValue.match(K));for(var e=a(c).filter(function(a,b){return b instanceof RegExp}),f=0,g=e.length;f<g;f++)if(d.match(e[f]))return!0;return!1}function n(b,c,d){if(0===b.length)return b;if(d&&"function"==typeof d)return d(b);if(!document.implementation||!document.implementation.createHTMLDocument)return b;var e=document.implementation.createHTMLDocument("sanitization");e.body.innerHTML=b;for(var f=a.map(c,function(a,b){return b}),g=a(e.body).find("*"),h=0,i=g.length;h<i;h++){var j=g[h],k=j.nodeName.toLowerCase();if(a.inArray(k,f)!==-1)for(var l=a.map(j.attributes,function(a){return a}),n=[].concat(c["*"]||[],c[k]||[]),o=0,p=l.length;o<p;o++)m(l[o],n)||j.removeAttribute(l[o].nodeName);else j.parentNode.removeChild(j)}return e.body.innerHTML}function o(b){return this.each(function(){var c=a(this),d=c.data("bs.tooltip"),e="object"==typeof b&&b;!d&&/destroy|hide/.test(b)||(d||c.data("bs.tooltip",d=new L(this,e)),"string"==typeof b&&d[b]())})}function p(b){return this.each(function(){var c=a(this),d=c.data("bs.popover"),e="object"==typeof b&&b;!d&&/destroy|hide/.test(b)||(d||c.data("bs.popover",d=new M(this,e)),"string"==typeof b&&d[b]())})}function q(b,c){this.$body=a(document.body),this.$scrollElement=a(a(b).is(document.body)?window:b),this.options=a.extend({},q.DEFAULTS,c),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",a.proxy(this.process,this)),this.refresh(),this.process()}function r(b){return this.each(function(){var c=a(this),d=c.data("bs.scrollspy"),e="object"==typeof b&&b;d||c.data("bs.scrollspy",d=new q(this,e)),"string"==typeof b&&d[b]()})}function s(b){return this.each(function(){var c=a(this),d=c.data("bs.tab");d||c.data("bs.tab",d=new N(this)),"string"==typeof b&&d[b]()})}function t(b){return this.each(function(){var c=a(this),d=c.data("bs.affix"),e="object"==typeof b&&b;d||c.data("bs.affix",d=new O(this,e)),"string"==typeof b&&d[b]()})}a(".h1").hide(),b.debug("Bootstrap AMD initialised"),a.fn.emulateTransitionEnd=function(b){var c=!1,d=this;a(this).one("bsTransitionEnd",function(){c=!0});var e=function(){c||a(d).trigger(a.support.transition.end)};return setTimeout(e,b),this},a(function(){a.support.transition=c(),a.support.transition&&(a.event.special.bsTransitionEnd={bindType:a.support.transition.end,delegateType:a.support.transition.end,handle:function(b){if(a(b.target).is(this))return b.handleObj.handler.apply(this,arguments)}})});var u='[data-dismiss="alert"]',v=function(b){a(b).on("click",u,this.close)};v.VERSION="3.4.1",v.TRANSITION_DURATION=150,v.prototype.close=function(b){function c(){f.detach().trigger("closed.bs.alert").remove()}var d=a(this),e=d.attr("data-target");e||(e=d.attr("href"),e=e&&e.replace(/.*(?=#[^\s]*$)/,"")),e="#"===e?[]:e;var f=a(document).find(e);b&&b.preventDefault(),f.length||(f=d.closest(".alert")),f.trigger(b=a.Event("close.bs.alert")),b.isDefaultPrevented()||(f.removeClass("in"),a.support.transition&&f.hasClass("fade")?f.one("bsTransitionEnd",c).emulateTransitionEnd(v.TRANSITION_DURATION):c())};var w=a.fn.alert;a.fn.alert=d,a.fn.alert.Constructor=v,a.fn.alert.noConflict=function(){return a.fn.alert=w,this},a(document).on("click.bs.alert.data-api",u,v.prototype.close);var x=function(b,c){this.$element=a(b),this.options=a.extend({},x.DEFAULTS,c),this.isLoading=!1};x.VERSION="3.4.1",x.DEFAULTS={loadingText:"loading..."},x.prototype.setState=function(b){var c="disabled",d=this.$element,e=d.is("input")?"val":"html",f=d.data();b+="Text",null==f.resetText&&d.data("resetText",d[e]()),setTimeout(a.proxy(function(){d[e](null==f[b]?this.options[b]:f[b]),"loadingText"==b?(this.isLoading=!0,d.addClass(c).attr(c,c).prop(c,!0)):this.isLoading&&(this.isLoading=!1,d.removeClass(c).removeAttr(c).prop(c,!1))},this),0)},x.prototype.toggle=function(){var a=!0,b=this.$element.closest('[data-toggle="buttons"]');if(b.length){var c=this.$element.find("input");"radio"==c.prop("type")?(c.prop("checked")&&(a=!1),b.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==c.prop("type")&&(c.prop("checked")!==this.$element.hasClass("active")&&(a=!1),this.$element.toggleClass("active")),c.prop("checked",this.$element.hasClass("active")),a&&c.trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")};var w=a.fn.button;a.fn.button=e,a.fn.button.Constructor=x,a.fn.button.noConflict=function(){return a.fn.button=w,this},a(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(b){var c=a(b.target).closest(".btn");e.call(c,"toggle"),a(b.target).is('input[type="radio"], input[type="checkbox"]')||(b.preventDefault(),c.is("input,button")?c.trigger("focus"):c.find("input:visible,button:visible").first().trigger("focus"))}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(b){a(b.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(b.type))});var y=function(b,c){this.$element=a(b),this.$indicators=this.$element.find(".carousel-indicators"),this.options=c,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",a.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",a.proxy(this.pause,this)).on("mouseleave.bs.carousel",a.proxy(this.cycle,this))};y.VERSION="3.4.1",y.TRANSITION_DURATION=600,y.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},y.prototype.keydown=function(a){if(!/input|textarea/i.test(a.target.tagName)){switch(a.which){case 37:this.prev();break;case 39:this.next();break;default:return}a.preventDefault()}},y.prototype.cycle=function(b){return b||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(a.proxy(this.next,this),this.options.interval)),this},y.prototype.getItemIndex=function(a){return this.$items=a.parent().children(".item"),this.$items.index(a||this.$active)},y.prototype.getItemForDirection=function(a,b){var c=this.getItemIndex(b),d="prev"==a&&0===c||"next"==a&&c==this.$items.length-1;if(d&&!this.options.wrap)return b;var e="prev"==a?-1:1,f=(c+e)%this.$items.length;return this.$items.eq(f)},y.prototype.to=function(a){var b=this,c=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(a>this.$items.length-1||a<0))return this.sliding?this.$element.one("slid.bs.carousel",function(){b.to(a)}):c==a?this.pause().cycle():this.slide(a>c?"next":"prev",this.$items.eq(a))},y.prototype.pause=function(b){return b||(this.paused=!0),this.$element.find(".next, .prev").length&&a.support.transition&&(this.$element.trigger(a.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},y.prototype.next=function(){if(!this.sliding)return this.slide("next")},y.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},y.prototype.slide=function(b,c){var d=this.$element.find(".item.active"),e=c||this.getItemForDirection(b,d),f=this.interval,g="next"==b?"left":"right",h=this;if(e.hasClass("active"))return this.sliding=!1;var i=e[0],j=a.Event("slide.bs.carousel",{relatedTarget:i,direction:g});if(this.$element.trigger(j),!j.isDefaultPrevented()){if(this.sliding=!0,f&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var k=a(this.$indicators.children()[this.getItemIndex(e)]);k&&k.addClass("active")}var l=a.Event("slid.bs.carousel",{relatedTarget:i,direction:g});return a.support.transition&&this.$element.hasClass("slide")?(e.addClass(b),"object"==typeof e&&e.length&&e[0].offsetWidth,d.addClass(g),e.addClass(g),d.one("bsTransitionEnd",function(){e.removeClass([b,g].join(" ")).addClass("active"),d.removeClass(["active",g].join(" ")),h.sliding=!1,setTimeout(function(){h.$element.trigger(l)},0)}).emulateTransitionEnd(y.TRANSITION_DURATION)):(d.removeClass("active"),e.addClass("active"),this.sliding=!1,this.$element.trigger(l)),f&&this.cycle(),this}};var w=a.fn.carousel;a.fn.carousel=f,a.fn.carousel.Constructor=y,a.fn.carousel.noConflict=function(){return a.fn.carousel=w,this};var z=function(b){var c=a(this),d=c.attr("href");d&&(d=d.replace(/.*(?=#[^\s]+$)/,""));var e=c.attr("data-target")||d,g=a(document).find(e);if(g.hasClass("carousel")){var h=a.extend({},g.data(),c.data()),i=c.attr("data-slide-to");i&&(h.interval=!1),f.call(g,h),i&&g.data("bs.carousel").to(i),b.preventDefault()}};a(document).on("click.bs.carousel.data-api","[data-slide]",z).on("click.bs.carousel.data-api","[data-slide-to]",z),a(window).on("load",function(){a('[data-ride="carousel"]').each(function(){var b=a(this);f.call(b,b.data())})});var A=function(b,c){this.$element=a(b),this.options=a.extend({},A.DEFAULTS,c),this.$trigger=a('[data-toggle="collapse"][href="#'+b.id+'"],[data-toggle="collapse"][data-target="#'+b.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};A.VERSION="3.4.1",A.TRANSITION_DURATION=350,A.DEFAULTS={toggle:!0},A.prototype.dimension=function(){var a=this.$element.hasClass("width");return a?"width":"height"},A.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var b,c=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(c&&c.length&&(b=c.data("bs.collapse"),b&&b.transitioning))){var d=a.Event("show.bs.collapse");if(this.$element.trigger(d),!d.isDefaultPrevented()){c&&c.length&&(h.call(c,"hide"),b||c.data("bs.collapse",null));var e=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[e](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var f=function(){this.$element.removeClass("collapsing").addClass("collapse in")[e](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!a.support.transition)return f.call(this);var g=a.camelCase(["scroll",e].join("-"));this.$element.one("bsTransitionEnd",a.proxy(f,this)).emulateTransitionEnd(A.TRANSITION_DURATION)[e](this.$element[0][g])}}}},A.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var b=a.Event("hide.bs.collapse");if(this.$element.trigger(b),!b.isDefaultPrevented()){var c=this.dimension();this.$element[c](this.$element[c]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var d=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return a.support.transition?void this.$element[c](0).one("bsTransitionEnd",a.proxy(d,this)).emulateTransitionEnd(A.TRANSITION_DURATION):d.call(this)}}},A.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},A.prototype.getParent=function(){return a(document).find(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(a.proxy(function(b,c){var d=a(c);this.addAriaAndCollapsedClass(g(d),d)},this)).end()},A.prototype.addAriaAndCollapsedClass=function(a,b){var c=a.hasClass("in");a.attr("aria-expanded",c),b.toggleClass("collapsed",!c).attr("aria-expanded",c)};var w=a.fn.collapse;a.fn.collapse=h,a.fn.collapse.Constructor=A,a.fn.collapse.noConflict=function(){return a.fn.collapse=w,this},a(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(b){var c=a(this);c.attr("data-target")||b.preventDefault();var d=g(c),e=d.data("bs.collapse"),f=e?"toggle":c.data();h.call(d,f)});var B=".dropdown-backdrop",C='[data-toggle="dropdown"]',D=function(b){a(b).on("click.bs.dropdown",this.toggle)};D.VERSION="3.4.1",D.prototype.toggle=function(b){var c=a(this);if(!c.is(".disabled, :disabled")){var d=i(c),e=d.hasClass("open");if(j(),!e){"ontouchstart"in document.documentElement&&!d.closest(".navbar-nav").length&&a(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(a(this)).on("click",j);var f={relatedTarget:this};if(d.trigger(b=a.Event("show.bs.dropdown",f)),b.isDefaultPrevented())return;c.trigger("focus").attr("aria-expanded","true"),d.toggleClass("open").trigger(a.Event("shown.bs.dropdown",f))}return!1}},D.prototype.keydown=function(b){if(/(38|40|27|32)/.test(b.which)&&!/input|textarea/i.test(b.target.tagName)){var c=a(this);if(b.preventDefault(),b.stopPropagation(),!c.is(".disabled, :disabled")){var d=i(c),e=d.hasClass("open");if(!e&&27!=b.which||e&&27==b.which)return 27==b.which&&d.find(C).trigger("focus"),c.trigger("click");var f=" li:not(.disabled):visible a",g=d.find(".dropdown-menu"+f);if(g.length){var h=g.index(b.target);38==b.which&&h>0&&h--,40==b.which&&h<g.length-1&&h++,~h||(h=0),g.eq(h).trigger("focus")}}}};var w=a.fn.dropdown;a.fn.dropdown=k,a.fn.dropdown.Constructor=D,a.fn.dropdown.noConflict=function(){return a.fn.dropdown=w,this},a(document).on("click.bs.dropdown.data-api",j).on("click.bs.dropdown.data-api",".dropdown form",function(a){a.stopPropagation()}).on("click.bs.dropdown.data-api",C,D.prototype.toggle).on("keydown.bs.dropdown.data-api",C,D.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",D.prototype.keydown);var E=function(b,c){this.options=c,this.$body=a(document.body),this.$element=a(b),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.fixedContent=".navbar-fixed-top, .navbar-fixed-bottom",this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,a.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};E.VERSION="3.4.1",E.TRANSITION_DURATION=300,E.BACKDROP_TRANSITION_DURATION=150,E.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},E.prototype.toggle=function(a){return this.isShown?this.hide():this.show(a)},E.prototype.show=function(b){var c=this,d=a.Event("show.bs.modal",{relatedTarget:b});this.$element.trigger(d),this.isShown||d.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',a.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){c.$element.one("mouseup.dismiss.bs.modal",function(b){a(b.target).is(c.$element)&&(c.ignoreBackdropClick=!0)})}),this.backdrop(function(){var d=a.support.transition&&c.$element.hasClass("fade");c.$element.parent().length||c.$element.appendTo(c.$body),c.$element.show().scrollTop(0),c.adjustDialog(),d&&c.$element[0].offsetWidth,c.$element.addClass("in"),c.enforceFocus();var e=a.Event("shown.bs.modal",{relatedTarget:b});d?c.$dialog.one("bsTransitionEnd",function(){c.$element.trigger("focus").trigger(e)}).emulateTransitionEnd(E.TRANSITION_DURATION):c.$element.trigger("focus").trigger(e)}))},E.prototype.hide=function(b){b&&b.preventDefault(),b=a.Event("hide.bs.modal"),this.$element.trigger(b),this.isShown&&!b.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),a(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),a.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",a.proxy(this.hideModal,this)).emulateTransitionEnd(E.TRANSITION_DURATION):this.hideModal())},E.prototype.enforceFocus=function(){a(document).off("focusin.bs.modal").on("focusin.bs.modal",a.proxy(function(a){document===a.target||this.$element[0]===a.target||this.$element.has(a.target).length||this.$element.trigger("focus")},this))},E.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",a.proxy(function(a){27==a.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},E.prototype.resize=function(){this.isShown?a(window).on("resize.bs.modal",a.proxy(this.handleUpdate,this)):a(window).off("resize.bs.modal")},E.prototype.hideModal=function(){var a=this;this.$element.hide(),this.backdrop(function(){a.$body.removeClass("modal-open"),a.resetAdjustments(),a.resetScrollbar(),a.$element.trigger("hidden.bs.modal")})},E.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},E.prototype.backdrop=function(b){var c=this,d=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var e=a.support.transition&&d;if(this.$backdrop=a(document.createElement("div")).addClass("modal-backdrop "+d).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",a.proxy(function(a){return this.ignoreBackdropClick?void(this.ignoreBackdropClick=!1):void(a.target===a.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),e&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!b)return;e?this.$backdrop.one("bsTransitionEnd",b).emulateTransitionEnd(E.BACKDROP_TRANSITION_DURATION):b()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var f=function(){c.removeBackdrop(),b&&b()};a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",f).emulateTransitionEnd(E.BACKDROP_TRANSITION_DURATION):f()}else b&&b()},E.prototype.handleUpdate=function(){this.adjustDialog()},E.prototype.adjustDialog=function(){var a=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&a?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!a?this.scrollbarWidth:""})},E.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},E.prototype.checkScrollbar=function(){var a=window.innerWidth;if(!a){var b=document.documentElement.getBoundingClientRect();a=b.right-Math.abs(b.left)}this.bodyIsOverflowing=document.body.clientWidth<a,this.scrollbarWidth=this.measureScrollbar()},E.prototype.setScrollbar=function(){var b=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"";var c=this.scrollbarWidth;this.bodyIsOverflowing&&(this.$body.css("padding-right",b+c),a(this.fixedContent).each(function(b,d){var e=d.style.paddingRight,f=a(d).css("padding-right");a(d).data("padding-right",e).css("padding-right",parseFloat(f)+c+"px")}))},E.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad),a(this.fixedContent).each(function(b,c){var d=a(c).data("padding-right");a(c).removeData("padding-right"),c.style.paddingRight=d?d:""})},E.prototype.measureScrollbar=function(){var a=document.createElement("div");a.className="modal-scrollbar-measure",this.$body.append(a);var b=a.offsetWidth-a.clientWidth;return this.$body[0].removeChild(a),b};var w=a.fn.modal;a.fn.modal=l,a.fn.modal.Constructor=E,a.fn.modal.noConflict=function(){return a.fn.modal=w,this},a(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(b){var c=a(this),d=c.attr("href"),e=c.attr("data-target")||d&&d.replace(/.*(?=#[^\s]+$)/,""),f=a(document).find(e),g=f.data("bs.modal")?"toggle":a.extend({remote:!/#/.test(d)&&d},f.data(),c.data());c.is("a")&&b.preventDefault(),f.one("show.bs.modal",function(a){a.isDefaultPrevented()||f.one("hidden.bs.modal",function(){c.is(":visible")&&c.trigger("focus")})}),l.call(f,g,this)});var F=["sanitize","whiteList","sanitizeFn"],G=["background","cite","href","itemtype","longdesc","poster","src","xlink:href"],H=/^aria-[\w-]*$/i,I={"*":["class","dir","id","lang","role",H],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},J=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,K=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+/]+=*$/i,L=function(a,b){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",a,b)};L.VERSION="3.4.1",L.TRANSITION_DURATION=150,L.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0},sanitize:!0,sanitizeFn:null,whiteList:I},L.prototype.init=function(b,c,d){if(this.enabled=!0,this.type=b,this.$element=a(c),this.options=this.getOptions(d),this.$viewport=this.options.viewport&&a(document).find(a.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var e=this.options.trigger.split(" "),f=e.length;f--;){var g=e[f];if("click"==g)this.$element.on("click."+this.type,this.options.selector,a.proxy(this.toggle,this));else if("manual"!=g){var h="hover"==g?"mouseenter":"focusin",i="hover"==g?"mouseleave":"focusout";this.$element.on(h+"."+this.type,this.options.selector,a.proxy(this.enter,this)),this.$element.on(i+"."+this.type,this.options.selector,a.proxy(this.leave,this))}}this.options.selector?this._options=a.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},L.prototype.getDefaults=function(){return L.DEFAULTS},L.prototype.getOptions=function(b){var c=this.$element.data();for(var d in c)c.hasOwnProperty(d)&&a.inArray(d,F)!==-1&&delete c[d];return b=a.extend({},this.getDefaults(),c,b),b.delay&&"number"==typeof b.delay&&(b.delay={show:b.delay,hide:b.delay}),b.sanitize&&(b.template=n(b.template,b.whiteList,b.sanitizeFn)),b},L.prototype.getDelegateOptions=function(){var b={},c=this.getDefaults();return this._options&&a.each(this._options,function(a,d){c[a]!=d&&(b[a]=d)}),b},L.prototype.enter=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);return c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),b instanceof a.Event&&(c.inState["focusin"==b.type?"focus":"hover"]=!0),c.tip().hasClass("in")||"in"==c.hoverState?void(c.hoverState="in"):(clearTimeout(c.timeout),c.hoverState="in",c.options.delay&&c.options.delay.show?void(c.timeout=setTimeout(function(){"in"==c.hoverState&&c.show()},c.options.delay.show)):c.show())},L.prototype.isInStateTrue=function(){for(var a in this.inState)if(this.inState[a])return!0;return!1},L.prototype.leave=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);if(c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),b instanceof a.Event&&(c.inState["focusout"==b.type?"focus":"hover"]=!1),!c.isInStateTrue())return clearTimeout(c.timeout),c.hoverState="out",c.options.delay&&c.options.delay.hide?void(c.timeout=setTimeout(function(){"out"==c.hoverState&&c.hide()},c.options.delay.hide)):c.hide()},L.prototype.show=function(){var b=a.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(b);var c=a.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(b.isDefaultPrevented()||!c)return;var d=this,e=this.tip(),f=this.getUID(this.type);this.setContent(),e.attr("id",f),this.$element.attr("aria-describedby",f),this.options.animation&&e.addClass("fade");var g="function"==typeof this.options.placement?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement,h=/\s?auto?\s?/i,i=h.test(g);i&&(g=g.replace(h,"")||"top"),e.detach().css({top:0,left:0,display:"block"}).addClass(g).data("bs."+this.type,this),this.options.container?e.appendTo(a(document).find(this.options.container)):e.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var j=this.getPosition(),k=e[0].offsetWidth,l=e[0].offsetHeight;if(i){var m=g,n=this.getPosition(this.$viewport);g="bottom"==g&&j.bottom+l>n.bottom?"top":"top"==g&&j.top-l<n.top?"bottom":"right"==g&&j.right+k>n.width?"left":"left"==g&&j.left-k<n.left?"right":g,e.removeClass(m).addClass(g)}var o=this.getCalculatedOffset(g,j,k,l);this.applyPlacement(o,g);var p=function(){var a=d.hoverState;d.$element.trigger("shown.bs."+d.type),d.hoverState=null,"out"==a&&d.leave(d)};a.support.transition&&this.$tip.hasClass("fade")?e.one("bsTransitionEnd",p).emulateTransitionEnd(L.TRANSITION_DURATION):p()}},L.prototype.applyPlacement=function(b,c){var d=this.tip(),e=d[0].offsetWidth,f=d[0].offsetHeight,g=parseInt(d.css("margin-top"),10),h=parseInt(d.css("margin-left"),10);isNaN(g)&&(g=0),isNaN(h)&&(h=0),b.top+=g,b.left+=h,a.offset.setOffset(d[0],a.extend({using:function(a){d.css({top:Math.round(a.top),left:Math.round(a.left)})}},b),0),d.addClass("in");var i=d[0].offsetWidth,j=d[0].offsetHeight;"top"==c&&j!=f&&(b.top=b.top+f-j);var k=this.getViewportAdjustedDelta(c,b,i,j);k.left?b.left+=k.left:b.top+=k.top;var l=/top|bottom/.test(c),m=l?2*k.left-e+i:2*k.top-f+j,n=l?"offsetWidth":"offsetHeight";d.offset(b),this.replaceArrow(m,d[0][n],l)},L.prototype.replaceArrow=function(a,b,c){this.arrow().css(c?"left":"top",50*(1-a/b)+"%").css(c?"top":"left","")},L.prototype.setContent=function(){var a=this.tip(),b=this.getTitle();this.options.html?(this.options.sanitize&&(b=n(b,this.options.whiteList,this.options.sanitizeFn)),a.find(".tooltip-inner").html(b)):a.find(".tooltip-inner").text(b),a.removeClass("fade in top bottom left right")},L.prototype.hide=function(b){function c(){"in"!=d.hoverState&&e.detach(),d.$element&&d.$element.removeAttr("aria-describedby").trigger("hidden.bs."+d.type),b&&b()}var d=this,e=a(this.$tip),f=a.Event("hide.bs."+this.type);if(this.$element.trigger(f),!f.isDefaultPrevented())return e.removeClass("in"),a.support.transition&&e.hasClass("fade")?e.one("bsTransitionEnd",c).emulateTransitionEnd(L.TRANSITION_DURATION):c(),this.hoverState=null,this},L.prototype.fixTitle=function(){var a=this.$element;(a.attr("title")||"string"!=typeof a.attr("data-original-title"))&&a.attr("data-original-title",a.attr("title")||"").attr("title","")},L.prototype.hasContent=function(){return this.getTitle()},L.prototype.getPosition=function(b){b=b||this.$element;var c=b[0],d="BODY"==c.tagName,e=c.getBoundingClientRect();null==e.width&&(e=a.extend({},e,{width:e.right-e.left,height:e.bottom-e.top}));var f=window.SVGElement&&c instanceof window.SVGElement,g=d?{top:0,left:0}:f?null:b.offset(),h={scroll:d?document.documentElement.scrollTop||document.body.scrollTop:b.scrollTop()},i=d?{width:a(window).width(),height:a(window).height()}:null;return a.extend({},e,h,i,g)},L.prototype.getCalculatedOffset=function(a,b,c,d){return"bottom"==a?{top:b.top+b.height,left:b.left+b.width/2-c/2}:"top"==a?{top:b.top-d,left:b.left+b.width/2-c/2}:"left"==a?{top:b.top+b.height/2-d/2,left:b.left-c}:{top:b.top+b.height/2-d/2,left:b.left+b.width}},L.prototype.getViewportAdjustedDelta=function(a,b,c,d){var e={top:0,left:0};if(!this.$viewport)return e;var f=this.options.viewport&&this.options.viewport.padding||0,g=this.getPosition(this.$viewport);if(/right|left/.test(a)){var h=b.top-f-g.scroll,i=b.top+f-g.scroll+d;h<g.top?e.top=g.top-h:i>g.top+g.height&&(e.top=g.top+g.height-i)}else{var j=b.left-f,k=b.left+f+c;j<g.left?e.left=g.left-j:k>g.right&&(e.left=g.left+g.width-k)}return e},L.prototype.getTitle=function(){var a,b=this.$element,c=this.options;return a=b.attr("data-original-title")||("function"==typeof c.title?c.title.call(b[0]):c.title)},L.prototype.getUID=function(a){do a+=~~(1e6*Math.random());while(document.getElementById(a));return a},L.prototype.tip=function(){if(!this.$tip&&(this.$tip=a(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},L.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},L.prototype.enable=function(){this.enabled=!0},L.prototype.disable=function(){this.enabled=!1},L.prototype.toggleEnabled=function(){this.enabled=!this.enabled},L.prototype.toggle=function(b){var c=this;b&&(c=a(b.currentTarget).data("bs."+this.type),c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c))),b?(c.inState.click=!c.inState.click,c.isInStateTrue()?c.enter(c):c.leave(c)):c.tip().hasClass("in")?c.leave(c):c.enter(c)},L.prototype.destroy=function(){var a=this;clearTimeout(this.timeout),this.hide(function(){a.$element.off("."+a.type).removeData("bs."+a.type),a.$tip&&a.$tip.detach(),a.$tip=null,a.$arrow=null,a.$viewport=null,a.$element=null})},L.prototype.sanitizeHtml=function(a){return n(a,this.options.whiteList,this.options.sanitizeFn)};var w=a.fn.tooltip;a.fn.tooltip=o,a.fn.tooltip.Constructor=L,a.fn.tooltip.noConflict=function(){return a.fn.tooltip=w,this};var M=function(a,b){this.init("popover",a,b)};if(!a.fn.tooltip)throw new Error("Popover requires tooltip.js");M.VERSION="3.4.1",M.DEFAULTS=a.extend({},a.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'
}),M.prototype=a.extend({},a.fn.tooltip.Constructor.prototype),M.prototype.constructor=M,M.prototype.getDefaults=function(){return M.DEFAULTS},M.prototype.setContent=function(){var a=this.tip(),b=this.getTitle(),c=this.getContent();if(this.options.html){var d=typeof c;this.options.sanitize&&(b=this.sanitizeHtml(b),"string"===d&&(c=this.sanitizeHtml(c))),a.find(".popover-title").html(b),a.find(".popover-content").children().detach().end()["string"===d?"html":"append"](c)}else a.find(".popover-title").text(b),a.find(".popover-content").children().detach().end().text(c);a.removeClass("fade top bottom left right in"),a.find(".popover-title").html()||a.find(".popover-title").hide()},M.prototype.hasContent=function(){return this.getTitle()||this.getContent()},M.prototype.getContent=function(){var a=this.$element,b=this.options;return a.attr("data-content")||("function"==typeof b.content?b.content.call(a[0]):b.content)},M.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var w=a.fn.popover;a.fn.popover=p,a.fn.popover.Constructor=M,a.fn.popover.noConflict=function(){return a.fn.popover=w,this},q.VERSION="3.4.1",q.DEFAULTS={offset:10},q.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},q.prototype.refresh=function(){var b=this,c="offset",d=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),a.isWindow(this.$scrollElement[0])||(c="position",d=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var b=a(this),e=b.data("target")||b.attr("href"),f=/^#./.test(e)&&a(e);return f&&f.length&&f.is(":visible")&&[[f[c]().top+d,e]]||null}).sort(function(a,b){return a[0]-b[0]}).each(function(){b.offsets.push(this[0]),b.targets.push(this[1])})},q.prototype.process=function(){var a,b=this.$scrollElement.scrollTop()+this.options.offset,c=this.getScrollHeight(),d=this.options.offset+c-this.$scrollElement.height(),e=this.offsets,f=this.targets,g=this.activeTarget;if(this.scrollHeight!=c&&this.refresh(),b>=d)return g!=(a=f[f.length-1])&&this.activate(a);if(g&&b<e[0])return this.activeTarget=null,this.clear();for(a=e.length;a--;)g!=f[a]&&b>=e[a]&&(void 0===e[a+1]||b<e[a+1])&&this.activate(f[a])},q.prototype.activate=function(b){this.activeTarget=b,this.clear();var c=this.selector+'[data-target="'+b+'"],'+this.selector+'[href="'+b+'"]',d=a(c).parents("li").addClass("active");d.parent(".dropdown-menu").length&&(d=d.closest("li.dropdown").addClass("active")),d.trigger("activate.bs.scrollspy")},q.prototype.clear=function(){a(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var w=a.fn.scrollspy;a.fn.scrollspy=r,a.fn.scrollspy.Constructor=q,a.fn.scrollspy.noConflict=function(){return a.fn.scrollspy=w,this},a(window).on("load.bs.scrollspy.data-api",function(){a('[data-spy="scroll"]').each(function(){var b=a(this);r.call(b,b.data())})});var N=function(b){this.element=a(b)};N.VERSION="3.4.1",N.TRANSITION_DURATION=150,N.prototype.show=function(){var b=this.element,c=b.closest("ul:not(.dropdown-menu)"),d=b.data("target");if(d||(d=b.attr("href"),d=d&&d.replace(/.*(?=#[^\s]*$)/,"")),!b.parent("li").hasClass("active")){var e=c.find(".active:last a"),f=a.Event("hide.bs.tab",{relatedTarget:b[0]}),g=a.Event("show.bs.tab",{relatedTarget:e[0]});if(e.trigger(f),b.trigger(g),!g.isDefaultPrevented()&&!f.isDefaultPrevented()){var h=a(document).find(d);this.activate(b.closest("li"),c),this.activate(h,h.parent(),function(){e.trigger({type:"hidden.bs.tab",relatedTarget:b[0]}),b.trigger({type:"shown.bs.tab",relatedTarget:e[0]})})}}},N.prototype.activate=function(b,c,d){function e(){f.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),b.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),g?(b[0].offsetWidth,b.addClass("in")):b.removeClass("fade"),b.parent(".dropdown-menu").length&&b.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),d&&d()}var f=c.find("> .active"),g=d&&a.support.transition&&(f.length&&f.hasClass("fade")||!!c.find("> .fade").length);f.length&&g?f.one("bsTransitionEnd",e).emulateTransitionEnd(N.TRANSITION_DURATION):e(),f.removeClass("in")};var w=a.fn.tab;a.fn.tab=s,a.fn.tab.Constructor=N,a.fn.tab.noConflict=function(){return a.fn.tab=w,this};var z=function(b){b.preventDefault(),s.call(a(this),"show")};a(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',z).on("click.bs.tab.data-api",'[data-toggle="pill"]',z);var O=function(b,c){this.options=a.extend({},O.DEFAULTS,c);var d=this.options.target===O.DEFAULTS.target?a(this.options.target):a(document).find(this.options.target);this.$target=d.on("scroll.bs.affix.data-api",a.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",a.proxy(this.checkPositionWithEventLoop,this)),this.$element=a(b),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};O.VERSION="3.4.1",O.RESET="affix affix-top affix-bottom",O.DEFAULTS={offset:0,target:window},O.prototype.getState=function(a,b,c,d){var e=this.$target.scrollTop(),f=this.$element.offset(),g=this.$target.height();if(null!=c&&"top"==this.affixed)return e<c&&"top";if("bottom"==this.affixed)return null!=c?!(e+this.unpin<=f.top)&&"bottom":!(e+g<=a-d)&&"bottom";var h=null==this.affixed,i=h?e:f.top,j=h?g:b;return null!=c&&e<=c?"top":null!=d&&i+j>=a-d&&"bottom"},O.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(O.RESET).addClass("affix");var a=this.$target.scrollTop(),b=this.$element.offset();return this.pinnedOffset=b.top-a},O.prototype.checkPositionWithEventLoop=function(){setTimeout(a.proxy(this.checkPosition,this),1)},O.prototype.checkPosition=function(){if(this.$element.is(":visible")){var b=this.$element.height(),c=this.options.offset,d=c.top,e=c.bottom,f=Math.max(a(document).height(),a(document.body).height());"object"!=typeof c&&(e=d=c),"function"==typeof d&&(d=c.top(this.$element)),"function"==typeof e&&(e=c.bottom(this.$element));var g=this.getState(f,b,d,e);if(this.affixed!=g){null!=this.unpin&&this.$element.css("top","");var h="affix"+(g?"-"+g:""),i=a.Event(h+".bs.affix");if(this.$element.trigger(i),i.isDefaultPrevented())return;this.affixed=g,this.unpin="bottom"==g?this.getPinnedOffset():null,this.$element.removeClass(O.RESET).addClass(h).trigger(h.replace("affix","affixed")+".bs.affix")}"bottom"==g&&this.$element.offset({top:f-b-e})}};var w=a.fn.affix;a.fn.affix=t,a.fn.affix.Constructor=O,a.fn.affix.noConflict=function(){return a.fn.affix=w,this},a(window).on("load",function(){a('[data-spy="affix"]').each(function(){var b=a(this),c=b.data();c.offset=c.offset||{},null!=c.offsetBottom&&(c.offset.bottom=c.offsetBottom),null!=c.offsetTop&&(c.offset.top=c.offsetTop),t.call(b,c)})})});
define('assquestion_multichoice/penaltyctl', ["jquery"],function(a){return{initialize:function(){this.togglePenalty(),a&&a("#id_config_choicetype").change(this.togglePenalty)},togglePenalty:function(){var b=a("#id_config_choicetype");1==b.val()?a("#fitem_id_responses input.penalty").prop("readonly",!0):a("#fitem_id_responses input.penalty").prop("readonly",!1)}}});
define('pathway_criteria_group/criteria_group', ["core/str","core/notification","core/templates","totara_competency/loader_manager"],function(a,b,c,d){function e(){return this instanceof e?(this.widget="",this.pathway={id:0,type:"criteria_group",scalevalue:0,sortorder:0,criteria:[]},this.pwKey="",this.lastCriterionKey=0,this.criteria={},this.criteriaLength=0,this.markedForDeletionCriteria={},this.typeModal=null,this.endpoints={create:"pathway_criteria_group_create",update:"pathway_criteria_group_update"},this.filename="criteria_group.js",this.busyAddCriterion="",void(this.loader=null)):new e}e.prototype={events:function(){var a,c=this;this.widget.addEventListener("click",function(d){if(!d.target)return!1;if(d.target.closest("[data-cg-action]"))a=d.target.closest("[data-cg-action]").getAttribute("data-cg-action"),"addcriterion"===a&&c.showCriteriaTypeOptions();else if(d.target.closest('[data-tw-editScaleValuePaths-dropDown-level="criteria_group"]')){var e=d.target.closest('[data-tw-editScaleValuePaths-dropDown-level="criteria_group"]');c.hideCriteriaTypeSelectors(),c.addCriterion(c.pwKey,e)}else if(d.target.closest("[data-tw-editScaleValuePaths-criterion-action]")){var f,g=d.target.closest("[data-tw-editScaleValuePaths-criterion-action]"),h=g.closest("[data-tw-editScaleValuePaths-criterion-key]"),i=h.querySelector("button");if(a=g.getAttribute("data-tw-editScaleValuePaths-criterion-action"),!h)return b.exception({fileName:c.filename,message:"Can't determine target of the "+a+" criterion action",name:"No criterion action target"}),!1;if(c.hideCriteriaTypeSelectors(),f=h.getAttribute("data-tw-editScaleValuePaths-criterion-key"),"toggle-detail"===a){c.toggleCriterionDetail(f);var j=i.getAttribute("aria-expanded"),k="true"===j?"false":"true";i.setAttribute("aria-expanded",k)}else"remove"===a?c.removeCriterion(f):"undo"===a&&c.undoCriterionRemoval(f)}return!1}),window.addEventListener("click",this.hideCriteriaTypeSelectors.bind(this))},bubbledEventsListener:function(){var a,b,c=this,d="totara_criteria/criterion:";this.widget.addEventListener(d+"update",function(d){a=d.detail.key,b=d.detail.criterion,b&&(c.criteria[a]||(c.criteria[a]={id:b.id?b.id:0,type:b.type?b.type:"",title:b.title?b.title:"",singleuse:b.singleuse||!1,expandable:b.expandable||!1},c.markedForDeletionCriteria[a]&&delete c.markedForDeletionCriteria[a],c.criteriaLength+=1),b.singleuse&&(c.hideAddCriteriaDropdown(),c.triggerEvent("singleUseCriterion",{used:!0,scalevalue:c.pathway.scalevalue})),delete b.singleuse,delete b.expandable,c.criteria[a].detail=b),c.packCriteria(),c.unsetBusyAddCriterion(),c.triggerEvent("update",{pathway:c.pathway})}),this.widget.addEventListener(d+"dirty",function(b){a=b.detail.key,c.criteria[a]&&(c.criteria[a].dirty=!0,c.triggerEvent("dirty",{}))})},setParent:function(a){this.widget=a},initData:function(){var a=this,b=this.widget.closest("[data-tw-editAchievementPaths-pathway-key]"),c=this.widget.closest("[data-tw-editScaleValuePaths-value]"),d=0,e=0,f="pathwayCriteriaGroupInit_";return new Promise(function(g){if(b&&(d=b.getAttribute("data-tw-editAchievementPaths-pathway-key")?b.getAttribute("data-tw-editAchievementPaths-pathway-key"):0,e=b.getAttribute("data-tw-editAchievementPaths-pathway-id")?b.getAttribute("data-tw-editAchievementPaths-pathway-id"):0,f+=d),M.util.js_pending(f),a.pwKey=d,c&&(a.pathway.scalevalue=c.getAttribute("data-tw-editScaleValuePaths-value")?c.getAttribute("data-tw-editScaleValuePaths-value"):1),0===e){delete a.pathway.id;var h=document.querySelector("[data-tw-editAchievementPaths-competency]"),i=1;h&&(i=h.getAttribute("data-tw-editAchievementPaths-competency")),a.pathway.competency_id=i,a.widget.setAttribute("data-tw-editAchievementPaths-save-endPoint",a.endpoints.create)}else a.widget.setAttribute("data-tw-editAchievementPaths-save-endPoint",a.endpoints.update),a.pathway.id=e;a.toggleSingleUse(!1),a.triggerEvent("update",{pathway:a.pathway}),M.util.js_complete(f),g()})},getNextCriterionKey:function(){return this.lastCriterionKey++,this.pwKey+"_new_criterion_"+this.lastCriterionKey},packCriteria:function(){this.pathway.criteria=[];for(var a in this.criteria)this.criteria[a].detail&&this.pathway.criteria.push(this.criteria[a].detail)},hideBottomActions:function(){var a=this.widget.closest("[data-tw-editAchievementPaths-pathway-key]").querySelector("[data-tw-editScaleValuePaths-group-add]");a.classList.add("tw-editAchievementPaths--hidden")},showBottomActions:function(){var a=this.widget.closest("[data-tw-editAchievementPaths-pathway-key]").querySelector("[data-tw-editScaleValuePaths-group-add]");a.classList.remove("tw-editAchievementPaths--hidden")},hideCriteriaTypeSelectors:function(a){var b=a&&a.target&&a.target.closest('[data-cg-action="addcriterion"]');if(!b){for(var c=document.querySelectorAll('[data-tw-editScaleValuePaths-dropDown="criteria_group"]'),d=0;d<c.length;d++)c[d].classList.add("tw-editAchievementPaths--hidden");for(var e=document.querySelectorAll('[data-cg-action="addcriterion"]'),d=0;d<e.length;d++)e[d].setAttribute("aria-expanded",!1)}},showCriteriaTypeOptions:function(){var a=this.widget.querySelector('[data-tw-editScaleValuePaths-dropDown="criteria_group"]'),b=!!a&&!a.classList.contains("tw-editAchievementPaths--hidden"),c=a.previousElementSibling;this.hideCriteriaTypeSelectors(),a&&!b&&(a.classList.remove("tw-editAchievementPaths--hidden"),c&&c.setAttribute("aria-expanded","true"))},addCriterion:function(a,d){var e,f=this,g=this.widget.querySelector("[data-tw-editScaleValuePaths-group-criteria]"),h="pathway_criteria_group/scalevalue_group_criteria",i=d.getAttribute("data-tw-editScaleValuePaths-dropDown-item-type"),j=d.getAttribute("data-tw-editScaleValuePaths-dropDown-item-title"),k=d.getAttribute("data-tw-editScaleValuePaths-dropDown-item-template"),l=d.getAttribute("data-tw-editScaleValuePaths-dropDown-item-singleUse");""===this.busyAddCriterion&&(this.setBusyAddCriterion(i),e=f.getNextCriterionKey(),this.criteria[e]={key:e,type:i,title:j,criterion_templatename:k,singleuse:!!+l},this.criteria[e].expandable=!this.criteria[e].singleuse,this.criteriaLength>0&&(this.criteria[e].showand=!0),this.criteriaLength+=1,c.renderAppend(h,{criteria:this.criteria[e]},g).then(function(){c.runTemplateJS(""),f.triggerEvent("dirty",{})})["catch"](function(a){a.fileName=f.filename,a.name="Error displaying "+i,b.exception(a),f.unsetBusyAddCriterion()}))},toggleSingleUse:function(a){var b=this.widget.querySelectorAll('[data-tw-editScaleValuePaths-dropDown-item-singleUse="1"]');if(b.length>0)if(a)for(var c=0;c<b.length;c++)b[c].removeAttribute("disabled");else for(var d=0;d<b.length;d++)b[d].setAttribute("disabled","")},hideAddCriteriaDropdown:function(){var a=this.widget.querySelector(".tw-editScaleValuePaths__addButton");a&&a.classList.add("tw-editAchievementPaths--hidden")},toggleCriterionDetail:function(a){var b=this.widget.querySelector('[data-tw-editScaleValuePaths-criterion-key="'+a+'"]'),c=this.widget.querySelector('[data-tw-editScaleValuePaths-criterion-detail="'+a+'"]'),d=b.hasAttribute("data-tw-editScaleValuePaths-criterion-detail-expanded")?b.getAttribute("data-tw-editScaleValuePaths-criterion-detail-expanded"):0,e=b.querySelector('[data-tw-editScaleValuePaths-criterion-detail-icon="expanded"]'),f=b.querySelector('[data-tw-editScaleValuePaths-criterion-detail-icon="collapsed"]');1==d?(c.classList.add("tw-editAchievementPaths--hidden"),e.classList.add("tw-editAchievementPaths--hidden"),f.classList.remove("tw-editAchievementPaths--hidden"),b.removeAttribute("data-tw-editScaleValuePaths-criterion-detail-expanded")):(c.classList.remove("tw-editAchievementPaths--hidden"),e.classList.remove("tw-editAchievementPaths--hidden"),f.classList.add("tw-editAchievementPaths--hidden"),b.setAttribute("data-tw-editScaleValuePaths-criterion-detail-expanded","1"))},removeCriterion:function(a){var b=this.widget.querySelector('[data-tw-editScaleValuePaths-criterion-key="'+a+'"]'),c=this.widget.querySelector('[data-tw-editAchievementPaths-and-key="'+a+'"]'),d=b.querySelector("[data-tw-editScaleValuePaths-criterion-active]"),e=b.querySelector("[data-tw-editScaleValuePaths-criterion-deleted]"),f=b.querySelector('[data-tw-editScaleValuePaths-criterion-action="remove"]'),g=b.querySelector('[data-tw-editScaleValuePaths-criterion-action="undo"]'),h={},i="removeCriterion"+a;M.util.js_pending(i),this.criteria[a]?(this.criteria[a].singleuse&&(this.triggerEvent("singleUseCriterion",{used:!1,scalevalue:this.pathway.scalevalue}),this.showBottomActions()),this.criteria[a].id&&0!=this.criteria[a].id?(h[a]=this.criteria[a],Object.assign(this.markedForDeletionCriteria,h),delete this.criteria[a],this.packCriteria(),d&&d.classList.add("tw-editAchievementPaths--hidden"),e&&e.classList.remove("tw-editAchievementPaths--hidden"),f&&f.classList.add("tw-editAchievementPaths--hidden"),g&&g.classList.remove("tw-editAchievementPaths--hidden"),this.triggerEvent("update",{pathway:this.pathway}),this.triggerEvent("dirty",{}),M.util.js_complete(i)):(b&&b.remove(),c?c.remove():this.pathway.criteria.length>1&&(c=this.widget.querySelector("[data-tw-editAchievementPaths-and-key]"),c&&c.remove()),delete this.criteria[a],this.packCriteria(),0==this.pathway.criteria.length?this.triggerEvent("remove",{pendingJsKey:i}):(this.triggerEvent("update",{pathway:this.pathway}),M.util.js_complete(i)),this.triggerEvent("dirty",{})),this.criteriaLength-=1):M.util.js_complete(i)},undoCriterionRemoval:function(c){if(this.markedForDeletionCriteria[c]){var d=this.widget.querySelector('[data-tw-editScaleValuePaths-criterion-key="'+c+'"]'),e=d.querySelector("[data-tw-editScaleValuePaths-criterion-active]"),f=d.querySelector("[data-tw-editScaleValuePaths-criterion-deleted]"),g=d.querySelector('[data-tw-editScaleValuePaths-criterion-action="remove"]'),h=d.querySelector('[data-tw-editScaleValuePaths-criterion-action="undo"]'),i={},j="undoRemoveCriterion"+c;if(M.util.js_pending(j),this.markedForDeletionCriteria[c].singleuse){var k=this.hasSingleUseCriteria();if(k)return b.clearNotifications(),a.get_string("error_cant_undo_single_use","pathway_criteria_group").done(function(a){b.addNotification({message:a,type:"error"}),window.scrollTo(0,0)}).fail(b.exception),M.util.js_complete(j),!1}i[c]=this.markedForDeletionCriteria[c],Object.assign(this.criteria,i),delete this.markedForDeletionCriteria[c],this.packCriteria(),this.criteria[c].singleuse?this.triggerEvent("singleUseCriterion",{used:!0,scalevalue:this.pathway.scalevalue}):this.toggleSingleUse(!1),e&&e.classList.remove("tw-editAchievementPaths--hidden"),f&&f.classList.add("tw-editAchievementPaths--hidden"),g&&g.classList.remove("tw-editAchievementPaths--hidden"),h&&h.classList.add("tw-editAchievementPaths--hidden"),this.triggerEvent("update",{pathway:this.pathway}),this.triggerEvent("dirty",{}),this.criteriaLength+=1,M.util.js_complete(j)}},hasSingleUseCriteria:function(){var a=document.querySelector("[data-tw-editAchievementPaths-criteria-singleUse]"),b=0;return a&&(b=a.getAttribute("data-tw-editAchievementPaths-criteria-singleUse")),!!+b},triggerEvent:function(a,b){b.key=this.pwKey;var c=new CustomEvent("totara_competency/pathway:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)},setBusyAddCriterion:function(a){this.busyAddCriterion=a,M.util.js_pending(this.busyAddCriterion),this.loader.show()},unsetBusyAddCriterion:function(){this.loader.hide(),M.util.js_complete(this.busyAddCriterion),this.busyAddCriterion=""}};var f=function(a){return new Promise(function(b){var c=new e;c.setParent(a),c.events(),c.bubbledEventsListener(),c.loader=d.init(a),b(c),M.util.js_pending("pathwayCriteriaGroup"),c.loader.show(),c.initData().then(function(){c.loader.hide(),M.util.js_complete("pathwayCriteriaGroup")})["catch"](function(){})})};return{init:f}});
define('pathway_learning_plan/learning_plan', [],function(){function a(){return this instanceof a?(this.widget="",this.pathway={id:0,sortorder:0,type:"learning_plan",singleuse:1},this.pwKey="",this.endpoints={create:"pathway_learning_plan_create",update:"pathway_learning_plan_update"},void(this.filename="modal.js")):new a}a.prototype={setParent:function(a){this.widget=a},initData:function(){var a=this,b=this.widget.closest("[data-tw-editAchievementPaths-pathway-key]"),c=0,d=0,e=this.widget.closest("[data-tw-editAchievementPaths-pathway-id]"),f=this.widget;return new Promise(function(g){if(b&&(c=b.getAttribute("data-tw-editAchievementPaths-pathway-key")?b.getAttribute("data-tw-editAchievementPaths-pathway-key"):0),e&&(d=e.getAttribute("data-tw-editAchievementPaths-pathway-id")?e.getAttribute("data-tw-editAchievementPaths-pathway-id"):0),a.pwKey=c,0===d){delete a.pathway.id;var h=document.querySelector("[data-tw-editAchievementPaths-competency]"),i=1;h&&(i=h.getAttribute("data-tw-editAchievementPaths-competency")),a.pathway.competency_id=i,f.setAttribute("data-tw-editAchievementPaths-save-endPoint",a.endpoints.create)}else a.pathway.id=d,f.setAttribute("data-tw-editAchievementPaths-save-endPoint",a.endpoints.update);a.triggerEvent("update",{pathway:a.pathway}),g()})},triggerEvent:function(a,b){b.key=this.pwKey;var c=new CustomEvent("totara_competency/pathway:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),c(d),M.util.js_pending("pathwayLearningPlan"),d.initData().then(function(){M.util.js_complete("pathwayLearningPlan")})["catch"](function(){})})};return{init:b}});
define('pathway_manual/manual', ["core/templates","core/notification","core/ajax","totara_competency/modal_list"],function(a,b,c,d){function e(){return this instanceof e?(this.widget="",this.pathway={id:0,type:"manual",sortorder:0,roles:[]},this.pwKey="",this.rolesPicker=null,this.fullRoles=[],this.roleIds=[],this.endpoints={create:"pathway_manual_create",update:"pathway_manual_update",allroles:"pathway_manual_get_roles"},void(this.filename="manual.js")):new e}e.prototype={events:function(){var a=this;this.widget.addEventListener("click",function(b){if(b.target){if(b.target.closest("[data-pw-manual-action]")){var c=b.target.closest("[data-pw-manual-action]").getAttribute("data-pw-manual-action");"addraters"===c&&a.pickRaters()}if(b.target.closest("[data-pw-item-remove]")&&b.target.closest("[data-pw-item-id]")){var d=b.target.closest("[data-pw-item-id]").getAttribute("data-pw-item-id");a.removeRole(d)}}})},setParent:function(a){this.widget=a},initData:function(){var a=this,c=this.widget.closest("[data-tw-editAchievementPaths-pathway-key]"),d=0,e=0;return new Promise(function(f,g){if(c&&(d=c.getAttribute("data-tw-editAchievementPaths-pathway-key")?c.getAttribute("data-tw-editAchievementPaths-pathway-key"):0,e=c.getAttribute("data-tw-editAchievementPaths-pathway-id")?c.getAttribute("data-tw-editAchievementPaths-pathway-id"):0),a.pwKey=d,0===e){delete a.pathway.id;var h=document.querySelector("[data-tw-editAchievementPaths-competency]"),i=1;h&&(i=h.getAttribute("data-tw-editAchievementPaths-competency")),a.pathway.competency_id=i,a.widget.setAttribute("data-tw-editAchievementPaths-save-endPoint",a.endpoints.create)}else a.pathway.id=e,a.widget.setAttribute("data-tw-editAchievementPaths-save-endPoint",a.endpoints.update),a.getRoles();a.showHideNoRaters(),a.initRolesPicker().then(function(){a.triggerEvent("update",{pathway:a.pathway}),f()})["catch"](function(c){b.exception({fileName:a.filename,message:c[0]+" modal: "+c[1],name:"Error initialising manual data"}),g()})})},getRoles:function(){for(var a,b=this.widget.querySelectorAll(".pw_item"),c=0;c<b.length;c++)a={},a.id=parseInt(b[c].getAttribute("data-pw-item-id")?b[c].getAttribute("data-pw-item-id"):0),a.value=b[c].getAttribute("data-pw-item-value")?b[c].getAttribute("data-pw-item-value"):"",this.pathway.roles.push(a.value),this.roleIds.push(a.id),this.fullRoles[a.id]=a},initRolesPicker:function(){var a=this;return new Promise(function(c){var e={key:"pwManualRolesPicker_"+a.pwKey,title:[{key:"select_raters",component:"pathway_manual"}],list:{map:{cols:[{dataPath:"text",headerString:{key:"select_raters",component:"pathway_manual"}}]},service:a.endpoints.allroles},onSaved:function(b,c,d){a.updateRoles(d)}};d.adder(e).then(function(b){a.rolesPicker=b,c(b)})["catch"](function(c){b.exception({fileName:a.filename,message:c[0]+" modal: "+c[1],name:"Error loading modal list adder"})})})},pickRaters:function(){var a=this;this.rolesPicker?a.rolesPicker.show(a.roleIds):this.initRolesPicker().then(function(b){b.show(a.roleIds)})["catch"](function(c){b.exception({fileName:a.filename,message:c[0]+" modal: "+c[1],name:"Error loading modal list adder"})})},updateRoles:function(c){for(var d=this,e=this.widget.querySelector("[data-pw-roles]"),f=[],g=0;g<c.length;g++){var h=c[g];this.roleIds.indexOf(h.id)<0&&(this.pathway.roles.push(h.value),this.roleIds.push(h.id),this.fullRoles[h.id]=h,f.push(a.renderAppend("totara_competency/partial_item",h,e)))}d.showHideNoRaters(),f.length>0&&Promise.all(f).then(function(){d.triggerEvent("update",{pathway:d.pathway}),d.triggerEvent("dirty",{})})["catch"](function(a){a.fileName=d.filename,a.name="Error showing updated roles",b.exception(a)})},removeRole:function(a){a=parseInt(a);var b,c=this.roleIds.indexOf(a),d=-1;c>=0&&(this.fullRoles[a]&&(d=this.pathway.roles.indexOf(this.fullRoles[a].value),delete this.fullRoles[a]),d>=0&&this.pathway.roles.splice(d,1),this.roleIds.splice(c,1),b=this.widget.querySelector('.pw_item[data-pw-item-id="'+a+'"'),b&&(b.remove(),this.triggerEvent("update",{pathway:this.pathway}),this.triggerEvent("dirty",{}))),this.showHideNoRaters()},showHideNoRaters:function(){var a=this.widget.querySelector("[data-pw-manual-error-no-raters]");0==this.roleIds.length?a.classList.remove("tw-editAchievementPaths--hidden"):a.classList.add("tw-editAchievementPaths--hidden")},triggerEvent:function(a,b){b.key=this.pwKey;var c=new CustomEvent("totara_competency/pathway:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)}};var f=function(a){return new Promise(function(b){var c=new e;c.setParent(a),c.events(),b(c),M.util.js_pending("pathwayManual"),c.initData().then(function(){M.util.js_complete("pathwayManual")})["catch"](function(){})})};return{init:f}});
define('pathway_perform_rating/perform_rating', [],function(){function a(){return this instanceof a?(this.widget="",this.pathway={id:0,type:"perform_rating",sortorder:0,singleuse:1},this.pwKey="",this.endpoints={create:"pathway_perform_rating_create",update:"pathway_perform_rating_update"},void(this.filename="perform_rating.js")):new a}a.prototype={events:function(){},setParent:function(a){this.widget=a},initData:function(){var a=this,b=this.widget.closest("[data-tw-editAchievementPaths-pathway-key]"),c=0,d=0;return new Promise(function(e,f){if(b&&(c=b.getAttribute("data-tw-editAchievementPaths-pathway-key")?b.getAttribute("data-tw-editAchievementPaths-pathway-key"):0,d=b.getAttribute("data-tw-editAchievementPaths-pathway-id")?b.getAttribute("data-tw-editAchievementPaths-pathway-id"):0),a.pwKey=c,0===d){delete a.pathway.id;var g=document.querySelector("[data-tw-editAchievementPaths-competency]"),h=1;g&&(h=g.getAttribute("data-tw-editAchievementPaths-competency")),a.pathway.competency_id=h,a.widget.setAttribute("data-tw-editAchievementPaths-save-endPoint",a.endpoints.create)}else a.pathway.id=d,a.widget.setAttribute("data-tw-editAchievementPaths-save-endPoint",a.endpoints.update);a.triggerEvent("update",{pathway:a.pathway})})},triggerEvent:function(a,b){b.key=this.pwKey;var c=new CustomEvent("totara_competency/pathway:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),d.events(),c(d),M.util.js_pending("pathwayPerformRating"),d.initData().then(function(){M.util.js_complete("pathwayPerformRating")})["catch"](function(){})})};return{init:b}});
define('contentmarketplace_goone/form_element_listeditor', ["jquery","totara_form/form"],function(a,b){function c(a,d,e,f){return this instanceof c?(b.Element.apply(this,arguments),this.container=null,this.inputs=null,void(this.validationerroradded=!1)):new c(a,d,e,f)}return c.prototype=Object.create(b.Element.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object ListeditorElement]"},c.prototype.init=function(b){var c=this.id,d=a("#"+c),e=a("#"+c+" li");e.find("a").on("click",a.proxy(this.removeItem,this)),1===e.length&&a("a",d).hide(),this.container=d,b()},c.prototype.getValue=function(){return this.container.find("input").map(function(){return a(this).val()}).get()},c.prototype.showLoading=function(){this.container.find(".tf_update_pending .tf_loading").show()},c.prototype.hideLoading=function(){this.container.find(".tf_loading").hide()},c.prototype.removeItem=function(b){b.preventDefault();var c=a(b.target).closest("li");c.addClass("tf_update_pending"),c.find("input").remove(),this.changed()},c});
define('contentmarketplace_goone/oauth', ["jquery"],function(a){var b={};return b.init=function(b){var c=a(b),d=c.data("oauthauthorizeurl");c.on("click",function(a){a.preventDefault();var b=500,c=700,e=window.screenLeft?window.screenLeft:window.screenX,f=window.screenTop?window.screenTop:window.screenY,g=e+window.innerWidth/2-b/2,h=f+window.innerHeight/2-c/2,i=window.open(d,"setup","height="+c+", width="+b+", top="+h+", left="+g);window.focus&&i.focus()})},b});
define('criteria_childcompetency/childcompetency', ["core/ajax","core/notification","totara_competency/loader_manager"],function(a,b,c){function d(){return this instanceof d?(this.widget="",this.competencyKey="competency_id",this.criterionKey="",this.loader=null,this.criterion={type:"childcompetency",metadata:[],aggregation:{method:1,reqitems:1},singleuse:!1,expandable:!0},void(this.domClasses={hidden:"tw-editAchievementPaths--hidden"})):new d}d.prototype={events:function(){var a=this;this.widget.addEventListener("change",function(b){if(b.target)if(b.target.closest("[data-tw-criterionChildCompetency-aggregationMethod-changed]")){b.preventDefault();var c=b.target.closest("[data-tw-criterionChildCompetency-aggregationMethod-changed]").value;a.criterion.aggregation.method!==c&&(a.setAggregationMethod(c),a.triggerEvent("update",{criterion:a.criterion}),a.triggerEvent("dirty",{}))}else if(b.target.closest("[data-tw-criterionChildCompetency-aggregationCount-changed]")){b.preventDefault();var d=b.target.closest("[data-tw-criterionChildCompetency-aggregationCount-changed]").value;a.criterion.aggregation.reqitems!=d&&(a.setAggregationCount(d),a.triggerEvent("update",{criterion:a.criterion}),a.triggerEvent("dirty",{}))}})},setParent:function(a){this.widget=a},getDetail:function(){var a=this,b=this.widget.closest("[data-tw-editScaleValuePaths-criterion-key]"),c=b.querySelector("[data-tw-criterionChildCompetency-aggregation]"),d=document.querySelector("[data-tw-editAchievementPaths-competency]");return new Promise(function(e){if(b&&(a.criterionKey=b.hasAttribute("data-tw-editScaleValuePaths-criterion-key")?b.getAttribute("data-tw-editScaleValuePaths-criterion-key"):0,a.criterion.id=b.hasAttribute("data-tw-editScaleValuePaths-criterion-id")?b.getAttribute("data-tw-editScaleValuePaths-criterion-id"):0),d){var f=d.getAttribute("data-tw-editAchievementPaths-competency")?d.getAttribute("data-tw-editAchievementPaths-competency"):1;a.criterion.metadata=[{metakey:a.competencyKey,metavalue:f}]}c&&(a.criterion.aggregation.method=c.getAttribute("data-tw-criterionChildCompetency-aggregation"),a.criterion.aggregation.reqitems=c.hasAttribute("data-tw-criterionChildCompetency-aggregation-reqitems")?c.getAttribute("data-tw-criterionChildCompetency-aggregation-reqitems"):1),a.setAggregationMethod(a.criterion.aggregation.method),a.setAggregationCount(a.criterion.aggregation.reqitems),a.triggerEvent("update",{criterion:a.criterion}),e()})},setAggregationMethod:function(a){var b=this.widget.querySelector('[data-tw-criterionChildCompetency-aggregationMethod="'+a+'"]'),c=b.querySelector("[data-tw-criterionChildCompetency-aggregationMethod-changed]"),d=this.widget.querySelector("[data-tw-criterionChildCompetency-aggregationCount-changed]"),e=b.querySelector("[data-tw-criterionChildCompetency-aggregationCount-changed]");this.criterion.aggregation.method=a,c&&(c.checked=!0),d&&(d.disabled=!e),this.hideAggregationCountInfo()},setAggregationCount:function(a){var b=this.widget.querySelector("[data-tw-criterionChildCompetency-aggregationCount-changed]"),c=parseInt(a)||0;this.criterion.aggregation.reqitems=c<1?1:c,b&&(b.value=this.criterion.aggregation.reqitems),c<1?this.showAggregationCountInfo():this.hideAggregationCountInfo()},showAggregationCountInfo:function(){var a=this.widget.querySelector('[data-tw-criterionChildCompetency-info="aggregation-count"]');a&&a.classList.remove(this.domClasses.hidden)},hideAggregationCountInfo:function(){var a=this.widget.querySelector('[data-tw-criterionChildCompetency-info="aggregation-count"]');a&&a.classList.add(this.domClasses.hidden)},triggerEvent:function(a,b){b.key=this.criterionKey;var c=new CustomEvent("totara_criteria/criterion:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)}};var e=function(a){return new Promise(function(b){var e=new d;e.setParent(a),e.events(),e.loader=c.init(a),e.loader.show(),b(e),M.util.js_pending("criterionChildCompetency"),e.getDetail().then(function(){e.loader.hide(),M.util.js_complete("criterionChildCompetency")})["catch"](function(){})})};return{init:e}});
define('criteria_coursecompletion/coursecompletion', ["core/templates","core/notification","core/ajax","totara_competency/modal_list","totara_competency/loader_manager"],function(a,b,c,d,e){function f(){return this instanceof f?(this.widget="",this.loader=null,this.criterion={id:0,type:"coursecompletion",itemids:[],aggregation:{method:1,reqitems:1},singleuse:!1,expandable:!0},this.criterionKey="",this.courseAdder=null,this.endpoints={detail:"criteria_coursecompletion_get_detail",courses:"totara_competency_get_courses",courseCategories:"totara_competency_get_categories"},this.domClasses={hidden:"tw-editAchievementPaths--hidden"},void(this.filename="coursecompletion.js")):new f}f.prototype={events:function(){var a=this;this.widget.addEventListener("click",function(b){if(b.target)if(b.target.closest("[data-tw-criterionCourseCompletion-addCourses]"))b.preventDefault(),a.addCourses();else if(b.target.closest("[data-tw-course-item-remove]")){b.preventDefault();var c,d=b.target.closest("[data-tw-course-item-value]");if(!d)return;c=d.getAttribute("data-tw-course-item-value"),a.removeCourse(c)}}),this.widget.addEventListener("change",function(b){if(b.target)if(b.target.closest("[data-tw-criterionCourseCompletion-aggregationMethod-changed]")){b.preventDefault();var c=b.target.closest("[data-tw-criterionCourseCompletion-aggregationMethod-changed]").value;a.criterion.aggregation.method!=c&&(a.setAggregationMethod(c),a.triggerEvent("update",{criterion:a.criterion}),a.triggerEvent("dirty",{}))}else if(b.target.closest("[data-tw-criterionCourseCompletion-aggregationCount-changed]")){b.preventDefault();var d=b.target.closest("[data-tw-criterionCourseCompletion-aggregationCount-changed]").value;a.criterion.aggregation.reqitems!=d&&(a.setAggregationCount(d),a.triggerEvent("update",{criterion:a.criterion}),a.triggerEvent("dirty",{}))}})},setParent:function(a){this.widget=a},getDetail:function(a){var b=this,c=a.closest("[data-tw-editScaleValuePaths-criterion-key]"),d=c.querySelector("[data-tw-criterionCourseCompletion-aggregation]");return new Promise(function(e){c&&(b.criterionKey=c.hasAttribute("data-tw-editScaleValuePaths-criterion-key")?c.getAttribute("data-tw-editScaleValuePaths-criterion-key"):"",b.criterion.id=c.hasAttribute("data-tw-editScaleValuePaths-criterion-id")?c.getAttribute("data-tw-editScaleValuePaths-criterion-id"):0),d&&(b.criterion.aggregation.method=d.getAttribute("data-tw-criterionCourseCompletion-aggregation"),b.criterion.aggregation.reqitems=d.hasAttribute("data-tw-criterionCourseCompletion-aggregation-reqitems")?d.getAttribute("data-tw-criterionCourseCompletion-aggregation-reqitems"):1),b.setAggregationMethod(b.criterion.aggregation.method),b.setAggregationCount(b.criterion.aggregation.reqitems),b.setCourses(a),b.showHideNotEnoughCourses(),Promise.all([b.initCourseAdder()]).then(function(){b.triggerEvent("update",{criterion:b.criterion}),e()})["catch"](function(){})})},setAggregationMethod:function(a){var b=this.widget.querySelector('[data-tw-criterionCourseCompletion-aggregationMethod="'+a+'"]'),c=b.querySelector("[data-tw-criterionCourseCompletion-aggregationMethod-changed]"),d=this.widget.querySelector("[data-tw-criterionCourseCompletion-aggregationCount-changed]"),e=b.querySelector("[data-tw-criterionCourseCompletion-aggregationCount-changed]");this.criterion.aggregation.method=a,c&&(c.checked=!0),d&&(d.disabled=!e),this.showHideNotEnoughCourses(),this.hideAggregationCountInfo()},setAggregationCount:function(a){var b=this.widget.querySelector("[data-tw-criterionCourseCompletion-aggregationCount-changed]"),c=parseInt(a)||0;this.criterion.aggregation.reqitems=c<1?1:c,b&&(b.value=this.criterion.aggregation.reqitems),this.showHideNotEnoughCourses(),c<1?this.showAggregationCountInfo():this.hideAggregationCountInfo()},setCourses:function(a){var b,c=a.querySelectorAll("[data-tw-course-item-value]");this.criterion.itemids=[];for(var d=0;d<c.length;d++)b=parseInt(c[d].getAttribute("data-tw-course-item-value")?c[d].getAttribute("data-tw-course-item-value"):0),b&&this.criterion.itemids.push(b)},initCourseAdder:function(){var a=this;return new Promise(function(c){var e={key:"courseAdder_"+a.criterionKey,title:[{key:"select_courses",component:"criteria_coursecompletion"}],list:{map:{cols:[{dataPath:"fullname",headerString:{key:"select_courses",component:"totara_competency"}}]},service:a.endpoints.courses},primaryDropDown:{filterKey:"category",serviceLabelKey:"fullname",placeholderString:[{component:"totara_competency",key:"all_categories"}],service:a.endpoints.courseCategories,serviceArgs:{}},primarySearch:{filterKey:"name",placeholderString:[{component:"totara_competency",key:"search_courses"}]},onSaved:function(b,c,d){a.updateCourses(d)}};d.adder(e).then(function(b){a.courseAdder=b,c(b)})["catch"](function(c){b.exception({fileName:a.filename,message:c[0]+" modal: "+c[1],name:"Error loading modal list adder"})})})},addCourses:function(){var a=this;this.courseAdder?this.courseAdder.show(this.criterion.itemids):this.initCourseAdder().then(function(){a.courseAdder.show(a.criterion.itemids)})["catch"](function(c){c.fileName=a.filename,c.name="Error initialsing the course adder",b.exception(c)})},updateCourses:function(c){for(var d,e,f,g=this,h=g.widget.querySelector("[data-tw-criterionCourseCompletion-courses]"),i=[],j={},k=0;k<c.length;k++)d=c[k].id,e=c[k].fullname,f=this.criterion.itemids.indexOf(d),f<0&&(this.criterion.itemids.push(d),j={type:"course",value:d,text:e},i.push(a.renderAppend("totara_criteria/partial_item",j,h)));i.length>0&&Promise.all(i).then(function(){g.showHideNotEnoughCourses(),g.triggerEvent("update",{criterion:g.criterion}),g.triggerEvent("dirty",{})})["catch"](function(a){a.fileName=g.filename,a.name="Showing courses",b.exception(a)})},removeCourse:function(a){a=parseInt(a);var b=this,c=b.widget.querySelector('[data-tw-course-item-value="'+a+'"]'),d=this.criterion.itemids.indexOf(a);d>=0&&(this.criterion.itemids.splice(d,1),c&&c.remove()),b.showHideNotEnoughCourses(),b.triggerEvent("update",{criterion:b.criterion}),b.triggerEvent("dirty",{})},showHideNotEnoughCourses:function(){var a=this.widget.querySelector('[data-tw-criterionCourseCompletion-error="nocourses"]'),b=this.widget.querySelector('[data-tw-criterionCourseCompletion-error="notenoughcourses"]');a&&b&&(this.criterion.itemids.length>0?(a.classList.add(this.domClasses.hidden),1==this.criterion.aggregation.method?b.classList.add(this.domClasses.hidden):this.criterion.aggregation.reqitems>this.criterion.itemids.length?b.classList.remove(this.domClasses.hidden):b.classList.add(this.domClasses.hidden)):(a.classList.remove(this.domClasses.hidden),b.classList.add(this.domClasses.hidden)))},showAggregationCountInfo:function(){var a=this.widget.querySelector('[data-tw-criterionCourseCompletion-info="aggregation-count"]');a&&a.classList.remove(this.domClasses.hidden)},hideAggregationCountInfo:function(){var a=this.widget.querySelector('[data-tw-criterionCourseCompletion-info="aggregation-count"]');a&&a.classList.add(this.domClasses.hidden)},triggerEvent:function(a,b){b.key=this.criterionKey;var c=new CustomEvent("totara_criteria/criterion:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)}};var g=function(a){return new Promise(function(b){var c=new f;c.setParent(a),c.events(),c.loader=e.init(a),c.loader.show(),b(c),M.util.js_pending("criterionCourseCompletion"),c.getDetail(a).then(function(){c.loader.hide(),M.util.js_complete("criterionCourseCompletion")})["catch"](function(){})})};return{init:g}});
define('criteria_linkedcourses/linkedcourses', ["core/ajax","core/notification","totara_competency/loader_manager"],function(a,b,c){function d(){return this instanceof d?(this.widget="",this.competencyKey="competency_id",this.criterionKey="",this.loader=null,this.criterion={type:"linkedcourses",metadata:[],aggregation:{method:1,reqitems:1},singleuse:!1,expandable:!0},void(this.domClasses={hidden:"tw-editAchievementPaths--hidden"})):new d}d.prototype={events:function(){var a=this;this.widget.addEventListener("change",function(b){if(b.target)if(b.target.closest("[data-tw-criterionLinkedCourses-aggregationMethod-changed]")){b.preventDefault();var c=b.target.closest("[data-tw-criterionLinkedCourses-aggregationMethod-changed]").value;a.criterion.aggregation.method!==c&&(a.setAggregationMethod(c),a.triggerEvent("update",{criterion:a.criterion}),a.triggerEvent("dirty",{}))}else if(b.target.closest("[data-tw-criterionLinkedCourses-aggregationCount-changed]")){b.preventDefault();var d=b.target.closest("[data-tw-criterionLinkedCourses-aggregationCount-changed]").value;a.criterion.aggregation.reqitems!=d&&(a.setAggregationCount(d),a.triggerEvent("update",{criterion:a.criterion}),a.triggerEvent("dirty",{}))}})},setParent:function(a){this.widget=a},getDetail:function(){var a=this,b=this.widget.closest("[data-tw-editScaleValuePaths-criterion-key]"),c=b.querySelector("[data-tw-criterionLinkedCourses-aggregation]"),d=document.querySelector("[data-tw-editAchievementPaths-competency]");return new Promise(function(e){if(b&&(a.criterionKey=b.hasAttribute("data-tw-editScaleValuePaths-criterion-key")?b.getAttribute("data-tw-editScaleValuePaths-criterion-key"):0,a.criterion.id=b.hasAttribute("data-tw-editScaleValuePaths-criterion-id")?b.getAttribute("data-tw-editScaleValuePaths-criterion-id"):0),d){var f=d.getAttribute("data-tw-editAchievementPaths-competency")?d.getAttribute("data-tw-editAchievementPaths-competency"):1;a.criterion.metadata=[{metakey:a.competencyKey,metavalue:f}]}c&&(a.criterion.aggregation.method=c.getAttribute("data-tw-criterionLinkedCourses-aggregation"),a.criterion.aggregation.reqitems=c.hasAttribute("data-tw-criterionLinkedCourses-aggregation-reqitems")?c.getAttribute("data-tw-criterionLinkedCourses-aggregation-reqitems"):1),a.setAggregationMethod(a.criterion.aggregation.method),a.setAggregationCount(a.criterion.aggregation.reqitems),a.triggerEvent("update",{criterion:a.criterion}),e()})},setAggregationMethod:function(a){var b=this.widget.querySelector('[data-tw-criterionLinkedCourses-aggregationMethod="'+a+'"]'),c=b.querySelector("[data-tw-criterionLinkedCourses-aggregationMethod-changed]"),d=this.widget.querySelector("[data-tw-criterionLinkedCourses-aggregationCount-changed]"),e=b.querySelector("[data-tw-criterionLinkedCourses-aggregationCount-changed]");this.criterion.aggregation.method=a,c&&(c.checked=!0),d&&(d.disabled=!e),this.hideAggregationCountInfo()},setAggregationCount:function(a){var b=this.widget.querySelector("[data-tw-criterionLinkedCourses-aggregationCount-changed]"),c=parseInt(a)||0;this.criterion.aggregation.reqitems=c<1?1:c,b&&(b.value=this.criterion.aggregation.reqitems),c<1?this.showAggregationCountInfo():this.hideAggregationCountInfo()},showAggregationCountInfo:function(){var a=this.widget.querySelector('[data-tw-criterionLinkedCourses-info="aggregation-count"]');a&&a.classList.remove(this.domClasses.hidden)},hideAggregationCountInfo:function(){var a=this.widget.querySelector('[data-tw-criterionLinkedCourses-info="aggregation-count"]');a&&a.classList.add(this.domClasses.hidden)},triggerEvent:function(a,b){b.key=this.criterionKey;var c=new CustomEvent("totara_criteria/criterion:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)}};var e=function(a){return new Promise(function(b){var e=new d;e.setParent(a),e.events(),e.loader=c.init(a),e.loader.show(),b(e),M.util.js_pending("criterionLinkedCourses"),e.getDetail().then(function(){e.loader.hide(),M.util.js_complete("criterionLinkedCourses")})["catch"](function(){})})};return{init:e}});
define('criteria_onactivate/onactivate', ["totara_competency/loader_manager"],function(a){function b(){return this instanceof b?(this.widget="",this.competencyKey="competency_id",this.criterionKey="",this.loader=null,void(this.criterion={type:"onactivate",metadata:[],id:0,singleuse:!0,expandable:!1})):new b}b.prototype={setParent:function(a){this.widget=a},getDetail:function(){var a=this,b=this.widget.closest("[data-tw-editScaleValuePaths-criterion-key]"),c=document.querySelector("[data-tw-editAchievementPaths-competency]");return new Promise(function(d){if(b&&(a.criterionKey=b.hasAttribute("data-tw-editScaleValuePaths-criterion-key")?b.getAttribute("data-tw-editScaleValuePaths-criterion-key"):0,a.criterion.id=b.hasAttribute("data-tw-editScaleValuePaths-criterion-id")?b.getAttribute("data-tw-editScaleValuePaths-criterion-id"):0),c){var e=c.getAttribute("data-tw-editAchievementPaths-competency")?c.getAttribute("data-tw-editAchievementPaths-competency"):1;a.criterion.metadata=[{metakey:a.competencyKey,metavalue:e}]}a.triggerEvent("update",{criterion:a.criterion}),d()})},triggerEvent:function(a,b){b.key=this.criterionKey;var c=new CustomEvent("totara_criteria/criterion:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)}};var c=function(c){return new Promise(function(d){var e=new b;e.setParent(c),e.loader=a.init(c),e.loader.show(),d(e),M.util.js_pending("criterionCourseCompletion"),e.getDetail().then(function(){e.loader.hide(),M.util.js_complete("criterionCourseCompletion")})["catch"](function(){})})};return{init:c}});
define('criteria_othercompetency/othercompetency', ["core/templates","core/notification","core/ajax","totara_competency/modal_list","totara_competency/loader_manager","totara_competency/list_framework_hierarchy_events"],function(a,b,c,d,e,f){function g(){return this instanceof g?(this.widget="",this.loader=null,this.criterion={id:0,type:"othercompetency",itemids:[],aggregation:{method:1,reqitems:1},singleuse:!1,expandable:!0},this.criterionKey="",this.competencies=[],this.competencyAdder=null,this.pwCompetencyId=0,this.endpoints={detail:"criteria_othercompetency_get_detail",competencies:"totara_competency_competency_index"},this.domClasses={hidden:"tw-editAchievementPaths--hidden"},void(this.filename="othercompetency.js")):new g}g.prototype={events:function(){var a=this;this.widget.addEventListener("click",function(b){if(b.target)if(b.target.closest("[data-tw-criterionOtherCompetency-addCompetencies]"))b.preventDefault(),a.addCompetencies();else if(b.target.closest("[data-tw-competency-item-remove]")){b.preventDefault();var c,d=b.target.closest("[data-tw-competency-item-value]");if(!d)return;c=d.getAttribute("data-tw-competency-item-value"),a.removeCompetency(c)}}),this.widget.addEventListener("change",function(b){if(b.target)if(b.target.closest("[data-tw-criterionOtherCompetency-aggregationMethod-changed]")){b.preventDefault();var c=b.target.closest("[data-tw-criterionOtherCompetency-aggregationMethod-changed]").value;a.criterion.aggregation.method!=c&&(a.setAggregationMethod(c),a.triggerEvent("update",{criterion:a.criterion}),a.triggerEvent("dirty",{}))}else if(b.target.closest("[data-tw-criterionOtherCompetency-aggregationCount-changed]")){b.preventDefault();var d=b.target.closest("[data-tw-criterionOtherCompetency-aggregationCount-changed]").value;a.criterion.aggregation.reqitems!=d&&(a.setAggregationCount(d),a.triggerEvent("update",{criterion:a.criterion}),a.triggerEvent("dirty",{}))}})},setParent:function(a){this.widget=a},getDetail:function(a){var b=this,c=this.widget.closest("[data-tw-editScaleValuePaths-criterion-key]"),d=c.querySelector("[data-tw-criterionOtherCompetency-aggregation]"),e=document.querySelector("[data-tw-editAchievementPaths-competency]");return new Promise(function(f){e&&(b.pwCompetencyId=e.getAttribute("data-tw-editAchievementPaths-competency")),c&&(b.criterionKey=c.hasAttribute("data-tw-editScaleValuePaths-criterion-key")?c.getAttribute("data-tw-editScaleValuePaths-criterion-key"):"",b.criterion.id=c.hasAttribute("data-tw-editScaleValuePaths-criterion-id")?c.getAttribute("data-tw-editScaleValuePaths-criterion-id"):0),d&&(b.criterion.aggregation.method=d.getAttribute("data-tw-criterionOtherCompetency-aggregation"),b.criterion.aggregation.reqitems=d.hasAttribute("data-tw-criterionOtherCompetency-aggregation-reqitems")?d.getAttribute("data-tw-criterionOtherCompetency-aggregation-reqitems"):1),b.setAggregationMethod(b.criterion.aggregation.method),b.setAggregationCount(b.criterion.aggregation.reqitems),b.setCompetencies(a),b.showHideNotEnoughCompetency(),Promise.all([b.initCompetencyAdder()]).then(function(){b.triggerEvent("update",{criterion:b.criterion}),f()})["catch"](function(){})})},setAggregationMethod:function(a){var b=this.widget.querySelector('[data-tw-criterionOtherCompetency-aggregationMethod="'+a+'"]'),c=b.querySelector("[data-tw-criterionOtherCompetency-aggregationMethod-changed]"),d=this.widget.querySelector("[data-tw-criterionOtherCompetency-aggregationCount-changed]"),e=b.querySelector("[data-tw-criterionOtherCompetency-aggregationCount-changed]");this.criterion.aggregation.method=a,c&&(c.checked=!0),d&&(d.disabled=!e),this.showHideNotEnoughCompetency(),this.hideAggregationCountInfo()},setAggregationCount:function(a){var b=this.widget.querySelector("[data-tw-criterionOtherCompetency-aggregationCount-changed]"),c=parseInt(a)||0;this.criterion.aggregation.reqitems=c<1?1:c,b&&(b.value=this.criterion.aggregation.reqitems),this.showHideNotEnoughCompetency(),c<1?this.showAggregationCountInfo():this.hideAggregationCountInfo()},setCompetencies:function(a){var b,c=a.querySelectorAll("[data-tw-competency-item-value]");this.criterion.itemids=[];for(var d=0;d<c.length;d++)b=parseInt(c[d].getAttribute("data-tw-competency-item-value")?c[d].getAttribute("data-tw-competency-item-value"):0),b&&this.criterion.itemids.push(b)},odlCreateEmptyCriterion:function(){return new Promise(function(a){a({results:{id:0,items:[],aggregation:{method:1,reqitems:1}}})})},initCompetencyAdder:function(){var a=this;return new Promise(function(b,c){a.getCompetencyAdderDate().then(function(e){d.adder(e).then(function(c){a.competencyAdder=c,b(c)})["catch"](function(){c()})})["catch"](function(){c()})})},getCompetencyAdderDate:function(){var a=this;return new Promise(function(b,c){f.init().then(function(c){var d={key:"competencies",crumbtrail:{service:"totara_competency_competency_show",stringList:[{component:"criteria_othercompetency",key:"hierarchy_list_competency_all"},{component:"criteria_othercompetency",key:"hierarchy_list_competency_all_in_framework"}]},events:c,expandable:{args:{include:{crumbs:1}},service:"totara_competency_competency_show",template:"totara_competency/hierarchy_expanded"},levelToggle:!0,list:{map:{cols:[{dataPath:"fullname",expandedViewTrigger:!0,headerString:{component:"criteria_othercompetency",key:"select_competencies"}}],extraRowData:[{key:"framework",dataPath:"frameworkid"}],hasExpandedView:!0,hasHierarchy:!0},service:"totara_competency_competency_index"},onSaved:function(b,c,d){a.updateCompetencies(d)},primaryDropDown:{filterKey:"framework",placeholderString:[{component:"criteria_othercompetency",key:"all_frameworks"}],service:"totara_competency_get_frameworks",serviceArgs:{},serviceLabelKey:"fullname"},primarySearch:{filterKey:"text",placeholderString:[{component:"totara_core",key:"search"}]},title:[{component:"criteria_othercompetency",key:"hierarchy_list_competency_select"}]};b(d)})["catch"](function(){c()})})},addCompetencies:function(){var a=this,c=this.criterion.itemids.slice(0);c.push(a.pwCompetencyId),this.competencyAdder?this.competencyAdder.show(c):this.initCompetencyAdder().then(function(){a.competencyAdder.show(c)})["catch"](function(c){c.fileName=a.filename,c.name="Error initialsing the competency adder",b.exception(c)})},updateCompetencies:function(c){for(var d,e,f,g=this,h=g.widget.querySelector("[data-tw-criterionOtherCompetency-competencies]"),i=[],j={},k=0;k<c.length;k++)d=c[k].id,d!=g.pwCompetencyId&&(e=c[k].fullname,f=this.criterion.itemids.indexOf(d),f<0&&(this.criterion.itemids.push(d),j={type:"competency",value:d,text:e},i.push(a.renderAppend("totara_criteria/partial_item",j,h))));i.length>0&&Promise.all(i).then(function(){g.showHideNotEnoughCompetency(),g.triggerEvent("update",{criterion:g.criterion}),g.triggerEvent("dirty",{})})["catch"](function(a){a.fileName=g.filename,a.name="Showing competencies",b.exception(a)})},removeCompetency:function(a){a=parseInt(a);var b=this,c=b.widget.querySelector('[data-tw-competency-item-value="'+a+'"]'),d=this.criterion.itemids.indexOf(a);d>=0&&(this.criterion.itemids.splice(d,1),c&&c.remove()),b.showHideNotEnoughCompetency(),b.triggerEvent("update",{criterion:b.criterion}),b.triggerEvent("dirty",{})},showHideNotEnoughCompetency:function(){var a=this.widget.querySelector('[data-tw-criterionOtherCompetency-error="noothercompetency"]'),b=this.widget.querySelector('[data-tw-criterionOtherCompetency-error="notenoughothercompetency"]');a&&b&&(this.criterion.itemids.length>0?(a.classList.add(this.domClasses.hidden),1==this.criterion.aggregation.method?b.classList.add(this.domClasses.hidden):this.criterion.aggregation.reqitems>this.criterion.itemids.length?b.classList.remove(this.domClasses.hidden):b.classList.add(this.domClasses.hidden)):(a.classList.remove(this.domClasses.hidden),b.classList.add(this.domClasses.hidden)))},showAggregationCountInfo:function(){var a=this.widget.querySelector('[data-tw-criterionOtherCompetency-info="aggregation-count"]');a&&a.classList.remove(this.domClasses.hidden)},hideAggregationCountInfo:function(){var a=this.widget.querySelector('[data-tw-criterionOtherCompetency-info="aggregation-count"]');a&&a.classList.add(this.domClasses.hidden)},triggerEvent:function(a,b){b.key=this.criterionKey;var c=new CustomEvent("totara_criteria/criterion:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)}};var h=function(a){return new Promise(function(b){var c=new g;c.setParent(a),c.events(),c.loader=e.init(a),c.loader.show(),b(c),M.util.js_pending("criterionOtherCompetency"),c.getDetail(a).then(function(){c.loader.hide(),M.util.js_complete("criterionOtherCompetency")})["catch"](function(){})})};return{init:h}});
define('local_email_log/modal', ["jquery"],function(a){return a.init_dialog_link=function(b){var c=a("body");c.data("dialog_init")||(c.data("dialog_init",!0),c.on("click",".modal-dialogbox-link",function(c){var d=a(this);c.preventDefault();var e=d.data("content"),f=d.data("size"),g=d.data("header"),h={header:g,size:f?f:"medium"};d.data("header")&&(h.header=d.data("header")),e?h.content=e:h.url=d.data("url"),a.showDialog(h,b)}))},a.showDialog=function(b,c,d){function e(a,b){b?(a.find(".modal-header").show(),a.find(".modal-header").children(":not(.close)").remove(),a.find(".modal-header").append('<h4 class="modal-title" id="myModalLabel">'+b+"</h4>")):a.find(".modal-header").hide()}var f=a("#modal_dialog"),g="",h="";c||(c={}),g=c["class"]?c["class"]:"",h=c.outerclass?c.outerclass:"",0===f.length&&(f=a('<div id="modal_dialog" class="kineomodal modal fade" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true"><div id="innermodal" class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="myModalLabel">Modal title</h4></div><div class="modal-body"></div></div></div><div class="modal-backdrop fade in"></div></div>'),f.on("click",function(b){(a(b.target).is("#innermodal",".modal-backdrop")||a(b.target.parentNode).is(":button",".close"))&&(f.hide(),a("body").removeClass("modal-open"))}),a("body").append(f),f=a("#modal_dialog")),d||(d="center"),"center"===d?(f.css("display","table"),f.removeClass("topmode")):"top"===d&&(f.css("display","block"),f.addClass("topmode")),f.addClass("modal fade "+h),f.find("#innermodal").attr("class","modal-dialog "+g),e(f,!!b.header&&b.header);var i={large:"modal-lg",medium:"modal-md",small:"modal-sm"};b.size&&i[b.size]||(b.size="medium"),f.addClass(i[b.size]),f.find("#innermodal").removeClass("modal-lg modal-md modal-sm").addClass(i[b.size]);var j=.85*a(window).height()-f.find(".modal-header").outerHeight();c.maxheightpercentage&&(j*=c.maxheightpercentage),c.nomaxheight||"center"!==d?f.find(".modal-body").css("max-height",""):f.find(".modal-body").css("max-height",""+j+"px"),c.allowoverflow&&f.find(".modal-body").addClass("allowoverflow");var k={backdrop:!0,keyboard:!0,show:!0};for(var l in k)b[l]&&(k[l]=b[l]);f.addClass("fade in"),a("body").addClass("modal-open"),f.show();var m=f.find(".modal-body");if(b.url){var n='<img src="'+M.util.image_url("i/loading")+'" />';m.addClass("loadingcenter").html(n),a.get(b.url,function(a){m.html(a.content),m.removeClass("loadingcenter"),a.header&&e(f,a.header),b.callback&&b.callback(a,m)})}else b.content?m.html(b.content):b.element&&m.empty().append(b.element)},{init_dialog_link:a.init_dialog_link}});
