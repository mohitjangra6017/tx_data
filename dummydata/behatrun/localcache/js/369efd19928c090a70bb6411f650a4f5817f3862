M.totara_iconpicker=M.totara_iconpicker||{Y:null,config:{},init:function(Y,args){this.Y=Y;if(args){var jargs=Y.JSON.parse(args);for(var a in jargs){if(Y.Object.owns(jargs,a)){this.config[a]=jargs[a]}}}
if(typeof $==='undefined'){throw new Error('M.totara_iconpicker.init()-> jQuery dependency required for this module to function.')}
var btnids=['show-icon-dialog'];if(!$('#show-icon-dialog').length){btnids=[];$('.show-icon-dialog').each(function(indx,btnelem){btnids.push($(btnelem).attr('id'))})}
$(btnids).each(function(idx,btnid){var handler=new totaraDialog_handler_selectable(M.totara_iconpicker.config.selected_icon);var suffix=($('#'+btnid).data('ind')===undefined)?'':$('#'+btnid).data('ind');var buttonsObj={};buttonsObj[M.util.get_string('ok','moodle')]=function(){dialog.close()};buttonsObj[M.util.get_string('cancel','moodle')]=function(){handler._cancel()};var dialog=new totaraDialog('icon-dialog'+suffix,btnid,{buttons:buttonsObj,title:'<h2>'+M.util.get_string('chooseicon','totara_program')+'</h2>'},M.cfg.wwwroot+'/totara/core/icons.php?type='+M.totara_iconpicker.config.type,handler);dialog.suffix=suffix;dialog.base_url=dialog.default_url;dialog.old_open=dialog.open;dialog.open=function(){this.old_open()};dialog.close=function(){var id=$(".ui-selected").attr('id');var source=$(".ui-selected > img").attr('src');var data={'id':id,'src':source};handler._updatePage(data)};totaraDialogs['icon-dialog'+suffix]=dialog;if($("#src"+suffix).length&&$("#src"+suffix).val().length){id=$("#icon"+suffix).val();src=$("#src"+suffix).val();var data={'id':id,'src':src};dialog.handler._updatePage(data)}})}}