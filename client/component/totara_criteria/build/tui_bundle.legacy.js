!function(e){function t(t){for(var n,a,s=t[0],c=t[1],u=t[2],m=0,p=[];m<s.length;m++)a=s[m],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&p.push(r[a][0]),r[a]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);for(l&&l(t);p.length;)p.shift()();return o.push.apply(o,u||[]),i()}function i(){for(var e,t=0;t<o.length;t++){for(var i=o[t],n=!0,s=1;s<i.length;s++){var c=i[s];0!==r[c]&&(n=!1)}n&&(o.splice(t--,1),e=a(a.s=i[0]))}return e}var n={},r={29:0},o=[];function a(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=e,a.c=n,a.d=function(e,t,i){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(i,n,function(t){return e[t]}.bind(null,n));return i},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var s=window.webpackJsonp=window.webpackJsonp||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=c;o.push(["rLaO",0]),i()}({"C+/B":function(e,t){e.exports=tui.require("tui/components/modal/ConfirmationModal")},JThd:function(e,t){e.exports=tui.require("tui/components/icons/CheckSuccess")},KGot:function(e,t){e.exports=tui.require("tui/components/datatable/Cell")},"MQ/M":function(e,t){e.exports=tui.require("totara_competency/components/achievements/ProgressCircle")},RJdj:function(e,t,i){"use strict";t.a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_competency_create_user_assignments"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"user_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"competency_ids"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totara_competency_create_user_assignments"},arguments:[{kind:"Argument",name:{kind:"Name",value:"user_id"},value:{kind:"Variable",name:{kind:"Name",value:"user_id"}}},{kind:"Argument",name:{kind:"Name",value:"competency_ids"},value:{kind:"Variable",name:{kind:"Name",value:"competency_ids"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}]}},Slh4:function(e,t){e.exports=tui.require("tui/components/progress/Progress")},WRMn:function(e,t){},YYZa:function(e,t,i){var n={"./achievements/CompetencyAchievementDisplay":"cF5s","./achievements/CompetencyAchievementDisplay.vue":"cF5s","./achievements/CourseAchievementDisplay":"kirD","./achievements/CourseAchievementDisplay.vue":"kirD"};function r(e){var t=o(e);return i(t)}function o(e){if(!i.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}r.keys=function(){return Object.keys(n)},r.resolve=o,e.exports=r,r.id="YYZa"},Zoit:function(e,t){e.exports=tui.require("totara_competency/components/achievements/AchievementLayout")},cF5s:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-criteriaCompetencyAchievement"},[i("AchievementLayout",{scopedSlots:e._u([{key:"left",fn:function(){return[i("div",{staticClass:"tui-criteriaCompetencyAchievement__goal"},[i("h5",{staticClass:"tui-criteriaCompetencyAchievement__title"},[e._v("\n          "+e._s(e.criteriaHeading)+"\n        ")]),e._v(" "),i("ProgressCircle",{attrs:{complete:e.criteriaComplete,completed:e.criteriaComplete?e.numberOfRequiredCompetencies:e.achievedCompetencies,target:e.numberOfRequiredCompetencies}})],1)]},proxy:!0},{key:"right",fn:function(){return[i("Table",{attrs:{data:e.achievements.items,"expandable-rows":!0,"no-items-text":e.noCompetenciesString},scopedSlots:e._u([{key:"row",fn:function(t){var n=t.row,r=t.expand,o=t.expandState;return[i("ExpandCell",{attrs:{size:"1","expand-state":o},on:{click:function(e){return r()}}}),e._v(" "),i("Cell",{attrs:{size:"9","column-header":e.$str("competencies","totara_criteria")}},[e._v("\n            "+e._s(n.competency.fullname)+"\n          ")]),e._v(" "),i("Cell",{class:"tui-criteriaCompetencyAchievement__level",attrs:{size:"3","column-header":e.$str("achievement_level","totara_criteria")}},[n.value?[e._v("\n              "+e._s(n.value.name)+"\n            ")]:[i("span",{staticClass:"tui-criteriaCompetencyAchievement__level-notAvailable"},[e._v("\n                "+e._s(e.$str("not_available","totara_criteria"))+"\n              ")])]],2),e._v(" "),i("Cell",{attrs:{size:"3","column-header":e.$str("completion","totara_criteria"),align:"end"}},[n.value&&n.value.proficient?i("div",{staticClass:"tui-criteriaCompetencyAchievement__completion-complete"},[i("CheckIcon",{attrs:{size:"200"}}),e._v("\n              "+e._s(e.$str("complete","totara_criteria"))+"\n            ")],1):i("div",{staticClass:"tui-criteriaCompetencyAchievement__completion-notComplete"},[e._v("\n              "+e._s(e.$str("not_complete","totara_criteria"))+"\n            ")])])]}},{key:"expand-content",fn:function(t){var n=t.row;return[i("div",{staticClass:"tui-criteriaCompetencyAchievement__summary"},[i("h6",{staticClass:"tui-criteriaCompetencyAchievement__summary-header"},[e._v("\n              "+e._s(n.competency.fullname)+"\n            ")]),e._v(" "),i("div",{staticClass:"tui-criteriaCompetencyAchievement__summary-body",domProps:{innerHTML:e._s(n.competency.description)}}),e._v(" "),n.assigned?i("ActionLink",{class:"tui-criteriaCompetencyAchievement__summary-button",attrs:{href:e.$url("/totara/competency/profile/details/index.php",{competency_id:n.competency.id,user_id:e.userId}),text:e.$str("view_competency","totara_criteria"),styleclass:{primary:!0,small:!0}}}):n.self_assignable?i("div",[i("Button",{class:"tui-criteriaCompetencyAchievement__summary-button",attrs:{text:e.$str(e.achievements.current_user?"self_assign_competency":"assign_competency","totara_criteria"),styleclass:{primary:!0,small:!0}},on:{click:function(t){return e.showModal(n.competency)}}})],1):e._e()],1),e._v(" "),i("ConfirmationModal",{attrs:{open:e.modalOpen,title:e.$str("confirm_assign_competency_title","totara_criteria")},on:{confirm:function(t){return e.assignCompetency(n.competency)},cancel:e.closeModal}},[e._v("\n            "+e._s(e.$str(e.achievements.current_user?"confirm_assign_competency_body_by_self":"confirm_assign_competency_body_by_other","totara_criteria",n.competency.fullname))+"\n          ")])]}}])})]},proxy:!0}])})],1)};n._withStripped=!0;var r=i("Zoit"),o=i.n(r),a=i("fCWf"),s=i.n(a),c=i("vF5l"),u=i.n(c),l=i("KGot"),m=i.n(l),p=i("JThd"),_=i.n(p),d=i("C+/B"),f=i.n(d),v=i("rsf9"),h=i.n(v),y=i("MQ/M"),C=i.n(y),g=i("yikf"),b=i.n(g),k=i("vyVp"),x=i("RJdj"),A={components:{AchievementLayout:o.a,ActionLink:s.a,Button:u.a,Cell:m.a,CheckIcon:_.a,ConfirmationModal:f.a,ExpandCell:h.a,ProgressCircle:C.a,Table:b.a},props:{achievements:{required:!0,type:Object},type:{required:!0,type:String},userId:{required:!0,type:Number}},data:function(){return{modalOpen:!1}},computed:{achievedCompetencies:function(){return this.achievements.items.reduce((function(e,t){return t.value&&t.value.proficient?e+=1:e}),0)},criteriaComplete:function(){return this.achievedCompetencies>=this.numberOfRequiredCompetencies},criteriaHeading:function(){return"otherCompetency"===this.type?this.$str("achieve_proficiency_in_other_competencies","totara_criteria"):this.$str("achieve_proficiency_in_child_competencies","totara_criteria")},noCompetenciesString:function(){return"otherCompetency"===this.type?this.$str("no_competencies","criteria_othercompetency"):this.$str("no_competencies","criteria_childcompetency")},numberOfRequiredCompetencies:function(){return 1===this.achievements.aggregation_method?this.achievements.items.length:this.achievements.required_items}},methods:{assignCompetency:function(e){var t=this;this.$apollo.mutate({mutation:x.a,variables:{competency_ids:[e.id],user_id:this.userId}}).then((function(e){var i=e.data;i&&i.totara_competency_create_user_assignments&&(i.totara_competency_create_user_assignments.length>0?t.$emit("self-assigned"):t.triggerErrorNotification(t.$str("error_competency_assignment","totara_criteria")))})).catch((function(e){console.error(e),t.triggerErrorNotification(t.$str("error_competency_assignment","totara_criteria"))})).finally((function(){return t.closeModal()}))},triggerErrorNotification:function(e){Object(k.notify)({message:e,type:"error"})},showModal:function(){this.modalOpen=!0},closeModal:function(){this.modalOpen=!1}}},O=(i("WRMn"),i("KHd+")),N=function(e){e.options.__langStrings={criteria_childcompetency:["no_competencies"],criteria_othercompetency:["no_competencies"],totara_criteria:["achieve_proficiency_in_child_competencies","achieve_proficiency_in_other_competencies","assign_competency","competencies","complete","completion","confirm_assign_competency_body_by_other","confirm_assign_competency_body_by_self","confirm_assign_competency_title","error_competency_assignment","network_error","not_available","not_complete","achievement_level","self_assign_competency","view_competency"]}},$=Object(O.a)(A,n,[],!1,null,null,null);"function"==typeof N&&N($),$.options.__hasBlocks={script:!0,template:!0},$.options.__file="client/component/totara_criteria/src/components/achievements/CompetencyAchievementDisplay.vue";t.default=$.exports},fCWf:function(e,t){e.exports=tui.require("tui/components/links/ActionLink")},kirD:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-criteriaCourseAchievement"},[i("AchievementLayout",{scopedSlots:e._u([{key:"left",fn:function(){return[i("div",{staticClass:"tui-criteriaCourseAchievement__goal"},[i("h4",{staticClass:"tui-criteriaCourseAchievement__title"},[e._v("\n          "+e._s(e.$str("complete_courses","totara_criteria"))+"\n        ")]),e._v(" "),i("ProgressCircle",{attrs:{complete:e.criteriaFulfilled,completed:e.completedNumberOfCourses>=e.targetNumberOfCourses?e.targetNumberOfCourses:e.completedNumberOfCourses,target:e.targetNumberOfCourses}})],1)]},proxy:!0},{key:"right",fn:function(){return[i("Table",{attrs:{data:e.achievements.items,"expandable-rows":!0,"no-items-text":e.$str("no_courses","totara_criteria")},scopedSlots:e._u([{key:"row",fn:function(t){var n=t.row,r=t.expand,o=t.expandState;return[i("ExpandCell",{attrs:{"expand-state":o},on:{click:function(e){return r()}}}),e._v(" "),i("Cell",{attrs:{size:"9","column-header":e.$str("courses","totara_criteria")}},[e._v("\n            "+e._s(e.getCourseName(n))+"\n          ")]),e._v(" "),i("Cell",{class:"tui-criteriaCourseAchievement__progress",attrs:{size:"3","column-header":e.$str("progress","totara_criteria")}},[e.hasProgress(n)?i("div",{staticClass:"tui-criteriaCourseAchievement__progress-bar"},[i("Progress",{attrs:{value:n.course.progress}})],1):i("div",{staticClass:"tui-criteriaCourseAchievement__progress-empty"},[e._v("\n              "+e._s(e.$str("not_available","totara_criteria"))+"\n            ")])]),e._v(" "),i("Cell",{attrs:{size:"3","column-header":e.$str("completion","totara_criteria"),align:"end"}},[e.isComplete(n)?i("div",{staticClass:"tui-criteriaCourseAchievement__completion-complete"},[i("CheckIcon",{attrs:{size:"200"}}),e._v("\n              "+e._s(e.$str("complete","totara_criteria"))+"\n            ")],1):i("div",{staticClass:"tui-criteriaCourseAchievement__completion-notComplete"},[e._v("\n              "+e._s(e.$str("not_complete","totara_criteria"))+"\n            ")])])]}},{key:"expand-content",fn:function(t){var n=t.row;return[i("div",{staticClass:"tui-criteriaCourseAchievement__summary"},[i("h6",{staticClass:"tui-criteriaCourseAchievement__summary-header"},[e._v("\n              "+e._s(n.course.fullname)+"\n            ")]),e._v(" "),i("div",{staticClass:"tui-criteriaCourseAchievement__summary-body",domProps:{innerHTML:e._s(n.course.description)}}),e._v(" "),i("ActionLink",{class:"tui-criteriaCourseAchievement__summary-button",attrs:{href:n.course.url_view,text:e.$str("course_link","totara_criteria"),styleclass:{primary:!0,small:!0}}})],1)]}}])})]},proxy:!0}])})],1)};n._withStripped=!0;var r=i("Zoit"),o=i.n(r),a=i("fCWf"),s=i.n(a),c=i("KGot"),u=i.n(c),l=i("JThd"),m=i.n(l),p=i("rsf9"),_=i.n(p),d=i("Slh4"),f=i.n(d),v=i("MQ/M"),h=i.n(v),y=i("yikf"),C=i.n(y),g={components:{AchievementLayout:o.a,ActionLink:s.a,Cell:u.a,CheckIcon:m.a,ExpandCell:_.a,Progress:f.a,ProgressCircle:h.a,Table:C.a},props:{achievements:{required:!0,type:Object}},computed:{criteriaFulfilled:function(){return this.completedNumberOfCourses>=this.targetNumberOfCourses},numberOfCourses:function(){return this.achievements.items?this.achievements.items.length:0},completedNumberOfCourses:function(){var e=0;return this.numberOfCourses?(this.achievements.items.forEach((function(t){t.course&&100===t.course.progress&&e++})),e):e},targetNumberOfCourses:function(){return 1===this.achievements.aggregation_method?this.numberOfCourses:this.achievements.required_items}},methods:{getCourseName:function(e){return e.course?e.course.fullname:this.$str("hidden_course","totara_criteria")},hasProgress:function(e){return e.course&&e.course.progress>0},isComplete:function(e){return e.course&&100===e.course.progress}}},b=(i("rGmZ"),i("KHd+")),k=function(e){e.options.__langStrings={totara_criteria:["complete","completion","complete_courses","course_link","courses","hidden_course","no_courses","not_available","not_complete","progress"]}},x=Object(b.a)(g,n,[],!1,null,null,null);"function"==typeof k&&k(x),x.options.__hasBlocks={script:!0,template:!0},x.options.__file="client/component/totara_criteria/src/components/achievements/CourseAchievementDisplay.vue";t.default=x.exports},rGmZ:function(e,t){},rLaO:function(e,t,i){!function(){"use strict";"undefined"!=typeof tui&&tui._bundle.isLoaded("totara_criteria")?console.warn('[tui bundle] The bundle "totara_criteria" is already loaded, skipping initialisation.'):(tui._bundle.register("totara_criteria"),tui._bundle.addModulesFromContext("totara_criteria/components",i("YYZa")))}()},rsf9:function(e,t){e.exports=tui.require("tui/components/datatable/ExpandCell")},vF5l:function(e,t){e.exports=tui.require("tui/components/buttons/Button")},vyVp:function(e,t){e.exports=tui.require("tui/notifications")},yikf:function(e,t){e.exports=tui.require("tui/components/datatable/Table")}});