!function(e){var t={};function i(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s="WPr+")}({"+WuH":function(e,t,i){"use strict";i.r(t);var n=i("WBvU"),a=i("JXQf"),s=i.n(a),r=i("8km3"),l=i.n(r),d={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"performelement_redisplay_source_activities"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_activities"},arguments:[{kind:"Argument",name:{kind:"Name",value:"query_options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"sort_by"},value:{kind:"StringValue",value:"name",block:!1}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"state_details"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"display_name"},arguments:[],directives:[]}]}}]}}]}}]},o={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"performelement_redisplay_source_activity_question_elements"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"source_activity_question_elements_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"performelement_redisplay_source_activity_question_elements"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sections"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"title"},name:{kind:"Name",value:"display_title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"respondable_section_elements"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"element"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"element_plugin"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"plugin_name"},arguments:[],directives:[]}]}}]}}]}}]}}]}}]}}]},m={components:{FormRow:n.FormRow,FormSelect:n.FormSelect,Loader:s.a,PerformAdminCustomElementEdit:l.a},inheritAttrs:!1,props:{identifier:String,isRequired:Boolean,rawData:Object,rawTitle:String,settings:Object,data:Object,currentActivityId:Number},data(){return{initialValues:{activityId:this.rawData.activityId||null,sourceSectionElementId:this.rawData.sourceSectionElementId||null,identifier:this.identifier,rawTitle:this.rawTitle,responseRequired:this.isRequired},activities:[],selectedActivityElementOptions:[],selectedActivityId:this.rawData.activityId||null,loadingSectionElements:!1}},computed:{activityOptions(){let e={id:null,label:this.$str("select_activity","performelement_redisplay")},t=this.activities.map(e=>({id:e.id,label:this.getActivityStatusLabel(e)}));return t.unshift(e),t}},apollo:{activities:{query:d,update:e=>e.mod_perform_activities}},mounted(){this.rawData.activityId&&this.fetchSourceSectionElements(this.rawData.activityId)},methods:{updateOptionValues(e){if(e.activityId!==this.selectedActivityId){if(!e||!e.activityId)return this.selectedActivityId=null,void(this.selectedActivityElementOptions=[]);this.selectedActivityId=e.activityId,this.resetQuestionElementFormValue(),this.fetchSourceSectionElements(e.activityId)}},fetchSourceSectionElements(e){this.loadingSectionElements=!0,this.$apollo.query({query:o,variables:{input:{activity_id:e}},fetchPolicy:"network-only"}).then(e=>{this.processSectionElements(e),this.loadingSectionElements=!1})},processSectionElements(e){let t,i=e.data.performelement_redisplay_source_activity_question_elements.sections;if(0===i.length)return void(this.selectedActivityElementOptions=[{id:null,label:this.$str("no_available_questions","performelement_redisplay")}]);t=i.length>1?i.map(e=>({label:e.title,options:this.filterLinkedReview(e.respondable_section_elements).map(e=>({id:e.id,label:this.getElementLabel(e.element)}))})):this.filterLinkedReview(i[0].respondable_section_elements).map(e=>({id:e.id,label:this.getElementLabel(e.element)}));let n={id:null,label:this.$str("select_question_element","performelement_redisplay")};t.unshift(n),this.selectedActivityElementOptions=t},filterLinkedReview:e=>e.filter(e=>"linked_review"!==e.element.element_plugin.plugin_name),getActivityStatusLabel(e){let t=e.state_details.display_name;return this.currentActivityId===parseInt(e.id)&&(t=this.$str("current_activity","performelement_redisplay")),this.$str("activity_name_with_status","performelement_redisplay",{activity_name:e.name,activity_status:t})},getElementLabel(e){return this.$str("source_element_option","performelement_redisplay",{element_title:e.title,element_plugin_name:e.element_plugin.name})},resetQuestionElementFormValue(){this.$refs.redisplayUniform.update("sourceSectionElementId",null)},saveRedisplayElement(e){delete e.data.activityId,this.$emit("update",e)}}},u=(i("loeb"),i("KHd+")),c=function(e){e.options.__langStrings={performelement_redisplay:["activity_name_with_status","current_activity","no_available_questions","select_activity","select_question_element","source_activity_value","source_activity_value_help","source_element_option","source_question_element_value","source_question_element_value_help"]}},p=Object(u.a)(m,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-redisplayAdminEdit"},[i("PerformAdminCustomElementEdit",{ref:"redisplayUniform",attrs:{"initial-values":e.initialValues,settings:e.settings,"validation-mode":"auto"},on:{change:e.updateOptionValues,cancel:function(t){return e.$emit("display")},update:e.saveRedisplayElement}},[i("FormRow",{attrs:{label:e.$str("source_activity_value","performelement_redisplay"),helpmsg:e.$str("source_activity_value_help","performelement_redisplay"),required:!0},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.labelId;return[i("Loader",{staticClass:"tui-redisplayAdminEdit__loader tui-redisplayAdminEdit__loader--charLength-25",attrs:{loading:e.$apollo.queries.activities.loading}},[i("FormSelect",{attrs:{"aria-labelledby":n,options:e.activityOptions,disabled:e.$apollo.queries.activities.loading,name:"activityId","char-length":"25",validations:function(e){return[e.required()]}}})],1)]}}])}),e._v(" "),e.selectedActivityId?i("FormRow",{attrs:{label:e.$str("source_question_element_value","performelement_redisplay"),helpmsg:e.$str("source_question_element_value_help","performelement_redisplay"),required:!0},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.labelId;return[i("Loader",{staticClass:"tui-redisplayAdminEdit__loader tui-redisplayAdminEdit__loader--charLength-25",attrs:{loading:e.$apollo.loading||e.loadingSectionElements}},[e.selectedActivityElementOptions?i("FormSelect",{attrs:{"aria-labelledby":n,name:"sourceSectionElementId","char-length":"25",disabled:e.$apollo.loading,options:e.selectedActivityElementOptions,validations:function(e){return[e.required()]}}}):e._e()],1)]}}],null,!1,2691299484)}):e._e()],1)],1)}),[],!1,null,null,null);"function"==typeof c&&c(p),p.options.__hasBlocks={script:!0,template:!0};t.default=p.exports},"2ENX":function(e,t,i){"use strict";i.r(t);var n=i("jJ8l"),a=i.n(n),s=i("hQxJ"),r=i.n(s),l={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"performelement_redisplay_subject_instance_previous_responses"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"subject_instance_previous_responses_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"redisplayData"},name:{kind:"Name",value:"performelement_redisplay_subject_instance_previous_responses"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_anonymous"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"your_response"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"response_data"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"response_data_formatted_lines"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"other_responder_groups"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"relationship_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"responses"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant_instance"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimagealt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurlsmall"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"response_data"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"response_data_formatted_lines"},arguments:[],directives:[]}]}}]}}]}}]}}]},d={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"performelement_redisplay_subject_instance_previous_responses_nosession"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"subject_instance_previous_responses_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"redisplayData"},name:{kind:"Name",value:"performelement_redisplay_subject_instance_previous_responses_external_participant"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_anonymous"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"your_response"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"response_data"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"response_data_formatted_lines"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"other_responder_groups"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"relationship_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"responses"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant_instance"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimagealt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurlsmall"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"response_data"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"response_data_formatted_lines"},arguments:[],directives:[]}]}}]}}]}}]}}]},o={components:{Card:a.a,ElementParticipantFormContent:r.a},props:{element:{type:Object,validator:function(e){return e.data&&e.data.elementPluginDisplayComponent}},token:String,subjectInstanceId:Number},data:()=>({ready:!1,redisplayData:{}}),apollo:{redisplayData:{query(){return this.element.participantSectionId&&this.token&&this.token.length>0?d:l},fetchPolicy:"network-only",variables(){let e={subject_instance_id:this.subjectInstanceId,section_element_id:this.element.data.sourceSectionElementId};return this.token&&(e.token=this.token),this.element.participantSectionId&&(e.participant_section_id=this.element.participantSectionId),{input:e}},update(e){return this.ready=!0,e.redisplayData}}},computed:{otherData(){if(!this.element.data.elementPluginDisplayComponent)return null;let e=Object.assign({},this.element.element_plugin,{participant_response_component:this.element.data.elementPluginDisplayComponent});return{element:Object.assign({},this.element,{element_plugin:e}),other_responder_groups:this.redisplayData.other_responder_groups,response_data_formatted_lines:this.redisplayData.your_response?this.redisplayData.your_response.response_data_formatted_lines:[]}}}},m=(i("x9uU"),i("KHd+")),u=Object(m.a)(o,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.ready?i("div",{staticClass:"tui-redisplayParticipantForm"},[e._v("\n  "+e._s(e.redisplayData.title)+"\n\n  "),i("div",{staticClass:"tui-redisplayParticipantForm__cardArea"},[i("Card",{staticClass:"tui-redisplayParticipantForm__card"},[i("h4",{staticClass:"tui-redisplayParticipantForm__card-title"},[e._v("\n        "+e._s(e.element.data.elementTitle)+"\n      ")]),e._v(" "),i("ElementParticipantFormContent",e._b({attrs:{"active-section-is-closed":!0,"participant-can-answer":!0,element:e.element,"element-components":e.otherData.element.element_plugin,"section-element":e.otherData,"show-other-response":!0}},"ElementParticipantFormContent",e.$attrs,!1))],1)],1)]):e._e()}),[],!1,null,null,null);u.options.__hasBlocks={script:!0,template:!0};t.default=u.exports},"8km3":function(e,t){e.exports=tui.require("mod_perform/components/element/PerformAdminCustomElementEdit")},CyDE:function(e,t,i){"use strict";var n=i("Q9mu");i.n(n).a},HqhK:function(e,t){e.exports=tui.require("mod_perform/components/element/PerformAdminCustomElementSummary")},JXQf:function(e,t){e.exports=tui.require("tui/components/loading/Loader")},"KHd+":function(e,t,i){"use strict";function n(e,t,i,n,a,s,r,l){var d,o="function"==typeof e?e.options:e;if(t&&(o.render=t,o.staticRenderFns=i,o._compiled=!0),n&&(o.functional=!0),s&&(o._scopeId="data-v-"+s),r?(d=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),a&&a.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(r)},o._ssrRegister=d):a&&(d=l?function(){a.call(this,(o.functional?this.parent:this).$root.$options.shadowRoot)}:a),d)if(o.functional){o._injectStyles=d;var m=o.render;o.render=function(e,t){return d.call(t),m(e,t)}}else{var u=o.beforeCreate;o.beforeCreate=u?[].concat(u,d):[d]}return{exports:e,options:o}}i.d(t,"a",(function(){return n}))},Q9mu:function(e,t,i){},RZu2:function(e,t,i){},S6fK:function(e,t,i){},WBvU:function(e,t){e.exports=tui.require("tui/components/uniform")},"WPr+":function(e,t,i){!function(){"use strict";"undefined"!=typeof tui&&tui._bundle.isLoaded("performelement_redisplay")?console.warn('[tui bundle] The bundle "performelement_redisplay" is already loaded, skipping initialisation.'):(tui._bundle.register("performelement_redisplay"),tui._bundle.addModulesFromContext("performelement_redisplay/components",i("wGs1")))}()},hQxJ:function(e,t){e.exports=tui.require("mod_perform/components/element/ElementParticipantFormContent")},jJ8l:function(e,t){e.exports=tui.require("tui/components/card/Card")},loeb:function(e,t,i){"use strict";var n=i("S6fK");i.n(n).a},me1m:function(e,t,i){"use strict";i.r(t);var n=i("jJ8l"),a={components:{Card:i.n(n).a},inheritAttrs:!1,props:{data:Object}},s=(i("CyDE"),i("KHd+")),r=function(e){e.options.__langStrings={performelement_redisplay:["redisplayed_element_admin_preview"]}},l=Object(s.a)(a,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-redisplayAdminView"},[e.data.activityName?i("div",[e._v("\n    "+e._s(e.$str("redisplayed_element_admin_preview","performelement_redisplay",{activity_name:e.data.activityName}))+"\n  ")]):e._e(),e._v(" "),i("div",{staticClass:"tui-redisplayAdminView__cardArea"},[i("Card",{staticClass:"tui-redisplayAdminView__card"},[e.data.elementTitle?i("h4",{staticClass:"tui-redisplayAdminView__card-title"},[e._v("\n        "+e._s(e.data.elementTitle)+"\n      ")]):e._e(),e._v(" "),e.data.relationships?i("div",{staticClass:"tui-redisplayAdminView__card-content"},[e._v("\n        "+e._s(e.data.relationships)+"\n      ")]):e._e()])],1)])}),[],!1,null,null,null);"function"==typeof r&&r(l),l.options.__hasBlocks={script:!0,template:!0};t.default=l.exports},wGs1:function(e,t,i){var n={"./RedisplayAdminEdit":"+WuH","./RedisplayAdminEdit.vue":"+WuH","./RedisplayAdminSummary":"yUEk","./RedisplayAdminSummary.vue":"yUEk","./RedisplayAdminView":"me1m","./RedisplayAdminView.vue":"me1m","./RedisplayParticipantForm":"2ENX","./RedisplayParticipantForm.vue":"2ENX"};function a(e){var t=s(e);return i(t)}function s(e){if(!i.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=s,e.exports=a,a.id="wGs1"},x9uU:function(e,t,i){"use strict";var n=i("RZu2");i.n(n).a},yUEk:function(e,t,i){"use strict";i.r(t);var n=i("HqhK"),a={components:{PerformAdminCustomElementSummary:i.n(n).a},props:{data:Object,identifier:String,isRequired:Boolean,settings:Object,title:String,type:Object,currentActivityId:Number},data(){return{extraFields:[{title:this.$str("source_activity_value","performelement_redisplay"),value:this.$str("activity_name_with_status","performelement_redisplay",{activity_name:this.data.activityName,activity_status:this.activityStatus})},{title:this.$str("source_question_element_value","performelement_redisplay"),value:this.$str("source_element_option","performelement_redisplay",{element_title:this.data.elementTitle,element_plugin_name:this.data.elementPluginName})}]}},calculated:{activityStatus(){return parseInt(this.data.activityId)===this.currentActivityId?this.$str("current_activity","performelement_redisplay"):this.data.activityStatus}}},s=i("KHd+"),r=function(e){e.options.__langStrings={performelement_redisplay:["activity_name_with_status","current_activity","source_activity_value","source_element_option","source_question_element_value"]}},l=Object(s.a)(a,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-redisplayAdminSummary"},[i("PerformAdminCustomElementSummary",{attrs:{"extra-fields":e.extraFields,identifier:e.identifier,"is-required":e.isRequired,settings:e.settings,title:e.title},on:{display:function(t){return e.$emit("display")}}})],1)}),[],!1,null,null,null);"function"==typeof r&&r(l),l.options.__hasBlocks={script:!0,template:!0};t.default=l.exports}});