!function(e){var n={};function i(a){if(n[a])return n[a].exports;var t=n[a]={i:a,l:!1,exports:{}};return e[a].call(t.exports,t,t.exports,i),t.l=!0,t.exports}i.m=e,i.c=n,i.d=function(e,n,a){i.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:a})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,n){if(1&n&&(e=i(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var t in e)i.d(a,t,function(n){return e[n]}.bind(null,t));return a},i.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(n,"a",n),n},i.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},i.p="",i(i.s="Tdly")}({"+nV2":function(e,n,i){},"/ghu":function(e,n,i){"use strict";i.r(n);var a=i("gLvT"),t=i.n(a),r=i("5h9J"),l=i.n(r),d=i("tNJr"),o=i.n(d),s=i("KGcv"),u=i.n(s),c={components:{Dropdown:t.a,ButtonIcon:l.a,MoreIcon:o.a,DropdownItem:u.a},props:{preferenceTitle:{type:String,required:!0},isDeletable:{type:Boolean,required:!0}}},m=(i("F4ve"),i("KHd+")),v=function(e){e.options.__langStrings={core:["edit","delete"],totara_notification:["edit_notification_name","actions_for","delete_notification_name"]}},_=Object(m.a)(c,(function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("div",{staticClass:"tui-notificationAction"},[i("Dropdown",{scopedSlots:e._u([{key:"trigger",fn:function(n){var a=n.toggle,t=n.isOpen;return[i("ButtonIcon",{attrs:{"aria-expanded":t?"true":"false","aria-label":e.$str("actions_for","totara_notification",e.preferenceTitle),styleclass:{small:!0,transparentNoPadding:!0}},on:{click:a}},[i("MoreIcon",{attrs:{size:300}})],1)]}}])},[e._v(" "),i("DropdownItem",{attrs:{title:e.$str("edit_notification_name","totara_notification",e.preferenceTitle),"aria-label":e.$str("edit_notification_name","totara_notification",e.preferenceTitle)},on:{click:function(n){return e.$emit("edit-notification")}}},[e._v("\n      "+e._s(e.$str("edit","core"))+"\n    ")]),e._v(" "),e.isDeletable?i("DropdownItem",{attrs:{title:e.$str("delete_notification_name","totara_notification",e.preferenceTitle),"aria-label":e.$str("delete_notification_name","totara_notification",e.preferenceTitle)},on:{click:function(n){return e.$emit("delete-notification")}}},[e._v("\n      "+e._s(e.$str("delete","core"))+"\n    ")]):e._e()],1)],1)}),[],!1,null,null,null);"function"==typeof v&&v(_),_.options.__hasBlocks={script:!0,template:!0};n.default=_.exports},"3qs6":function(e,n,i){"use strict";var a=i("fBnv");i.n(a).a},"5h9J":function(e,n){e.exports=tui.require("tui/components/buttons/ButtonIcon")},"5qAA":function(e,n){e.exports=tui.require("tui/components/datatable/HeaderCell")},"6u1p":function(e,n,i){var a={"./action/NotifiableEventAction":"klUK","./action/NotifiableEventAction.vue":"klUK","./action/NotificationAction":"/ghu","./action/NotificationAction.vue":"/ghu","./form/DeliveryPreferenceForm":"tg4Y","./form/DeliveryPreferenceForm.vue":"tg4Y","./form/NotificationPreferenceForm":"oOjY","./form/NotificationPreferenceForm.vue":"oOjY","./form/field/ForceDeliveryChannels":"sUqY","./form/field/ForceDeliveryChannels.vue":"sUqY","./json_editor/nodes/Placeholder":"8Hmb","./json_editor/nodes/Placeholder.vue":"8Hmb","./modal/DeliveryPreferenceModal":"FnWa","./modal/DeliveryPreferenceModal.vue":"FnWa","./modal/NotificationPreferenceModal":"TyRh","./modal/NotificationPreferenceModal.vue":"TyRh","./table/NotificationTable":"kMiS","./table/NotificationTable.vue":"kMiS","./table/UserPreferencesTable":"tzWU","./table/UserPreferencesTable.vue":"tzWU"};function t(e){var n=r(e);return i(n)}function r(e){if(!i.o(a,e)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return a[e]}t.keys=function(){return Object.keys(a)},t.resolve=r,e.exports=t,t.id="6u1p"},"7zst":function(e,n){e.exports=tui.require("totara_notification/components/form/NotificationPreferenceForm")},"8Hmb":function(e,n,i){"use strict";i.r(n);var a=i("9G+f"),t={components:{Popover:i.n(a).a},props:{placeholderKey:{type:String,required:!0},displayName:{type:String,required:!0}}},r=(i("ddbG"),i("KHd+")),l=Object(r.a)(t,(function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("Popover",{staticClass:"tui-placeholder",attrs:{"data-key":e.placeholderKey,"data-label":e.displayName,triggers:["hover"]},scopedSlots:e._u([{key:"trigger",fn:function(){return[i("span",{staticClass:"tui-placeholder__text",attrs:{slot:"trigger"},slot:"trigger"},[e._v("\n      "+e._s(e.displayName))])]},proxy:!0}])},[e._v(" "),[i("span",[e._v("\n      ["+e._s(e.placeholderKey)+"]\n    ")])]],2)}),[],!1,null,null,null);l.options.__hasBlocks={script:!0,template:!0};n.default=l.exports},"9G+f":function(e,n){e.exports=tui.require("tui/components/popover/Popover")},BKk5:function(e,n,i){var a={"./NotificationPage":"FD7q","./NotificationPage.vue":"FD7q","./UserPreferences":"fhDg","./UserPreferences.vue":"fhDg"};function t(e){var n=r(e);return i(n)}function r(e){if(!i.o(a,e)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return a[e]}t.keys=function(){return Object.keys(a)},t.resolve=r,e.exports=t,t.id="BKk5"},BN8m:function(e,n){e.exports=tui.require("tui/components/buttons/ButtonGroup")},"C+/B":function(e,n){e.exports=tui.require("tui/components/modal/ConfirmationModal")},Djw7:function(e,n){e.exports=tui.require("totara_notification/components/action/NotifiableEventAction")},DkAd:function(e,n,i){"use strict";var a=i("c1kg");i.n(a).a},F4ve:function(e,n,i){"use strict";var a=i("WPzr");i.n(a).a},FD7q:function(e,n,i){"use strict";i.r(n);var a=i("bxeI"),t=i.n(a),r=i("XTJy"),l=i.n(r),d=i("Mnur"),o=i.n(d),s=i("oMyG"),u=i.n(s),c=i("C+/B"),m=i.n(c),v=i("coz5"),_=i.n(v),k=i("vyVp"),f={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"totara_notification_event_resolvers"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"extended_context"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"totara_notification_extended_context_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"resolvers"},name:{kind:"Name",value:"totara_notification_event_resolvers"},arguments:[{kind:"Argument",name:{kind:"Name",value:"extended_context"},value:{kind:"Variable",name:{kind:"Name",value:"extended_context"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"plugin_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"additional_criteria_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"recipients"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"notification_preferences"},arguments:[{kind:"Argument",name:{kind:"Name",value:"extended_context"},value:{kind:"Variable",name:{kind:"Name",value:"extended_context"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"ancestor_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"body"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",alias:{kind:"Name",value:"body_content"},name:{kind:"Name",value:"body"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"body_format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",alias:{kind:"Name",value:"subject_content"},name:{kind:"Name",value:"subject"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject_format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_body"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_subject"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_recipient"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_additional_criteria"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"additional_criteria"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_custom"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"parent_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_offset"},arguments:[{kind:"Argument",name:{kind:"Name",value:"unit"},value:{kind:"EnumValue",value:"DAY"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_schedule"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_forced_delivery_channels"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"forced_delivery_channels"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"recipient"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"extended_context"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"context_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"area"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"item_id"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"parent_value"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"body"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"body_format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"additional_criteria"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_offset"},arguments:[{kind:"Argument",name:{kind:"Name",value:"unit"},value:{kind:"EnumValue",value:"DAY"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject_format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"forced_delivery_channels"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"recipient"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"valid_schedules"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[{kind:"Argument",name:{kind:"Name",value:"extended_context"},value:{kind:"Variable",name:{kind:"Name",value:"extended_context"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_enabled"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"default_delivery_channels"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_sub_delivery_channel"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"parent_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_order"},arguments:[],directives:[]}]}}]}}]}}]},p={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_notification_create_custom_notification_preference"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"context_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"extended_context_component"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_component"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"extended_context_area"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_area"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"extended_context_item_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resolver_class_name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"title"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"additional_criteria"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"body"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"body_format"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subject"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"schedule_type"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"schedule_offset"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subject_format"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"recipient"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"enabled"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"forced_delivery_channels"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"notification_preference"},name:{kind:"Name",value:"totara_notification_create_notification_preference"},arguments:[{kind:"Argument",name:{kind:"Name",value:"extended_context"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"context_id"},value:{kind:"Variable",name:{kind:"Name",value:"context_id"}}},{kind:"ObjectField",name:{kind:"Name",value:"component"},value:{kind:"Variable",name:{kind:"Name",value:"extended_context_component"}}},{kind:"ObjectField",name:{kind:"Name",value:"area"},value:{kind:"Variable",name:{kind:"Name",value:"extended_context_area"}}},{kind:"ObjectField",name:{kind:"Name",value:"item_id"},value:{kind:"Variable",name:{kind:"Name",value:"extended_context_item_id"}}}]}},{kind:"Argument",name:{kind:"Name",value:"resolver_class_name"},value:{kind:"Variable",name:{kind:"Name",value:"resolver_class_name"}}},{kind:"Argument",name:{kind:"Name",value:"title"},value:{kind:"Variable",name:{kind:"Name",value:"title"}}},{kind:"Argument",name:{kind:"Name",value:"additional_criteria"},value:{kind:"Variable",name:{kind:"Name",value:"additional_criteria"}}},{kind:"Argument",name:{kind:"Name",value:"body"},value:{kind:"Variable",name:{kind:"Name",value:"body"}}},{kind:"Argument",name:{kind:"Name",value:"body_format"},value:{kind:"Variable",name:{kind:"Name",value:"body_format"}}},{kind:"Argument",name:{kind:"Name",value:"subject"},value:{kind:"Variable",name:{kind:"Name",value:"subject"}}},{kind:"Argument",name:{kind:"Name",value:"schedule_type"},value:{kind:"Variable",name:{kind:"Name",value:"schedule_type"}}},{kind:"Argument",name:{kind:"Name",value:"schedule_offset"},value:{kind:"Variable",name:{kind:"Name",value:"schedule_offset"}}},{kind:"Argument",name:{kind:"Name",value:"subject_format"},value:{kind:"Variable",name:{kind:"Name",value:"subject_format"}}},{kind:"Argument",name:{kind:"Name",value:"recipient"},value:{kind:"Variable",name:{kind:"Name",value:"recipient"}}},{kind:"Argument",name:{kind:"Name",value:"enabled"},value:{kind:"Variable",name:{kind:"Name",value:"enabled"}}},{kind:"Argument",name:{kind:"Name",value:"forced_delivery_channels"},value:{kind:"Variable",name:{kind:"Name",value:"forced_delivery_channels"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"ancestor_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"body"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",alias:{kind:"Name",value:"body_content"},name:{kind:"Name",value:"body"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"body_format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",alias:{kind:"Name",value:"subject_content"},name:{kind:"Name",value:"subject"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject_format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_body"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_subject"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_recipient"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_additional_criteria"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"additional_criteria"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_custom"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"parent_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_offset"},arguments:[{kind:"Argument",name:{kind:"Name",value:"unit"},value:{kind:"EnumValue",value:"DAY"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_schedule"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_forced_delivery_channels"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"forced_delivery_channels"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"recipient"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"extended_context"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"context_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"area"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"item_id"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"parent_value"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"body"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"body_format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"additional_criteria"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_offset"},arguments:[{kind:"Argument",name:{kind:"Name",value:"unit"},value:{kind:"EnumValue",value:"DAY"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject_format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"forced_delivery_channels"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"recipient"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}}]}}]},b={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_notification_override_notification_preference"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"context_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"extended_context_component"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_component"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"extended_context_area"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_area"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"extended_context_item_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resolver_class_name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ancestor_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"title"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"additional_criteria"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"body"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"body_format"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subject"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"schedule_type"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"schedule_offset"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subject_format"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"recipient"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"enabled"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"forced_delivery_channels"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"notification_preference"},name:{kind:"Name",value:"totara_notification_create_notification_preference"},arguments:[{kind:"Argument",name:{kind:"Name",value:"extended_context"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"context_id"},value:{kind:"Variable",name:{kind:"Name",value:"context_id"}}},{kind:"ObjectField",name:{kind:"Name",value:"component"},value:{kind:"Variable",name:{kind:"Name",value:"extended_context_component"}}},{kind:"ObjectField",name:{kind:"Name",value:"area"},value:{kind:"Variable",name:{kind:"Name",value:"extended_context_area"}}},{kind:"ObjectField",name:{kind:"Name",value:"item_id"},value:{kind:"Variable",name:{kind:"Name",value:"extended_context_item_id"}}}]}},{kind:"Argument",name:{kind:"Name",value:"resolver_class_name"},value:{kind:"Variable",name:{kind:"Name",value:"resolver_class_name"}}},{kind:"Argument",name:{kind:"Name",value:"ancestor_id"},value:{kind:"Variable",name:{kind:"Name",value:"ancestor_id"}}},{kind:"Argument",name:{kind:"Name",value:"title"},value:{kind:"Variable",name:{kind:"Name",value:"title"}}},{kind:"Argument",name:{kind:"Name",value:"additional_criteria"},value:{kind:"Variable",name:{kind:"Name",value:"additional_criteria"}}},{kind:"Argument",name:{kind:"Name",value:"body"},value:{kind:"Variable",name:{kind:"Name",value:"body"}}},{kind:"Argument",name:{kind:"Name",value:"body_format"},value:{kind:"Variable",name:{kind:"Name",value:"body_format"}}},{kind:"Argument",name:{kind:"Name",value:"subject"},value:{kind:"Variable",name:{kind:"Name",value:"subject"}}},{kind:"Argument",name:{kind:"Name",value:"schedule_type"},value:{kind:"Variable",name:{kind:"Name",value:"schedule_type"}}},{kind:"Argument",name:{kind:"Name",value:"schedule_offset"},value:{kind:"Variable",name:{kind:"Name",value:"schedule_offset"}}},{kind:"Argument",name:{kind:"Name",value:"subject_format"},value:{kind:"Variable",name:{kind:"Name",value:"subject_format"}}},{kind:"Argument",name:{kind:"Name",value:"recipient"},value:{kind:"Variable",name:{kind:"Name",value:"recipient"}}},{kind:"Argument",name:{kind:"Name",value:"enabled"},value:{kind:"Variable",name:{kind:"Name",value:"enabled"}}},{kind:"Argument",name:{kind:"Name",value:"forced_delivery_channels"},value:{kind:"Variable",name:{kind:"Name",value:"forced_delivery_channels"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"ancestor_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"body"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",alias:{kind:"Name",value:"body_content"},name:{kind:"Name",value:"body"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"body_format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",alias:{kind:"Name",value:"subject_content"},name:{kind:"Name",value:"subject"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject_format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_body"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_subject"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_recipient"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_additional_criteria"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"additional_criteria"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_custom"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"parent_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_offset"},arguments:[{kind:"Argument",name:{kind:"Name",value:"unit"},value:{kind:"EnumValue",value:"DAY"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_schedule"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_forced_delivery_channels"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"forced_delivery_channels"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"recipient"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"extended_context"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"context_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"area"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"item_id"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"parent_value"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"body"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"body_format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"additional_criteria"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_offset"},arguments:[{kind:"Argument",name:{kind:"Name",value:"unit"},value:{kind:"EnumValue",value:"DAY"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject_format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"forced_delivery_channels"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"recipient"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}}]}}]},y={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_notification_update_notification_preference"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"body"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subject"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"body_format"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"title"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"additional_criteria"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"schedule_type"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"schedule_offset"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subject_format"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"recipient"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"enabled"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"forced_delivery_channels"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"notification_preference"},name:{kind:"Name",value:"totara_notification_update_notification_preference"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"body"},value:{kind:"Variable",name:{kind:"Name",value:"body"}}},{kind:"Argument",name:{kind:"Name",value:"subject"},value:{kind:"Variable",name:{kind:"Name",value:"subject"}}},{kind:"Argument",name:{kind:"Name",value:"body_format"},value:{kind:"Variable",name:{kind:"Name",value:"body_format"}}},{kind:"Argument",name:{kind:"Name",value:"title"},value:{kind:"Variable",name:{kind:"Name",value:"title"}}},{kind:"Argument",name:{kind:"Name",value:"additional_criteria"},value:{kind:"Variable",name:{kind:"Name",value:"additional_criteria"}}},{kind:"Argument",name:{kind:"Name",value:"schedule_type"},value:{kind:"Variable",name:{kind:"Name",value:"schedule_type"}}},{kind:"Argument",name:{kind:"Name",value:"schedule_offset"},value:{kind:"Variable",name:{kind:"Name",value:"schedule_offset"}}},{kind:"Argument",name:{kind:"Name",value:"subject_format"},value:{kind:"Variable",name:{kind:"Name",value:"subject_format"}}},{kind:"Argument",name:{kind:"Name",value:"recipient"},value:{kind:"Variable",name:{kind:"Name",value:"recipient"}}},{kind:"Argument",name:{kind:"Name",value:"enabled"},value:{kind:"Variable",name:{kind:"Name",value:"enabled"}}},{kind:"Argument",name:{kind:"Name",value:"forced_delivery_channels"},value:{kind:"Variable",name:{kind:"Name",value:"forced_delivery_channels"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"ancestor_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"body"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",alias:{kind:"Name",value:"body_content"},name:{kind:"Name",value:"body"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"body_format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",alias:{kind:"Name",value:"subject_content"},name:{kind:"Name",value:"subject"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject_format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_body"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_subject"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_recipient"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_additional_criteria"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"additional_criteria"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_custom"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"parent_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_offset"},arguments:[{kind:"Argument",name:{kind:"Name",value:"unit"},value:{kind:"EnumValue",value:"DAY"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_schedule"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_forced_delivery_channels"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"forced_delivery_channels"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"recipient"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"extended_context"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"context_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"area"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"item_id"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"parent_value"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"body"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"body_format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"additional_criteria"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_offset"},arguments:[{kind:"Argument",name:{kind:"Name",value:"unit"},value:{kind:"EnumValue",value:"DAY"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject_format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"forced_delivery_channels"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"recipient"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}}]}}]},N={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_notification_delete_notification_preference"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totara_notification_delete_notification_preference"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[]}]}}]},h={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_notification_update_notifiable_event_default_delivery_channels"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resolver_class_name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"default_delivery_channels"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"default_delivery_channels"},name:{kind:"Name",value:"totara_notification_update_default_delivery_channels"},arguments:[{kind:"Argument",name:{kind:"Name",value:"resolver_class_name"},value:{kind:"Variable",name:{kind:"Name",value:"resolver_class_name"}}},{kind:"Argument",name:{kind:"Name",value:"default_delivery_channels"},value:{kind:"Variable",name:{kind:"Name",value:"default_delivery_channels"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_sub_delivery_channel"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"parent_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_order"},arguments:[],directives:[]}]}}]}}]},g={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_notification_toggle_notifiable_event"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resolver_class_name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"extended_context"}},type:{kind:"NamedType",name:{kind:"Name",value:"totara_notification_extended_context_input"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"is_enabled"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_boolean"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"notifiable_event"},name:{kind:"Name",value:"totara_notification_toggle_notifiable_event"},arguments:[{kind:"Argument",name:{kind:"Name",value:"resolver_class_name"},value:{kind:"Variable",name:{kind:"Name",value:"resolver_class_name"}}},{kind:"Argument",name:{kind:"Name",value:"extended_context"},value:{kind:"Variable",name:{kind:"Name",value:"extended_context"}}},{kind:"Argument",name:{kind:"Name",value:"is_enabled"},value:{kind:"Variable",name:{kind:"Name",value:"is_enabled"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"class_name"},arguments:[],directives:[]}]}}]}}]};var x={components:{Layout:t.a,NotificationTable:l.a,ModalPresenter:o.a,NotificationPreferenceModal:u.a,DeleteConfirmationModal:m.a,DeliveryPreferenceModal:_.a},props:{title:{type:String,required:!0},contextId:{type:[Number,String],required:!0},preferredEditorFormat:[Number,String],extendedContext:{type:Object,default:()=>({}),validate:e=>"component"in e&&"area"in e&&"itemId"in e&&(""===e.component&&""===e.area&&0==e.itemId||""!==e.component&&""!==e.area&&0!=e.itemId)},canChangeDeliveryChannelDefaults:Boolean},apollo:{eventResolvers:{query:f,variables(){return{extended_context:{context_id:this.contextId,component:this.extendedContext.component,area:this.extendedContext.area,item_id:this.extendedContext.itemId}}},update({resolvers:e}){let n={};return e.forEach(e=>{const{component:i,plugin_name:a,recipients:t}=e;n[i]||(n[i]={component:i,plugin_name:a,resolvers:[],recipients:t}),n[i].resolvers.push(e)}),Object.values(n)}}},data:()=>({modal:{open:!1,title:"",state:null},deleteModal:{open:!1},deliveryPreferenceModal:{open:!1},deleting:!1,targetResolverClassName:null,targetDeletePreference:null,targetPreference:null,targetScheduleTypes:[],targetAvailableRecipients:[],targetDefaultDeliveryChannels:[],targetadditionalCriteriaComponent:null,targetResolverLabel:null}),computed:{deleteNotificationTitle(){let e="";return this.targetDeletePreference&&(e=this.$str("delete_confirm_title","totara_notification",this.targetDeletePreference.title)),e},queryVariables(){return{extended_context:{context_id:this.contextId,component:this.extendedContext.component,area:this.extendedContext.area,item_id:this.extendedContext.itemId}}}},methods:{resetState(){this.targetResolverClassName=null,this.targetPreference=null,this.modal.title="",this.targetScheduleTypes=[],this.targetDefaultDeliveryChannels=[],this.targetadditionalCriteriaComponent=null,this.targetResolverLabel=null},handleCreateCustomNotification({resolverClassName:e,scheduleTypes:n,recipients:i,deliveryChannels:a,additionalCriteriaComponent:t}){this.modal.title=this.$str("create_custom_notification_title","totara_notification"),this.modal.open=!0,this.modal.state="create",this.targetResolverClassName=e,this.targetScheduleTypes=n,this.targetAvailableRecipients=i,this.targetDefaultDeliveryChannels=a,this.targetadditionalCriteriaComponent=t},async handleEditNotification(e,n,i,a,t){this.targetPreference=await this.getOverriddenPreference(e),this.targetResolverClassName=this.targetPreference.resolver_class_name,this.targetScheduleTypes=n,this.targetAvailableRecipients=i,this.targetDefaultDeliveryChannels=a,this.targetadditionalCriteriaComponent=t,this.modal.title=this.$str("edit_notification","totara_notification"),this.modal.open=!0,this.modal.state="update"},async handleUpdateDeliveryPreferences({resolverClassName:e,resolverLabel:n,defaultDeliveryChannels:i}){this.targetResolverClassName=e,this.targetResolverLabel=n,this.targetDefaultDeliveryChannels=i,this.deliveryPreferenceModal.open=!0},async deleteNotification(){this.deleteModal.open&&(this.deleting=!0,await this.handleDeleteNotification(this.targetDeletePreference),this.deleteModal.open=!1,Object(k.notify)({type:"success",message:this.$str("delete_success","totara_notification")}),this.deleting=!1)},async handleDeleteNotification(e){await this.$apollo.mutate({mutation:N,variables:{id:e.id},update:n=>{let{resolvers:i}=n.readQuery({query:f,variables:this.queryVariables});const{extended_context:a,id:t,resolver_class_name:r}=e,{component:l}=a;i=Object.assign([],i),i=i.map(e=>{const{notification_preferences:n}=e;return n.map(e=>e.extended_context&&e.extended_context.component).includes(l)&&e.class_name===r?((e=Object.assign({},e)).notification_preferences=n.filter(e=>e.id!==t),e):e}),n.writeQuery({query:f,variables:this.queryVariables,data:{resolvers:i}})}})},confirmDeleteNotification(e){this.targetDeletePreference=e,this.deleteModal.open=!0},async handleFormSubmit(e){if("create"===this.modal.state)await this.createCustomNotification(e);else{if("update"!==this.modal.state)throw new Error("The modal state is invalid");await this.updateNotification(e)}this.modal.open=!1,Object(k.notify)({type:"success",message:"create"===this.modal.state?this.$str("saved_notification","totara_notification"):this.$str("updated_notification","totara_notification")})},async createCustomNotification({subject:e,body:n,title:i,additional_criteria:a,body_format:t,resolver_class_name:r,schedule_type:l,schedule_offset:d,subject_format:o,recipient:s,enabled:u,forced_delivery_channels:c}){const m={body:n,subject:e,title:i,additional_criteria:a,body_format:t,resolver_class_name:r,subject_format:o,context_id:this.contextId,schedule_type:l,schedule_offset:d,recipient:s,enabled:u,forced_delivery_channels:c};this.extendedContext.area&&this.extendedContext.component&&this.extendedContext.itemId&&(m.extended_context_area=this.extendedContext.area,m.extended_context_component=this.extendedContext.component,m.extended_context_item_id=this.extendedContext.itemId),await this.$apollo.mutate({mutation:p,variables:m,update:(e,{data:{notification_preference:n}})=>{const{resolvers:i}=e.readQuery({query:f,variables:this.queryVariables}),{resolver_component:a,resolver_class_name:t}=n;e.writeQuery({query:f,variables:this.queryVariables,data:{resolvers:i.map(e=>{if(e.component===a&&e.class_name===t){e=Object.assign({},e);const{notification_preferences:i}=e;e.notification_preferences=[n].concat(i)}return e})}})}})},async getOverriddenPreference(e){if(e.extended_context.context_id==this.contextId)return e;const{data:{notification_preference:n}}=await this.$apollo.mutate({mutation:b,variables:{context_id:this.contextId,resolver_class_name:e.resolver_class_name,extended_context_component:this.extendedContext.component,extended_context_area:this.extendedContext.area,extended_context_item_id:this.extendedContext.itemId,ancestor_id:e.ancestor_id?e.ancestor_id:e.id},update:(e,{data:{notification_preference:n}})=>{const{resolvers:i}=e.readQuery({query:f,variables:this.queryVariables}),{resolver_component:a,resolver_class_name:t,parent_id:r}=n;e.writeQuery({query:f,variables:this.queryVariables,data:{resolvers:i.map(e=>{if(e.component===a&&e.class_name===t){e=Object.assign({},e);const{notification_preferences:i}=e;e.notification_preferences=i.map(e=>e.id==r?n:e)}return e})}})}});return n},async updateNotification({subject:e,title:n,additional_criteria:i,body:a,body_format:t,schedule_type:r,schedule_offset:l,subject_format:d,recipient:o,enabled:s,forced_delivery_channels:u}){if(!this.targetPreference)throw new Error("Cannot run update while target preference is empty");await this.$apollo.mutate({mutation:y,variables:{id:this.targetPreference.id,additional_criteria:i,subject:e,body:a,body_format:t,subject_format:d,title:this.targetPreference.is_custom&&!this.targetPreference.parent_id?n:void 0,schedule_type:r,schedule_offset:l,recipient:o,enabled:s,forced_delivery_channels:u},update:(e,{data:{notification_preference:n}})=>{const{resolvers:i}=e.readQuery({query:f,variables:this.queryVariables}),{resolver_component:a,resolver_class_name:t}=n;e.writeQuery({query:f,variables:this.queryVariables,data:{resolvers:i.map(e=>{if(e.component===a&&e.class_name===t){e=Object.assign({},e);const{notification_preferences:i}=e;e.notification_preferences=i.map(e=>e.id==n.id?n:e)}return e})}})}})},async handleNotificationPreferenceSubmit({delivery_channels:e,resolver_class_name:n}){await this.$apollo.mutate({mutation:h,variables:{resolver_class_name:n,default_delivery_channels:e},update:(e,{data:{default_delivery_channels:i}})=>{let{resolvers:a}=e.readQuery({query:f,variables:this.queryVariables});a=Object.assign([],a),a=a.map(e=>(e.class_name===n&&((e=Object.assign({},e)).default_delivery_channels=i),e)),e.writeQuery({query:f,variables:this.queryVariables,data:{resolvers:a}})}}),this.deliveryPreferenceModal.open=!1},async statusToggle({value:e,resolver:n}){await this.$apollo.mutate({mutation:g,variables:{resolver_class_name:n.class_name,extended_context:{context_id:this.contextId,component:this.extendedContext.component,area:this.extendedContext.area,item_id:this.extendedContext.itemId},is_enabled:e},update:(i,{data:{notifiable_event:a}})=>{const{resolvers:t}=i.readQuery({query:f,variables:this.queryVariables}),{notification_preferences:r}=n;i.writeQuery({query:f,variables:this.queryVariables,data:{resolvers:t.map(n=>(n.class_name===a.class_name&&((n=Object.assign({},n)).status=Object.assign({},n.status,{is_enabled:e,__typename:n.status.__typename}),n.notification_preferences=r.map(e=>e)),n))}})}})}}},F=i("KHd+"),C=function(e){e.options.__langStrings={core:["delete"],totara_notification:["create_custom_notification_title","delete_confirm_title","delete_confirm_message","delete_success","edit_delivery_preferences","edit_notification","saved_notification","updated_notification"]}},V=Object(F.a)(x,(function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("Layout",{staticClass:"tui-notificationPage",attrs:{title:e.title,loading:e.$apollo.loading},scopedSlots:e._u([e.$apollo.loading?null:{key:"content",fn:function(){return[i("NotificationTable",{staticClass:"tui-notificationPage__table",attrs:{"event-resolvers":e.eventResolvers,"context-id":parseInt(e.contextId),"show-delivery-preference-option":e.canChangeDeliveryChannelDefaults},on:{"status-toggle":e.statusToggle,"create-custom-notification":e.handleCreateCustomNotification,"edit-notification":e.handleEditNotification,"delete-notification":e.confirmDeleteNotification,"update-delivery-preferences":e.handleUpdateDeliveryPreferences}})]},proxy:!0},{key:"modals",fn:function(){return[i("ModalPresenter",{attrs:{open:e.modal.open},on:{"request-close":function(n){e.modal.open=!1},"close-complete":e.resetState}},[i("NotificationPreferenceModal",{attrs:{"context-id":e.contextId,"extended-context":e.extendedContext,"resolver-class-name":e.targetResolverClassName,preference:e.targetPreference||void 0,"parent-value":e.targetPreference?e.targetPreference.parent_value:null,title:e.modal.title,"valid-schedule-types":e.targetScheduleTypes,"available-recipients":e.targetAvailableRecipients,"default-delivery-channels":e.targetDefaultDeliveryChannels,"additional-criteria-component":e.targetadditionalCriteriaComponent,"preferred-editor-format":null!==e.preferredEditorFormat?Number(e.preferredEditorFormat):null},on:{"form-submit":e.handleFormSubmit}})],1),e._v(" "),i("DeleteConfirmationModal",{attrs:{open:e.deleteModal.open,title:e.deleteNotificationTitle,"confirm-button-text":e.$str("delete","core"),loading:e.deleting},on:{confirm:e.deleteNotification,cancel:function(n){e.deleteModal.open=!1}}},[[i("p",[e._v(e._s(e.$str("delete_confirm_message","totara_notification")))])]],2),e._v(" "),e.canChangeDeliveryChannelDefaults?i("ModalPresenter",{attrs:{open:e.deliveryPreferenceModal.open},on:{"request-close":function(n){e.deliveryPreferenceModal.open=!1},"close-complete":e.resetState}},[i("DeliveryPreferenceModal",{attrs:{"context-id":e.contextId,"resolver-class-name":e.targetResolverClassName,"resolver-label":e.targetResolverLabel,"default-delivery-channels":e.targetDefaultDeliveryChannels,"additional-criteria-component":e.targetadditionalCriteriaComponent,title:e.$str("edit_delivery_preferences","totara_notification")},on:{"form-submit":e.handleNotificationPreferenceSubmit}})],1):e._e()]},proxy:!0}],null,!0)})}),[],!1,null,null,null);"function"==typeof C&&C(V),V.options.__hasBlocks={script:!0,template:!0};n.default=V.exports},FnWa:function(e,n,i){"use strict";i.r(n);var a=i("tkAW"),t=i.n(a),r=i("u5iS"),l=i.n(r),d=i("HAvG"),o=i.n(d),s=i("Tdxx"),u={components:{Modal:t.a,ModalContent:l.a,DeliveryPreferenceForm:o.a},props:{title:{type:String,required:!0},showCloseButton:{type:Boolean,default:!0},defaultDeliveryChannels:{type:Array,required:!0,validator:Object(s.d)()},resolverClassName:{type:String,required:!0},resolverLabel:{type:String,required:!0},showOverride:Boolean,initialOverrideStatus:Boolean},methods:{handleSubmit(e,n){const i={resolver_class_name:this.resolverClassName,delivery_channels:e};this.$emit("form-submit",i,n)}}},c=i("KHd+"),m=function(e){e.options.__langStrings={totara_notification:["notification_trigger"]}},v=Object(c.a)(u,(function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("Modal",{attrs:{size:"large","aria-labelledby":e.$id("title"),dismissable:{esc:!0,backdropClick:!0,overlayClose:!1}}},[i("ModalContent",{attrs:{title:e.title,"title-id":e.$id("title"),"close-button":e.showCloseButton}},[i("p",[e._v("\n      "+e._s(e.$str("notification_trigger","totara_notification",e.resolverLabel))+"\n    ")]),e._v(" "),i("DeliveryPreferenceForm",{attrs:{"default-delivery-channels":e.defaultDeliveryChannels,"show-override":e.showOverride,"initial-override-status":e.initialOverrideStatus},on:{"form-submit":e.handleSubmit,cancel:function(n){return e.$emit("request-close")}}})],1)],1)}),[],!1,null,null,null);"function"==typeof m&&m(v),v.options.__hasBlocks={script:!0,template:!0};n.default=v.exports},GEsA:function(e,n,i){"use strict";var a=i("+nV2");i.n(a).a},HAvG:function(e,n){e.exports=tui.require("totara_notification/components/form/DeliveryPreferenceForm")},IqB1:function(e,n){e.exports=tui.require("tui/components/collapsible/Collapsible")},JThd:function(e,n){e.exports=tui.require("tui/components/icons/CheckSuccess")},"K2m/":function(e,n){e.exports=tui.require("totara_notification/components/table/UserPreferencesTable")},KGcv:function(e,n){e.exports=tui.require("tui/components/dropdown/DropdownItem")},KGot:function(e,n){e.exports=tui.require("tui/components/datatable/Cell")},"KHd+":function(e,n,i){"use strict";function a(e,n,i,a,t,r,l,d){var o,s="function"==typeof e?e.options:e;if(n&&(s.render=n,s.staticRenderFns=i,s._compiled=!0),a&&(s.functional=!0),r&&(s._scopeId="data-v-"+r),l?(o=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(l)},s._ssrRegister=o):t&&(o=d?function(){t.call(this,(s.functional?this.parent:this).$root.$options.shadowRoot)}:t),o)if(s.functional){s._injectStyles=o;var u=s.render;s.render=function(e,n){return o.call(n),u(e,n)}}else{var c=s.beforeCreate;s.beforeCreate=c?[].concat(c,o):[o]}return{exports:e,options:s}}i.d(n,"a",(function(){return a}))},Mnur:function(e,n){e.exports=tui.require("tui/components/modal/ModalPresenter")},NN9N:function(e,n,i){},PuHf:function(e,n){e.exports=tui.require("totara_notification/components/action/NotificationAction")},Tdly:function(e,n,i){!function(){"use strict";"undefined"!=typeof tui&&tui._bundle.isLoaded("totara_notification")?console.warn('[tui bundle] The bundle "totara_notification" is already loaded, skipping initialisation.'):(tui._bundle.register("totara_notification"),tui._bundle.addModulesFromContext("totara_notification/components",i("6u1p")),tui._bundle.addModulesFromContext("totara_notification/pages",i("BKk5")))}()},Tdxx:function(e,n,i){"use strict";i.d(n,"a",(function(){return t})),i.d(n,"e",(function(){return r})),i.d(n,"c",(function(){return l})),i.d(n,"d",(function(){return d})),i.d(n,"b",(function(){return o}));const a=["subject","body","body_format","title","schedule_type","schedule_offset","subject_format","recipient","enabled","forced_delivery_channels"],t={ON_EVENT:"ON_EVENT",BEFORE_EVENT:"BEFORE_EVENT",AFTER_EVENT:"AFTER_EVENT"};function r(e=[]){const n=e.concat(a);return e=>0===n.filter(n=>!(n in e)).length}function l(){return e=>e.every(e=>"class_name"in e&&"name"in e)}function d(){return e=>e.every(e=>"component"in e&&"label"in e&&"is_enabled"in e&&"is_sub_delivery_channel"in e&&"parent_component"in e)}function o(e={}){const n={subject:"",body:"",body_format:null,subject_format:null,title:null,schedule_type:t.ON_EVENT,schedule_offset:null,recipient:null,enabled:!1,forced_delivery_channels:[]};return()=>Object.assign({},n,e)}},TyRh:function(e,n,i){"use strict";i.r(n);var a=i("tkAW"),t=i.n(a),r=i("u5iS"),l=i.n(r),d=i("7zst"),o=i.n(d),s=i("Tdxx"),u={components:{Modal:t.a,ModalContent:l.a,NotificationPreferenceForm:o.a},props:{title:{type:String,required:!0},contextId:{type:Number,required:!0},extendedContext:{type:Object,required:!1},showCloseButton:{type:Boolean,default:!0},preference:{type:Object,validator:Object(s.e)(),default:Object(s.b)({body_content:"",subject_content:""})},parentValue:{type:Object,validator:Object(s.e)(),default:()=>null},resolverClassName:{type:String,required:!0},validScheduleTypes:{type:Array,required:!0},availableRecipients:{type:Array,required:!0,validator:Object(s.c)()},defaultDeliveryChannels:{type:Array,required:!0,validator:Object(s.d)()},additionalCriteriaComponent:{type:String},preferredEditorFormat:Number},methods:{handleSubmit(e){this.resolverClassName&&(e.resolver_class_name=this.resolverClassName),this.$emit("form-submit",e)}}},c=(i("tZ6d"),i("KHd+")),m=Object(c.a)(u,(function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("Modal",{attrs:{size:"large","aria-labelledby":e.$id("title"),dismissable:{esc:!0,backdropClick:!1,overlayClose:!1}}},[i("ModalContent",{attrs:{title:e.title,"title-id":e.$id("title"),"close-button":e.showCloseButton}},[i("NotificationPreferenceForm",{staticClass:"tui-notificationPreferenceModal__form",attrs:{"context-id":e.contextId,"extended-context":e.extendedContext,preference:e.preference,"parent-value":e.parentValue,"valid-schedule-types":e.validScheduleTypes,"resolver-class-name":e.resolverClassName,"available-recipients":e.availableRecipients,"default-delivery-channels":e.defaultDeliveryChannels,"additional-criteria-component":e.additionalCriteriaComponent,"preferred-editor-format":e.preferredEditorFormat},on:{submit:e.handleSubmit,cancel:function(n){return e.$emit("request-close")}}})],1)],1)}),[],!1,null,null,null);m.options.__hasBlocks={script:!0,template:!0};n.default=m.exports},UMYj:function(e,n){e.exports=tui.require("tui/components/editor/Editor")},UbXC:function(e,n){e.exports=tui.require("tui/components/form/RadioNumberInput")},VX2K:function(e,n){e.exports=tui.require("tui/components/form/Radio")},Vwoz:function(e,n){e.exports=tui.require("tui/components/collapsible/CollapsibleGroupToggle")},WBvU:function(e,n){e.exports=tui.require("tui/components/uniform")},WPzr:function(e,n,i){},XTJy:function(e,n){e.exports=tui.require("totara_notification/components/table/NotificationTable")},XaQC:function(e,n){e.exports=tui.require("totara_notification/components/form/field/ForceDeliveryChannels")},bJcL:function(e,n,i){},bxeI:function(e,n){e.exports=tui.require("tui/components/layouts/LayoutOneColumn")},c1kg:function(e,n,i){},coz5:function(e,n){e.exports=tui.require("totara_notification/components/modal/DeliveryPreferenceModal")},dB5e:function(e,n){e.exports=tui.require("tui/editor")},ddbG:function(e,n,i){"use strict";var a=i("lKDV");i.n(a).a},e3MU:function(e,n){e.exports=tui.require("tui/components/buttons/InfoIconButton")},fBnv:function(e,n,i){},fhDg:function(e,n,i){"use strict";i.r(n);var a=i("bxeI"),t=i.n(a),r=i("K2m/"),l=i.n(r),d=i("vyVp"),o=i("Mnur"),s=i.n(o),u=i("coz5"),c=i.n(u),m={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_notification_update_notifiable_event_user_preference"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resolver_class_name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"is_enabled"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_boolean"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"user_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"extended_context"}},type:{kind:"NamedType",name:{kind:"Name",value:"totara_notification_extended_context_input"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"user_preference_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"notifiable_event_user_preference"},name:{kind:"Name",value:"totara_notification_update_notifiable_event_user_preference"},arguments:[{kind:"Argument",name:{kind:"Name",value:"resolver_class_name"},value:{kind:"Variable",name:{kind:"Name",value:"resolver_class_name"}}},{kind:"Argument",name:{kind:"Name",value:"is_enabled"},value:{kind:"Variable",name:{kind:"Name",value:"is_enabled"}}},{kind:"Argument",name:{kind:"Name",value:"user_id"},value:{kind:"Variable",name:{kind:"Name",value:"user_id"}}},{kind:"Argument",name:{kind:"Name",value:"extended_context"},value:{kind:"Variable",name:{kind:"Name",value:"extended_context"}}},{kind:"Argument",name:{kind:"Name",value:"user_preference_id"},value:{kind:"Variable",name:{kind:"Name",value:"user_preference_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"plugin_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user_preference_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_delivery_channels"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"delivery_channels"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_sub_delivery_channel"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"parent_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_order"},arguments:[],directives:[]}]}}]}}]}}]},v={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_notification_update_user_delivery_channels"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resolver_class_name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"delivery_channels"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"user_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"extended_context"}},type:{kind:"NamedType",name:{kind:"Name",value:"totara_notification_extended_context_input"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"user_preference_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"notifiable_event_user_preference"},name:{kind:"Name",value:"totara_notification_update_notifiable_event_user_delivery_channels"},arguments:[{kind:"Argument",name:{kind:"Name",value:"resolver_class_name"},value:{kind:"Variable",name:{kind:"Name",value:"resolver_class_name"}}},{kind:"Argument",name:{kind:"Name",value:"delivery_channels"},value:{kind:"Variable",name:{kind:"Name",value:"delivery_channels"}}},{kind:"Argument",name:{kind:"Name",value:"user_id"},value:{kind:"Variable",name:{kind:"Name",value:"user_id"}}},{kind:"Argument",name:{kind:"Name",value:"extended_context"},value:{kind:"Variable",name:{kind:"Name",value:"extended_context"}}},{kind:"Argument",name:{kind:"Name",value:"user_preference_id"},value:{kind:"Variable",name:{kind:"Name",value:"user_preference_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"plugin_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user_preference_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"overridden_delivery_channels"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"delivery_channels"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_sub_delivery_channel"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"parent_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_order"},arguments:[],directives:[]}]}}]}}]}}]},_={components:{Layout:t.a,UserPreferencesTable:l.a,ModalPresenter:s.a,DeliveryPreferenceModal:c.a},props:{resolverPreferences:{type:Array,required:!0},extendedContext:{type:Object,default:()=>({}),validate:e=>"component"in e&&"area"in e&&"itemId"in e&&(""===e.component&&""===e.area&&0==e.itemId||""!==e.component&&""!==e.area&&0!=e.itemId)}},data(){return{userPreferencesList:this.resolverPreferences,groupedPreferences:[],deliveryPreferenceModal:{open:!1},targetResolverClassName:null,targetResolverLabel:null,targetDefaultDeliveryChannels:null,userPreferenceId:null,OverrideDeliveryChannels:!1,showDeliveryChannelsOverride:!0,preferences:this.resolverPreferences}},computed:{groupPreferences(){let e={};return this.userPreferencesList.forEach(n=>{const{component:i,plugin_name:a}=n;e[i]||(e[i]={component:i,plugin_name:a,resolvers:[]}),e[i].resolvers.push(n)}),Object.values(e)}},watch:{groupPreferences:{immediate:!0,deep:!0,handler(e){this.groupedPreferences=e}}},methods:{resetState(){this.targetResolverClassName=null,this.targetDefaultDeliveryChannels=null,this.targetResolverLabel=null},async saveUserPreference({userId:e,resolverClassname:n,isEnabled:i,userPreferenceId:a}){try{const{data:t}=await this.$apollo.mutate({mutation:m,variables:{user_id:e,resolver_class_name:n,extended_context:this.extendedContext,is_enabled:i,user_preference_id:a}});this.updateResolverPreferenceList(t.notifiable_event_user_preference)}catch(e){await Object(d.notify)({type:"error",message:this.$str("error_user_preference_permission","totara_notification")})}},updateResolverPreferenceList(e){let n=Object.assign([],this.groupedPreferences).find(n=>n.component===e.component);n.resolvers=n.resolvers.map(n=>n.resolver_class_name===e.resolver_class_name&&n.component===e.component&&n.name===e.name&&n.plugin_name===e.plugin_name?e:n)},handleUpdateDeliveryPreferences({resolverClassName:e,resolverLabel:n,defaultDeliveryChannels:i,OverrideDeliveryChannels:a,userPreferenceId:t}){this.targetResolverClassName=e,this.targetResolverLabel=n,this.targetDefaultDeliveryChannels=i,this.OverrideDeliveryChannels=a,this.userPreferenceId=t,this.deliveryPreferenceModal.open=!0},async handleNotificationPreferenceSubmit({delivery_channels:e,resolver_class_name:n},i){let a=i?e:null;await this.$apollo.mutate({mutation:v,variables:{resolver_class_name:n,extended_context:this.extendedContext,delivery_channels:a,user_preference_id:this.userPreferenceId},update:(e,{data:{notifiable_event_user_preference:n}})=>{let i=Object.assign([],this.groupedPreferences).find(e=>e.component===n.component);i.resolvers=i.resolvers.map(e=>e.resolver_class_name===n.resolver_class_name&&e.name===n.name?n:e)}}),this.deliveryPreferenceModal.open=!1}}},k=i("KHd+"),f=function(e){e.options.__langStrings={totara_notification:["error_user_preference_permission","user_preferences_page_title","delivery_preferences"]}},p=Object(k.a)(_,(function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("Layout",{staticClass:"tui-userPreferences",attrs:{title:e.$str("user_preferences_page_title","totara_notification"),loading:e.$apollo.loading},scopedSlots:e._u([e.$apollo.loading?null:{key:"content",fn:function(){return[i("UserPreferencesTable",{staticClass:"tui-userPreferences__table",attrs:{"event-resolvers":e.groupedPreferences},on:{"toggle-enabled":e.saveUserPreference,"update-delivery-preferences":e.handleUpdateDeliveryPreferences}}),e._v(" "),i("ModalPresenter",{attrs:{open:e.deliveryPreferenceModal.open},on:{"request-close":function(n){e.deliveryPreferenceModal.open=!1},"close-complete":e.resetState}},[i("DeliveryPreferenceModal",{attrs:{title:e.$str("delivery_preferences","totara_notification"),"resolver-class-name":e.targetResolverClassName,"resolver-label":e.targetResolverLabel,"default-delivery-channels":e.targetDefaultDeliveryChannels,"show-override":e.showDeliveryChannelsOverride,"initial-override-status":e.OverrideDeliveryChannels},on:{"form-submit":e.handleNotificationPreferenceSubmit}})],1)]},proxy:!0}],null,!0)})}),[],!1,null,null,null);"function"==typeof f&&f(p),p.options.__hasBlocks={script:!0,template:!0};n.default=p.exports},gLvT:function(e,n){e.exports=tui.require("tui/components/dropdown/Dropdown")},hjaT:function(e,n){e.exports=tui.require("tui/components/form/Checkbox")},"i/kK":function(e,n){e.exports=tui.require("tui/components/form/FormRow")},"iJY/":function(e,n,i){"use strict";var a=i("bJcL");i.n(a).a},jv1t:function(e,n,i){"use strict";var a=i("uZjY");i.n(a).a},kMiS:function(e,n,i){"use strict";i.r(n);var a=i("vF5l"),t=i.n(a),r=i("IqB1"),l=i.n(r),d=i("Vwoz"),o=i.n(d),s=i("KGot"),u=i.n(s),c=i("rsf9"),m=i.n(c),v=i("5qAA"),_=i.n(v),k=i("yikf"),f=i.n(k),p=i("PuHf"),b=i.n(p),y=i("Djw7"),N=i.n(y),h=i("lOlL"),g=i.n(h),x=i("e3MU"),F=i.n(x),C={components:{Button:t.a,Collapsible:l.a,CollapsibleGroupToggle:o.a,Cell:u.a,ExpandCell:m.a,HeaderCell:_.a,Table:f.a,NotificationAction:b.a,NotifiableEventAction:N.a,ToggleSwitch:g.a,InfoIconButton:F.a},props:{contextId:{type:Number,required:!0},eventResolvers:{type:Array,default:()=>[],validator:e=>e.every(e=>"component"in e&&"resolvers"in e&&"recipients"in e&&"plugin_name"in e)},showDeliveryPreferenceOption:Boolean},data(){const e=1===this.eventResolvers.length,n={};return e?n[this.eventResolvers[0].component]=!0:this.eventResolvers.forEach(e=>n[e.component]=!1),{singleEventResolver:e,expanded:n}},methods:{display_delivery_channels:e=>e.filter(({is_enabled:e})=>e).map(({label:e})=>e).join("; "),onStatusToggle(e,n){const i={value:e,resolver:n};this.$emit("status-toggle",i)}}},V=(i("GEsA"),i("KHd+")),S=function(e){e.options.__langStrings={totara_notification:["notifiable_events","recipient","schedule","custom","delivery_channels","disable","disabled","delivery_preferences_helptext_aria","default_delivery_preferences_helptext","enabled","enabled_helptext","enabled_helptext_aria","enable_status","factory","inherited","notifications","create_notification","create_notification_for_event","no_notifications","type"],core:["actions","status"]}},D=Object(V.a)(C,(function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("div",[i("CollapsibleGroupToggle",{directives:[{name:"show",rawName:"v-show",value:!e.singleEventResolver,expression:"!singleEventResolver"}],attrs:{"align-end":!1,transparent:!1},model:{value:e.expanded,callback:function(n){e.expanded=n},expression:"expanded"}}),e._v(" "),i("div",{staticClass:"tui-notificationTable",class:{"tui-notificationTable--singleEventResolver":e.singleEventResolver}},e._l(e.eventResolvers,(function(n){return i("Collapsible",{key:n.component,attrs:{label:n.plugin_name,"indent-contents":!e.singleEventResolver},model:{value:e.expanded[n.component],callback:function(i){e.$set(e.expanded,n.component,i)},expression:"expanded[eventResolver.component]"}},[i("Table",{attrs:{data:n.resolvers,"expandable-rows":!0,"expand-multiple-rows":!0,"border-bottom-hidden":!0,"hover-off":!0,"indent-expanded-contents":!0,"stealth-expanded":!0},scopedSlots:e._u([{key:"header-row",fn:function(){return[i("ExpandCell",{attrs:{hidden:!0,header:!0}}),e._v(" "),i("HeaderCell",{attrs:{size:"4"}},[e._v("\n            "+e._s(e.$str("notifiable_events","totara_notification"))+"\n          ")]),e._v(" "),i("HeaderCell",{attrs:{size:"4"}},[i("div",{staticClass:"tui-notificationTable__header"},[e._v("\n              "+e._s(e.$str("delivery_channels","totara_notification"))+"\n              "),i("InfoIconButton",{attrs:{"aria-label":e.$str("delivery_preferences_helptext_aria","totara_notification")}},[e._v("\n                "+e._s(e.$str("default_delivery_preferences_helptext","totara_notification"))+"\n              ")])],1)]),e._v(" "),i("HeaderCell",{attrs:{align:"start",size:"2"}},[i("div",{staticClass:"tui-notificationTable__header"},[e._v("\n              "+e._s(e.$str("enabled","totara_notification"))+"\n              "),i("InfoIconButton",{attrs:{"aria-label":e.$str("enabled_helptext_aria","totara_notification")}},[e._v("\n                "+e._s(e.$str("enabled_helptext","totara_notification"))+"\n              ")])],1)]),e._v(" "),i("HeaderCell",{attrs:{size:"1"}},[i("span",{staticClass:"sr-only"},[e._v("\n              "+e._s(e.$str("actions","core"))+"\n            ")])])]},proxy:!0},{key:"row",fn:function(n){var a=n.expand,t=n.expandState,r=n.row;return[i("ExpandCell",{attrs:{"aria-label":r.name,"expand-state":t},on:{click:function(e){return a()}}}),e._v(" "),i("Cell",{attrs:{size:"4","column-header":e.$str("notifiable_events","totara_notification")}},[e._v("\n            "+e._s(r.name)+"\n          ")]),e._v(" "),i("Cell",{attrs:{size:"4","column-header":e.$str("delivery_channels","totara_notification")}},[e._v("\n            "+e._s(e.display_delivery_channels(r.default_delivery_channels))+"\n          ")]),e._v(" "),i("Cell",{attrs:{align:"start",size:"2","column-header":e.$str("enabled","totara_notification")}},[i("ToggleSwitch",{attrs:{"aria-label":e.$str("enable_status","totara_notification",r.name),value:r.status.is_enabled,"toggle-only":!0},on:{input:function(n){return e.onStatusToggle(n,r)}}})],1),e._v(" "),i("Cell",{attrs:{align:"end",size:"1"}},[i("NotifiableEventAction",{attrs:{"resolver-name":r.name,"show-delivery-preference-option":e.showDeliveryPreferenceOption},on:{"create-custom-notification":function(n){return e.$emit("create-custom-notification",{resolverClassName:r.class_name,scheduleTypes:r.valid_schedules,recipients:r.recipients,deliveryChannels:r.default_delivery_channels,additionalCriteriaComponent:r.additional_criteria_component})},"update-delivery-preferences":function(n){return e.$emit("update-delivery-preferences",{resolverClassName:r.class_name,resolverLabel:r.name,defaultDeliveryChannels:r.default_delivery_channels,additionalCriteriaComponent:r.additional_criteria_component})}}})],1)]}},{key:"expand-content",fn:function(n){var a=n.row;return[a.notification_preferences.length?i("Table",{class:{"tui-notificationTable__subTable":!a.status.is_enabled},attrs:{data:a.notification_preferences,"expandable-rows":!1,"expand-multiple-rows":!0,"hover-off":!0,"get-id":function(e,n){return n},"indent-expanded-contents":!0,"stealth-expanded":!0},scopedSlots:e._u([{key:"header-row",fn:function(){return[i("HeaderCell",{attrs:{align:"start",size:"4"}},[e._v("\n                "+e._s(e.$str("notifications","totara_notification"))+"\n              ")]),e._v(" "),i("HeaderCell",{attrs:{align:"start",size:"4"}},[e._v("\n                "+e._s(e.$str("type","totara_notification"))+"\n              ")]),e._v(" "),i("HeaderCell",{attrs:{align:"start",size:"4"}},[e._v("\n                "+e._s(e.$str("recipient","totara_notification"))+"\n              ")]),e._v(" "),i("HeaderCell",{attrs:{align:"start",size:"3"}},[e._v("\n                "+e._s(e.$str("schedule","totara_notification"))+"\n              ")]),e._v(" "),i("HeaderCell",{attrs:{align:"start",size:"2"}},[e._v("\n                "+e._s(e.$str("status","core"))+"\n              ")]),e._v(" "),i("HeaderCell",{attrs:{size:"1"}},[i("span",{staticClass:"sr-only"},[e._v("\n                  "+e._s(e.$str("actions","core"))+"\n                ")])])]},proxy:!0},{key:"row",fn:function(n){var t=n.row;return[i("Cell",{attrs:{align:"start",size:"4","column-header":e.$str("notifications","totara_notification")}},[e._v("\n                "+e._s(t.title)+"\n              ")]),e._v(" "),i("Cell",{attrs:{align:"start",size:"4","column-header":e.$str("type","totara_notification")}},[t.is_custom&&!t.ancestor_id?[e._v("\n                  "+e._s(e.$str("custom","totara_notification"))+"\n                ")]:t.is_custom||t.ancestor_id?[e._v("\n                  "+e._s(e.$str("inherited","totara_notification"))+"\n                ")]:[e._v("\n                  "+e._s(e.$str("factory","totara_notification"))+"\n                ")]],2),e._v(" "),i("Cell",{attrs:{align:"start",size:"4","column-header":e.$str("recipient","totara_notification")}},[e._v("\n                "+e._s(t.recipient.name)+"\n              ")]),e._v(" "),i("Cell",{attrs:{align:"start",size:"3","column-header":e.$str("schedule","totara_notification")}},[e._v("\n                "+e._s(t.schedule_label)+"\n              ")]),e._v(" "),i("Cell",{attrs:{align:"start",size:"2","column-header":e.$str("status","core")}},[a.status.is_enabled?[t.enabled?[e._v("\n                    "+e._s(e.$str("enabled","totara_notification"))+"\n                  ")]:e._e(),e._v(" "),t.enabled?e._e():[e._v("\n                    "+e._s(e.$str("disabled","totara_notification"))+"\n                  ")]]:[t.enabled?[i("del",[e._v(e._s(e.$str("enabled","totara_notification")))])]:e._e(),e._v(" "),t.enabled?e._e():[i("del",[e._v(e._s(e.$str("disabled","totara_notification")))])]]],2),e._v(" "),i("Cell",{attrs:{align:"end",size:"1"}},[i("NotificationAction",{attrs:{"preference-title":t.title,"is-deletable":t.is_custom&&null==t.parent_id},on:{"edit-notification":function(n){return e.$emit("edit-notification",t,a.valid_schedules,a.recipients,a.default_delivery_channels,a.additional_criteria_component)},"delete-notification":function(n){return e.$emit("delete-notification",t)}}})],1)]}}],null,!0)}):[e._v("\n            "+e._s(e.$str("no_notifications","totara_notification"))+"\n\n            "),i("Button",{attrs:{text:e.$str("create_notification","totara_notification"),"aria-label":e.$str("create_notification_for_event","totara_notification",a.name)},on:{click:function(n){return e.$emit("create-custom-notification",{resolverClassName:a.class_name,scheduleTypes:a.valid_schedules,recipients:a.recipients,deliveryChannels:a.default_delivery_channels,additionalCriteriaComponent:a.additional_criteria_component})}}})]]}}],null,!0)})],1)})),1)],1)}),[],!1,null,null,null);"function"==typeof S&&S(D),D.options.__hasBlocks={script:!0,template:!0};n.default=D.exports},klUK:function(e,n,i){"use strict";i.r(n);var a=i("gLvT"),t=i.n(a),r=i("KGcv"),l=i.n(r),d=i("tNJr"),o=i.n(d),s={components:{DropdownItem:l.a,Dropdown:t.a,MoreIcon:o.a},props:{resolverName:{type:String,required:!0},showDeliveryPreferenceOption:Boolean,showCreateNotificationOption:{type:Boolean,default:!0}}},u=(i("qAwj"),i("KHd+")),c=function(e){e.options.__langStrings={totara_notification:["actions_for_event","create_notification","create_notification_for_event","edit_delivery_preferences","delivery_preferences_for_event"]}},m=Object(u.a)(s,(function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("div",{staticClass:"tui-notifiableEventAction"},[i("Dropdown",{scopedSlots:e._u([{key:"trigger",fn:function(n){var a=n.toggle,t=n.isOpen;return[i("MoreIcon",{attrs:{"aria-expanded":t?"true":"false","aria-label":e.$str("actions_for_event","totara_notification",e.resolverName),"no-padding":!0,size:300},on:{click:a}})]}}])},[e._v(" "),e.showCreateNotificationOption?i("DropdownItem",{attrs:{"aria-label":e.$str("create_notification_for_event","totara_notification",e.resolverName)},on:{click:function(n){return e.$emit("create-custom-notification")}}},[e._v("\n      "+e._s(e.$str("create_notification","totara_notification"))+"\n    ")]):e._e(),e._v(" "),e.showDeliveryPreferenceOption?i("DropdownItem",{attrs:{"aria-label":e.$str("delivery_preferences_for_event","totara_notification",e.resolverName)},on:{click:function(n){return e.$emit("update-delivery-preferences")}}},[e._v("\n      "+e._s(e.$str("edit_delivery_preferences","totara_notification"))+"\n    ")]):e._e()],1)],1)}),[],!1,null,null,null);"function"==typeof c&&c(m),m.options.__hasBlocks={script:!0,template:!0};n.default=m.exports},lKDV:function(e,n,i){},lOlL:function(e,n){e.exports=tui.require("tui/components/toggle/ToggleSwitch")},nEm4:function(e,n){e.exports=tui.require("tui/components/form/Form")},nXMa:function(e,n){e.exports=tui.require("tui/components/buttons/Cancel")},oMyG:function(e,n){e.exports=tui.require("totara_notification/components/modal/NotificationPreferenceModal")},oOjY:function(e,n,i){"use strict";i.r(n);var a=i("WBvU"),t=i("i/kK"),r=i.n(t),l=i("VX2K"),d=i.n(l),o=i("UbXC"),s=i.n(o),u=i("dB5e"),c=i("UMYj"),m=i.n(c),v=i("BN8m"),_=i.n(v),k=i("vF5l"),f=i.n(k),p=i("nXMa"),b=i.n(p),y=i("Tdxx"),N=i("XaQC"),h=i.n(N),g=i("hjaT"),x=i.n(g),F={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_notification_validate_notification_preference_input"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"body"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"title"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subject"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"schedule_type"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"schedule_offset"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"result"},name:{kind:"Name",value:"totara_notification_validate_notification_preference_input"},arguments:[{kind:"Argument",name:{kind:"Name",value:"title"},value:{kind:"Variable",name:{kind:"Name",value:"title"}}},{kind:"Argument",name:{kind:"Name",value:"subject"},value:{kind:"Variable",name:{kind:"Name",value:"subject"}}},{kind:"Argument",name:{kind:"Name",value:"body"},value:{kind:"Variable",name:{kind:"Name",value:"body"}}},{kind:"Argument",name:{kind:"Name",value:"schedule_type"},value:{kind:"Variable",name:{kind:"Name",value:"schedule_type"}}},{kind:"Argument",name:{kind:"Name",value:"schedule_offset"},value:{kind:"Variable",name:{kind:"Name",value:"schedule_offset"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"field_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"error_message"},arguments:[],directives:[]}]}}]}}]};function C(e,n,i){const a={subject:{value:void 0,type:u.EditorContent},body:{value:void 0,type:u.EditorContent},title:{value:n&&n.title?n.title:e.title,type:"text"},additional_criteria:!n||e.overridden_additional_criteria?e.additional_criteria?JSON.parse(e.additional_criteria):null:n.additional_criteria?JSON.parse(n.additional_criteria):null,schedule_type:{value:!n||e.overridden_schedule?e.schedule_type:n.schedule_type,type:"text"},schedule_offset:{[y.a.BEFORE_EVENT]:1,[y.a.AFTER_EVENT]:1,[y.a.ON_EVENT]:0,type:"number"},recipient:!n||e.overridden_recipient?e.recipient?e.recipient.class_name:null:n.recipient?n.recipient.class_name:null,enabled:{value:!n||e.overridden_enabled?e.enabled:n.enabled},forced_delivery_channels:{value:!n||e.forced_delivery_channels?e.forced_delivery_channels:n.forced_delivery_channels||[],type:"array"}};a.schedule_type.value!==y.a.ON_EVENT&&(a.schedule_offset[a.schedule_type.value]=null===n||e.overridden_schedule?e.schedule_offset:n.schedule_offset);let t=i,r=i;return!n||e.overridden_subject?(null!==e.subject_format&&(r=e.subject_format),a.subject.value=new u.EditorContent({format:r,content:e.subject})):(null!==n.subject_format&&(r=n.subject_format),a.subject.value=new u.EditorContent({format:r,content:n.subject})),!n||e.overridden_body?(null!==e.body_format&&(t=e.body_format),a.body.value=new u.EditorContent({format:t,content:e.body})):(null!==n.body_format&&(t=n.body_format),a.body.value=new u.EditorContent({format:t,content:n.body})),a}var V={components:{Uniform:a.Uniform,FormCheckbox:a.FormCheckbox,FormField:a.FormField,FormRow:r.a,FormScope:a.FormScope,FormText:a.FormText,Editor:m.a,ButtonGroup:_.a,Button:f.a,Cancel:b.a,FormRadioGroup:a.FormRadioGroup,Radio:d.a,RadioNumberInput:s.a,FormRadioWithInput:a.FormRadioWithInput,FormSelect:a.FormSelect,ForceDeliveryChannels:h.a,Checkbox:x.a},props:{resolverClassName:{type:String,required:!0},contextId:{type:Number,required:!0},extendedContext:{type:Object,required:!1},parentValue:{type:Object,validator:Object(y.e)(),default:()=>null},preference:{type:Object,validator:Object(y.e)(["body_content","subject_content"]),default:Object(y.b)({body_content:"",subject_content:""})},validScheduleTypes:{type:Array,required:!0},availableRecipients:{type:Array,required:!0,validator:Object(y.c)()},defaultDeliveryChannels:{type:Array,required:!0,validator:Object(y.d)()},additionalCriteriaComponent:{type:String},preferredEditorFormat:Number},data(){return{customisation:{additional_criteria:this.preference.overridden_additional_criteria||Boolean(!this.parentValue),body:this.preference.overridden_body||Boolean(!this.parentValue),subject:this.preference.overridden_subject||Boolean(!this.parentValue),schedule:this.preference.overridden_schedule||Boolean(!this.parentValue),recipient:this.preference.overridden_recipient||Boolean(!this.parentValue),enabled:this.preference.overridden_enabled||Boolean(!this.parentValue),forcedDeliveryChannels:this.preference.overridden_forced_delivery_channels||Boolean(!this.parentValue)},errors:null,formInitialValues:C(this.preference,this.parentValue,this.preferredEditorFormat),saving:!1,scheduleTypes:y.a}},computed:{hasAdditionalCriteriaComponent(){return this.additionalCriteriaComponent&&""!==this.additionalCriteriaComponent},additionalCriteriaComponentResolved(){return tui.asyncComponent(this.additionalCriteriaComponent)},disableTitleField(){return!!this.parentValue&&(this.parentValue.title&&""!==this.parentValue.title)},requiredSubject(){return!this.parentValue||(!this.parentValue.subject||""===this.parentValue.subject)},requiredBody(){return!this.parentValue||(!this.parentValue.body||""===this.parentValue.body)},showCustomCheckBoxes(){return!!this.parentValue},showScheduleOnEvent(){return this.validScheduleTypes.indexOf(y.a.ON_EVENT)>=0},showScheduleBeforeEvent(){return this.validScheduleTypes.indexOf(y.a.BEFORE_EVENT)>=0},showScheduleAfterEvent(){return this.validScheduleTypes.indexOf(y.a.AFTER_EVENT)>=0},recipientOptions(){const e=this.availableRecipients.map(e=>({id:e.class_name,label:e.name}));return this.preference.recipient?e:[{id:null,label:this.$str("create_notification_select_placeholder","totara_notification")}].concat(e)}},watch:{customisation:{deep:!0,handler(e){if(!this.showCustomCheckBoxes||!this.$refs.preferenceForm)return;if(!this.parentValue)throw new Error("Cannot toggle the customisation when the parent preference is not passed down to the form");const{preferenceForm:n}=this.$refs;e.additional_criteria||n.update(["additional_criteria"],this.parentValue.additional_criteria?JSON.parse(this.parentValue.additional_criteria):null),e.recipient||n.update(["recipient"],this.parentValue.recipient.class_name),e.schedule||(n.update(["schedule_type","value"],this.parentValue.schedule_type),this.parentValue.schedule_type!=this.scheduleTypes.ON_EVENT&&n.update(["schedule_offset",this.parentValue.schedule_type],this.parentValue.schedule_offset)),e.subject||n.update(["subject","value"],new u.EditorContent({content:this.parentValue.subject,format:this.parentValue.subject_format?this.parentValue.subject_format:this.formInitialValues.subject.value.format})),e.body||n.update(["body","value"],new u.EditorContent({content:this.parentValue.body,format:this.parentValue.body_format?this.parentValue.body_format:this.formInitialValues.body.value.format})),e.forcedDeliveryChannels||n.update(["forced_delivery_channels","value"],this.parentValue.forced_delivery_channels||[]),e.enabled||n.update(["enabled","value"],this.parentValue.enabled)}}},methods:{validateBodyEditor(e){return this.requiredBody&&(!e||e.isEmpty)?this.$str("required","core"):""},validateSubjectEditor(e){return this.requiredSubject&&(!e||e.isEmpty)?this.$str("required","core"):""},async submitForm(e){this.saving=!0,this.errors||(this.errors=null);const{data:{result:n}}=await this.$apollo.mutate({mutation:F,variables:{title:e.title.value||"",subject:e.subject.value.getContent()||"",body:e.body.value.getContent()||"",schedule_type:e.schedule_type.value||"",schedule_offset:e.schedule_offset[e.schedule_type.value]||0}});if(n.length)return this.errors={},n.forEach(({field_name:e,error_message:n})=>{this.errors[e]={value:n}}),void(this.saving=!1);const i={title:e.title.value,additional_criteria:this.customisation.additional_criteria?JSON.stringify(e.additional_criteria):null,subject:this.customisation.subject?e.subject.value.getContent():null,subject_format:this.customisation.subject?e.subject.value.format:null,body:this.customisation.body?e.body.value.getContent():null,body_format:this.customisation.body?e.body.value.format:null,schedule_type:this.customisation.schedule?e.schedule_type.value:null,schedule_offset:this.customisation.schedule?e.schedule_offset[e.schedule_type.value]:null,recipient:this.customisation.recipient?e.recipient:null,enabled:this.customisation.enabled?e.enabled.value:null,forced_delivery_channels:this.customisation.forcedDeliveryChannels?e.forced_delivery_channels.value:null};this.$emit("submit",i)},updateBodyEditor(e,n){this.errors&&this.errors.body&&(this.errors.body.value=""),n(e)},updateSchedule(e,n=null){this.errors&&this.errors.schedule_type&&(this.errors.schedule_type.value=""),n&&n(e)},updateSubjectEditor(e,n){this.errors&&this.errors.subject&&(this.errors.subject.value=""),n(e)},resetErrorFieldTitle(){this.errors&&this.errors.title&&(this.errors.title.value="")}}},S=(i("iJY/"),i("KHd+")),D=function(e){e.options.__langStrings={totara_notification:["create_notification_select_placeholder","delivery_label","enable_custom_additional_criteria","enable_custom_body","enable_custom_forced_delivery_channels","enable_custom_recipient","enable_custom_schedule","enable_custom_status","enable_custom_subject","notification_body_label","notification_body_label_help","notification_schedule_label","notification_status_label","notification_subject_label","notification_subject_label_help","notification_title_label","override","recipient","schedule_form_label_after_event","schedule_form_label_before_event","schedule_form_label_on_event","schedule_label_after_event","schedule_label_before_event"],totara_core:["enabled","save"],core:["required"]}},T=Object(S.a)(V,(function(){var e=this,n=e.$createElement,i=e._self._c||n;return e.formInitialValues?i("Uniform",{ref:"preferenceForm",staticClass:"tui-notificationPreferenceForm",attrs:{"initial-values":e.formInitialValues,errors:e.errors,"input-width":"full"},on:{submit:e.submitForm}},[i("FormRow",{attrs:{label:e.$str("notification_title_label","totara_notification"),required:!e.parentValue||!e.parentValue.title||""===e.parentValue.title},scopedSlots:e._u([{key:"default",fn:function(n){var a=n.id;return[i("FormText",{attrs:{id:a,name:["title","value"],disabled:e.disableTitleField,validations:function(e){return[e.required()]}},on:{input:e.resetErrorFieldTitle}})]}}],null,!1,2380982492)}),e._v(" "),i("FormScope",{attrs:{path:"additional_criteria"}},[e.hasAdditionalCriteriaComponent?i("div",[e.showCustomCheckBoxes?i("FormRow",{staticClass:"tui-notificationPreferenceForm__additionalCriteria-checkbox",attrs:{required:!1}},[i("Checkbox",{attrs:{"aria-label":e.$str("enable_custom_additional_criteria","totara_notification"),checked:e.customisation.additional_criteria,value:e.customisation.additional_criteria?"1":"0",name:"override_additional_criteria"},on:{change:function(n){e.customisation.additional_criteria=n}}},[e._v("\n          "+e._s(e.$str("override","totara_notification"))+"\n        ")])],1):e._e(),e._v(" "),i(e.additionalCriteriaComponentResolved,{tag:"component",attrs:{disabled:e.showCustomCheckBoxes&&!e.customisation.additional_criteria,"context-id":e.contextId,"extended-context":e.extendedContext}})],1):e._e()]),e._v(" "),i("FormRow",{attrs:{label:e.$str("recipient","totara_notification"),required:!e.parentValue},scopedSlots:e._u([{key:"default",fn:function(n){var a=n.id;return[e.showCustomCheckBoxes?i("Checkbox",{attrs:{"aria-label":e.$str("enable_custom_recipient","totara_notification"),checked:e.customisation.recipient,value:e.customisation.recipient?"1":"0",name:"override_recipient"},on:{change:function(n){e.customisation.recipient=n}}},[e._v("\n        "+e._s(e.$str("override","totara_notification"))+"\n      ")]):e._e(),e._v(" "),i("FormSelect",{attrs:{"aria-labelledby":a,name:"recipient",options:e.recipientOptions,disabled:e.showCustomCheckBoxes&&!e.customisation.recipient,validations:function(e){return[e.required()]}}})]}}],null,!1,1464634843)}),e._v(" "),i("FormRow",{attrs:{label:e.$str("notification_schedule_label","totara_notification"),required:!e.parentValue},scopedSlots:e._u([{key:"default",fn:function(n){var a=n.id;return[e.showCustomCheckBoxes?i("Checkbox",{attrs:{"aria-label":e.$str("enable_custom_schedule","totara_notification"),checked:e.customisation.schedule,value:e.customisation.schedule?"1":"0",name:"override_schedule"},on:{change:function(n){e.customisation.schedule=n}}},[e._v("\n        "+e._s(e.$str("override","totara_notification"))+"\n      ")]):e._e(),e._v(" "),i("FormRadioGroup",{attrs:{"aria-labelledby":a,disabled:e.showCustomCheckBoxes&&!e.customisation.schedule,validations:function(e){return[e.required()]},name:["schedule_type","value"]},on:{input:function(n){return e.updateSchedule(n)}}},[e.showScheduleOnEvent?i("Radio",{attrs:{value:e.scheduleTypes.ON_EVENT}},[e._v("\n          "+e._s(e.$str("schedule_form_label_on_event","totara_notification"))+"\n        ")]):e._e(),e._v(" "),e.showScheduleBeforeEvent?i("FormRadioWithInput",{attrs:{disabled:e.showCustomCheckBoxes&&!e.customisation.schedule,name:["schedule_offset",e.scheduleTypes.BEFORE_EVENT],value:e.scheduleTypes.BEFORE_EVENT,text:e.$str("schedule_form_label_before_event","totara_notification")},scopedSlots:e._u([{key:"default",fn:function(n){var a=n.disabledRadio,t=n.nameLabel,r=n.setAccessibleLabel,l=n.update,d=n.value;return[i("RadioNumberInput",{attrs:{disabled:a,name:t,value:d},on:{input:function(n){return e.updateSchedule(n,l)},"accessible-change":function(n){return r(e.$str("schedule_label_before_event","totara_notification",n))}}})]}}],null,!0)}):e._e(),e._v(" "),e.showScheduleAfterEvent?i("FormRadioWithInput",{attrs:{disabled:e.showCustomCheckBoxes&&!e.customisation.schedule,name:["schedule_offset",e.scheduleTypes.AFTER_EVENT],value:e.scheduleTypes.AFTER_EVENT,text:e.$str("schedule_form_label_after_event","totara_notification")},scopedSlots:e._u([{key:"default",fn:function(n){var a=n.disabledRadio,t=n.nameLabel,r=n.setAccessibleLabel,l=n.update,d=n.value;return[i("RadioNumberInput",{attrs:{disabled:a,name:t,value:d},on:{input:function(n){return e.updateSchedule(n,l)},"accessible-change":function(n){return r(e.$str("schedule_label_after_event","totara_notification",n))}}})]}}],null,!0)}):e._e()],1)]}}],null,!1,3026575372)}),e._v(" "),i("FormRow",{attrs:{label:e.$str("delivery_label","totara_notification")},scopedSlots:e._u([{key:"default",fn:function(n){var a=n.id;return[e.showCustomCheckBoxes?i("Checkbox",{attrs:{value:e.customisation.forcedDeliveryChannels?"1":"0",name:"override_forced_delivery_channels",checked:e.customisation.forcedDeliveryChannels,"aria-label":e.$str("enable_custom_forced_delivery_channels","totara_notification")},on:{change:function(n){e.customisation.forcedDeliveryChannels=n}}},[e._v("\n        "+e._s(e.$str("override","totara_notification"))+"\n      ")]):e._e(),e._v(" "),i("FormField",{attrs:{name:["forced_delivery_channels","value"]},scopedSlots:e._u([{key:"default",fn:function(n){var t=n.value,r=n.update;return[i("ForceDeliveryChannels",{attrs:{"aria-labelledby":a,"default-delivery-channels":e.defaultDeliveryChannels,"forced-delivery-channels":t,disabled:e.showCustomCheckBoxes&&!e.customisation.forcedDeliveryChannels},on:{"update-forced-delivery-channels":r}})]}}],null,!0)})]}}],null,!1,4152754183)}),e._v(" "),i("FormRow",{attrs:{label:e.$str("notification_subject_label","totara_notification"),required:e.requiredSubject,helpmsg:e.$str("notification_subject_label_help","totara_notification")},scopedSlots:e._u([{key:"default",fn:function(n){var a=n.id;return[e.showCustomCheckBoxes?i("Checkbox",{attrs:{"aria-label":e.$str("enable_custom_subject","totara_notification"),checked:e.customisation.subject,value:e.customisation.subject?"1":"0",name:"override_subject"},on:{change:function(n){e.customisation.subject=n}}},[e._v("\n        "+e._s(e.$str("override","totara_notification"))+"\n      ")]):e._e(),e._v(" "),i("FormField",{attrs:{name:["subject","value"],validate:e.validateSubjectEditor,disabled:e.showCustomCheckBoxes&&!e.customisation.subject,"char-length":"full"},scopedSlots:e._u([{key:"default",fn:function(n){var t=n.value,r=n.update;return[i("Editor",{staticClass:"tui-notificationPreferenceForm__subjectEditor",attrs:{id:a,disabled:!e.customisation.subject,value:t,"context-id":e.contextId,"usage-identifier":{component:"totara_notification",area:"notification_subject"},"extra-extensions":[{name:"weka_notification_placeholder_extension",options:{resolver_class_name:e.resolverClassName}},{name:"weka_simple_multi_lang_extension",options:{context_id:e.contextId,placeholder_resolver_class_name:e.resolverClassName,compact:!0}}],variant:"simple",compact:!0},on:{input:function(n){return e.updateSubjectEditor(n,r)}}})]}}],null,!0)})]}}],null,!1,81289284)}),e._v(" "),i("FormRow",{attrs:{required:e.requiredBody,label:e.$str("notification_body_label","totara_notification"),helpmsg:e.$str("notification_body_label_help","totara_notification")},scopedSlots:e._u([{key:"default",fn:function(n){var a=n.id;return[e.showCustomCheckBoxes?i("Checkbox",{attrs:{"aria-label":e.$str("enable_custom_body","totara_notification"),checked:e.customisation.body,value:e.customisation.body?"1":"0",name:"override_body"},on:{change:function(n){e.customisation.body=n}}},[e._v("\n        "+e._s(e.$str("override","totara_notification"))+"\n      ")]):e._e(),e._v(" "),i("FormField",{attrs:{name:["body","value"],validate:e.validateBodyEditor,disabled:e.showCustomCheckBoxes&&!e.customisation.body,"char-length":"full"},scopedSlots:e._u([{key:"default",fn:function(n){var t=n.value,r=n.update;return[i("Editor",{staticClass:"tui-notificationPreferenceForm__bodyEditor",attrs:{id:a,value:t,"context-id":e.contextId,disabled:!e.customisation.body,"usage-identifier":{component:"totara_notification",area:"notification_body"},"extra-extensions":[{name:"weka_notification_placeholder_extension",options:{resolver_class_name:e.resolverClassName}},{name:"weka_simple_multi_lang_extension",options:{context_id:e.contextId,placeholder_resolver_class_name:e.resolverClassName}}],variant:"description"},on:{input:function(n){return e.updateBodyEditor(n,r)}}})]}}],null,!0)})]}}],null,!1,3515353798)}),e._v(" "),i("FormRow",{attrs:{label:e.$str("notification_status_label","totara_notification")},scopedSlots:e._u([{key:"default",fn:function(n){var a=n.id;return[e.showCustomCheckBoxes?i("Checkbox",{attrs:{"aria-label":e.$str("enable_custom_status","totara_notification"),checked:e.customisation.enabled,value:e.customisation.enabled?"1":"0",name:"override_enabled"},on:{change:function(n){e.customisation.enabled=n}}},[e._v("\n      "+e._s(e.$str("override","totara_notification"))+"\n    ")]):e._e(),e._v(" "),i("FormCheckbox",{attrs:{id:a,name:["enabled","value"],disabled:e.showCustomCheckBoxes&&!e.customisation.enabled}},[e._v("\n      "+e._s(e.$str("enabled","totara_core"))+"\n    ")])]}}],null,!1,1474882410)}),e._v(" "),i("FormRow",[i("ButtonGroup",{staticClass:"tui-notificationPreferenceForm__buttonGroup"},[i("Button",{attrs:{styleclass:{primary:!0},text:e.$str("save","totara_core"),"aria-label":e.$str("save","totara_core"),loading:e.saving,type:"submit"}}),e._v(" "),i("Cancel",{attrs:{disabled:e.saving},on:{click:function(n){return e.$emit("cancel")}}})],1)],1)],1):e._e()}),[],!1,null,null,null);"function"==typeof D&&D(T),T.options.__hasBlocks={script:!0,template:!0};n.default=T.exports},pAKS:function(e,n,i){},qAwj:function(e,n,i){"use strict";var a=i("pAKS");i.n(a).a},rsf9:function(e,n){e.exports=tui.require("tui/components/datatable/ExpandCell")},sUqY:function(e,n,i){"use strict";i.r(n);var a=i("yikf"),t=i.n(a),r=i("5qAA"),l=i.n(r),d=i("KGot"),o=i.n(d),s=i("Tdxx"),u=i("JThd"),c=i.n(u),m=i("hjaT"),v=i.n(m),_=i("e3MU"),k=i.n(_),f={components:{Table:t.a,HeaderCell:l.a,Cell:o.a,CheckSuccess:c.a,Checkbox:v.a,InfoIconButton:k.a},props:{disabled:Boolean,defaultDeliveryChannels:{type:Array,required:!0,validator:Object(s.d)()},forcedDeliveryChannels:{type:Array,default:()=>[],validator:e=>e.every(e=>"string"==typeof e)}},methods:{isForced({component:e}){return!!this.forcedDeliveryChannels.find(n=>e===n)},isChannelAvailable(e){if(!e)return!0;const n=this.defaultDeliveryChannels.find(({component:n})=>n===e);return!n||(n.is_enabled||this.isForced({component:e}))},updateForceDeliveryChannels(e,n){const i=this.forcedDeliveryChannels;if(n){return i.find(n=>e===n)?void this.$emit("update-forced-delivery-channels",i):void this.$emit("update-forced-delivery-channels",i.concat([e]))}this.$emit("update-forced-delivery-channels",i.filter(n=>n!==e))}}},p=(i("DkAd"),i("KHd+")),b=function(e){e.options.__langStrings={totara_notification:["delivery_channel","force_channel_x","forced","forced_info","forced_delivery_help"],core:["default","notavailable"]}},y=Object(p.a)(f,(function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("Table",{staticClass:"tui-forceDeliveryChannels",attrs:{data:e.defaultDeliveryChannels,"stack-at":350},scopedSlots:e._u([{key:"header-row",fn:function(){return[i("HeaderCell",[e._v("\n      "+e._s(e.$str("delivery_channel","totara_notification"))+"\n    ")]),e._v(" "),i("HeaderCell",{attrs:{align:"center"}},[e._v("\n      "+e._s(e.$str("default","core"))+"\n    ")]),e._v(" "),i("HeaderCell",{attrs:{align:"center"}},[i("div",{staticClass:"tui-forceDeliveryChannels__forcedHeader"},[e._v("\n        "+e._s(e.$str("forced","totara_notification"))+"\n        "),i("InfoIconButton",{attrs:{"aria-label":e.$str("forced_info","totara_notification")}},[e._v("\n          "+e._s(e.$str("forced_delivery_help","totara_notification"))+"\n        ")])],1)])]},proxy:!0},{key:"row",fn:function(n){var a=n.row,t=a.label,r=a.is_enabled,l=a.component,d=a.is_sub_delivery_channel,o=a.parent_component;return[i("Cell",[e._v("\n      "+e._s(t)+"\n    ")]),e._v(" "),i("Cell",{attrs:{align:"center","column-header":e.$str("default","core")}},[r?i("CheckSuccess"):e._e()],1),e._v(" "),i("Cell",{attrs:{align:"center","column-header":e.$str("forced","totara_notification")}},[!d||e.isChannelAvailable(o)?[i("Checkbox",{attrs:{value:l,checked:e.isForced({component:l}),"aria-label":e.$str("force_channel_x","totara_notification",t),disabled:e.disabled,name:"force_"+l},on:{change:function(n){return e.updateForceDeliveryChannels(l,n)}}})]:[e._v("\n        "+e._s(e.$str("notavailable","core"))+"\n      ")]],2)]}}])})}),[],!1,null,null,null);"function"==typeof b&&b(y),y.options.__hasBlocks={script:!0,template:!0};n.default=y.exports},tNJr:function(e,n){e.exports=tui.require("tui/components/buttons/MoreIcon")},tZ6d:function(e,n,i){"use strict";var a=i("NN9N");i.n(a).a},tg4Y:function(e,n,i){"use strict";i.r(n);var a=i("KGot"),t=i.n(a),r=i("5qAA"),l=i.n(r),d=i("yikf"),o=i.n(d),s=i("hjaT"),u=i.n(s),c=i("nEm4"),m=i.n(c),v=i("i/kK"),_=i.n(v),k=i("BN8m"),f=i.n(k),p=i("vF5l"),b=i.n(p),y=i("nXMa"),N=i.n(y),h=i("e3MU"),g=i.n(h),x=i("Tdxx");function F(e){const n={};return e.map(({component:e,is_enabled:i})=>{n[e]=i}),n}var C={components:{Table:o.a,HeaderCell:l.a,Cell:t.a,Checkbox:u.a,Form:m.a,FormRow:_.a,ButtonGroup:f.a,Button:b.a,Cancel:N.a,InfoIconButton:g.a},props:{defaultDeliveryChannels:{type:Array,required:!0,validator:Object(x.d)()},showOverride:Boolean,initialOverrideStatus:Boolean},data(){return{deliveryChannels:F(this.defaultDeliveryChannels),isCheckboxDisabled:this.selectionsDisabled(),isDeliveryPreferenceOverridden:this.initialOverrideStatus}},watch:{isDeliveryPreferenceOverridden(){this.isCheckboxDisabled=this.selectionsDisabled()}},methods:{handleFormSubmit(){const e=[];for(const n in this.deliveryChannels)this.deliveryChannels[n]&&e.push(n);this.$emit("form-submit",e,this.showOverride?this.isDeliveryPreferenceOverridden:null)},selectionsDisabled(){return!(!this.showOverride||(void 0!==this.isDeliveryPreferenceOverridden||this.initialOverrideStatus)&&(void 0===this.isDeliveryPreferenceOverridden||this.isDeliveryPreferenceOverridden))},overrideDeliveryPreference(e){this.isDeliveryPreferenceOverridden=e}}},V=(i("3qs6"),i("KHd+")),S=function(e){e.options.__langStrings={totara_notification:["delivery_preferences_helptext","delivery_preferences_helptext_aria","notification_delivery_channels_label","unavailable","delivery_preferences_override_helptext","delivery_preferences_override_helptext_aria","override","override_delivery_channels_aria"],totara_core:["save"],core:["required"]}},D=Object(V.a)(C,(function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("Form",{staticClass:"tui-notificationDeliveryPreferenceForm",on:{submit:e.handleFormSubmit}},[e.showOverride?i("div",{staticClass:"tui-notificationDeliveryPreferenceForm__overrideWrapper"},[i("Checkbox",{attrs:{"aria-label":e.$str("override_delivery_channels_aria","totara_notification"),checked:e.isDeliveryPreferenceOverridden,value:e.isDeliveryPreferenceOverridden?"1":"0",name:"override_delivery_preferences"},on:{change:e.overrideDeliveryPreference}},[e._v("\n      "+e._s(e.$str("override","totara_notification"))+"\n    ")]),e._v(" "),i("InfoIconButton",{attrs:{"aria-label":e.$str("delivery_preferences_override_helptext_aria","totara_notification")}},[e._v("\n      "+e._s(e.$str("delivery_preferences_override_helptext","totara_notification"))+"\n    ")])],1):e._e(),e._v(" "),i("Table",{attrs:{data:e.defaultDeliveryChannels,"expandable-rows":!0},scopedSlots:e._u([{key:"header-row",fn:function(){return[i("HeaderCell",{attrs:{size:"3"}},[e._v("\n        "+e._s(e.$str("notification_delivery_channels_label","totara_notification"))+"\n        "),e.showOverride?e._e():i("InfoIconButton",{attrs:{"aria-label":e.$str("delivery_preferences_helptext_aria","totara_notification")}},[e._v("\n          "+e._s(e.$str("delivery_preferences_helptext","totara_notification"))+"\n        ")])],1)]},proxy:!0},{key:"row",fn:function(n){var a=n.row;return[i("Cell",{attrs:{size:"3"}},[e._v("\n        "+e._s(a.label)+"\n      ")]),e._v(" "),i("Cell",[!a.parent_component||e.deliveryChannels[a.parent_component]?i("Checkbox",{attrs:{"aria-label":a.label,disabled:e.isCheckboxDisabled,name:"default_"+a.component},model:{value:e.deliveryChannels[a.component],callback:function(n){e.$set(e.deliveryChannels,a.component,n)},expression:"deliveryChannels[row.component]"}}):[e._v("\n          "+e._s(e.$str("unavailable","totara_notification"))+"\n        ")]],2)]}}])}),e._v(" "),i("FormRow",[i("ButtonGroup",{staticClass:"tui-notificationPreferenceForm__buttonGroup"},[i("Button",{attrs:{styleclass:{primary:!0},text:e.$str("save","totara_core"),type:"submit"}}),e._v(" "),i("Cancel",{on:{click:function(n){return e.$emit("cancel")}}})],1)],1)],1)}),[],!1,null,null,null);"function"==typeof S&&S(D),D.options.__hasBlocks={script:!0,template:!0};n.default=D.exports},tkAW:function(e,n){e.exports=tui.require("tui/components/modal/Modal")},tzWU:function(e,n,i){"use strict";i.r(n);var a=i("IqB1"),t=i.n(a),r=i("Vwoz"),l=i.n(r),d=i("KGot"),o=i.n(d),s=i("5qAA"),u=i.n(s),c=i("yikf"),m=i.n(c),v=i("lOlL"),_=i.n(v),k=i("Djw7"),f=i.n(k),p={components:{Collapsible:t.a,CollapsibleGroupToggle:l.a,Cell:o.a,HeaderCell:u.a,Table:m.a,ToggleSwitch:_.a,NotifiableEventAction:f.a},props:{eventResolvers:{type:Array,default:()=>[],validator:e=>e.every(e=>"component"in e&&"plugin_name"in e&&"resolvers"in e)}},data:()=>({expanded:{}}),created(){const e={};this.eventResolvers.forEach(n=>e[n.component]=!1),this.expanded=e},methods:{toggleEnabled(e,n){this.$emit("toggle-enabled",{userId:n.user_id,resolverClassname:n.resolver_class_name,isEnabled:e,userPreferenceId:n.user_preference_id})},display_delivery_channels:e=>e.filter(({is_enabled:e})=>e).map(({label:e})=>e).join("; "),updateDeliveryPreference(e){this.$emit("update-delivery-preferences",{resolverClassName:e.resolver_class_name,resolverLabel:e.name,defaultDeliveryChannels:e.delivery_channels,OverrideDeliveryChannels:e.overridden_delivery_channels,userPreferenceId:e.user_preference_id})}}},b=(i("jv1t"),i("KHd+")),y=function(e){e.options.__langStrings={totara_notification:["delivery_channels","enabled","enable_status","notifiable_events"],core:["actions"]}},N=Object(b.a)(p,(function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("div",[i("CollapsibleGroupToggle",{attrs:{"align-end":!1,transparent:!1},model:{value:e.expanded,callback:function(n){e.expanded=n},expression:"expanded"}}),e._v(" "),i("div",{staticClass:"tui-userPreferencesTable"},e._l(e.eventResolvers,(function(n){return i("Collapsible",{key:n.component,attrs:{label:n.plugin_name,"indent-contents":!0},model:{value:e.expanded[n.component],callback:function(i){e.$set(e.expanded,n.component,i)},expression:"expanded[eventResolver.component]"}},[i("Table",{attrs:{data:n.resolvers,"expandable-rows":!0,"hover-off":!0},scopedSlots:e._u([{key:"header-row",fn:function(){return[i("HeaderCell",{attrs:{size:"4"}},[e._v("\n            "+e._s(e.$str("notifiable_events","totara_notification"))+"\n          ")]),e._v(" "),i("HeaderCell",{attrs:{size:"4"}},[e._v("\n            "+e._s(e.$str("delivery_channels","totara_notification"))+"\n          ")]),e._v(" "),i("HeaderCell",{attrs:{align:"start",size:"2"}},[e._v("\n            "+e._s(e.$str("enabled","totara_notification"))+"\n          ")]),e._v(" "),i("HeaderCell",[i("span",{staticClass:"sr-only"},[e._v("\n              "+e._s(e.$str("actions","core"))+"\n            ")])])]},proxy:!0},{key:"row",fn:function(n){var a=n.row;return[i("Cell",{attrs:{size:"4"}},[e._v("\n            "+e._s(a.name)+"\n          ")]),e._v(" "),i("Cell",{attrs:{size:"4"}},[e._v("\n            "+e._s(e.display_delivery_channels(a.delivery_channels))+"\n          ")]),e._v(" "),i("Cell",{attrs:{align:"start",size:"2"}},[i("ToggleSwitch",{attrs:{"aria-label":e.$str("enable_status","totara_notification",a.name),value:a.enabled,"toggle-only":!0},on:{input:function(n){return e.toggleEnabled(n,a)}}})],1),e._v(" "),i("Cell",{attrs:{align:"end",size:"1"}},[i("NotifiableEventAction",{attrs:{"resolver-name":a.name,"show-create-notification-option":!1,"show-delivery-preference-option":!0},on:{"update-delivery-preferences":function(n){return e.updateDeliveryPreference(a)}}})],1)]}}],null,!0)})],1)})),1)],1)}),[],!1,null,null,null);"function"==typeof y&&y(N),N.options.__hasBlocks={script:!0,template:!0};n.default=N.exports},u5iS:function(e,n){e.exports=tui.require("tui/components/modal/ModalContent")},uZjY:function(e,n,i){},vF5l:function(e,n){e.exports=tui.require("tui/components/buttons/Button")},vyVp:function(e,n){e.exports=tui.require("tui/notifications")},yikf:function(e,n){e.exports=tui.require("tui/components/datatable/Table")}});