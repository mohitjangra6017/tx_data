!function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s="2luj")}({"/8EC":function(t,e,n){},"1jEG":function(t,e){t.exports=tui.require("editor_weka/toolbar")},"22E+":function(t,e){t.exports=tui.require("ext_prosemirror/view")},"2luj":function(t,e,n){!function(){"use strict";"undefined"!=typeof tui&&tui._bundle.isLoaded("weka_simple_multi_lang")?console.warn('[tui bundle] The bundle "weka_simple_multi_lang" is already loaded, skipping initialisation.'):(tui._bundle.register("weka_simple_multi_lang"),tui._bundle.addModulesFromContext("weka_simple_multi_lang",n("Hp1E")),tui._bundle.addModulesFromContext("weka_simple_multi_lang/components",n("xMTB")))}()},"2wx7":function(t,e){t.exports=tui.require("editor_weka/components/Weka")},"5h9J":function(t,e){t.exports=tui.require("tui/components/buttons/ButtonIcon")},BH6T:function(t,e,n){"use strict";n.r(e);var o=n("GcJT");e.default=function({handleKeyDown:t}){const e=new o.PluginKey("weka_simple_multi_lang");return new o.Plugin({key:e,props:{handleKeyDown:t}})}},BN8m:function(t,e){t.exports=tui.require("tui/components/buttons/ButtonGroup")},BfEt:function(t,e,n){"use strict";n.r(e);var o=n("tnXT"),i=n.n(o),a=n("5h9J"),l=n.n(a),r=n("rNse"),s=n.n(r),u=n("vH83"),c=n.n(u),_=n("Mnur"),d=n.n(_),m=n("WJii"),p=n.n(m),g={components:{ButtonIcon:l.a,Edit:s.a,Delete:c.a,ModalPresenter:d.a,EditMultiLangModal:p.a},extends:i.a,data:()=>({editModal:!1}),computed:{language(){return this.attrs.lang},langContentJson(){const t=[];return this.node.content.forEach(e=>t.push(e.toJSON())),t},removable(){return!this.editorDisabled&&this.attrs.siblings_count>2},editLanguageAriaLabel(){return this.$str("edit_language_x","weka_simple_multi_lang",this.language||this.$str("unspecified","weka_simple_multi_lang"))},removeLanguageAriaLabel(){return this.$str("remove_language_x","weka_simple_multi_lang",this.language||this.$str("unspecified","weka_simple_multi_lang"))},editorCompact(){return this.context.getCompact()},placeholderResolverClass(){return this.context.getPlaceholderResolverClassName()}},methods:{handleUpdateLangContent({lang:t,content:e}){const n={attrs:{lang:t,siblings_count:this.attrs.siblings_count},content:e};this.editModal=!1,this.context.updateSelf(n,this.getRange)},handleRemoving(){this.context.removeSelf(this.getRange)}}},f=(n("mfot"),n("KHd+")),h=function(t){t.options.__langStrings={weka_simple_multi_lang:["edit_language_x","remove_language_x","unspecified","language_label"]}},k=Object(f.a)(g,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tui-wekaMultiLangBlock",attrs:{"data-lang":t.language||t.$str("unspecified","weka_simple_multi_lang"),contenteditable:"false"}},[n("ModalPresenter",{attrs:{open:t.editModal},on:{"request-close":function(e){t.editModal=!1}}},[n("EditMultiLangModal",{attrs:{lang:t.language,content:t.langContentJson,"editor-compact":t.editorCompact,"placeholder-resolver-class":t.placeholderResolverClass},on:{submit:t.handleUpdateLangContent}})],1),t._v(" "),n("div",{staticClass:"tui-wekaMultiLangBlock__container"},[n("div",{staticClass:"tui-wekaMultiLangBlock__wrapper"},[n("div",{staticClass:"tui-wekaMultiLangBlock__languageWrapper"},[n("div",{staticClass:"tui-wekaMultiLangBlock__language"},[t._v("\n          "+t._s(t.$str("language_label","weka_simple_multi_lang",t.language||t.$str("unspecified","weka_simple_multi_lang")))+"\n        ")]),t._v(" "),n("div",{staticClass:"tui-wekaMultiLangBlock__actions"},[t.editorDisabled?t._e():n("ButtonIcon",{attrs:{"aria-label":t.editLanguageAriaLabel,styleclass:{transparent:!0,transparentNoPadding:!0}},on:{click:function(e){t.editModal=!0}}},[n("Edit",{attrs:{size:100}})],1)],1)]),t._v(" "),n("div",{ref:"content",staticClass:"tui-wekaMultiLangBlock__texts"})]),t._v(" "),t.removable?n("ButtonIcon",{staticClass:"tui-wekaMultiLangBlock__remove",attrs:{"aria-label":t.removeLanguageAriaLabel,styleclass:{transparent:!0,transparentNoPadding:!0}},on:{click:t.handleRemoving}},[n("Delete",{attrs:{size:100}})],1):t._e()],1)],1)}),[],!1,null,null,null);"function"==typeof h&&h(k),k.options.__hasBlocks={script:!0,template:!0};e.default=k.exports},Dg9Z:function(t,e){t.exports=tui.require("tui/components/uniform/FormText")},FXsc:function(t,e,n){},GGoX:function(t,e,n){"use strict";var o=n("FXsc");n.n(o).a},GcJT:function(t,e){t.exports=tui.require("ext_prosemirror/state")},Hp1E:function(t,e,n){var o={"./extension":"bZ4Q","./extension.js":"bZ4Q","./plugin":"BH6T","./plugin.js":"BH6T"};function i(t){var e=a(t);return n(e)}function a(t){if(!n.o(o,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return o[t]}i.keys=function(){return Object.keys(o)},i.resolve=a,t.exports=i,i.id="Hp1E"},IQMv:function(t,e,n){},J3p9:function(t,e,n){"use strict";n.r(e);var o=n("tnXT"),i=n.n(o),a=n("5h9J"),l=n.n(a),r=n("PNFE"),s=n.n(r),u={components:{ButtonIcon:l.a,Add:s.a},extends:i.a,computed:{isActionSpacingRequired(){return this.node.content.content.length>2}},methods:{insertNewLangBlock(){this.context.insertNewLangBlock(this.getRange)}}},c=(n("GGoX"),n("KHd+")),_=function(t){t.options.__langStrings={weka_simple_multi_lang:["add_new","remove_collection_block"]}},d=Object(c.a)(u,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tui-wekaMultiLangBlockCollection"},[e("div",{ref:"content",staticClass:"tui-wekaMultiLangBlockCollection__content"}),this._v(" "),e("div",{staticClass:"tui-wekaMultiLangBlockCollection__actions",class:{"tui-wekaMultiLangBlockCollection__actions--spacing":this.isActionSpacingRequired}},[this.editorDisabled?this._e():e("ButtonIcon",{attrs:{"aria-label":this.$str("add_new","weka_simple_multi_lang"),styleclass:{transparentNoPadding:!0}},on:{click:this.insertNewLangBlock}},[e("Add",{attrs:{size:300}})],1)],1)])}),[],!1,null,null,null);"function"==typeof _&&_(d),d.options.__hasBlocks={script:!0,template:!0};e.default=d.exports},"KHd+":function(t,e,n){"use strict";function o(t,e,n,o,i,a,l,r){var s,u="function"==typeof t?t.options:t;if(e&&(u.render=e,u.staticRenderFns=n,u._compiled=!0),o&&(u.functional=!0),a&&(u._scopeId="data-v-"+a),l?(s=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),i&&i.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(l)},u._ssrRegister=s):i&&(s=r?function(){i.call(this,(u.functional?this.parent:this).$root.$options.shadowRoot)}:i),s)if(u.functional){u._injectStyles=s;var c=u.render;u.render=function(t,e){return s.call(e),c(t,e)}}else{var _=u.beforeCreate;u.beforeCreate=_?[].concat(_,s):[s]}return{exports:t,options:u}}n.d(e,"a",(function(){return o}))},LZSQ:function(t,e,n){"use strict";var o=n("IQMv");n.n(o).a},Mnur:function(t,e){t.exports=tui.require("tui/components/modal/ModalPresenter")},O8Ag:function(t,e){t.exports=tui.require("tui/components/uniform/Uniform")},PNFE:function(t,e){t.exports=tui.require("tui/components/icons/Add")},PjtW:function(t,e){t.exports=tui.require("weka_simple_multi_lang/components/MultiLangBlockCollection")},TXEh:function(t,e){t.exports=tui.require("tui/util")},V68o:function(t,e){t.exports=tui.require("tui/i18n")},WJii:function(t,e){t.exports=tui.require("weka_simple_multi_lang/components/modal/EditSimpleMultiLangModal")},XiXK:function(t,e){t.exports=tui.require("weka_simple_multi_lang/components/MultiLangBlock")},a6XR:function(t,e,n){"use strict";n.r(e);var o=n("rL2w"),i=n.n(o),a=n("tkAW"),l=n.n(a),r=n("u5iS"),s=n.n(r),u={components:{MultiLangForm:i.a,Modal:l.a,ModalContent:s.a},props:{lang:String,content:Array,editorCompact:Boolean,placeholderResolverClass:String},computed:{editorExtraExtensions(){return this.placeholderResolverClass?[{name:"weka_notification_placeholder_extension",options:{resolver_class_name:this.placeholderResolverClass}}]:[]}}},c=n("KHd+"),_=function(t){t.options.__langStrings={weka_simple_multi_lang:["edit_language"]}},d=Object(c.a)(u,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Modal",{staticClass:"tui-wekaEditSimpleMultiLangModal",attrs:{size:"large",dismissable:{esc:!1,backdropClick:!1}}},[n("ModalContent",{attrs:{title:t.$str("edit_language","weka_simple_multi_lang"),"close-button":!0}},[n("MultiLangForm",{attrs:{lang:t.lang,content:t.content,"editor-compact":t.editorCompact,"editor-extra-extensions":t.editorExtraExtensions},on:{submit:function(e){return t.$emit("submit",e)},cancel:function(e){return t.$emit("request-close")}}})],1)],1)}),[],!1,null,null,null);"function"==typeof _&&_(d),d.options.__hasBlocks={script:!0,template:!0};e.default=d.exports},aMNZ:function(t,e){t.exports=tui.require("tui/components/icons/MultiLang")},bZ4Q:function(t,e,n){"use strict";n.r(e);var o=n("gAZ6"),i=n.n(o),a=n("XiXK"),l=n.n(a),r=n("PjtW"),s=n.n(r),u=n("1jEG"),c=n("V68o"),_=n("TXEh"),d=n("aMNZ"),m=n.n(d),p=n("BH6T"),g=n("GcJT"),f=n("jMu/");n("22E+");class h extends i.a{nodes(){return{weka_simple_multi_lang_lang_block:{schema:{atom:!0,selectable:!1,isolating:!0,group:"weka_simple_multi_lang_lang_blocks",draggable:!1,content:"(paragraph|heading)*",attrs:{lang:{default:void 0},siblings_count:{default:1}},toDOM:t=>["div",{class:"tui-wekaMultiLangBlock","data-attrs":JSON.stringify({lang:t.attrs.lang,siblings_count:t.attrs.siblings_count})},0],parseDOM:[{tag:"div.tui-wekaMultiLangBlock",getAttrs:f.getJsonAttrs}]},component:l.a,componentContext:{removeSelf:this._removeLangBlock.bind(this),updateSelf:this._updateLangBlock.bind(this),getCompact:()=>this.options.compact||!1,getPlaceholderResolverClassName:()=>this.options.placeholder_resolver_class_name||null}},weka_simple_multi_lang_lang_blocks:{schema:{atom:!0,draggable:!1,selectable:!0,isolating:!0,group:"block",content:"weka_simple_multi_lang_lang_block+",toDOM:()=>["div",{class:"tui-wekaMultiLangBlockCollection"},0],parseDOM:[{tag:"div.tui-wekaMultiLangBlockCollection",getAttrs:()=>({})}]},component:s.a,componentContext:{insertNewLangBlock:this._insertNewLangBlock.bind(this)}}}}toolbarItems(){return this.options.is_active?[new u.ToolbarItem({group:"embeds",label:Object(c.langString)("multi_lang","weka_simple_multi_lang"),iconComponent:m.a,execute:this._createCollectionBlock.bind(this)})]:[]}plugins(){return[Object(p.default)({handleKeyDown:this._handleKeyDown.bind(this)})]}keymap(t){this.options.is_active&&t("Ctrl-m",this._createCollectionBlock.bind(this))}_createCollectionBlock(){const{from:t,to:e}=Object(_.pick)(this.editor.state.selection,["from","to"]);this.editor.execute((n,o)=>{const{tr:i}=n;i.replaceWith(t,e,[n.schema.node("weka_simple_multi_lang_lang_blocks",{},[n.schema.node("weka_simple_multi_lang_lang_block",{siblings_count:2}),n.schema.node("weka_simple_multi_lang_lang_block",{siblings_count:2})])]),o(i)})}_removeLangBlock(t){const{from:e}=t(),n=this.doc.resolve(e),o=this.doc.resolve(n.end());let i=o.node();"weka_simple_multi_lang_lang_blocks"===i.type.name?i.content.content.length<=2?console.warn("[Weka] cannot remove another single lang block due to the minimum requirement"):this.editor.execute((t,e)=>{const{schema:a,tr:l}=t;i=i.toJSON(),i.content=i.content.filter((t,e)=>e!==n.index());const r=i.content.length;i.content=i.content.map(t=>((t=Object.assign({},t)).attrs=Object.assign({},t,{siblings_count:r}),t)),l.replaceWith(o.before(),o.after(),a.nodeFromJSON(i)),e(l),this.editor.view.focus()}):console.error("[Weka] cannot resolve the position of parent collection node")}_updateLangBlock({attrs:t,content:e},n){const{from:o,to:i}=n();this.editor.execute((n,a)=>{const{tr:l}=n,r=e.map(t=>n.schema.nodeFromJSON(t));a(l.replaceWith(o,i,n.schema.node("weka_simple_multi_lang_lang_block",t,r)))}),this.editor.view.focus()}_insertNewLangBlock(t){const{to:e}=t(),n=this.editor.state.doc.resolve(e-1);let o=n.node();if("weka_simple_multi_lang_lang_blocks"!==o.type.name)return void console.warn("Unable to resolve node 'weka_simple_multi_lang_lang_blocks' from the position "+e);o=o.toJSON();const i=o.content.length;o.content=o.content.map(t=>((t=Object.assign({},t)).attrs=Object.assign({},t.attrs,{siblings_count:i+1}),t)),this.editor.execute((t,e)=>{const{tr:a,schema:l}=t;a.replaceWith(n.before(),n.after(),l.nodeFromJSON(o)),a.insert(n.end(),l.node("weka_simple_multi_lang_lang_block",{siblings_count:i+1})),e(a)}),this.editor.view.focus()}_handleKeyDown(t,e){switch(e.key){case"Enter":return this._createNewLine(t);case"Backspace":case"Delete":return this._handleRemoveCollectionBlocKFromBackspace(t);default:const e=t.state.tr.selection.$from.node();return!(!e||"weka_simple_multi_lang_lang_blocks"!==e.type.name&&"weka_simple_multi_lang_lang_block"!==e.type.name)}}_createNewLine(t){const e=t.state.tr.selection.$from,n=e.node();let o=(()=>{switch(n.type.name){case"weka_simple_multi_lang_lang_blocks":return e.after();case"weka_simple_multi_lang_lang_block":return this.doc.resolve(e.before()).after();case"paragraph":case"heading":if("weka_simple_multi_lang_lang_block"===e.node(e.depth-1).type.name){const n=t.state.doc.resolve(e.before());return t.state.doc.resolve(n.before()).after()}return null;default:return null}})();return null!==o&&(this.editor.execute((t,e)=>{const{tr:n}=t;n.insert(o,t.schema.nodes.paragraph.createAndFill()),n.setSelection(new g.TextSelection(n.doc.resolve(o+1))),e(n)}),!0)}_handleRemoveCollectionBlocKFromBackspace(t){const e=t.state.tr.selection.$from,n=e.node(),o=({from:t,to:e})=>{this.editor.execute((n,o)=>{const{tr:i}=n;i.delete(t,e),o(i)})};if("weka_simple_multi_lang_lang_blocks"===n.type.name)return o({from:e.before(),to:e.after()}),!0;if("weka_simple_multi_lang_lang_block"===n.type.name)return!0;if("paragraph"===n.type.name){if("weka_simple_multi_lang_lang_block"===e.node(e.depth-1).type.name)return!0}return!1}}e.default=t=>new h(t)},ezXF:function(t,e,n){"use strict";n.r(e);var o=n("O8Ag"),i=n.n(o),a=n("2wx7"),l=n.n(a),r=n("kkOl"),s=n.n(r),u=n("i/kK"),c=n.n(u),_=n("Dg9Z"),d=n.n(_),m=n("zZ9w"),p=n.n(m),g=n("BN8m"),f=n.n(g),h=n("vF5l"),k=n.n(h),v=n("nXMa"),b=n.n(v),w={components:{Uniform:i.a,FormRow:c.a,FormText:d.a,FormField:p.a,Weka:l.a,ButtonGroup:f.a,Cancel:b.a,Button:k.a},props:{lang:{type:String,validator:t=>t.length<=5},content:{type:Array,validator:t=>t.every(t=>t.type&&("paragraph"===t.type||"heading"===t.type)),default:()=>[]},editorCompact:Boolean,editorExtraExtensions:{type:Array,default:()=>[],validator:t=>t.every(t=>"name"in t)}},data(){let t=null;return this.content.length&&(t=s.a.fromDoc({type:"doc",content:this.content})),{formValue:{lang:{type:String,value:this.lang},content:{type:s.a,value:t}}}},methods:{submitForm(t){const e={lang:t.lang.value,content:[]},{content:n}=t.content.value.getDoc();n&&n.length&&(e.content=n),this.$emit("submit",e)},validateContentEditor(t){return t?t.isEmpty?this.$str("required","moodle"):"":this.$str("required","moodle")}}},x=(n("LZSQ"),n("KHd+")),M=function(t){t.options.__langStrings={weka_simple_multi_lang:["lang_code","content","content_help","lang_code_help"],totara_core:["save"],moodle:["required"]}},C=Object(x.a)(w,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Uniform",{staticClass:"tui-wekaSimpleMultiLangForm",attrs:{"initial-values":t.formValue,"input-width":"full"},on:{submit:t.submitForm}},[n("FormRow",{attrs:{label:t.$str("lang_code","weka_simple_multi_lang"),required:!0,helpmsg:t.$str("lang_code_help","weka_simple_multi_lang")}},[[n("FormText",{attrs:{name:["lang","value"],maxlength:5,"char-length":5,validations:function(t){return[t.required()]}}})]],2),t._v(" "),n("FormRow",{attrs:{label:t.$str("content","weka_simple_multi_lang"),required:!0,helpmsg:t.$str("content_help","weka_simple_multi_lang")}},[[n("FormField",{attrs:{name:["content","value"],"char-length":"full",validate:t.validateContentEditor},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.value,i=e.update;return[n("Weka",{attrs:{value:o,compact:t.editorCompact,"extra-extensions":t.editorExtraExtensions,variant:"simple"},on:{input:i}})]}}])})]],2),t._v(" "),n("ButtonGroup",{staticClass:"tui-wekaSimpleMultiLangForm__buttonGroup"},[[n("Button",{attrs:{styleclass:{primary:!0},text:t.$str("save","totara_core"),"aria-label":t.$str("save","totara_core"),type:"submit"}}),t._v(" "),n("Cancel",{on:{click:function(e){return t.$emit("cancel")}}})]],2)],1)}),[],!1,null,null,null);"function"==typeof M&&M(C),C.options.__hasBlocks={script:!0,template:!0};e.default=C.exports},gAZ6:function(t,e){t.exports=tui.require("editor_weka/extensions/Base")},"i/kK":function(t,e){t.exports=tui.require("tui/components/form/FormRow")},"jMu/":function(t,e){t.exports=tui.require("editor_weka/extensions/util")},kkOl:function(t,e){t.exports=tui.require("editor_weka/WekaValue")},mfot:function(t,e,n){"use strict";var o=n("/8EC");n.n(o).a},nXMa:function(t,e){t.exports=tui.require("tui/components/buttons/Cancel")},rL2w:function(t,e){t.exports=tui.require("weka_simple_multi_lang/components/form/SimpleMultiLangForm")},rNse:function(t,e){t.exports=tui.require("tui/components/icons/Edit")},tkAW:function(t,e){t.exports=tui.require("tui/components/modal/Modal")},tnXT:function(t,e){t.exports=tui.require("editor_weka/components/nodes/BaseNode")},u5iS:function(t,e){t.exports=tui.require("tui/components/modal/ModalContent")},vF5l:function(t,e){t.exports=tui.require("tui/components/buttons/Button")},vH83:function(t,e){t.exports=tui.require("tui/components/icons/Delete")},xMTB:function(t,e,n){var o={"./MultiLangBlock":"BfEt","./MultiLangBlock.vue":"BfEt","./MultiLangBlockCollection":"J3p9","./MultiLangBlockCollection.vue":"J3p9","./form/SimpleMultiLangForm":"ezXF","./form/SimpleMultiLangForm.vue":"ezXF","./modal/EditSimpleMultiLangModal":"a6XR","./modal/EditSimpleMultiLangModal.vue":"a6XR"};function i(t){var e=a(t);return n(e)}function a(t){if(!n.o(o,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return o[t]}i.keys=function(){return Object.keys(o)},i.resolve=a,t.exports=i,i.id="xMTB"},zZ9w:function(t,e){t.exports=tui.require("tui/components/uniform/FormField")}});