!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="8E5r")}({"2ryK":function(e,t,n){"use strict";n.r(t),n.d(t,"REGEX",(function(){return u}));var o=n("TXEh"),r=n("GcJT"),i=n("UJXg"),a=n.n(i),s=n("g+N3"),l=n.n(s),u=new RegExp("\\[([a-z_:]+]?)?","ig");t.default=function(e,t){var n=new r.PluginKey("placeholders"),i=new a.a(e);return new r.Plugin({key:n,view:function(){var n=this;return{update:Object(o.debounce)((function(o){var r=n.key.getState(o.state),a=r.text,s=r.active,u=r.range;if(i.destroyInstance(),a&&s){var c=a.slice(1);i.showList({view:o,component:{name:"totara_notification_placeholder",component:l.a,attrs:function(e,t){return{key:e,label:t}},props:{resolverClassName:t,contextId:e.identifier.contextId,pattern:c}},state:{text:c,active:s,range:u}})}}),250)}},state:{init:function(){return{active:!1,range:{},text:null}},apply:function(e,t){return u.lastIndex=0,i.apply(e,t,u)}},props:{handleKeyDown:function(e,t){if("Escape"===t.key)return!!this.getState(e.state).active&&(i.destroyInstance(),e.focus(),!0)}}})}},"45xq":function(e,t,n){"use strict";n.r(t);var o=n("tnXT"),r=n.n(o),i=n("Ki6H"),a={components:{Placeholder:n.n(i).a},extends:r.a,computed:{placeholderKey:function(){var e=this.attrs;return e.key?e.key:""},displayName:function(){var e=this.attrs;return e.label?e.label:""}}},s=n("KHd+"),l=Object(s.a)(a,(function(){var e=this.$createElement;return(this._self._c||e)("Placeholder",{attrs:{"placeholder-key":this.placeholderKey,"display-name":this.displayName}})}),[],!1,null,null,null);l.options.__hasBlocks={script:!0,template:!0};t.default=l.exports},"4NLQ":function(e,t,n){var o={"./extension":"i58X","./extension.js":"i58X","./plugin":"2ryK","./plugin.js":"2ryK"};function r(e){var t=i(e);return n(t)}function i(e){if(!n.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}r.keys=function(){return Object.keys(o)},r.resolve=i,e.exports=r,r.id="4NLQ"},"7W2i":function(e,t,n){var o=n("SksO");e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)},e.exports.default=e.exports,e.exports.__esModule=!0},"8E5r":function(e,t,n){!function(){"use strict";"undefined"!=typeof tui&&tui._bundle.isLoaded("weka_notification_placeholder")?console.warn('[tui bundle] The bundle "weka_notification_placeholder" is already loaded, skipping initialisation.'):(tui._bundle.register("weka_notification_placeholder"),tui._bundle.addModulesFromContext("weka_notification_placeholder",n("4NLQ")),tui._bundle.addModulesFromContext("weka_notification_placeholder/components",n("IiAa")))}()},GcJT:function(e,t){e.exports=tui.require("ext_prosemirror/state")},IiAa:function(e,t,n){var o={"./nodes/Placeholder":"45xq","./nodes/Placeholder.vue":"45xq","./suggestion/Placeholder":"bX1p","./suggestion/Placeholder.vue":"bX1p"};function r(e){var t=i(e);return n(t)}function i(e){if(!n.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}r.keys=function(){return Object.keys(o)},r.resolve=i,e.exports=r,r.id="IiAa"},JXQf:function(e,t){e.exports=tui.require("tui/components/loading/Loader")},KGcv:function(e,t){e.exports=tui.require("tui/components/dropdown/DropdownItem")},"KHd+":function(e,t,n){"use strict";function o(e,t,n,o,r,i,a,s){var l,u="function"==typeof e?e.options:e;if(t&&(u.render=t,u.staticRenderFns=n,u._compiled=!0),o&&(u.functional=!0),i&&(u._scopeId="data-v-"+i),a?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),r&&r.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(a)},u._ssrRegister=l):r&&(l=s?function(){r.call(this,(u.functional?this.parent:this).$root.$options.shadowRoot)}:r),l)if(u.functional){u._injectStyles=l;var c=u.render;u.render=function(e,t){return l.call(t),c(e,t)}}else{var d=u.beforeCreate;u.beforeCreate=d?[].concat(d,l):[l]}return{exports:e,options:u}}n.d(t,"a",(function(){return o}))},Ki6H:function(e,t){e.exports=tui.require("totara_notification/components/json_editor/nodes/Placeholder")},Nsbk:function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.default=e.exports,e.exports.__esModule=!0,n(t)}e.exports=n,e.exports.default=e.exports,e.exports.__esModule=!0},P8Br:function(e,t){},PJYZ:function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.default=e.exports,e.exports.__esModule=!0},SksO:function(e,t){function n(t,o){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},e.exports.default=e.exports,e.exports.__esModule=!0,n(t,o)}e.exports=n,e.exports.default=e.exports,e.exports.__esModule=!0},TXEh:function(e,t){e.exports=tui.require("tui/util")},UJXg:function(e,t){e.exports=tui.require("editor_weka/helpers/suggestion")},W8MJ:function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}e.exports=function(e,t,o){return t&&n(e.prototype,t),o&&n(e,o),e},e.exports.default=e.exports,e.exports.__esModule=!0},a1gu:function(e,t,n){var o=n("cDf5").default,r=n("PJYZ");e.exports=function(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?r(e):t},e.exports.default=e.exports,e.exports.__esModule=!0},bX1p:function(e,t,n){"use strict";n.r(t);var o=n("gLvT"),r=n.n(o),i=n("KGcv"),a=n.n(i),s=n("JXQf"),l=n.n(s),u={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"weka_notification_placeholder_placeholders"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"context_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pattern"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resolver_class_name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"placeholders"},name:{kind:"Name",value:"weka_notification_placeholder_placeholders"},arguments:[{kind:"Argument",name:{kind:"Name",value:"context_id"},value:{kind:"Variable",name:{kind:"Name",value:"context_id"}}},{kind:"Argument",name:{kind:"Name",value:"pattern"},value:{kind:"Variable",name:{kind:"Name",value:"pattern"}}},{kind:"Argument",name:{kind:"Name",value:"resolver_class_name"},value:{kind:"Variable",name:{kind:"Name",value:"resolver_class_name"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"key"},arguments:[],directives:[]}]}}]}}]},c={components:{Dropdown:r.a,DropdownItem:a.a,Loader:l.a},props:{contextId:{type:[Number,String],required:!0},resolverClassName:{type:String,required:!0},location:{required:!0,type:Object},pattern:{required:!0,type:String}},apollo:{placeholders:{query:u,fetchPolicy:"network-only",variables:function(){return{pattern:this.pattern,context_id:this.contextId,resolver_class_name:this.resolverClassName}}}},data:function(){return{placeholders:[]}},computed:{showSuggestions:function(){return this.$apollo.loading||this.placeholders.length>0},positionStyle:function(){return{left:"".concat(this.location.x,"px"),top:"".concat(this.location.y,"px")}}},watch:{showSuggestions:function(e){e||this.$emit("dismiss")}},methods:{pickPlaceholder:function(e){var t=e.key,n=e.label;this.$emit("item-selected",{id:t,text:n})}}},d=(n("P8Br"),n("KHd+")),p=function(e){e.options.__langStrings={editor_weka:["matching_placeholders"]}},f=Object(d.a)(c,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tui-wekaPlaceholderSuggestion",style:e.positionStyle},[n("Dropdown",{attrs:{separator:!0,open:e.showSuggestions,"inline-menu":!0},on:{dismiss:function(t){return e.$emit("dismiss")}}},[n("span",{staticClass:"sr-only"},[e._v("\n      "+e._s(e.$str("matching_placeholders","editor_weka"))+":\n    ")]),e._v(" "),e.$apollo.loading?[n("DropdownItem",{attrs:{disabled:!0}},[n("Loader",{attrs:{loading:!0}})],1)]:e._e(),e._v(" "),e._l(e.placeholders,(function(t,o){return n("DropdownItem",{key:o,attrs:{"no-padding":!0},on:{click:function(n){return e.pickPlaceholder(t)}}},[n("span",{staticClass:"tui-wekaPlaceholderSuggestion__label"},[e._v("\n        "+e._s(t.label)+"\n      ")])])}))],2)],1)}),[],!1,null,null,null);"function"==typeof p&&p(f),f.options.__hasBlocks={script:!0,template:!0};t.default=f.exports},cDf5:function(e,t){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(e.exports=n=function(e){return typeof e},e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.default=e.exports,e.exports.__esModule=!0),n(t)}e.exports=n,e.exports.default=e.exports,e.exports.__esModule=!0},"g+N3":function(e,t){e.exports=tui.require("weka_notification_placeholder/components/suggestion/Placeholder")},gAZ6:function(e,t){e.exports=tui.require("editor_weka/extensions/Base")},gLvT:function(e,t){e.exports=tui.require("tui/components/dropdown/Dropdown")},hstw:function(e,t){e.exports=tui.require("weka_notification_placeholder/components/nodes/Placeholder")},i58X:function(e,t,n){"use strict";n.r(t);var o=n("lwsE"),r=n.n(o),i=n("W8MJ"),a=n.n(i),s=n("7W2i"),l=n.n(s),u=n("a1gu"),c=n.n(u),d=n("Nsbk"),p=n.n(d),f=n("hstw"),_=n.n(f),m=n("gAZ6"),y=n.n(m),v=n("2ryK");function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=p()(e);if(t){var r=p()(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return c()(this,n)}}var x=function(e){l()(n,e);var t=h(n);function n(){return r()(this,n),t.apply(this,arguments)}return a()(n,[{key:"nodes",value:function(){return{totara_notification_placeholder:{schema:{group:"inline",inline:!0,attrs:{key:{default:void 0},label:{default:void 0}},parseDOM:[{tag:"span.tui-placeholder__text",getAttrs:function(e){try{return{key:e.getAttribute("data-key"),label:e.getAttribute("data-label")}}catch(e){return{}}}}],toDOM:function(e){return["span",{class:"tui-placeholder__text","data-key":e.attrs.key,"data-label":e.attrs.label},"["+e.attrs.label+"]"]}},component:_.a}}}},{key:"plugins",value:function(){return[Object(v.default)(this.editor,this.options.resolver_class_name)]}}]),n}(y.a);t.default=function(e){return new x(e)}},lwsE:function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.default=e.exports,e.exports.__esModule=!0},tnXT:function(e,t){e.exports=tui.require("editor_weka/components/nodes/BaseNode")}});