!function(e){function t(t){for(var n,r,o=t[0],d=t[1],l=t[2],m=0,u=[];m<o.length;m++)r=o[m],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&u.push(a[r][0]),a[r]=0;for(n in d)Object.prototype.hasOwnProperty.call(d,n)&&(e[n]=d[n]);for(c&&c(t);u.length;)u.shift()();return s.push.apply(s,l||[]),i()}function i(){for(var e,t=0;t<s.length;t++){for(var i=s[t],n=!0,o=1;o<i.length;o++){var d=i[o];0!==a[d]&&(n=!1)}n&&(s.splice(t--,1),e=r(r.s=i[0]))}return e}var n={},a={6:0},s=[];function r(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=n,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var o=window.webpackJsonp=window.webpackJsonp||[],d=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var c=d;s.push(["+xVU",0]),i()}({"+kGl":function(e,t,i){"use strict";t.a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_activity_types"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_activity_types"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_name"},arguments:[],directives:[]}]}}]}}]}},"+xVU":function(e,t,i){!function(){"use strict";"undefined"!=typeof tui&&tui._bundle.isLoaded("mod_perform")?console.warn('[tui bundle] The bundle "mod_perform" is already loaded, skipping initialisation.'):(tui._bundle.register("mod_perform"),tui._bundle.addModulesFromContext("mod_perform",i("qrY1")),tui._bundle.addModulesFromContext("mod_perform/components",i("zPJE")),tui._bundle.addModulesFromContext("mod_perform/pages",i("fD1q")))}()},"/Ngp":function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/participation/InstanceInfoCard")},"/V0O":function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/assignment/schedule/ScheduleSettings")},"/X/1":function(e,t){e.exports=tui.require("tui/components/toggle/ToggleSet")},"1i2V":function(e,t){e.exports=tui.require("tui/components/tabs/Tab")},"2HWE":function(e,t){e.exports=tui.require("tui/components/icons/common/AddUser")},"2LpK":function(e,t){e.exports=tui.require("mod_perform/components/activities_list/ActivityActions")},"2nWl":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performManualParticipantSelectionBanner"},[i("ActionCard",{scopedSlots:e._u([{key:"card-body",fn:function(){return[i("span",[e._v(e._s(e.$str("user_activities_require_manual_participant_selection_text","mod_perform")))])]},proxy:!0},{key:"card-action",fn:function(){return[i("ActionLink",{attrs:{href:e.$url("/mod/perform/activity/select-participants.php"),text:e.$str("user_activities_require_manual_participant_selection_link","mod_perform"),styleclass:{primary:!0,small:!0}}})]},proxy:!0}])})],1)};n._withStripped=!0;var a=i("kUb+"),s=i.n(a),r=i("fCWf"),o=i.n(r),d={components:{ActionCard:s.a,ActionLink:o.a},props:{},data:()=>({})},l=i("KHd+"),c=function(e){e.options.__langStrings={mod_perform:["user_activities_require_manual_participant_selection_text","user_activities_require_manual_participant_selection_link"]}},m=Object(l.a)(d,n,[],!1,null,null,null);"function"==typeof c&&c(m),m.options.__hasBlocks={script:!0,template:!0},m.options.__file="client/src/mod_perform/components/user_activities/ManualParticipantsSelectionBanner.vue";t.default=m.exports},"3vGC":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Collapsible",{staticClass:"tui-activityNotificationSettings",attrs:{label:e.data.name},scopedSlots:e._u([{key:"collapsible-side-content",fn:function(){return[i("div",{staticClass:"tui-activityNotificationSettings__toggle"},[i("ToggleSwitch",{staticClass:"tui-activityNotificationSettings__active",attrs:{text:"","aria-label":e.$str("toggle_notification","mod_perform",e.data.name),value:e.data.active},on:{input:function(t){return e.$emit("toggleNotification",e.data,t)}}})],1)]},proxy:!0}]),model:{value:e.expanded,callback:function(t){e.expanded=t},expression:"expanded"}},[e._v(" "),i("Form",{attrs:{"input-width":"full"}},[i("FormRow",{staticClass:"tui-activityNotificationsRecipients",attrs:{label:e.$str("recipients","mod_perform")}},[e.data.recipients.length?i("RecipientsTable",{attrs:{data:e.data.recipients,"class-key":e.data.class_key},on:{toggle:function(t){return e.$emit("toggleRecipient",e.data,t)}}}):i("div",[e._v(e._s(e.$str("no_recipients","mod_perform")))])],1),e._v(" "),e.data.trigger_label?i("FormRow",{attrs:{label:e.$str("trigger_events","mod_perform")}},[i("TriggersTable",{attrs:{data:e.data.triggers,label:e.data.trigger_label,"class-key":e.data.class_key},on:{input:function(t){return e.$emit("updateTriggers",e.data,t)}}})],1):e._e()],1)],1)};n._withStripped=!0;var a=i("IqB1"),s=i.n(a),r=i("lOlL"),o=i.n(r),d=i("fkPW"),l=i.n(d),c=i("XDjs"),m=i.n(c),u=i("nEm4"),_=i.n(u),p=i("i/kK"),v=i.n(p),f={components:{Collapsible:s.a,ToggleSwitch:o.a,RecipientsTable:l.a,TriggersTable:m.a,Form:_.a,FormRow:v.a},props:{data:{required:!0,type:Object},preview:Object},data(){return{isSection:!0,expanded:this.data.active}}},g=i("KHd+"),h=function(e){e.options.__langStrings={mod_perform:["no_recipients","recipients","toggle_notification","trigger_events"]}},k=Object(g.a)(f,n,[],!1,null,null,null);"function"==typeof h&&h(k),k.options.__hasBlocks={script:!0,template:!0},k.options.__file="client/src/mod_perform/components/manage_activity/notification/NotificationSection.vue";t.default=k.exports},"3wZ/":function(e,t){e.exports=tui.require("tui/components/icons/common/Warning")},"4Nja":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"tui-performAssignmentScheduleSettingContainer"},[t("h4",{staticClass:"tui-performAssignmentScheduleSettingContainer__title",attrs:{id:this.$id("settings-container-title")}},[this._v("\n    "+this._s(this.title)+"\n  ")]),this._v(" "),t("div",{staticClass:"tui-performAssignmentScheduleSettingContainer__container",attrs:{"aria-labelledby":this.$id("settings-container-title")}},[this._t("default")],2)])};n._withStripped=!0;var a={props:{title:{required:!0,type:String}}},s=i("KHd+"),r=Object(s.a)(a,n,[],!1,null,null,null);r.options.__hasBlocks={script:!0,template:!0},r.options.__file="client/src/mod_perform/components/manage_activity/assignment/schedule/ScheduleSettingContainer.vue";t.default=r.exports},"4Xyi":function(e,t,i){"use strict";i.r(t);var n=i("IqF/"),a=i("RFl9"),s=i.n(a),r=Object(n.createUniformInputWrapper)(s.a),o=i("KHd+"),d=Object(o.a)(r,void 0,void 0,!1,null,null,null);d.options.__hasBlocks={script:!0,template:!1},d.options.__file="client/src/mod_perform/components/user_activities/participant_selector/FormUserSelector.vue";t.default=d.exports},"58sl":function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/content/ActivityContentTab")},"5h9J":function(e,t){e.exports=tui.require("tui/components/buttons/ButtonIcon")},"5qAA":function(e,t){e.exports=tui.require("tui/components/datatable/HeaderCell")},"5xBH":function(e,t){e.exports=tui.require("tui/components/uniform/FormRadioGroup")},"6Mwu":function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/assignment/AssignmentsTab")},"6T8K":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performElementReadOnlyDisplay",attrs:{tabindex:"0"}},[i("Form",{attrs:{vertical:!0,"input-width":"full"}},[i("FormRow",{attrs:{label:e.$str(e.isStatic?"element_title":"question_title","mod_perform")}},[e._v("\n      "+e._s(e.title)+"\n    ")]),e._v(" "),e._t("content"),e._v(" "),e.isStatic?e._e():i("div",[i("FormRow",{attrs:{label:e.$str("section_element_response_required","mod_perform")}},[i("span",[e._v("\n          "+e._s(e.$str(e.isRequired?"question_response_required_yes":"question_response_required_no","mod_perform"))+"\n        ")])]),e._v(" "),i("FormRow",{attrs:{label:e.$str("reporting_identifier","mod_perform")}},[e._v("\n        "+e._s(e.identifier)+"\n      ")])],1),e._v(" "),i("FormRow",[i("div",{staticClass:"tui-performElementReadOnlyDisplay__action"},[i("ButtonGroup",[i("Button",{attrs:{styleclass:{small:!0},text:"Close"},on:{click:function(t){return e.done()}}})],1)],1)])],2)],1)};n._withStripped=!0;var a=i("vF5l"),s=i.n(a),r=i("BN8m"),o=i.n(r),d=i("i/kK"),l=i.n(d),c=i("nEm4"),m=i.n(c),u={components:{Button:s.a,ButtonGroup:o.a,FormRow:l.a,Form:m.a},props:{title:{type:String,required:!0},type:{type:Object,required:!0},isRequired:{type:Boolean},isStatic:Boolean,identifier:String},methods:{done(){this.$emit("display")}}},_=i("KHd+"),p=function(e){e.options.__langStrings={mod_perform:["element_title","question_title","question_response_required_yes","question_response_required_no","section_element_response_required","reporting_identifier"]}},v=Object(_.a)(u,n,[],!1,null,null,null);"function"==typeof p&&p(v),v.options.__hasBlocks={script:!0,template:!0},v.options.__file="client/src/mod_perform/components/element/ElementAdminReadOnlyDisplay.vue";t.default=v.exports},"6XB6":function(e,t,i){"use strict";i.r(t);var n=i("lBzj"),a=i.n(n),s={functional:!0,components:{FlexIcon:a.a},props:{alt:String,customClass:[String,Object,Array],styleClass:Object,size:[String,Number],title:String},render:(e,{props:t})=>e(a.a,{props:Object.assign({},t,{icon:"mod_perform|repeat"})})},r=i("KHd+"),o=Object(r.a)(s,void 0,void 0,!1,null,null,null);o.options.__hasBlocks={script:!0,template:!1},o.options.__file="client/src/mod_perform/components/icons/RepeatingEnabled.vue";t.default=o.exports},"6e99":function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/assignment/schedule/FrequencySettings")},"77RH":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Loader",{attrs:{loading:e.$apollo.loading}},[e.$apollo.loading?e._e():i("Table",{staticClass:"tui-performUserActivityList",attrs:{data:e.subjectInstances,"expandable-rows":!0},scopedSlots:e._u([{key:"header-row",fn:function(){return[i("ExpandCell",{attrs:{header:!0}}),e._v(" "),i("HeaderCell",{attrs:{size:e.isAboutOthers?"3":"7"}},[e._v("\n        "+e._s(e.$str("user_activities_title_header","mod_perform"))+"\n      ")]),e._v(" "),i("HeaderCell",{attrs:{size:"2"}},[e._v("\n        "+e._s(e.$str("user_activities_type_header","mod_perform"))+"\n      ")]),e._v(" "),e.isAboutOthers?i("HeaderCell",{attrs:{size:"2"}},[e._v("\n        "+e._s(e.$str("user_activities_subject_header","mod_perform"))+"\n      ")]):e._e(),e._v(" "),e.isAboutOthers?i("HeaderCell",{attrs:{size:"2"}},[e._v("\n        "+e._s(e.$str("user_activities_status_header_relationship","mod_perform"))+"\n      ")]):e._e(),e._v(" "),i("HeaderCell",{attrs:{size:"2"}},[e._v("\n        "+e._s(e.$str("user_activities_status_header_activity","mod_perform"))+"\n      ")]),e._v(" "),i("HeaderCell",{attrs:{size:"2"}},[e._v("\n        "+e._s(e.$str("user_activities_status_header_participation","mod_perform"))+"\n      ")])]},proxy:!0},{key:"row",fn:function(t){var n=t.row,a=t.expand,s=t.expandState;return[i("ExpandCell",{attrs:{"expand-state":s,size:"1"},on:{click:function(e){return a()}}}),e._v(" "),i("Cell",{attrs:{size:e.isAboutOthers?"3":"7","column-header":e.$str("user_activities_title_header","mod_perform"),valign:"center"}},[e.currentUserHasMultipleRelationships(n.subject.participant_instances)?i("Button",{staticClass:"tui-performUserActivityList__select-relationship-link",attrs:{styleclass:{transparent:!0},text:n.subject.activity.name},on:{click:function(t){return t.preventDefault(),e.showRelationshipSelector(n)}}}):i("a",{attrs:{href:e.getViewActivityUrl(n)}},[e._v("\n          "+e._s(n.subject.activity.name)+"\n        ")])],1),e._v(" "),i("Cell",{attrs:{size:"2","column-header":e.$str("user_activities_type_header","mod_perform")}},[e._v("\n        "+e._s(n.subject.activity.type.display_name)+"\n      ")]),e._v(" "),e.isAboutOthers?i("Cell",{attrs:{size:"2","column-header":e.$str("user_activities_subject_header","mod_perform"),valign:"center"}},[e._v("\n        "+e._s(n.subject.subject_user.fullname)+"\n      ")]):e._e(),e._v(" "),e.isAboutOthers?i("Cell",{attrs:{size:"2","column-header":e.$str("user_activities_status_header_relationship","mod_perform"),valign:"center"}},[e._v("\n        "+e._s(e.getRelationshipText(n.subject.participant_instances))+"\n      ")]):e._e(),e._v(" "),i("Cell",{attrs:{size:"2","column-header":e.$str("user_activities_status_header_activity","mod_perform"),valign:"center"}},[e._v("\n        "+e._s(e.getStatusText(n.subject.progress_status))+"\n        "),n.subject.is_overdue?i("Lozenge",{attrs:{type:"alert",text:e.$str("is_overdue","mod_perform")}}):e._e(),e._v(" "),"CLOSED"===n.subject.availability_status?i("Lock",{attrs:{alt:e.$str("user_activities_closed","mod_perform"),title:e.$str("user_activities_closed","mod_perform")}}):e._e()],1),e._v(" "),i("Cell",{attrs:{size:"2","column-header":e.$str("user_activities_status_header_participation","mod_perform"),valign:"center"}},[e._v("\n        "+e._s(e.getYourProgressText(n.subject.participant_instances))+"\n        "),e.allYourInstancesAreOverdue(n.subject.participant_instances)?i("Lozenge",{attrs:{type:"alert",text:e.$str("is_overdue","mod_perform")}}):e._e(),e._v(" "),e.allYourInstancesAreClosed(n.subject.participant_instances)?i("Lock",{attrs:{alt:e.$str("user_activities_closed","mod_perform"),title:e.$str("user_activities_closed","mod_perform")}}):e._e()],1)]}},{key:"expand-content",fn:function(t){var n=t.row;return[i("p",{staticClass:"tui-performUserActivityDateSummary"},[e._v("\n        "+e._s(e.$str("user_activities_created_at","mod_perform",n.subject.created_at))+"\n        "),n.subject.due_date?i("span",[e._v("\n          "+e._s(e.$str("user_activities_complete_before","mod_perform",n.subject.due_date))+"\n        ")]):e._e()]),e._v(" "),i("SectionsList",{attrs:{"subject-sections":n.sections,"is-multi-section-active":n.subject.activity.settings.multisection,"view-url":e.viewUrl,"current-user-id":e.currentUserId,"subject-user":n.subject.subject_user,"anonymous-responses":n.subject.activity.anonymous_responses}})]}}],null,!1,2671526515)}),e._v(" "),i("ModalPresenter",{attrs:{open:e.isRelationshipSelectorShown},on:{"request-close":e.hideRelationshipSelector}},[i("RelationshipSelector",{attrs:{"current-user-id":e.currentUserId,"participant-sections":e.selectedParticipantSections,"is-for-section":!1,"subject-user":e.selectedSubjectUser,"view-url":e.viewUrl},model:{value:e.isRelationshipSelectorShown,callback:function(t){e.isRelationshipSelectorShown=t},expression:"isRelationshipSelectorShown"}})],1)],1)};n._withStripped=!0;var a=i("vF5l"),s=i.n(a),r=i("KGot"),o=i.n(r),d=i("rsf9"),l=i.n(d),c=i("5qAA"),m=i.n(c),u=i("AdjL"),_=i.n(u),p=i("cytP"),v=i.n(p),f=i("PNtU"),g=i.n(f),h=i("Mnur"),k=i.n(h),y=i("tKZN"),S=i.n(y),b=i("7tcR"),N=i.n(b),F=i("yikf"),A=i.n(F),T={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_my_subject_instances"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filters"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_subject_instance_filters"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_my_subject_instances"},arguments:[{kind:"Argument",name:{kind:"Name",value:"filters"},value:{kind:"Variable",name:{kind:"Name",value:"filters"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"subject"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"progress_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"availability_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"created_at"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"due_date"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_overdue"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"activity"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"display_name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"settings"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"multisection"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"anonymous_responses"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"subject_user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"participant_instances"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"participant_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"progress_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"availability_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_overdue"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"core_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"sections"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"can_participate"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"section"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sort_order"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"participant_sections"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"progress_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"availability_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_overdue"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"participant_instance"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"progress_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"participant_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"participant"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurlsmall"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"core_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"is_for_current_user"},arguments:[],directives:[]}]}}]}}]}}]}}]}}]},C={components:{Button:s.a,Cell:o.a,ExpandCell:l.a,HeaderCell:m.a,Loader:_.a,Lock:v.a,Lozenge:g.a,ModalPresenter:k.a,RelationshipSelector:N.a,SectionsList:S.a,Table:A.a},props:{currentUserId:{required:!0,type:Number},about:{type:String,validator:e=>["self","others"].includes(e)},viewUrl:{type:String,required:!0}},data:()=>({subjectInstances:[],isRelationshipSelectorShown:!1,selectedParticipantSections:[],selectedSubjectUser:{}}),computed:{aboutFilter(){return[this.about.toUpperCase()]},isAboutOthers(){return"others"===this.about}},apollo:{subjectInstances:{query:T,fetchPolicy:"network-only",variables(){return{filters:{about:this.aboutFilter}}},update:e=>e.mod_perform_my_subject_instances}},methods:{getViewActivityUrl(e){const t=this.getFirstSectionToParticipate(e.sections);return t?this.$url(this.viewUrl,{participant_section_id:t.id}):""},getFirstSectionToParticipate(e){let t=null;return e.forEach(e=>{let i=e.participant_sections.find(e=>e.participant_instance.is_for_current_user);i&&null===t&&(t=i)}),t},showRelationshipSelector(e){this.selectedSubjectUser=e.subject.subject_user,this.selectedParticipantSections=[],e.sections.forEach(e=>{e.participant_sections.forEach(e=>{this.selectedParticipantSections.push(e)})}),this.isRelationshipSelectorShown=!0},hideRelationshipSelector(){this.isRelationshipSelectorShown=!1},getStatusText(e){switch(e){case"NOT_STARTED":return this.$str("user_activities_status_not_started","mod_perform");case"IN_PROGRESS":return this.$str("user_activities_status_in_progress","mod_perform");case"COMPLETE":return this.$str("user_activities_status_complete","mod_perform");default:return""}},getYourProgressText(e){let t=!0,i=!0;this.filterToCurrentUser(e).forEach((function(e){switch(e.progress_status){case"NOT_STARTED":t=!1;break;case"IN_PROGRESS":t=!1,i=!1;break;case"COMPLETE":i=!1}}));let n=i?"NOT_STARTED":t?"COMPLETE":"IN_PROGRESS";return this.getStatusText(n)},allYourInstancesAreClosed(e){return!e.find(e=>parseInt(e.participant_id)===this.currentUserId&&e.availability_status&&"CLOSED"!==e.availability_status)},allYourInstancesAreOverdue(e){return!e.find(e=>parseInt(e.participant_id)===this.currentUserId&&!e.is_overdue)},getRelationshipText(e){return this.filterToCurrentUser(e).map(e=>e.core_relationship.name).join(", ")},currentUserHasMultipleRelationships(e){return this.filterToCurrentUser(e).length>1},filterToCurrentUser(e){return e.filter(e=>Number(this.currentUserId)===Number(e.participant_id))}}},I=i("KHd+"),E=function(e){e.options.__langStrings={mod_perform:["is_overdue","user_activities_closed","user_activities_complete_before","user_activities_created_at","user_activities_status_complete","user_activities_status_header_activity","user_activities_status_header_participation","user_activities_status_header_relationship","user_activities_status_in_progress","user_activities_status_not_started","user_activities_subject_header","user_activities_title_header","user_activities_type_header"]}},O=Object(I.a)(C,n,[],!1,null,null,null);"function"==typeof E&&E(O),O.options.__hasBlocks={script:!0,template:!0},O.options.__file="client/src/mod_perform/components/user_activities/list/Activities.vue";t.default=O.exports},"7tcR":function(e,t){e.exports=tui.require("mod_perform/components/user_activities/list/RelationshipSelector")},"7vnN":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ModalPresenter",{attrs:{open:e.isOpen},on:{"request-close":e.close}},[i("Modal",[i("ModalContent",{attrs:{title:e.$str("manage_participation_select_activity","mod_perform")},scopedSlots:e._u([{key:"buttons",fn:function(){return[e.mightHaveOptions?i("ActionLink",{attrs:{href:e.continueHref,text:e.$str("button_continue","mod_perform"),disabled:!e.selectedActivityId,styleclass:{primary:!0}}}):e._e(),e._v(" "),i("Button",{attrs:{text:e.$str("button_close","mod_perform")},on:{click:e.close}})]},proxy:!0}])},[i("Loader",{attrs:{loading:e.$apollo.loading}},[e.mightHaveOptions?i("Select",{attrs:{options:e.options,name:"manage-participation-activity-select"},model:{value:e.selectedActivityId,callback:function(t){e.selectedActivityId=t},expression:"selectedActivityId"}}):i("p",[e._v("\n          "+e._s(e.$str("manage_participation_no_activities","mod_perform"))+"\n        ")])],1)],1)],1)],1)};n._withStripped=!0;var a=i("fCWf"),s=i.n(a),r=i("vF5l"),o=i.n(r),d=i("AdjL"),l=i.n(d),c=i("tkAW"),m=i.n(c),u=i("u5iS"),_=i.n(u),p=i("Mnur"),v=i.n(p),f=i("fw38"),g=i.n(f),h={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_participant_manageable_activities"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_participant_manageable_activities"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]},k={components:{ActionLink:s.a,Button:o.a,Loader:l.a,Modal:m.a,ModalContent:_.a,ModalPresenter:v.a,Select:g.a},props:{value:{type:Boolean,required:!0}},data:()=>({isOpen:!1,selectedActivityId:null,activities:[]}),computed:{mightHaveOptions(){return!!this.$apollo.loading||this.activities.length>0},options(){return this.activities.map(e=>({id:e.id,label:e.name}))},continueHref(){return this.selectedActivityId?this.$url("/mod/perform/manage/participation/subject_instances.php?activity_id="+this.selectedActivityId):"#"}},mounted(){this.value&&this.open()},apollo:{activities:{query:h,update(e){const t=e.mod_perform_participant_manageable_activities;return t.length>0&&(this.selectedActivityId=t[0].id),t}}},methods:{open(){this.isOpen=!0},close(){this.isOpen=!1,this.$emit("input",!1)}}},y=i("KHd+"),S=function(e){e.options.__langStrings={mod_perform:["button_close","button_continue","manage_participation","manage_participation_select_activity","manage_participation_no_activities"]}},b=Object(y.a)(k,n,[],!1,null,null,null);"function"==typeof S&&S(b),b.options.__hasBlocks={script:!0,template:!0},b.options.__file="client/src/mod_perform/components/manage_activity/participation/SelectActivityModal.vue";t.default=b.exports},"8dSb":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"tui-performElementParticipantResponse"},[this._t("content")],2)};n._withStripped=!0;var a={props:{type:Object}},s=i("KHd+"),r=Object(s.a)(a,n,[],!1,null,null,null);r.options.__hasBlocks={script:!0,template:!0},r.options.__file="client/src/mod_perform/components/element/ElementParticipantResponse.vue";t.default=r.exports},"90VL":function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/notification/NotificationsTab")},"9Afl":function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/content/ActivitySectionElementSummary")},"9G+f":function(e,t){e.exports=tui.require("tui/components/popover/Popover")},"9Mux":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performActivityActions__actionIcons"},[e.activityIsDraft?e._e():i("a",{staticClass:"tui-performActivityActions__actionIcons__link",attrs:{href:e.participationManagementUrl,title:e.$str("manage_participation","mod_perform")}},[i("Users",{attrs:{alt:e.$str("manage_participation","mod_perform"),title:e.$str("manage_participation","mod_perform"),size:"200"}})],1),e._v(" "),e.activity.can_view_participation_reporting?i("a",{staticClass:"tui-performActivityActions__actionIcons__link",attrs:{href:e.participationReportingUrl,title:e.$str("participation_reporting","mod_perform")}},[i("ParticipationReportingIcon",{attrs:{alt:e.$str("participation_reporting","mod_perform"),title:e.$str("participation_reporting","mod_perform"),size:"200"}})],1):e._e(),e._v(" "),e.activity.can_manage?i("Dropdown",{attrs:{position:"bottom-right"},scopedSlots:e._u([{key:"trigger",fn:function(t){var n=t.toggle;return[i("MoreButton",{attrs:{"aria-label":e.$str("activity_action_options","mod_perform")},on:{click:n}})]}}],null,!1,304734647)},[e._v(" "),e.activity.can_potentially_activate?i("DropdownItem",{on:{click:function(t){return e.$refs.activateActivityModal.open()}}},[e._v("\n      "+e._s(e.$str("activity_action_activate","mod_perform"))+"\n    ")]):e._e(),e._v(" "),e.activity.can_clone?i("DropdownItem",{on:{click:e.cloneActivity}},[e._v("\n      "+e._s(e.$str("activity_action_clone","mod_perform"))+"\n    ")]):e._e(),e._v(" "),i("DropdownItem",{on:{click:e.showDeleteModal}},[e._v("\n      "+e._s(e.$str("activity_action_delete","mod_perform"))+"\n    ")])],1):e._e(),e._v(" "),e.activity.can_potentially_activate?i("ActivateActivityModal",{ref:"activateActivityModal",attrs:{activity:e.activity},on:{refetch:function(t){return e.$emit("refetch")}}}):e._e(),e._v(" "),i("ConfirmationModal",{attrs:{open:e.deleteModalOpen,title:e.deleteConfirmationTitle,"confirm-button-text":e.$str("delete"),loading:e.deleting},on:{confirm:e.deleteActivity,cancel:e.closeDeleteModal}},[e.activityIsDraft?[i("p",[e._v(e._s(e.$str("modal_delete_draft_message","mod_perform")))])]:[i("p",[e._v(e._s(e.$str("modal_delete_message","mod_perform")))]),e._v(" "),i("p",[i("strong",[e._v(e._s(e.$str("modal_delete_message_data_recovery_warning","mod_perform")))])])],e._v(" "),i("p",[e._v(e._s(e.$str("modal_delete_confirmation_line","mod_perform")))])],2)],1)};n._withStripped=!0;var a=i("bOP/"),s=i.n(a),r=i("S6e1"),o=i.n(r),d=i("C+/B"),l=i.n(d),c=i("gLvT"),m=i.n(c),u=i("KGcv"),_=i.n(u),p=i("tNJr"),v=i.n(p),f=i("vBwk"),g=i.n(f),h=i("vyVp"),k=i("KxNG"),y={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_clone_activity"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_clone_activity_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_clone_activity"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activity"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"state_details"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"code"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_name"},arguments:[],directives:[]}]}}]}}]}}]}}]},S={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_delete_activity"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_delete_activity_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_delete_activity"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[]}]}}]},b={components:{ActivateActivityModal:s.a,Users:o.a,ConfirmationModal:l.a,Dropdown:m.a,DropdownItem:_.a,MoreButton:v.a,ParticipationReportingIcon:g.a},props:{activity:{required:!0,type:Object}},data:()=>({deleteModalOpen:!1,deleting:!1}),computed:{activityIsDraft(){return this.activity.state_details.name===k.ACTIVITY_STATUS_DRAFT},deleteConfirmationTitle(){return this.activityIsDraft?this.$str("modal_delete_draft_title","mod_perform"):this.$str("modal_delete_title","mod_perform")},participationManagementUrl(){return this.$url("/mod/perform/manage/participation/subject_instances.php",{activity_id:this.activity.id})},participationReportingUrl(){return this.$url("/mod/perform/reporting/participation/index.php",{activity_id:this.activity.id})}},methods:{async cloneActivity(){try{await this.$apollo.mutate({mutation:y,variables:{input:{activity_id:this.activity.id}}}),this.showCloneSuccessNotification()}catch(e){this.showErrorNotification()}this.$emit("refetch")},closeDeleteModal(){this.deleteModalOpen=!1,this.deleting=!1},async deleteActivity(){this.deleting=!0;try{await this.$apollo.mutate({mutation:S,variables:{input:{activity_id:this.activity.id}}}),this.showDeleteSuccessNotification()}catch(e){this.showErrorNotification()}this.$emit("refetch"),this.closeDeleteModal()},showCloneSuccessNotification(){Object(h.notify)({duration:k.NOTIFICATION_DURATION,message:this.$str("toast_success_activity_cloned","mod_perform",this.activity.name),type:"success"})},showDeleteModal(){this.deleteModalOpen=!0},showDeleteSuccessNotification(){let e=this.$str("toast_success_activity_deleted","mod_perform");this.activityIsDraft&&(e=this.$str("toast_success_draft_activity_deleted","mod_perform")),Object(h.notify)({duration:k.NOTIFICATION_DURATION,message:e,type:"success"})},showErrorNotification(){Object(h.notify)({duration:k.NOTIFICATION_DURATION,message:this.$str("toast_error_generic_update","mod_perform",this.activity.name),type:"error"})}}},N=i("KHd+"),F=function(e){e.options.__langStrings={mod_perform:["activity_action_activate","activity_action_clone","activity_action_delete","activity_action_options","manage_participation","modal_delete_confirmation_line","modal_delete_draft_message","modal_delete_draft_title","modal_delete_message","modal_delete_message_data_recovery_warning","modal_delete_title","participation_reporting","toast_error_generic_update","toast_success_activity_cloned","toast_success_activity_deleted","toast_success_draft_activity_deleted"],moodle:["delete"]}},A=Object(N.a)(b,n,[],!1,null,null,null);"function"==typeof F&&F(A),A.options.__hasBlocks={script:!0,template:!0},A.options.__file="client/src/mod_perform/components/activities_list/ActivityActions.vue";t.default=A.exports},"9aSr":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performAddParticipants"},[i("h2",{staticClass:"tui-performAddParticipants__title"},[e._v("\n    "+e._s(e.$str("add_participants_page_title","mod_perform"))+"\n  ")]),e._v(" "),i("Loader",{attrs:{loading:e.$apollo.loading}},[i("Card",{staticClass:"tui-performAddParticipants__card"},[i("h3",{staticClass:"tui-performAddParticipants__card-title"},[e._v(e._s(e.cardTitle))]),e._v(" "),e.$apollo.loading?e._e():[e.distinctRelationships.length>0?i("Form",{staticClass:"tui-performAddParticipants__form"},e._l(e.distinctRelationships,(function(t){return i("FormRow",{key:t.id,attrs:{label:t.name},scopedSlots:e._u([{key:"default",fn:function(n){var a=n.id;n.label;return[i("InputText",{attrs:{id:a,value:e.getNewParticipantsAsCsv(t.id)},on:{input:function(i){return e.updateNewParticipants(t.id,i)}}})]}}],null,!0)})})),1):i("p",[e._v("\n          "+e._s(e.$str("manual_participant_add_no_relationships","mod_perform"))+"\n        ")])]],2)],1),e._v(" "),i("ButtonGroup",{staticClass:"tui-performAddParticipants__action-buttons"},[i("Button",{attrs:{styleclass:{primary:!0},text:e.$str("save","mod_perform"),disabled:e.isSaving,type:"submit"},on:{click:function(t){return t.preventDefault(),e.showConfirmModal(t)}}}),e._v(" "),i("ActionLink",{attrs:{href:e.goBackLink,text:e.$str("button_cancel","mod_perform"),disabled:e.isSaving}})],1),e._v(" "),i("ConfirmationModal",{attrs:{open:e.openConfirmationModal,title:e.$str("manual_participant_add_confirmation_title","mod_perform"),"confirm-button-text":e.$str("button_create","mod_perform"),loading:e.isSaving},on:{confirm:e.trySave,cancel:e.closeConfirmModal}},[i("p",[e._v(e._s(e.confirmationMessage))])])],1)};n._withStripped=!0;var a=i("fCWf"),s=i.n(a),r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_add_participants"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_add_participants_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_add_participants"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant_instances"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"participant_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"core_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}]}}]}}]},o=i("vF5l"),d=i.n(o),l=i("BN8m"),c=i.n(l),m=i("jJ8l"),u=i.n(m),_=i("C+/B"),p=i.n(_),v=i("nEm4"),f=i.n(v),g=i("i/kK"),h=i.n(g),k=i("oMuj"),y=i.n(k),S=i("AdjL"),b=i.n(S),N={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_subject_instance_for_participation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subject_instance_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_subject_instance"},arguments:[{kind:"Argument",name:{kind:"Name",value:"subject_instance_id"},value:{kind:"Variable",name:{kind:"Name",value:"subject_instance_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"activity"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sections"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"section_relationships"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"core_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"is_subject"},arguments:[],directives:[]}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"subject_user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"participant_instances"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"core_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}}]}}]},F=i("KxNG"),A=i("vyVp"),T=i("E7bt"),C={components:{ConfirmationModal:p.a,ActionLink:s.a,Button:d.a,ButtonGroup:c.a,Form:f.a,FormRow:h.a,Card:u.a,Loader:b.a,InputText:y.a},props:{subjectInstanceId:{required:!0,type:Number},goBackLink:{required:!0,type:String}},data:()=>({subjectInstance:null,newParticipantsByCoreRelationship:{},isSaving:!1,openConfirmationModal:!1}),computed:{cardTitle(){if(!this.subjectInstance)return"";const e=this.subjectInstance.activity.name,t=this.subjectInstance.subject_user.fullname;return this.$str("activity_title_for_subject","mod_perform",{activity_name:e,subject_name:t})},distinctRelationships(){if(!this.subjectInstance)return[];const e=this.subjectInstance.activity.sections.map(e=>e.section_relationships),t={},i=[];return e.forEach(e=>{e.forEach(e=>{const n=e.core_relationship.id;e.is_subject||t[n]||i.push(e.core_relationship)})}),i},participantInstanceCount(){return Object.entries(this.newParticipantsByCoreRelationship).reduce((e,t)=>e+t[1].length,0)},confirmationMessage(){return 1===this.participantInstanceCount?this.$str("manual_participant_add_confirmation_message_singular","mod_perform"):this.$str("manual_participant_add_confirmation_message","mod_perform",this.participantInstanceCount)}},apollo:{subjectInstance:{query:N,variables(){return{subject_instance_id:this.subjectInstanceId}},update:e=>e.mod_perform_subject_instance}},methods:{getNewParticipantsAsCsv(e){return this.newParticipantsByCoreRelationship[e]?this.newParticipantsByCoreRelationship[e].join(", "):""},updateNewParticipants(e,t){const i=t.split(",").map(e=>e.trim()).filter(e=>""!==e);this.$set(this.newParticipantsByCoreRelationship,e,i)},showConfirmModal(){this.openConfirmationModal=!0},closeConfirmModal(){this.openConfirmationModal=!1},prepareParticipantsDataForSaving(){let e=[];return Object.entries(this.newParticipantsByCoreRelationship).forEach(t=>{const i=t[0];t[1].forEach(t=>{e.push({core_relationship_id:i,participant_id:t})})}),e},showMutationErrorNotification(){Object(A.notify)({duration:F.NOTIFICATION_DURATION,message:this.$str("toast_error_generic_update","mod_perform"),type:"error"})},async trySave(){this.isSaving=!0;try{const e=await this.save();Object(T.redirectWithPost)(this.goBackLink,{participant_instance_created_count:e.length})}catch(e){this.showMutationErrorNotification(),this.isSaving=!1,this.closeConfirmModal()}},async save(){const{data:{mod_perform_add_participants:{participant_instances:e}}}=await this.$apollo.mutate({mutation:r,variables:{input:{subject_instance_ids:[this.subjectInstanceId],participants:this.prepareParticipantsDataForSaving()}},refetchAll:!1});return e}}},I=i("KHd+"),E=function(e){e.options.__langStrings={mod_perform:["activity_title_for_subject","add_participants_page_title","button_cancel","button_create","manual_participant_add_confirmation_message","manual_participant_add_confirmation_message_singular","manual_participant_add_confirmation_title","manual_participant_add_no_relationships","save","toast_error_generic_update"]}},O=Object(I.a)(C,n,[],!1,null,null,null);"function"==typeof E&&E(O),O.options.__hasBlocks={script:!0,template:!0},O.options.__file="client/src/mod_perform/pages/AddParticipants.vue";t.default=O.exports},"9hJx":function(e,t,i){"use strict";function n(e,t){const i=document.createElement("form");i.style.display="hidden",i.action=e,i.method="post",Object.entries(t).forEach(e=>{const t=e[0],n=e[1],a=document.createElement("input");a.name=t,"boolean"==typeof n?(a.type="checkbox",a.checked=n):(a.type="text",a.value=n),i.appendChild(a)}),document.body.appendChild(i),i.submit()}i.r(t),i.d(t,"redirectWithPost",(function(){return n}))},"9u29":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"tui-performElementAdminForm"},[this.error?t("div",[this._v(this._s(this.error))]):this._e(),this._v(" "),this._t("content")],2)};n._withStripped=!0;var a={props:{type:{type:Object,required:!0},activityState:{type:Object,required:!0},error:{type:String}},methods:{edit(){this.$emit("edit")},remove(){this.$emit("remove")}}},s=i("KHd+"),r=function(e){e.options.__langStrings={mod_perform:["activity_action_options","section_delete_element"]}},o=Object(s.a)(a,n,[],!1,null,null,null);"function"==typeof r&&r(o),o.options.__hasBlocks={script:!0,template:!0},o.options.__file="client/src/mod_perform/components/element/ElementAdminForm.vue";t.default=o.exports},AdjL:function(e,t){e.exports=tui.require("tui/components/loader/Loader")},"Aka+":function(e,t){e.exports=tui.require("mod_perform/components/element/ElementParticipantForm")},Aros:function(e,t){e.exports=tui.require("tui/components/tag/TagList")},Awxv:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/CreateActivityForm")},BN8m:function(e,t){e.exports=tui.require("tui/components/buttons/ButtonGroup")},BRmP:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.isSubjectReport?i("SubjectOpenCloseActionModal",{attrs:{"modal-open":e.showModalOpen,"subject-instance-id":e.id,"is-open":e.isOpen,"report-type":e.reportType},on:{"modal-close":e.modalClose}}):e._e(),e._v(" "),e.isParticipantReport?i("ParticipantOpenCloseActionModal",{attrs:{"modal-open":e.showModalOpen,"participant-instance-id":e.id,"is-open":e.isOpen,"report-type":e.reportType},on:{"modal-close":e.modalClose}}):e._e(),e._v(" "),e.isSectionReport?i("SectionOpenCloseActionModal",{attrs:{"modal-open":e.showModalOpen,"participant-section-id":e.id,"is-open":e.isOpen,"report-type":e.reportType},on:{"modal-close":e.modalClose}}):e._e(),e._v(" "),e.isSubjectReport?i("a",{attrs:{href:e.participationManagementUrl,title:e.$str("activity_participants_add","mod_perform")}},[i("ParticipantAddIcon")],1):e._e(),e._v(" "),e.isOpen?i("ButtonIcon",{attrs:{"aria-label":e.$str("button_close","mod_perform"),styleclass:{transparentNoPadding:!0}},on:{click:function(t){return e.showModal()}}},[i("LockIcon")],1):i("ButtonIcon",{attrs:{"aria-label":e.$str("button_reopen","mod_perform"),styleclass:{transparentNoPadding:!0}},on:{click:function(t){return e.showModal()}}},[i("UnlockIcon")],1)],1)};n._withStripped=!0;var a=i("5h9J"),s=i.n(a),r=i("cytP"),o=i.n(r),d=i("Xuva"),l=i.n(d),c=i("mawr"),m=i.n(c),u=i("fqqR"),_=i.n(u),p=i("2HWE"),v=i.n(p),f=i("cZWK"),g=i.n(f);var h={components:{ButtonIcon:s.a,LockIcon:o.a,ParticipantOpenCloseActionModal:l.a,ParticipantAddIcon:v.a,SectionOpenCloseActionModal:m.a,SubjectOpenCloseActionModal:_.a,UnlockIcon:g.a},props:{reportType:{type:String},id:{type:String},isOpen:{type:Boolean}},data:()=>({showModalOpen:!1}),computed:{isSectionReport(){return"PARTICIPANT_SECTION"===this.reportType},isParticipantReport(){return"PARTICIPANT_INSTANCE"===this.reportType},isSubjectReport(){return"SUBJECT_INSTANCE"===this.reportType},participationManagementUrl(){return this.$url("/mod/perform/manage/participation/add_participants.php",{subject_instance_id:this.id})}},methods:{modalClose(){this.showModalOpen=!1},showModal(){this.showModalOpen=!0}}},k=i("KHd+"),y=function(e){e.options.__langStrings={mod_perform:["activity_participants_add","button_reopen","button_close"]}},S=Object(k.a)(h,n,[],!1,null,null,null);"function"==typeof y&&y(S),S.options.__hasBlocks={script:!0,template:!0},S.options.__file="client/src/mod_perform/components/report/manage_participation/Actions.vue";t.default=S.exports},BaY1:function(e,t){e.exports=tui.require("tui/components/sidepanel/SidePanel")},Bh5B:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this.$createElement,t=this._self._c||e;return t("Loader",{attrs:{loading:this.$apollo.loading}},[t("InstanceInfoCard",{attrs:{title:this.$str("participant_instance_card_title","mod_perform"),"info-lines":this.infoLines,"show-all-link":this.showAllLink}})],1)};n._withStripped=!0;var a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_participant_instance"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"participant_instance_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_participant_instance"},arguments:[{kind:"Argument",name:{kind:"Name",value:"participant_instance_id"},value:{kind:"Variable",name:{kind:"Name",value:"participant_instance_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"subject_instance"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"subject_user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"core_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"created_at"},arguments:[],directives:[]}]}}]}}]},s=i("/Ngp"),r=i.n(s),o=i("AdjL"),d=i.n(o),l={components:{InstanceInfoCard:r.a,Loader:d.a},props:{participantInstanceId:{type:Number,required:!0},showAllLink:{type:String,required:!0}},data:()=>({participantInstance:null}),computed:{infoLines(){return null===this.participantInstance?[]:[{label:this.$str("participant_instance_card_participant_full_name","mod_perform"),text:this.participantInstance.participant.fullname},{label:this.$str("instance_info_card_subject_full_name","mod_perform"),text:this.participantInstance.subject_instance.subject_user.fullname},{label:this.$str("participant_instance_card_relationship","mod_perform"),text:this.participantInstance.core_relationship.name},{label:this.$str("instance_info_card_creation_date","mod_perform"),text:this.participantInstance.created_at}]}},apollo:{participantInstance:{query:a,variables(){return{participant_instance_id:this.participantInstanceId}},update:e=>e.mod_perform_participant_instance}}},c=i("KHd+"),m=function(e){e.options.__langStrings={mod_perform:["instance_info_card_subject_full_name","instance_info_card_creation_date","participant_instance_card_participant_full_name","participant_instance_card_relationship","participant_instance_card_title"]}},u=Object(c.a)(l,n,[],!1,null,null,null);"function"==typeof m&&m(u),u.options.__hasBlocks={script:!0,template:!0},u.options.__file="client/src/mod_perform/components/manage_activity/participation/ParticipantInstanceInfoCard.vue";t.default=u.exports},"C+/B":function(e,t){e.exports=tui.require("tui/components/modal/ConfirmationModal")},CHlV:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ScheduleSettingContainer",{attrs:{title:e.title}},[e.isOpen?i("p",{staticClass:"tui-performAssignmentScheduleSettingContainer__preamble"},[e._v("\n    "+e._s(e.$str("schedule_range_date_preamble_with_from","mod_perform"))+"\n  ")]):i("p",{staticClass:"tui-performAssignmentScheduleSettingContainer__preamble"},[e._v("\n    "+e._s(e.$str("schedule_range_date_preamble","mod_perform"))+"\n  ")]),e._v(" "),e.isFixed?i("FixedScheduleRangeSelector",{attrs:{path:"scheduleFixed","has-range":!e.isOpen}}):i("RelativeDateSelector",{attrs:{path:"scheduleDynamic","has-direction":"","has-range":!e.isOpen,"dynamic-date-sources":e.dynamicDateSources,"dynamic-date-setting-component":e.dynamicDateSettingComponent}}),e._v(" "),e.isOpen&&e.isFixed?i("div",{staticClass:"tui-performAssignmentScheduleSettingContainer__onwards"},[e._v("\n    "+e._s(e.$str("schedule_date_range_onwards","mod_perform"))+"\n  ")]):e._e(),e._v(" "),e.isFixed?e._e():i("FormScope",{attrs:{path:"scheduleDynamic"}},[i("div",{staticClass:"tui-performAssignmentScheduleSettings__use-anniversary"},[i("FormCheckbox",{attrs:{name:"use_anniversary"}},[e._v("\n        "+e._s(e.$str("schedule_use_anniversary_label","mod_perform"))+"\n      ")])],1)])],1)};n._withStripped=!0;var a=i("dk0v"),s=i.n(a),r=i("K2XK"),o=i.n(r),d=i("DRQV"),l=i.n(d),c=i("LxOS"),m=i.n(c),u=i("lgQG"),_=i.n(u),p={components:{FixedScheduleRangeSelector:l.a,FormCheckbox:m.a,FormScope:_.a,RelativeDateSelector:s.a,ScheduleSettingContainer:o.a},props:{isOpen:{type:Boolean,required:!0},isFixed:{type:Boolean,required:!0},dynamicDateSources:{type:Array,required:!0},dynamicDateSettingComponent:{type:Object}},computed:{title(){return this.isOpen&&this.isFixed?this.$str("schedule_range_heading_open_fixed","mod_perform"):!this.isOpen&&this.isFixed?this.$str("schedule_range_heading_limited_fixed","mod_perform"):this.isOpen&&!this.isFixed?this.$str("schedule_range_heading_open_dynamic","mod_perform"):this.$str("schedule_range_heading_limited_dynamic","mod_perform")}}},v=i("KHd+"),f=function(e){e.options.__langStrings={mod_perform:["schedule_date_range_onwards","schedule_range_date_preamble","schedule_range_date_preamble_with_from","schedule_range_heading_limited_dynamic","schedule_range_heading_limited_fixed","schedule_range_heading_open_dynamic","schedule_range_heading_open_fixed","user_creation_date","schedule_use_anniversary_label"]}},g=Object(v.a)(p,n,[],!1,null,null,null);"function"==typeof f&&f(g),g.options.__hasBlocks={script:!0,template:!0},g.options.__file="client/src/mod_perform/components/manage_activity/assignment/schedule/ScheduleSettings.vue";t.default=g.exports},COfJ:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Card",{staticClass:"tui-performActivitySection",class:[!e.autoSave&&"tui-performActivitySection__multiple"],attrs:{"no-border":e.autoSave}},[i("div",{class:[e.editMode&&!e.autoSave&&"tui-performActivitySection__editing"]},[e.autoSave||e.editMode?e._e():i("Grid",[i("GridItem",{attrs:{units:e.isDraft?10:12}},[i("h4",{staticClass:"tui-performActivitySection__title"},[e._v("\n          "+e._s(e.savedSection.display_title)+"\n        ")])]),e._v(" "),e.isDraft?i("GridItem",{attrs:{units:2}},[i("div",{staticClass:"tui-performActivitySection__action-buttons"},[i("EditIcon",{staticClass:"tui-performActivitySection__action-edit",attrs:{"aria-label":e.$str("edit_section","mod_perform")},on:{click:e.enableEditing}}),e._v(" "),i("Dropdown",{attrs:{position:"bottom-right"},scopedSlots:e._u([{key:"trigger",fn:function(t){var n=t.toggle;return[i("MoreButton",{attrs:{"aria-label":e.$str("section_dropdown_menu","mod_perform"),"no-padding":!0},on:{click:n}})]}}],null,!1,3709095304)},[e._v(" "),i("DropdownItem",{attrs:{disabled:e.isAdding},on:{click:function(t){return e.$emit("add_above")}}},[e._v("\n              "+e._s(e.$str("section_action_add_above","mod_perform"))+"\n            ")]),e._v(" "),e.lastSection?e._e():i("DropdownItem",{attrs:{disabled:e.isAdding},on:{click:function(t){return e.$emit("add_below")}}},[e._v("\n              "+e._s(e.$str("section_action_add_below","mod_perform"))+"\n            ")]),e._v(" "),e.canDelete?i("DropdownItem",{on:{click:e.showDeleteModal}},[e._v("\n              "+e._s(e.$str("section_action_delete","mod_perform"))+"\n            ")]):e._e()],1)],1)]):e._e()],1),e._v(" "),!e.autoSave&&e.editMode?i("InputText",{attrs:{value:e.title,placeholder:e.$str("untitled_section","mod_perform"),"aria-label":e.$str("section_title","mod_perform"),maxlength:e.TITLE_INPUT_MAX_LENGTH},on:{input:function(t){e.title=t}}}):e._e(),e._v(" "),i("div",{staticClass:"tui-performActivitySection__participant"},[i("h4",{staticClass:"tui-performActivitySection__participant-heading"},[e._v("\n        "+e._s(e.$str("activity_participants_heading","mod_perform"))+"\n      ")]),e._v(" "),(e.autoSave||e.editMode)&&e.isDraft?e._e():i("span",[e._v("\n        "+e._s(e.$str("activity_participant_view_other_responses","mod_perform"))+"\n      ")]),e._v(" "),i("div",{staticClass:"tui-performActivitySection__participant-items"},e._l(e.displayedParticipantsSorted,(function(t){return i("ActivitySectionRelationship",{key:t.core_relationship.id,attrs:{participant:t,editable:(e.autoSave||e.editMode)&&e.isDraft},on:{"participant-removed":e.removeDisplayedParticipant,"can-view-changed":e.updateParticipantData}})})),1),e._v(" "),0!==e.displayedParticipantsSorted.length||(e.autoSave||e.editMode)&&e.isDraft?e._e():i("div",[i("span",{staticClass:"tui-performActivitySection__participant-info"},[e._v("\n          "+e._s(e.$str("no_participants_added","mod_perform"))+"\n        ")])]),e._v(" "),(e.autoSave||e.editMode)&&e.isDraft?i("ParticipantsPopover",{attrs:{relationships:e.relationships,"active-participants":e.displayedParticipants},on:{"update-participants":e.updateDisplayedParticipants}}):e._e()],1)],1),e._v(" "),!e.autoSave&&e.editMode?i("ButtonGroup",{staticClass:"tui-performActivitySection__saveButtons"},[i("Button",{attrs:{styleclass:{primary:!0,small:!0},text:e.$str("activity_section_done","mod_perform"),disabled:e.isSaving||!e.editMode||!e.hasChanges},on:{click:e.trySave}}),e._v(" "),i("Button",{attrs:{text:e.$str("cancel"),styleclass:{small:!0},disabled:e.isSaving||!e.editMode},on:{click:e.resetSectionChanges}})],1):e._e(),e._v(" "),i("div",{staticClass:"tui-performActivitySection__content",class:[e.autoSave&&"tui-performActivitySection__content-autoSave"]},[i("Grid",{attrs:{"stack-at":700}},[i("GridItem",{attrs:{grows:"",units:9}},[e.section.section_elements_summary?i("ActivitySectionElementSummary",{attrs:{"elements-summary":e.section.section_elements_summary}}):e._e()],1),e._v(" "),i("GridItem",{attrs:{grows:"",units:3}},[i("div",{staticClass:"tui-performActivitySection__content-buttons"},[i("EditSectionContentModal",{attrs:{"section-id":e.section.id,title:e.multipleSectionsEnabled?e.savedSection.display_title:e.activityName,"activity-state":e.activityState,"required-text":!0},on:{"update-summary":e.updateSection},scopedSlots:e._u([{key:"trigger",fn:function(t){var n=t.open;return[i("Button",{attrs:{styleclass:{small:!0},text:e.isDraft?e.$str("edit_content_elements","mod_perform"):e.$str("view_content_elements","mod_perform")},on:{click:n}})]}}])})],1)])],1)],1),e._v(" "),i("ConfirmationModal",{attrs:{open:e.deleteSectionModalOpen,title:e.$str("modal_section_delete_title","mod_perform"),"confirm-button-text":e.$str("delete"),loading:e.deleting},on:{confirm:e.deleteSection,cancel:e.closeDeleteSectionModal}},[[i("p",[e._v(e._s(e.$str("modal_section_delete_message","mod_perform")))])]],2)],1)};n._withStripped=!0;var a=i("9Afl"),s=i.n(a),r=i("F6B7"),o=i.n(r),d=i("vF5l"),l=i.n(d),c=i("BN8m"),m=i.n(c),u=i("jJ8l"),_=i.n(u),p=i("C+/B"),v=i.n(p),f={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_delete_section"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_delete_section_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_delete_section"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[]}]}}]},g=i("gLvT"),h=i.n(g),k=i("KGcv"),y=i.n(k),S=i("bF0+"),b=i.n(S),N=i("pD8U"),F=i.n(N),A=i("NAOU"),T=i.n(A),C=i("D9If"),I=i.n(C),E=i("oMuj"),O=i.n(E),$=i("tNJr"),D=i.n($),x=i("tXLW"),w=i.n(x),R={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_update_section_settings"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"update_section_settings_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_update_section_settings"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"section"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"section_relationships"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_view"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_answer"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"core_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"section_elements_summary"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"required_question_count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"optional_question_count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"other_element_count"},arguments:[],directives:[]}]}},{kind:"Field",alias:{kind:"Name",value:"raw_created_at"},name:{kind:"Name",value:"created_at"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"TIMESTAMP"}}],directives:[]},{kind:"Field",alias:{kind:"Name",value:"raw_updated_at"},name:{kind:"Name",value:"updated_at"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"TIMESTAMP"}}],directives:[]}]}}]}}]}}]},j=i("KxNG");var P={components:{ActivitySectionElementSummary:s.a,ActivitySectionRelationship:o.a,Button:l.a,ButtonGroup:m.a,Card:_.a,ConfirmationModal:v.a,Dropdown:h.a,DropdownItem:y.a,EditIcon:b.a,EditSectionContentModal:F.a,Grid:T.a,GridItem:I.a,InputText:O.a,MoreButton:D.a,ParticipantsPopover:w.a},props:{autoSave:{type:Boolean,default:!1},editMode:{type:Boolean,default:!1},section:{type:Object,required:!0},lastSection:{type:Boolean,required:!0},isAdding:{type:Boolean,required:!0},sortOrder:{type:Number,required:!0},relationships:{type:Array,required:!0},sectionCount:{type:Number,required:!0},activityName:{type:String,required:!0},multipleSectionsEnabled:{type:Boolean},activityState:{type:Object,required:!0}},data(){return{savedSection:this.section,displayedParticipants:this.getParticipantsFromSection(this.section),title:this.section.title,isSaving:!1,TITLE_INPUT_MAX_LENGTH:1024,deleteSectionModalOpen:!1,deleting:!1}},computed:{savedParticipants(){return this.getParticipantsFromSection(this.savedSection)},hasChanges(){return!!this.isNew||(this.title!==this.savedSection.title||(this.displayedParticipants.length!==this.savedParticipants.length||!this.displayedParticipants.every(e=>this.savedParticipants.find(t=>t.core_relationship.id===e.core_relationship.id&&t.can_view===e.can_view))))},displayedParticipantsSorted(){return this.displayedParticipants.slice().sort((e,t)=>e.core_relationship.sort_order-t.core_relationship.sort_order)},isNew(){return this.savedSection.raw_created_at===this.savedSection.raw_updated_at},canDelete(){return this.sectionCount>1},isDraft(){return this.activityState.name===j.ACTIVITY_STATUS_DRAFT}},methods:{getParticipantsFromSection:e=>e.section_relationships?e.section_relationships:[],getTitle(){return this.section.title},getSectionRelationships(){return this.displayedParticipants.map(e=>({core_relationship_id:e.core_relationship.id,can_view:e.can_view}))},updateSection(e){const t=Object.assign({},this.savedSection,e);this.$emit("input",t)},updateTitle(e){this.title=e},enableEditing(){this.$emit("toggle-edit-mode",!0)},disableEditing(){this.$emit("toggle-edit-mode",!1)},updateDisplayedParticipants(e){this.displayedParticipants=this.displayedParticipants.concat(e.map(e=>({can_view:!1,core_relationship:e}))),this.autoSave&&this.trySave()},updateParticipantData(e){this.displayedParticipants=this.displayedParticipants.map(t=>t.core_relationship.id===e.core_relationship.id?e:t),this.autoSave&&this.trySave()},removeDisplayedParticipant(e){this.displayedParticipants=this.displayedParticipants.filter(t=>t.core_relationship.id!==e.core_relationship.id),this.autoSave&&this.trySave()},resetSectionChanges(){this.displayedParticipants=this.getParticipantsFromSection(this.savedSection),this.title=this.savedSection.title,this.disableEditing()},async trySave(){this.isSaving=!0;try{const e=await this.save();this.updateTitle(e.section.title),this.updateSection(e),this.$emit("mutation-success")}catch(e){this.$emit("mutation-error",e)}this.isSaving=!1,this.disableEditing()},async save(){const{data:e}=await this.$apollo.mutate({mutation:R,variables:{input:{section_id:this.section.id,title:this.title,relationships:this.getSectionRelationships()}},refetchAll:!1}),t=e.mod_perform_update_section_settings;return this.savedSection=t.section,t},showDeleteModal(){this.deleteSectionModalOpen=!0},closeDeleteSectionModal(){this.deleteSectionModalOpen=!1,this.deleting=!1},async deleteSection(){this.deleting=!0;try{await this.$apollo.mutate({mutation:f,variables:{input:{section_id:this.section.id}}}),this.$emit("delete-section"),this.$emit("mutation-success")}catch(e){this.$emit("mutation-error",e)}this.closeDeleteSectionModal()}}},q=i("KHd+"),B=function(e){e.options.__langStrings={mod_perform:["activity_participant_view_other_responses","activity_participants_heading","activity_section_done","edit_content_elements","edit_section","modal_section_delete_message","modal_section_delete_title","no_participants_added","section_action_add_above","section_action_add_below","section_action_delete","section_dropdown_menu","section_title","unsaved_changes_warning","untitled_section","view_content_elements"],moodle:["cancel","delete"]}},M=Object(q.a)(P,n,[],!1,null,null,null);"function"==typeof B&&B(M),M.options.__hasBlocks={script:!0,template:!0},M.options.__file="client/src/mod_perform/components/manage_activity/content/ActivitySection.vue";t.default=M.exports},"CW/P":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performAssignmentSchedule"},[i("h3",{staticClass:"tui-performAssignmentSchedule__heading"},[e._v("\n    "+e._s(e.$str("activity_instance_creation_heading","mod_perform"))+"\n  ")]),e._v(" "),i("ScheduleToggles",{attrs:{"schedule-is-open":e.scheduleIsOpen,"schedule-is-fixed":e.scheduleIsFixed,"due-date-is-enabled":e.dueDateIsEnabled,"repeating-is-enabled":e.repeatingIsEnabled},on:{"update:scheduleIsOpen":function(t){e.scheduleIsOpen=t},"update:schedule-is-open":function(t){e.scheduleIsOpen=t},"update:scheduleIsFixed":function(t){e.scheduleIsFixed=t},"update:schedule-is-fixed":function(t){e.scheduleIsFixed=t},"update:dueDateIsEnabled":function(t){e.dueDateIsEnabled=t},"update:due-date-is-enabled":function(t){e.dueDateIsEnabled=t},"update:repeatingIsEnabled":function(t){e.repeatingIsEnabled=t},"update:repeating-is-enabled":function(t){e.repeatingIsEnabled=t}}}),e._v(" "),i("Uniform",{attrs:{"initial-values":e.initialValues,"input-width":"full",validate:e.validator},on:{submit:e.showConfirmationModal,change:e.onChange},scopedSlots:e._u([{key:"default",fn:function(t){t.getSubmitting;var n=t.reset;return[i("ScheduleSettings",{attrs:{"is-open":e.scheduleIsOpen,"is-fixed":e.scheduleIsFixed,"dynamic-date-sources":e.dynamicDateSources,"dynamic-date-setting-component":e.dynamicDateSettingComponent}}),e._v(" "),i("FrequencySettings",{attrs:{"is-open":e.scheduleIsOpen,"is-repeating":e.repeatingIsEnabled,"repeating-type":e.repeatingType}}),e._v(" "),i("DueDateSettings",{attrs:{"is-enabled":e.dueDateIsEnabled,"is-fixed":e.dueDateIsFixed,"schedule-is-limited-fixed":!e.scheduleIsOpen&&e.scheduleIsFixed}}),e._v(" "),i("div",{staticClass:"tui-performAssignmentSchedule__additional_settings"},[i("AdditionalScheduleSettings",{attrs:{"uses-job-based-dynamic-source":e.isUsingJobBasedDynamicSource,"dynamic-source-name":e.dynamicDateSourceName}})],1),e._v(" "),i("div",{staticClass:"tui-performAssignmentSchedule__action"},[i("ButtonGroup",[i("Button",{attrs:{disabled:e.isSaving,styleclass:{primary:"true"},text:e.$str("schedule_save_changes","mod_perform"),type:"submit"}}),e._v(" "),i("Button",{attrs:{disabled:e.isSaving,text:e.$str("cancel","moodle")},on:{click:n}})],1)],1)]}}])}),e._v(" "),i("ConfirmationModal",{attrs:{title:e.$str("schedule_confirm_title","mod_perform"),"confirm-button-text":e.$str("modal_confirm","mod_perform"),open:e.confirmationModalOpen},on:{confirm:e.trySave,cancel:e.hideConfirmationModal}},[e.isActive?i("p",[e._v("\n      "+e._s(e.$str("schedule_confirm_title_active","mod_perform"))+"\n    ")]):i("p",[e._v("\n      "+e._s(e.$str("schedule_confirm_title_draft","mod_perform"))+"\n    ")])])],1)};n._withStripped=!0;var a=i("WDyM"),s=i.n(a),r=i("vF5l"),o=i.n(r),d=i("BN8m"),l=i.n(d),c=i("6e99"),m=i.n(c),u=i("C+/B"),_=i.n(u),p=i("NMYu"),v=i.n(p),f=i("/V0O"),g=i.n(f),h=i("w31e"),k=i.n(h),y={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_update_track_schedule"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"track_schedule"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_track_schedule_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_update_track_schedule"},arguments:[{kind:"Argument",name:{kind:"Name",value:"track_schedule"},value:{kind:"Variable",name:{kind:"Name",value:"track_schedule"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"track"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"description"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject_instance_generation"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_is_open"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_is_fixed"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_fixed_from"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"iso"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"timezone"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"schedule_fixed_to"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"iso"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"timezone"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"schedule_dynamic_from"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"unit"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"direction"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"schedule_dynamic_to"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"unit"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"direction"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"schedule_dynamic_source"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"resolver_class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"option_key"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_available"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"custom_setting_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"custom_data"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_base"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"schedule_use_anniversary"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"due_date_is_enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"due_date_is_fixed"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"due_date_fixed"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"iso"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"timezone"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"due_date_offset"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"unit"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"repeating_is_enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"repeating_type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"repeating_offset"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"unit"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"repeating_is_limited"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"repeating_limit"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject_instance_generation"},arguments:[],directives:[]}]}}]}}]}}]},S=i("KxNG"),b=i("WBvU"),N=i("vyVp"),F=i("sVqh"),A={components:{AdditionalScheduleSettings:s.a,Button:o.a,ButtonGroup:l.a,ConfirmationModal:_.a,FrequencySettings:m.a,DueDateSettings:v.a,ScheduleSettings:g.a,ScheduleToggles:k.a,Uniform:b.Uniform},props:{track:{type:Object,required:!0},dynamicDateSources:{type:Array,required:!0},defaultFixedDate:{type:Object},activityId:{type:Number,required:!0},activityState:{type:String,required:!0}},data(){return{scheduleIsOpen:this.track.schedule_is_open,scheduleIsFixed:this.track.schedule_is_fixed,dueDateIsEnabled:this.track.due_date_is_enabled,dueDateIsFixed:this.track.due_date_is_fixed||!1,repeatingIsEnabled:this.track.repeating_is_enabled,repeatingType:this.track.repeating_type||S.SCHEDULE_REPEATING_TYPE_AFTER_CREATION,isSaving:!1,initialValues:this.getInitialValues(this.track),dynamicDateSettingComponent:{name:this.getDynamicCustomSettingComponent(),data:this.getDynamicCustomSettingData(this.track),configData:this.getDynamicCustomSettingConfig()},formValuesToSave:null,confirmationModalOpen:!1,isUsingJobBasedDynamicSource:this.dynamicDateSourceIsJobBased(),dynamicDateSourceName:this.getDynamicDateSourceName()}},computed:{isActive(){return this.activityState==S.ACTIVITY_STATUS_ACTIVE}},methods:{onChange(e){if(this.dueDateIsFixed="true"===e.dueDateIsFixed,this.repeatingType=e.repeatingType,e.scheduleDynamic.dynamic_source){const t=this.getSelectedDynamicDateSourceFromValues(e);this.dynamicDateSettingComponent.name=t.custom_setting_component,this.dynamicDateSettingComponent.data=JSON.parse(t.custom_data),this.isUsingJobBasedDynamicSource=!this.scheduleIsFixed&&this.dynamicDateSourceIsJobBased(t),this.dynamicDateSourceName=this.getDynamicDateSourceName(t)}},validator(e){if(!this.dueDateIsEnabled)return{};const t=this.$str("due_date_error_must_be_after_creation_date","mod_perform");if(this.dueDateIsFixed){if(e.dueDateFixed.iso===e.scheduleFixed.to.iso||!Object(F.isIsoAfter)(e.dueDateFixed.iso,e.scheduleFixed.to.iso))return{dueDateFixed:t}}else if(e.dueDateOffset.from_count<=0)return{dueDateOffset:{from_count:t}};return{}},getInitialValues(e){let t="0",i=S.RELATIVE_DATE_UNIT_DAY,n=S.RELATIVE_DATE_DIRECTION_BEFORE;e.schedule_dynamic_from&&(t=e.schedule_dynamic_from.count,i=e.schedule_dynamic_from.unit,n=e.schedule_dynamic_from.direction);let a="0",s=S.RELATIVE_DATE_UNIT_DAY,r=S.RELATIVE_DATE_DIRECTION_BEFORE;e.schedule_dynamic_to&&(a=e.schedule_dynamic_to.count,s=e.schedule_dynamic_to.unit,r=e.schedule_dynamic_to.direction);let o="14",d=S.RELATIVE_DATE_UNIT_DAY;return e.due_date_offset&&(o=e.due_date_offset.count,d=e.due_date_offset.unit),{scheduleFixed:{from:e.schedule_fixed_from||this.defaultFixedDate,to:e.schedule_fixed_to||this.defaultFixedDate},scheduleDynamic:{from_count:t,from_unit:i,from_direction:n,to_count:a,to_unit:s,to_direction:r,dynamic_source:this.getCombinedDynamicSourceKey(e),use_anniversary:e.schedule_use_anniversary,dynamicCustomSettings:this.getDynamicCustomSettingData(e)},dueDateIsFixed:(e.due_date_is_fixed||!1).toString(),dueDateFixed:e.due_date_fixed||this.defaultFixedDate,dueDateOffset:{from_count:o,from_unit:d},additionalSettings:{subject_instance_generation:e.subject_instance_generation},repeatingType:e.repeating_type||S.SCHEDULE_REPEATING_TYPE_AFTER_CREATION,repeatingIsLimited:e.repeating_is_limited||!1,repeatingLimit:e.repeating_limit||"3",repeatingOffset:this.initRepeatingOffset(e)}},getCombinedDynamicSourceKey(e){let t=null;return t=e.schedule_dynamic_source?e.schedule_dynamic_source:this.dynamicDateSources[0],`${t.resolver_class_name}--${t.option_key}`},async trySave(){const e=this.formValuesToSave;this.isSaving=!0;try{const t=await this.save(this.getMutationVariables(e));this.initialValues=this.getInitialValues(t),this.hideConfirmationModal(),this.showSuccessNotification(),this.isSaving=!1}catch(e){this.hideConfirmationModal(),this.showErrorNotification(),this.isSaving=!1}},getMutationVariables(e){return{track_schedule:Object.assign({track_id:this.track.id},this.getScheduleVariables(e),this.getRepeatingVariables(e),this.getDueDateVariables(e),this.getAdditionalSettingsVariables(e))}},getScheduleVariables(e){const t={};if(t.schedule_is_open=this.scheduleIsOpen,t.schedule_is_fixed=this.scheduleIsFixed,this.scheduleIsFixed){let i=e.scheduleFixed.from.timezone;t.schedule_fixed_from={iso:e.scheduleFixed.from.iso,timezone:i},this.scheduleIsOpen||(t.schedule_fixed_to={iso:e.scheduleFixed.to.iso,timezone:i})}else{t.schedule_dynamic_from={},t.schedule_dynamic_from.count=Number(e.scheduleDynamic.from_count),t.schedule_dynamic_from.unit=e.scheduleDynamic.from_unit,t.schedule_dynamic_from.direction=e.scheduleDynamic.from_direction,t.schedule_use_anniversary=e.scheduleDynamic.use_anniversary;const i=e.scheduleDynamic.dynamic_source.split("--"),n=Object.assign({},this.getDynamicCustomSettingConfig(),e.scheduleDynamic.dynamicCustomSettings);t.schedule_dynamic_source={resolver_class_name:i[0],option_key:i[1],custom_data:JSON.stringify(n)},t.due_date_offset=null,this.scheduleIsOpen||(t.schedule_dynamic_to={},t.schedule_dynamic_to.count=Number(e.scheduleDynamic.to_count),t.schedule_dynamic_to.unit=e.scheduleDynamic.to_unit,t.schedule_dynamic_to.direction=e.scheduleDynamic.to_direction)}return t},initRepeatingOffset(e){let t=[];if([S.SCHEDULE_REPEATING_TYPE_AFTER_CREATION,S.SCHEDULE_REPEATING_TYPE_AFTER_CREATION_WHEN_COMPLETE,S.SCHEDULE_REPEATING_TYPE_AFTER_COMPLETION].forEach(e=>{t[e]={from_count:"4",from_unit:S.RELATIVE_DATE_UNIT_WEEK}}),e.repeating_type){let i=t[e.repeating_type].from_count,n=t[e.repeating_type].from_unit;e.repeating_offset&&(i=e.repeating_offset.count,n=e.repeating_offset.unit),t[e.repeating_type].from_count=i,t[e.repeating_type].from_unit=n}return t},getRepeatingVariables(e){const t={};if(t.repeating_is_enabled=this.repeatingIsEnabled,t.repeating_is_enabled){t.repeating_type=e.repeatingType;let i=t.repeating_type;t.repeating_offset={},t.repeating_offset.count=Number(e.repeatingOffset[i].from_count),t.repeating_offset.unit=e.repeatingOffset[i].from_unit,t.repeating_is_limited=e.repeatingIsLimited,t.repeating_is_limited&&(t.repeating_limit=Number(e.repeatingLimit))}return t},getDueDateVariables(e){const t={};return t.due_date_is_enabled=this.dueDateIsEnabled,this.dueDateIsEnabled?(!this.scheduleIsOpen&&this.scheduleIsFixed&&(t.due_date_is_fixed=this.dueDateIsFixed),t.due_date_is_fixed?t.due_date_fixed=e.dueDateFixed:(t.due_date_offset={},t.due_date_offset.count=Number(e.dueDateOffset.from_count),t.due_date_offset.unit=e.dueDateOffset.from_unit),t):t},getAdditionalSettingsVariables(e){const t={};return t.subject_instance_generation=e.additionalSettings.subject_instance_generation,t},async save(e){const{data:t}=await this.$apollo.mutate({mutation:y,variables:e});return t.mod_perform_update_track_schedule.track},showErrorNotification(){Object(N.notify)({duration:S.NOTIFICATION_DURATION,message:this.$str("toast_error_generic_update","mod_perform"),type:"error"})},showSuccessNotification(){Object(N.notify)({duration:S.NOTIFICATION_DURATION,message:this.$str("toast_success_save_schedule","mod_perform"),type:"success"})},getDynamicCustomSettingData(e){let t={};return t=e.schedule_dynamic_source?JSON.parse(e.schedule_dynamic_source.custom_data):JSON.parse(this.dynamicDateSources[0].custom_data),t},getDynamicCustomSettingComponent(){let e=null;return e=this.track&&this.track.schedule_dynamic_source?this.track.schedule_dynamic_source.custom_setting_component:this.dynamicDateSources[0].custom_setting_component,e},getSelectedDynamicDateSourceFromValues(e){return this.dynamicDateSources.filter(t=>`${t.resolver_class_name}--${t.option_key}`==e.scheduleDynamic.dynamic_source).shift()},getDynamicCustomSettingConfig(){return{this_activity_id:this.activityId}},isDynamicCustomSettingSource(e){return null!==this.dynamicDateSources.filter(t=>`${t.resolver_class_name}--${t.option_key}`==e).shift().custom_setting_component},showConfirmationModal(e){this.formValuesToSave=e,this.confirmationModalOpen=!0},hideConfirmationModal(){this.formValuesToSave=null,this.confirmationModalOpen=!1},dynamicDateSourceIsJobBased(e){return e?e.resolver_base==S.DATE_RESOLVER_JOB_BASED:!(!this.track||!this.track.schedule_dynamic_source)&&this.track.schedule_dynamic_source.resolver_base==S.DATE_RESOLVER_JOB_BASED},getDynamicDateSourceName(e){return e?e.display_name:this.track&&this.track.schedule_dynamic_source?this.track.schedule_dynamic_source.display_name:null}}},T=i("KHd+"),C=function(e){e.options.__langStrings={mod_perform:["activity_instance_creation_heading","due_date_error_must_be_after_creation_date","modal_confirm","schedule_confirm_title","schedule_confirm_title_active","schedule_confirm_title_draft","schedule_save_changes","toast_error_generic_update","toast_success_save_schedule"],moodle:["cancel"]}},I=Object(T.a)(A,n,[],!1,null,null,null);"function"==typeof C&&C(I),I.options.__hasBlocks={script:!0,template:!0},I.options.__file="client/src/mod_perform/components/manage_activity/assignment/Schedule.vue";t.default=I.exports},D31S:function(e,t){e.exports=tui.require("tui/components/modal/InformationModal")},D3AF:function(e,t){e.exports=tui.require("tui/components/adder/AudienceAdder")},D9If:function(e,t){e.exports=tui.require("tui/components/grid/GridItem")},DFGH:function(e,t,i){"use strict";i.r(t);var n=i("lBzj"),a=i.n(n),s={functional:!0,components:{FlexIcon:a.a},props:{alt:String,customClass:[String,Object,Array],styleClass:Object,size:[String,Number],title:String},render:(e,{props:t})=>e(a.a,{props:Object.assign({},t,{icon:"tasks"})})},r=i("KHd+"),o=Object(r.a)(s,void 0,void 0,!1,null,null,null);o.options.__hasBlocks={script:!0,template:!1},o.options.__file="client/src/mod_perform/components/icons/ParticipationReporting.vue";t.default=o.exports},DHpr:function(e,t){e.exports=tui.require("tui/components/icons/common/Delete")},DRQV:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/assignment/schedule/FixedScheduleRangeSelector")},DUw4:function(e,t){e.exports=tui.require("mod_perform/components/icons/ReportingIdentifier")},"E+p/":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performManageActivityGeneralInfo"},[i("h3",{staticClass:"tui-performManageActivityGeneralInfo__heading"},[e._v("\n    "+e._s(e.$str("activity_general_tab_heading","mod_perform"))+"\n  ")]),e._v(" "),i("Form",[i("FormRow",{attrs:{label:e.$str("general_info_label_activity_title","mod_perform"),required:""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.id;return[i("InputText",{attrs:{id:n,maxlength:e.ACTIVITY_NAME_MAX_LENGTH},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})]}}])}),e._v(" "),i("FormRow",{attrs:{label:e.$str("general_info_label_activity_description","mod_perform")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.id;return[i("Textarea",{attrs:{id:n},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})]}}])}),e._v(" "),i("FormRow",{attrs:{label:e.$str("general_info_label_activity_type","mod_perform")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.id;return[i("div",[e.isActive?i("span",{staticClass:"tui-performManageActivityGeneralInfo"},[e._v(e._s(e.value.type.display_name))]):i("Select",{attrs:{id:n,"aria-labelledby":n,"aria-describedby":e.$id("aria-describedby"),options:e.activityTypes},model:{value:e.form.type_id,callback:function(t){e.$set(e.form,"type_id",t)},expression:"form.type_id"}})],1)]}}])}),e._v(" "),[i("h3",{staticClass:"tui-performManageActivityGeneralInfo__heading"},[e._v("\n        "+e._s(e.$str("activity_general_response_attribution_heading","mod_perform"))+"\n      ")]),e._v(" "),i("FormRow",{attrs:{label:e.$str("activity_general_anonymous_responses_label","mod_perform")}},[e.isActive?i("span",[e._v(e._s(e.activeToggleText(e.value.anonymous_responses)))]):i("ToggleSwitch",{attrs:{"toggle-first":""},model:{value:e.form.anonymousResponse,callback:function(t){e.$set(e.form,"anonymousResponse",t)},expression:"form.anonymousResponse"}})],1)],e._v(" "),i("div",{staticClass:"tui-performManageActivityManualRelationships"},[i("h3",{staticClass:"tui-performManageActivityManualRelationships__heading"},[e._v("\n        "+e._s(e.$str("general_info_participant_selection_heading","mod_perform"))+"\n      ")]),e._v(" "),i("p",[e._v("\n        "+e._s(e.$str("general_info_participant_selection_description","mod_perform"))+"\n      ")]),e._v(" "),e._l(e.manualRelationships,(function(t){return i("FormRow",{key:t.id,attrs:{label:t.name},scopedSlots:e._u([{key:"default",fn:function(n){var a=n.id;return[i("div",[e.isActive?i("span",[e._v("\n            "+e._s(t.selector_relationship_name)+"\n          ")]):i("Select",{attrs:{id:a,"aria-labelledby":a,"aria-label":t.name,"aria-describedby":e.$id("aria-describedby"),options:e.manualRelationshipOptions},model:{value:e.form.manualRelationshipSelections[t.id],callback:function(i){e.$set(e.form.manualRelationshipSelections,t.id,i)},expression:"form.manualRelationshipSelections[relationship.id]"}})],1)]}}],null,!0)})}))],2),e._v(" "),i("FormRow",[i("ButtonGroup",[i("Button",{attrs:{styleclass:{primary:!0},text:e.$str("save_changes","mod_perform"),disabled:e.isSaving||e.hasNoTitle,type:"submit"},on:{click:function(t){return t.preventDefault(),e.trySave(t)}}}),e._v(" "),i("Button",{attrs:{disabled:e.isSaving,text:e.$str("cancel","moodle")},on:{click:e.resetChanges}})],1)],1)],2)],1)};n._withStripped=!0;var a=i("vF5l"),s=i.n(a),r=i("BN8m"),o=i.n(r),d=i("nEm4"),l=i.n(d),c=i("i/kK"),m=i.n(c),u=i("oMuj"),_=i.n(u),p=i("fw38"),v=i.n(p),f=i("ruKP"),g=i.n(f),h=i("lOlL"),k=i.n(h),y=i("KxNG"),S=i("+kGl"),b={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_manual_relationship_selector_options"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"activity_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_manual_relationship_selector_options"},arguments:[{kind:"Argument",name:{kind:"Name",value:"activity_id"},value:{kind:"Variable",name:{kind:"Name",value:"activity_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]},N={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_update_activity"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"activity_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"description"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"type_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"anonymous_responses"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"relationships"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_activity_manual_relationship_selection_input"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"with_relationships"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_update_activity"},arguments:[{kind:"Argument",name:{kind:"Name",value:"activity_id"},value:{kind:"Variable",name:{kind:"Name",value:"activity_id"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"description"},value:{kind:"Variable",name:{kind:"Name",value:"description"}}},{kind:"Argument",name:{kind:"Name",value:"type_id"},value:{kind:"Variable",name:{kind:"Name",value:"type_id"}}},{kind:"Argument",name:{kind:"Name",value:"anonymous_responses"},value:{kind:"Variable",name:{kind:"Name",value:"anonymous_responses"}}},{kind:"Argument",name:{kind:"Name",value:"relationships"},value:{kind:"Variable",name:{kind:"Name",value:"relationships"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activity"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"edit_name"},name:{kind:"Name",value:"name"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"description"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"edit_description"},name:{kind:"Name",value:"description"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"anonymous_responses"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"manual_relationships"},arguments:[],directives:[{kind:"Directive",name:{kind:"Name",value:"include"},arguments:[{kind:"Argument",name:{kind:"Name",value:"if"},value:{kind:"Variable",name:{kind:"Name",value:"with_relationships"}}}]}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"manual_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"idnumber"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"selector_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"idnumber"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}}]}}]}}]},F={components:{Button:s.a,ButtonGroup:o.a,Form:l.a,FormRow:m.a,InputText:_.a,Select:v.a,Textarea:g.a,ToggleSwitch:k.a},props:{value:{type:Object,required:!0,validator(e){let t=Object.keys(e);return t.includes("edit_name")&&t.includes("edit_description")&&t.includes("anonymous_responses")&&t.includes("manual_relationships")}}},data(){return{form:{name:this.value.edit_name,description:this.value.edit_description,type_id:this.value.type.id,manualRelationshipSelections:this.getManualRelationshipSelections(),anonymousResponse:this.value&&this.value.anonymous_responses},activityTypes:[{id:this.value.type.id,label:this.value.type.display_name}],manualRelationshipOptions:this.value.manual_relationships.map(e=>({id:e.selector_relationship.id,label:e.selector_relationship.name})),isSaving:!1,mutationError:null}},computed:{hasNoTitle(){return!this.form.name||0===this.form.name.trim().length},isActive(){return!!this.value&&this.value.state_details.name===y.ACTIVITY_STATUS_ACTIVE},manualRelationships(){return this.value?this.value.manual_relationships.map(e=>({name:e.manual_relationship.name,id:e.manual_relationship.id,selector_relationship_id:e.selector_relationship.id,selector_relationship_name:e.selector_relationship.name})):[]}},created(){this.ACTIVITY_NAME_MAX_LENGTH=y.ACTIVITY_NAME_MAX_LENGTH},mounted(){window.addEventListener("beforeunload",this.unloadHandler)},apollo:{activityTypes:{query:S.a,variables:()=>[],update:({mod_perform_activity_types:e})=>e.map(e=>({id:e.id,label:e.display_name})).sort((e,t)=>e.label.localeCompare(t.label))},manualRelationshipOptions:{query:b,variables(){return{activity_id:this.value.id}},update:({mod_perform_manual_relationship_selector_options:e})=>e.map(e=>({id:e.id,label:e.name}))}},methods:{getManualRelationshipSelections(){let e={};return this.value&&this.value.manual_relationships&&this.value.manual_relationships.forEach(t=>{e[t.manual_relationship.id]=t.selector_relationship.id}),e},async trySave(){this.isSaving=!0;try{const e=await this.save();this.updateActivity(e),this.$emit("mutation-success",e)}catch(e){this.$emit("mutation-error",e)}this.isSaving=!1},async save(){let e=N,t={activity_id:this.value.id,name:this.form.name,description:this.form.description,with_relationships:!1};this.isActive||(this.value.anonymous_responses!==this.form.anonymousResponse&&(t.anonymous_responses=this.form.anonymousResponse),this.value.type.id!==this.form.type_id&&(t.type_id=this.form.type_id),this.hasChangesToRelationshipSelection()&&(t.with_relationships=!0,t.relationships=Object.keys(this.form.manualRelationshipSelections).map(e=>({manual_relationship_id:e,selector_relationship_id:this.form.manualRelationshipSelections[e]}))));const{data:i}=await this.$apollo.mutate({mutation:e,variables:t,refetchAll:!1});return i.mod_perform_update_activity.activity},activeToggleText(e){return e?this.$str("boolean_setting_text_enabled","mod_perform"):this.$str("boolean_setting_text_disabled","mod_perform")},hasUnsavedChanges(){return this.form.name!==this.value.edit_name||this.form.description!==this.value.edit_description||this.form.type_id!==this.value.type.id||this.form.anonymousResponse!==this.value.anonymous_responses||this.hasChangesToRelationshipSelection()},hasChangesToRelationshipSelection(){return this.manualRelationships.some(e=>this.form.manualRelationshipSelections[e.id]!==e.selector_relationship_id)},updateActivity(e){let t=Object.assign({},this.value,e);this.$emit("input",t)},unloadHandler(e){if(!this.hasUnsavedChanges())return;const t=this.$str("unsaved_changes_warning","mod_perform");return e.preventDefault(),e.returnValue=t,t},resetChanges(){this.resetActivityChanges(),this.resetManualRelationshipChanges()},resetActivityChanges(){this.form.name=this.value.edit_name,this.form.description=this.value.edit_description,this.form.type_id=this.value.type.id,this.form.anonymousResponse=this.value.anonymous_responses},resetManualRelationshipChanges(){this.value.manual_relationships.map(e=>{this.form.manualRelationshipSelections[e.manual_relationship.id]=e.selector_relationship.id})}}},A=i("KHd+"),T=function(e){e.options.__langStrings={mod_perform:["activity_general_tab_heading","activity_general_response_attribution_heading","activity_general_anonymous_responses_label","boolean_setting_text_enabled","boolean_setting_text_disabled","general_info_label_activity_description","general_info_label_activity_title","general_info_label_activity_type","general_info_participant_selection_description","general_info_participant_selection_heading","save_changes","unsaved_changes_warning"],moodle:["cancel"]}},C=Object(A.a)(F,n,[],!1,null,null,null);"function"==typeof T&&T(C),C.options.__hasBlocks={script:!0,template:!0},C.options.__file="client/src/mod_perform/components/manage_activity/GeneralInfoTab.vue";t.default=C.exports},E7bt:function(e,t){e.exports=tui.require("mod_perform/redirect")},EpBX:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performEditSectionContentAddElement"},[i("Dropdown",{attrs:{separator:!0},scopedSlots:e._u([{key:"trigger",fn:function(t){var n=t.toggle,a=t.isOpen;return[i("ButtonIcon",{attrs:{"aria-expanded":a?"true":"false","aria-label":e.$str("section_add_element","mod_perform"),text:e.$str("section_add_element","mod_perform"),styleclass:{small:!0},caret:!0},on:{click:function(e){return e.preventDefault(),n(e)}}},[i("AddIcon",{attrs:{size:"200"}})],1)]}}])},[e._v(" "),e._l(e.elementPlugins,(function(t){return i("DropdownItem",{key:t.plugin_name,on:{click:function(i){return e.addElementPlugin(t)}}},[e._v("\n      "+e._s(t.name)+"\n    ")])}))],2)],1)};n._withStripped=!0;var a=i("vgT7"),s=i.n(a),r=i("5h9J"),o=i.n(r),d=i("gLvT"),l=i.n(d),c=i("KGcv"),m=i.n(c),u={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_element_plugins"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_element_plugins"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"plugin_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"admin_form_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"admin_display_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"admin_read_only_display_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"participant_form_component"},arguments:[],directives:[]}]}}]}}]},_={components:{AddIcon:s.a,ButtonIcon:o.a,Dropdown:l.a,DropdownItem:m.a},data:()=>({elementPlugins:[]}),apollo:{elementPlugins:{query:u,variables:()=>[],update:e=>e.mod_perform_element_plugins}},methods:{addElementPlugin(e){this.$emit("add-element-item",e)}}},p=i("KHd+"),v=function(e){e.options.__langStrings={mod_perform:["section_element_questions","section_add_element"]}},f=Object(p.a)(_,n,[],!1,null,null,null);"function"==typeof v&&v(f),f.options.__hasBlocks={script:!0,template:!0},f.options.__file="client/src/mod_perform/components/manage_activity/content/ContentAddElementButton.vue";t.default=f.exports},F6B7:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/content/ActivitySectionRelationship")},"FL/Z":function(e,t){e.exports=tui.require("mod_perform/components/icons/EndDateDisabled")},FSRe:function(e,t){e.exports=tui.require("mod_perform/components/user_activities/list/Activities")},Fja8:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("p",[e.notVisibleToAnyone?[e._v("\n    "+e._s(e.$str("response_visibility_not_visible_to_anyone","mod_perform"))+"\n  ")]:[e.anonymousResponses?i("span",{domProps:{innerHTML:e._s(e.$str("response_visibility_label_anonymous","mod_perform"))}}):i("span",{domProps:{innerHTML:e._s(e.$str("response_visibility_label","mod_perform"))}}),e._v(" "),e._l(e.relationshipDescriptions,(function(t,n){return[i("span",{key:n,domProps:{innerHTML:e._s(t)}}),n+1!==e.relationshipDescriptions.length?[e._v(",\n      ")]:e._e()]}))]],2)};n._withStripped=!0;var a=i("KxNG"),s={props:{currentUserIsSubject:{type:Boolean,required:!0},visibleToRelationships:{type:Array,required:!0},anonymousResponses:{type:Boolean,required:!0}},computed:{notVisibleToAnyone(){return 0===this.visibleToRelationships.length||this.currentUserIsSubject&&this.visibleToSubjectOnly},visibleToSubjectOnly(){return 1===this.visibleToRelationships.length&&this.visibleToSubject},relationshipDescriptions(){return this.currentUserIsSubject?this.descriptionsForSubject:this.descriptionsForNonSubject},descriptionsForSubject(){return this.nonSubjectRelationships.map(e=>this.$str("response_visibility_your_relationship","mod_perform",e.name_plural))},descriptionsForNonSubject(){const e=[];this.visibleToSubject&&e.push(this.$str("response_visibility_the_employee","mod_perform"));const t=this.nonSubjectRelationships.map(e=>this.$str("response_visibility_the_employees_relationship","mod_perform",e.name_plural));return Array.prototype.push.apply(e,t),e},visibleToSubject(){return this.visibleToRelationships.some(e=>e.idnumber===a.RELATIONSHIP_SUBJECT)},nonSubjectRelationships(){return this.visibleToRelationships.filter(e=>e.idnumber!==a.RELATIONSHIP_SUBJECT)}}},r=i("KHd+"),o=function(e){e.options.__langStrings={mod_perform:["response_visibility_label","response_visibility_label_anonymous","response_visibility_not_visible_to_anyone","response_visibility_the_employee","response_visibility_the_employees_relationship","response_visibility_your_relationship"]}},d=Object(r.a)(s,n,[],!1,null,null,null);"function"==typeof o&&o(d),d.options.__hasBlocks={script:!0,template:!0},d.options.__file="client/src/mod_perform/components/user_activities/participant/ResponsesAreVisibleToDescription.vue";t.default=d.exports},G6cq:function(e,t){e.exports=tui.require("tui/components/form/RadioGroup")},H3Bi:function(e,t){e.exports=tui.require("mod_perform/components/icons/EndDateEnabled")},HGaK:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/content/ActivitySection")},HSlS:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performManageActivityContent"},[i("WorkflowSettings",{attrs:{activity:e.value}}),e._v(" "),i("h3",{staticClass:"tui-performManageActivityContent__heading"},[e._v("\n    "+e._s(e.$str("activity_content_tab_heading","mod_perform"))+"\n  ")]),e._v(" "),e.isDraft?i("ActivityMultipleSectionToggle",{attrs:{activity:e.value},on:{change:function(t){return e.updateMultiSection(t)}}}):e._e(),e._v(" "),i("div",{staticClass:"tui-performManageActivityContent__items"},e._l(e.sectionStates,(function(t,n){return i("ActivitySection",{key:t.section.id,ref:"activitySection",refInFor:!0,attrs:{"auto-save":e.autoSave,"edit-mode":t.editMode,section:t.section,"last-section":n===e.sectionStates.length-1,"is-adding":e.isAdding,"sort-order":t.sortOrder,"section-count":e.sectionStates.length,relationships:e.relationships,"activity-name":e.value.name,"multiple-sections-enabled":e.value.settings.multisection,"activity-state":e.activityState},on:{input:function(t){return e.updateSection(t,n)},"toggle-edit-mode":function(t){return e.toggleSectionStateEditMode(t,n)},"mutation-success":function(t){return e.$emit("mutation-success")},"mutation-error":function(t){return e.$emit("mutation-error")},add_above:function(t){return e.addSectionAbove(n)},add_below:function(t){return e.addSectionBelow(n)},"delete-section":function(t){return e.deleteSection(n)}}})})),1),e._v(" "),e.value.settings.multisection&&e.isDraft?i("ButtonIcon",{attrs:{disabled:e.isAdding,"aria-label":e.$str("add_section","mod_perform"),text:e.$str("add_section","mod_perform")},on:{click:function(t){return e.addSection(null)}}},[i("AddIcon",{attrs:{size:"200"}})],1):e._e()],1)};n._withStripped=!0;var a=i("lWyS"),s=i.n(a),r=i("HGaK"),o=i.n(r),d=i("vgT7"),l=i.n(d),c={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_add_section"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_add_section_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_add_section"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"section"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sort_order"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"section_relationships"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_view"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_answer"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"core_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"section_elements_summary"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"required_question_count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"optional_question_count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"other_element_count"},arguments:[],directives:[]}]}}]}}]}}]}}]},m=i("5h9J"),u=i.n(m),_={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_relationships"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"activity_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_relationships"},arguments:[{kind:"Argument",name:{kind:"Name",value:"activity_id"},value:{kind:"Variable",name:{kind:"Name",value:"activity_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"idnumber"},arguments:[],directives:[]}]}}]}}]},p=i("JLSV"),v=i.n(p),f=i("KxNG"),g={components:{ActivityMultipleSectionToggle:s.a,ActivitySection:o.a,AddIcon:l.a,ButtonIcon:u.a,WorkflowSettings:v.a},props:{value:{type:Object,required:!0}},data(){return{sectionStates:this.createSectionStates(this.value),relationships:[],isAdding:!1}},computed:{autoSave(){return!this.value.settings.multisection},hasUnsavedChanges(){return!this.autoSave&&this.sectionStates.some(e=>e.editMode)&&this.$refs.activitySection.some(e=>e.hasChanges)},activityState(){return this.value.state_details},isDraft(){return this.activityState.name===f.ACTIVITY_STATUS_DRAFT}},mounted(){window.addEventListener("beforeunload",this.unloadHandler)},methods:{updateSection(e,t){const i=this.value.sections.slice();i[t]=e;const n=Object.assign({},this.value,{sections:i});this.updateActivity(n),this.updateSectionState(e,t)},toggleSectionStateEditMode(e,t){this.sectionStates[t].editMode=e},updateSectionState(e,t){this.sectionStates[t].section=e},createSectionStates(e){return e.sections&&e.sections.length>0?e.sections.map(e=>this.createSectionState(e,!1)):[]},createSectionState:(e,t)=>({editMode:t,sortOrder:e.sort_order,section:e}),updateMultiSection(e){this.sectionStates=this.createSectionStates(e),this.updateActivity(e),this.toggleSectionStateEditMode(e.settings.multisection,0)},updateActivity(e){const t=Object.assign({},this.value,e);this.$emit("input",t)},async trySave(){try{const e=this.value;this.updateActivity(e),this.$emit("mutation-success")}catch(e){this.$emit("mutation-error",e)}},addSectionAbove(e){this.addSection(e)},addSectionBelow(e){this.addSection(e+1)},async addSection(e){this.isAdding=!0;const t=null!==e?this.sectionStates[e].sortOrder:null;try{const{data:{mod_perform_add_section:{section:i}}}=await this.$apollo.mutate({mutation:c,variables:{input:{activity_id:this.value.id,add_before:t}},refetchAll:!1});null!==e?this.insertSectionAt(i,e):this.insertSectionAtEnd(i),this.scrollToSection(i)}catch(e){this.$emit("mutation-error",e)}this.isAdding=!1},insertSectionAt(e,t){this.sectionStates.forEach((t,i)=>{t.sortOrder>=e.sort_order&&this.sectionStates[i].sortOrder++}),this.sectionStates.splice(t,0,this.createSectionState(e,!0))},insertSectionAtEnd(e){this.sectionStates.push(this.createSectionState(e,!0))},scrollToSection(e){this.$nextTick(()=>{this.$refs.activitySection.forEach((t,i)=>{t.sortOrder===e.sort_order&&this.$refs.activitySection[i].$el.scrollIntoView()})})},unloadHandler(e){if(!this.hasUnsavedChanges)return;const t=this.$str("unsaved_changes_warning","mod_perform");return e.preventDefault(),e.returnValue=t,t},deleteSection(e){this.sectionStates.splice(e,1)}},apollo:{relationships:{query:_,variables(){return{activity_id:this.value.id}},update:e=>e.mod_perform_relationships}}},h=i("KHd+"),k=function(e){e.options.__langStrings={mod_perform:["activity_content_tab_heading","add_section","unsaved_changes_warning"]}},y=Object(h.a)(g,n,[],!1,null,null,null);"function"==typeof k&&k(y),y.options.__hasBlocks={script:!0,template:!0},y.options.__file="client/src/mod_perform/components/manage_activity/content/ActivityContentTab.vue";t.default=y.exports},Hu2q:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("Loader",{attrs:{loading:this.$apollo.loading}},[t("FormScope",{attrs:{path:"dynamicCustomSettings"}},[t("FormSelect",{attrs:{id:this.$id("relative-date-reference-date"),options:this.activityOptions,validations:function(e){return[e.required()]},name:"activity"}})],1)],1)],1)};n._withStripped=!0;var a=i("WBvU"),s=i("sicn"),r=i("AdjL"),o={components:{Loader:i.n(r).a,FormSelect:a.FormSelect,FormScope:a.FormScope},props:{data:{type:Object,required:!0},configData:{type:Object,required:!0}},data:()=>({activities:[]}),computed:{activityOptions(){let e={id:void 0,label:this.$str("schedule_dynamic_another_activity_select","mod_perform")},t=this.activities.filter(e=>e.id!=this.configData.activityId).map(e=>({id:e.id,label:e.name}));return t.unshift(e),t}},apollo:{activities:{query:s.a,update:e=>e.mod_perform_activities}}},d=i("KHd+"),l=function(e){e.options.__langStrings={mod_perform:["schedule_dynamic_another_activity_select"]}},c=Object(d.a)(o,n,[],!1,null,null,null);"function"==typeof l&&l(c),c.options.__hasBlocks={script:!0,template:!0},c.options.__file="client/src/mod_perform/components/manage_activity/assignment/schedule/custom_settings/ActivitySelector.vue";t.default=c.exports},IC59:function(e,t){e.exports=tui.require("mod_perform/components/user_activities/participant_selector/FormUserSelector")},IqB1:function(e,t){e.exports=tui.require("tui/components/collapsible/Collapsible")},"IqF/":function(e,t){e.exports=tui.require("tui/components/uniform/util")},JGbd:function(e,t){e.exports=tui.require("mod_perform/components/user_activities/participant/ResponsesAreVisibleToDescription")},JHnp:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Popover",{attrs:{triggers:["click"]},scopedSlots:e._u([{key:"buttons",fn:function(t){var n=t.close;return[i("Button",{attrs:{styleclass:{small:!0,primary:!0},text:e.$str("activity_participants_select_done","mod_perform")},on:{click:function(t){return e.updateParticipants(n)}}}),e._v(" "),i("Button",{attrs:{styleclass:{small:!0,primary:!1},text:e.$str("cancel")},on:{click:n}})]}},{key:"trigger",fn:function(){return[i("ButtonIcon",{staticClass:"tui-performActivitySectionParticipants__add",attrs:{styleclass:{small:!0},"aria-label":e.$str("activity_participants_add","mod_perform"),disabled:e.hasAddedAllParticipants}},[i("AddIcon",{attrs:{size:"100"}})],1)]},proxy:!0}])},[i("h2",{staticClass:"sr-only"},[e._v("\n    "+e._s(e.$str("activity_participants_select_heading","mod_perform"))+"\n  ")]),e._v(" "),i("label",{attrs:{id:e.$id("participants-select-heading")}},[e._v("\n    "+e._s(e.$str("activity_participants_select_heading","mod_perform"))+"\n  ")]),e._v(" "),e._l(e.relationships,(function(t){return i("Checkbox",{key:t.id,attrs:{value:t.id,name:t.name,checked:e.isActiveParticipant(t),disabled:e.isActiveParticipant(t)},on:{change:function(i){return e.handleChange(i,t)}}},[[e._v("\n      "+e._s(t.name)+"\n    ")]],2)}))],2)};n._withStripped=!0;var a=i("vgT7"),s=i.n(a),r=i("vF5l"),o=i.n(r),d=i("5h9J"),l=i.n(d),c=i("hjaT"),m=i.n(c),u=i("9G+f"),_=i.n(u),p={components:{AddIcon:s.a,Button:o.a,ButtonIcon:l.a,Checkbox:m.a,Popover:_.a},props:{activeParticipants:{required:!0,type:Array,default:()=>[]},relationships:{type:Array,required:!0}},data:()=>({checkedParticipants:[]}),computed:{hasAddedAllParticipants(){return this.relationships.length===this.activeParticipants.length}},methods:{updateParticipants(e){e(),this.$emit("update-participants",this.checkedParticipants),this.checkedParticipants=[]},isActiveParticipant(e){return this.activeParticipants.map(e=>e.core_relationship.id).includes(e.id)},handleChange(e,t){e?this.checkedParticipants.push(t):this.checkedParticipants=this.checkedParticipants.filter(e=>e!==t)}}},v=i("KHd+"),f=function(e){e.options.__langStrings={mod_perform:["activity_participants_select_done","activity_participants_select_heading","activity_participants_add"],moodle:["cancel"]}},g=Object(v.a)(p,n,[],!1,null,null,null);"function"==typeof f&&f(g),g.options.__hasBlocks={script:!0,template:!0},g.options.__file="client/src/mod_perform/components/manage_activity/content/ParticipantsPopover.vue";t.default=g.exports},JLSV:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/content/WorkflowSettings")},Joh7:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-elementAdminFormActionButtons"},[i("ButtonGroup",[i("Button",{staticClass:"tui-elementAdminFormActionButtons__done",attrs:{styleclass:{primary:!0,small:!0},text:e.$str("button_done","mod_perform"),disabled:e.submitting,type:"submit"},on:{click:function(t){return e.$emit("submit",t)}}}),e._v(" "),i("Button",{staticClass:"tui-elementAdminFormActionButtons__cancel",attrs:{text:e.$str("button_cancel","mod_perform"),styleclass:{small:!0}},on:{click:function(t){return e.$emit("cancel")}}})],1)],1)};n._withStripped=!0;var a=i("BN8m"),s=i.n(a),r=i("vF5l"),o=i.n(r),d={components:{ButtonGroup:s.a,Button:o.a},props:{submitting:Boolean}},l=i("KHd+"),c=function(e){e.options.__langStrings={mod_perform:["button_done","button_cancel"]}},m=Object(l.a)(d,n,[],!1,null,null,null);"function"==typeof c&&c(m),m.options.__hasBlocks={script:!0,template:!0},m.options.__file="client/src/mod_perform/components/element/admin_form/ActionButtons.vue";t.default=m.exports},K2XK:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/assignment/schedule/ScheduleSettingContainer")},KGcv:function(e,t){e.exports=tui.require("tui/components/dropdown/DropdownItem")},KGot:function(e,t){e.exports=tui.require("tui/components/datatable/Cell")},KRvX:function(e,t){e.exports=tui.require("tui/components/buttons/Submit")},KWP4:function(e,t,i){"use strict";i.r(t);var n=i("lBzj"),a=i.n(n),s={functional:!0,components:{FlexIcon:a.a},props:{alt:String,customClass:[String,Object,Array],styleClass:Object,size:[String,Number],title:String},render:(e,{props:t})=>e(a.a,{props:Object.assign({},t,{icon:"mod_perform|once-off"})})},r=i("KHd+"),o=Object(r.a)(s,void 0,void 0,!1,null,null,null);o.options.__hasBlocks={script:!0,template:!1},o.options.__file="client/src/mod_perform/components/icons/RepeatingDisabled.vue";t.default=o.exports},KcPf:function(e,t,i){"use strict";t.a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_subject_instance"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subject_instance_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_subject_instance"},arguments:[{kind:"Argument",name:{kind:"Name",value:"subject_instance_id"},value:{kind:"Variable",name:{kind:"Name",value:"subject_instance_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"progress_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"created_at"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"instance_count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"activity"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"settings"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"close_on_completion"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"multisection"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"anonymous_responses"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"subject_user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurlsmall"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"participant_instances"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"participant_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"progress_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"core_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"job_assignment"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]}]}}]}}]}}]}},Ksqd:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performUserActivities"},[i("div",{staticClass:"tui-performUserActivities__header-row"},[i("h2",{staticClass:"tui-performUserActivities__heading"},[e._v("\n      "+e._s(e.$str("user_activities_page_title","mod_perform"))+"\n    ")]),e._v(" "),e.canPotentiallyManageParticipants?i("Button",{staticClass:"tui-performUserActivities__action-button",attrs:{text:e.$str("manage_participation","mod_perform")},on:{click:function(t){e.openParticipationModal=!0}}}):e._e()],1),e._v(" "),e.requireManualParticipantsNotification?i("ManualParticipantsSelectionBanner"):e._e(),e._v(" "),i("div",{staticClass:"tui-performUserActivities__content"},[i("Tabs",{attrs:{selected:e.initialTab}},[i("Tab",{attrs:{id:e.$id("your-activities-tab"),name:e.$str("user_activities_your_activities_title","mod_perform")}},[i("UserActivityList",{attrs:{about:"self","current-user-id":e.currentUserId,"view-url":e.viewActivityUrl}})],1),e._v(" "),i("Tab",{attrs:{id:e.$id("activities-about-others-tab"),name:e.$str("user_activities_activities_about_others_title","mod_perform")}},[i("UserActivityList",{attrs:{about:"others","current-user-id":e.currentUserId,"view-url":e.viewActivityUrl}})],1)],1)],1),e._v(" "),e.openParticipationModal?i("SelectActivityModal",{model:{value:e.openParticipationModal,callback:function(t){e.openParticipationModal=t},expression:"openParticipationModal"}}):e._e()],1)};n._withStripped=!0;var a=i("vF5l"),s=i.n(a),r=i("a0Gz"),o=i.n(r),d=i("W2cn"),l=i.n(d),c=i("1i2V"),m=i.n(c),u=i("txsu"),_=i.n(u),p=i("FSRe"),v=i.n(p),f=i("KxNG"),g=i("vyVp"),h={components:{Button:s.a,ManualParticipantsSelectionBanner:o.a,SelectActivityModal:l.a,Tab:m.a,Tabs:_.a,UserActivityList:v.a},props:{currentUserId:{required:!0,type:Number},viewActivityUrl:{required:!0,type:String},showAboutOthersTab:{required:!0,type:Boolean},completionSaveSuccess:{required:!0,type:Boolean},closedOnCompletion:{type:Boolean,default:!1},requireManualParticipantsNotification:{type:Boolean,default:!1},canPotentiallyManageParticipants:{required:!0,type:Boolean}},data:()=>({openParticipationModal:!1}),computed:{initialTab(){return this.showAboutOthersTab?this.$id("activities-about-others-tab"):this.$id("your-activities-tab")}},mounted(){if(this.completionSaveSuccess){let e=this.closedOnCompletion?"toast_success_save_close_on_completion_response":"toast_success_save_response";this.showSuccessNotification(e,"mod_perform")}},methods:{showSuccessNotification(e,t){Object(g.notify)({duration:f.NOTIFICATION_DURATION,message:this.$str(e,t),type:"success"})}}},k=i("KHd+"),y=function(e){e.options.__langStrings={mod_perform:["manage_participation","toast_success_save_close_on_completion_response","toast_success_save_response","user_activities_activities_about_others_title","user_activities_page_title","user_activities_your_activities_title"]}},S=Object(k.a)(h,n,[],!1,null,null,null);"function"==typeof y&&y(S),S.options.__hasBlocks={script:!0,template:!0},S.options.__file="client/src/mod_perform/pages/UserActivities.vue";t.default=S.exports},KxNG:function(e,t){e.exports=tui.require("mod_perform/constants")},LANY:function(e,t){e.exports=tui.require("mod_perform/components/icons/RepeatingDisabled")},LxOS:function(e,t){e.exports=tui.require("tui/components/uniform/FormCheckbox")},MAAM:function(e,t){e.exports=tui.require("tui/components/form/HelpIcon")},Mnur:function(e,t){e.exports=tui.require("tui/components/modal/ModalPresenter")},NAOU:function(e,t){e.exports=tui.require("tui/components/grid/Grid")},NMGf:function(e,t){e.exports=tui.require("tui/components/buttons/DeleteIcon")},NMYu:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/assignment/schedule/DueDateSettings")},Oj5a:function(e,t){e.exports=tui.require("tui/components/sidepanel/SidePanelNavGroup")},PJBr:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ModalPresenter",{attrs:{open:e.modalOpen},on:{"request-close":e.modalClose}},[i("Modal",{attrs:{size:"normal","aria-labelledby":e.$id("report_open_close")}},[i("ModalContent",{attrs:{title:e.$str(e.isOpen?"participant_section_close_title":"participant_section_reopen_title","mod_perform"),"title-id":e.$id("report_open_close")},scopedSlots:e._u([{key:"buttons",fn:function(){return[i("ButtonGroup",[i("Button",{attrs:{styleclass:{primary:!0},text:e.$str(e.isOpen?"button_close":"button_reopen","mod_perform")},on:{click:function(t){return e.changeAvailability()}}}),e._v(" "),i("Button",{attrs:{text:e.$str("button_cancel","mod_perform")},on:{click:function(t){return e.modalClose()}}})],1)]},proxy:!0}])},[e.isOpen?[i("p",[e._v("\n          "+e._s(e.$str("participant_section_close_message","mod_perform"))+"\n        ")])]:[i("p",[e._v("\n          "+e._s(e.$str("participant_section_reopen_message","mod_perform"))+"\n        ")])]],2)],1)],1)};n._withStripped=!0;var a=i("vF5l"),s=i.n(a),r=i("BN8m"),o=i.n(r),d=i("tkAW"),l=i.n(d),c=i("u5iS"),m=i.n(c),u=i("Mnur"),_=i.n(u),p={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_manually_change_participant_section"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_manually_change_participant_section_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_manually_change_participant_section"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant_section"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}]}}]},v=i("vyVp"),f=i("E7bt"),g=i("KxNG"),h={components:{Button:s.a,ButtonGroup:o.a,Modal:l.a,ModalContent:m.a,ModalPresenter:_.a},props:{modalOpen:{type:Boolean},participantSectionId:{type:String},isOpen:{type:Boolean},reportType:{type:String}},methods:{modalClose(){this.$emit("modal-close")},showErrorNotification(){Object(v.notify)({duration:g.NOTIFICATION_DURATION,message:this.$str("toast_error_generic_update","mod_perform"),type:"error"})},async changeAvailability(){try{let e=this.isOpen?g.INSTANCE_AVAILABILITY_STATUS_CLOSED:g.INSTANCE_AVAILABILITY_STATUS_OPEN;await this.$apollo.mutate({mutation:p,variables:{input:{participant_section_id:this.participantSectionId,availability:e}}}),this.$emit("modal-close"),Object(f.redirectWithPost)(window.location,{is_open:!this.isOpen,report_type:this.reportType})}catch(e){this.showErrorNotification()}}}},k=i("KHd+"),y=function(e){e.options.__langStrings={mod_perform:["button_cancel","button_close","button_reopen","participant_section_close_title","participant_section_close_message","participant_section_reopen_title","participant_section_reopen_message"]}},S=Object(k.a)(h,n,[],!1,null,null,null);"function"==typeof y&&y(S),S.options.__hasBlocks={script:!0,template:!0},S.options.__file="client/src/mod_perform/components/report/manage_participation/SectionOpenCloseActionModal.vue";t.default=S.exports},PNtU:function(e,t){e.exports=tui.require("tui/components/lozenge/Lozenge")},PRN7:function(e,t){e.exports=tui.require("tui/components/form/Label")},Q4hb:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performUserActivitiesSelectParticipants"},[i("a",{attrs:{href:e.$url(e.userActivitiesUrl)}},[e._v(e._s(e.$str("back_to_all_activities","mod_perform")))]),e._v(" "),i("h2",{staticClass:"tui-performUserActivitiesSelectParticipants__header"},[e._v("\n    "+e._s(e.$str("user_activities_select_participants_page_title","mod_perform"))+"\n  ")]),e._v(" "),e.$apollo.loading||e.participantSelectionInstances.length>0?i("Loader",{attrs:{loading:e.$apollo.loading}},[i("p",[e._v("\n      "+e._s(e.$str("user_activities_select_participants_note","mod_perform"))+"\n    ")]),e._v(" "),e._l(e.participantSelectionInstances,(function(t){return i("ActivityParticipants",{key:t.subject_instance.id,attrs:{"subject-instance":t.subject_instance,relationships:t.manual_relationships,users:e.users,"current-user-id":e.currentUserId},on:{submit:e.submit,error:e.error}})}))],2):i("p",[e._v("\n    "+e._s(e.$str("user_activities_select_participants_none","mod_perform"))+"\n  ")])],1)};n._withStripped=!0;var a=i("SNFb"),s=i.n(a),r=i("AdjL"),o=i.n(r),d={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_manual_participant_selection_instances"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_manual_participant_selection_instances"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"subject_instance"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"created_at"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject_user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"activity"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"manual_relationships"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}}]},l={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_selectable_users"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_selectable_users"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimagealt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurl"},arguments:[],directives:[]}]}}]}}]},c=i("KxNG"),m=i("vyVp"),u={components:{ActivityParticipants:s.a,Loader:o.a},props:{currentUserId:{required:!0,type:Number},userActivitiesUrl:{required:!0,type:String}},data:()=>({participantSelectionInstances:[],users:[]}),apollo:{participantSelectionInstances:{query:d,update:e=>e.mod_perform_manual_participant_selection_instances},users:{query:l,update:e=>e.mod_perform_selectable_users}},methods:{refetch(){this.$apollo.queries.participantSelectionInstances.refetch()},submit(){this.refetch(),Object(m.notify)({duration:c.NOTIFICATION_DURATION,message:this.$str("toast_success_participants_saved","mod_perform"),type:"success"})},error(){this.refetch(),Object(m.notify)({duration:c.NOTIFICATION_DURATION,message:this.$str("toast_error_generic_update","mod_perform"),type:"error"})}}},_=i("KHd+"),p=function(e){e.options.__langStrings={mod_perform:["back_to_all_activities","toast_error_generic_update","toast_success_participants_saved","user_activities_select_participants_none","user_activities_select_participants_note","user_activities_select_participants_page_title"]}},v=Object(_.a)(u,n,[],!1,null,null,null);"function"==typeof p&&p(v),v.options.__hasBlocks={script:!0,template:!0},v.options.__file="client/src/mod_perform/pages/UserActivitiesSelectParticipants.vue";t.default=v.exports},QFNw:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-activityMultipleSectionToggle"},[i("Form",[i("FormRow",{attrs:{label:e.$str("multiple_sections","mod_perform"),helpmsg:e.$str("multiple_sections_label_help","mod_perform")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.label;return[i("ToggleSwitch",{attrs:{disabled:e.isSaving,"aria-label":n,text:n,"toggle-first":!0},on:{input:e.openModal},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})]}}])})],1),e._v(" "),i("ConfirmationModal",{attrs:{open:e.modalOpen,title:e.$str("multiple_sections_confirmation_title","mod_perform"),"confirm-button-text":e.$str("modal_confirm","mod_perform")},on:{confirm:e.modalConfirmed,cancel:e.modalCancelled}},[e._v("\n    "+e._s(e.value?e.$str("multiple_sections_enabled_confirmation_text","mod_perform"):e.$str("multiple_sections_disabled_confirmation_text","mod_perform"))+"\n  ")])],1)};n._withStripped=!0;var a=i("vyVp"),s=i("KxNG"),r=i("C+/B"),o=i.n(r),d=i("nEm4"),l=i.n(d),c=i("i/kK"),m=i.n(c),u={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_toggle_activity_multisection_setting"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"toggle_activity_setting"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_toggle_activity_multisection_setting"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sections"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sort_order"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"section_relationships"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_view"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_answer"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"core_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"section_elements_summary"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"required_question_count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"optional_question_count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"other_element_count"},arguments:[],directives:[]}]}},{kind:"Field",alias:{kind:"Name",value:"raw_created_at"},name:{kind:"Name",value:"created_at"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"TIMESTAMP"}}],directives:[]},{kind:"Field",alias:{kind:"Name",value:"raw_updated_at"},name:{kind:"Name",value:"updated_at"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"TIMESTAMP"}}],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"settings"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"multisection"},arguments:[],directives:[]}]}}]}}]}}]},_=i("lOlL"),p=i.n(_),v={components:{ConfirmationModal:o.a,Form:l.a,FormRow:m.a,ToggleSwitch:p.a},props:{activity:{type:Object,required:!0}},data(){return{isSaving:!1,modalOpen:!1,value:this.activity.settings.multisection}},methods:{openModal(){this.modalOpen=!0},modalCancelled(){this.modalOpen=!1,this.value=!this.value},modalConfirmed(){this.modalOpen=!1,this.save()},async save(){this.isSaving=!0;try{const{data:e}=await this.$apollo.mutate({mutation:u,variables:{input:{activity_id:this.activity.id,setting:this.value}},refetchAll:!1});this.$emit("change",e.mod_perform_toggle_activity_multisection_setting),Object(a.notify)({duration:s.NOTIFICATION_DURATION,message:this.$str("toast_success_activity_update","mod_perform"),type:"success"})}catch(e){Object(a.notify)({duration:s.NOTIFICATION_DURATION,message:this.$str("toast_error_generic_update","mod_perform"),type:"error"})}this.isSaving=!1}}},f=i("KHd+"),g=function(e){e.options.__langStrings={mod_perform:["multiple_sections","multiple_sections_disabled_confirmation_text","multiple_sections_enabled_confirmation_text","multiple_sections_confirmation_title","multiple_sections_label_help","modal_confirm","toast_success_activity_update","toast_error_generic_update"],moodle:["help"]}},h=Object(f.a)(v,n,[],!1,null,null,null);"function"==typeof g&&g(h),h.options.__hasBlocks={script:!0,template:!0},h.options.__file="client/src/mod_perform/components/manage_activity/content/ActivityMultipleSectionToggle.vue";t.default=h.exports},RFl9:function(e,t){e.exports=tui.require("mod_perform/components/user_activities/participant_selector/UserSelector")},RM6z:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ul",{staticClass:"tui-activityNotificationsRecipientsTable"},e._l(e.data,(function(t){return i("li",{key:t.relationship_id,staticClass:"tui-activityNotificationsRecipientsTable__row"},[i("ToggleSwitch",{attrs:{text:t.name,value:t.active,"toggle-first":!0},on:{input:function(i){return e.onToggle(t,i)}}})],1)})),0)};n._withStripped=!0;var a=i("lOlL"),s={components:{ToggleSwitch:i.n(a).a},props:{data:{type:Array,required:!0},classKey:{type:String,required:!0}},methods:{onToggle(e,t){this.$emit("toggle",{id:e.relationship_id,active:t})}}},r=i("KHd+"),o=Object(r.a)(s,n,[],!1,null,null,null);o.options.__hasBlocks={script:!0,template:!0},o.options.__file="client/src/mod_perform/components/manage_activity/notification/RecipientsTable.vue";t.default=o.exports},RlWc:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-otherParticipantResponses"},[e.anonymousResponses?e._l(e.responderGroups,(function(t,n){return i("FormRow",{key:n,attrs:{label:e.$str("response_other","mod_perform")}},[i("div",{staticClass:"tui-otherParticipantResponses__anonymousResponse"},e._l(t.responses,(function(t,n){return i("div",{key:n,staticClass:"tui-otherParticipantResponses__anonymousResponse-participant"},[i("ElementParticipantResponse",{scopedSlots:e._u([{key:"content",fn:function(){return[i(e.componentFor(),{tag:"component",attrs:{data:JSON.parse(t.response_data),element:e.sectionElement.element}})]},proxy:!0}],null,!0)})],1)})),0)])})):e._l(e.responderGroups,(function(t,n){return i("FormRow",{key:n,attrs:{label:e.$str("user_activities_other_response_response","mod_perform",{relationship:t.relationship_name})}},[e.hasResponses(t.responses)?i("div",{staticClass:"tui-otherParticipantResponses__response"},e._l(t.responses,(function(t,n){return i("div",{key:n,staticClass:"tui-otherParticipantResponses__response-participant"},[i("ParticipantUserHeader",{attrs:{"user-name":t.participant_instance.participant.fullname,"profile-picture":t.participant_instance.participant.profileimageurlsmall,size:"xsmall"}}),e._v(" "),i("ElementParticipantResponse",{scopedSlots:e._u([{key:"content",fn:function(){return[i(e.componentFor(),{tag:"component",attrs:{data:JSON.parse(t.response_data),element:e.sectionElement.element}})]},proxy:!0}],null,!0)})],1)})),0):i("div",{staticClass:"tui-otherParticipantResponses__noParticipant"},[e._v("\n        "+e._s(e.$str("user_activities_other_response_no_participants_identified","mod_perform"))+"\n      ")])])}))],2)};n._withStripped=!0;var a=i("8dSb"),s=i("s0yi"),r=i.n(s),o=i("3wZ/"),d=i.n(o),l=i("WBvU"),c={components:{ElementParticipantResponse:a.default,FormRow:l.FormRow,ParticipantUserHeader:r.a,WarningIcon:d.a},props:{sectionElement:{type:Object,required:!0},anonymousResponses:{type:Boolean,required:!0}},data(){return{responderGroups:this.sectionElement.other_responder_groups}},methods:{componentFor(){return tui.asyncComponent(this.sectionElement.element.type.participant_response_component)},hasResponses:e=>e.length>0}},m=i("KHd+"),u=function(e){e.options.__langStrings={mod_perform:["response_other","user_activities_other_response_response","user_activities_other_response_no_participants_identified"]}},_=Object(m.a)(c,n,[],!1,null,null,null);"function"==typeof u&&u(_),_.options.__hasBlocks={script:!0,template:!0},_.options.__file="client/src/mod_perform/components/user_activities/participant/OtherParticipantResponses.vue";t.default=_.exports},S6e1:function(e,t){e.exports=tui.require("tui/components/icons/common/Users")},S790:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performUserActivity"},[i("Loader",{attrs:{loading:e.$apollo.loading}},[e.activityNotFound?i("NotificationBanner",{attrs:{dismissable:!1,message:e.$str("user_activities_activity_does_not_exist","mod_perform"),type:"error"}}):e.activityFound?i("ActivityContent",{attrs:{"current-user-id":e.currentUserId,activity:e.subjectInstance.activity,"participant-instance-id":e.participantInstanceId,"participant-section-id":e.participantSectionId,"subject-user":e.subjectInstance.subject_user}}):e._e()],1)],1)};n._withStripped=!0;var a=i("KcPf"),s=i("AdjL"),r=i.n(s),o=i("zdti"),d=i.n(o),l=i("nu/z"),c=i.n(l),m={components:{Loader:r.a,NotificationBanner:d.a,ActivityContent:c.a},props:{currentUserId:{required:!0,type:Number},participantInstanceId:{required:!1,type:Number},participantSectionId:{required:!1,type:Number},subjectInstanceId:{required:!1,type:Number}},data:()=>({hasLoaded:!1,userActivity:null,subjectInstance:null}),apollo:{subjectInstance:{query:a.a,skip(){return!this.subjectInstanceId},variables(){return{subject_instance_id:this.subjectInstanceId}},update(e){return this.hasLoaded=!0,e.mod_perform_subject_instance}}},computed:{activityNotFound(){return null===this.subjectInstanceId||!this.$apollo.loading&&null===this.subjectInstance},activityFound(){return null!==this.subjectInstanceId&&(!this.$apollo.loading&&null!==this.subjectInstance)}}},u=i("KHd+"),_=function(e){e.options.__langStrings={mod_perform:["user_activities_activity_does_not_exist"]}},p=Object(u.a)(m,n,[],!1,null,null,null);"function"==typeof _&&_(p),p.options.__hasBlocks={script:!0,template:!0},p.options.__file="client/src/mod_perform/pages/UserActivity.vue";t.default=p.exports},SB6c:function(e,t,i){"use strict";i.r(t),t.default={mounted(){this.$el.scrollIntoView(),this.$el.querySelector("input").focus()}}},SNFb:function(e,t){e.exports=tui.require("mod_perform/components/user_activities/participant_selector/ActivityParticipants")},"T0p/":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Grid",{attrs:{"stack-at":764}},[i("GridItem",{attrs:{units:4}},[i("div",[e._v("\n      "+e._s(e.$str("section_element_summary_required_questions","mod_perform"))+"\n    ")]),e._v(" "),i("div",{staticClass:"tui-performActivitySectionElementSummary__count"},[e._v("\n      "+e._s(e.elementsSummary.required_question_count)+"\n    ")])]),e._v(" "),i("GridItem",{attrs:{units:4}},[i("div",[e._v("\n      "+e._s(e.$str("section_element_summary_optional_questions","mod_perform"))+"\n    ")]),e._v(" "),i("div",{staticClass:"tui-performActivitySectionElementSummary__count"},[e._v("\n      "+e._s(e.elementsSummary.optional_question_count)+"\n    ")])]),e._v(" "),i("GridItem",{attrs:{units:4}},[i("div",[e._v("\n      "+e._s(e.$str("section_element_summary_other_content_elements","mod_perform"))+"\n    ")]),e._v(" "),i("div",{staticClass:"tui-performActivitySectionElementSummary__count"},[e._v("\n      "+e._s(e.elementsSummary.other_element_count)+"\n    ")])])],1)};n._withStripped=!0;var a=i("NAOU"),s=i.n(a),r=i("D9If"),o={components:{GridItem:i.n(r).a,Grid:s.a},props:{elementsSummary:{type:Object,required:!0}}},d=i("KHd+"),l=function(e){e.options.__langStrings={mod_perform:["section_element_summary_required_questions","section_element_summary_optional_questions","section_element_summary_other_content_elements"]}},c=Object(d.a)(o,n,[],!1,null,null,null);"function"==typeof l&&l(c),c.options.__hasBlocks={script:!0,template:!0},c.options.__file="client/src/mod_perform/components/manage_activity/content/ActivitySectionElementSummary.vue";t.default=c.exports},T5Kz:function(e,t,i){"use strict";i.r(t);var n=i("lBzj"),a=i.n(n),s={functional:!0,components:{FlexIcon:a.a},props:{alt:String,customClass:[String,Object,Array],styleClass:Object,size:[String,Number],title:String},render:(e,{props:t})=>e(a.a,{props:Object.assign({},t,{icon:"mod_perform|reporting"})})},r=i("KHd+"),o=Object(r.a)(s,void 0,void 0,!1,null,null,null);o.options.__hasBlocks={script:!0,template:!1},o.options.__file="client/src/mod_perform/components/icons/ReportingIdentifier.vue";t.default=o.exports},TXEh:function(e,t){e.exports=tui.require("tui/util")},"Ts/T":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performActivitySectionRelationship"},[e.editable?i("div",{staticClass:"tui-performActivitySectionRelationship__item"},[i("div",{staticClass:"tui-performActivitySectionRelationship__item-name"},[e._v("\n      "+e._s(e.participant.core_relationship.name)+"\n      "),i("DeleteIcon",{attrs:{"aria-label":e.$str("delete_relationship","mod_perform",e.participant.core_relationship.name)},on:{click:function(t){return e.removeDisplayedParticipant(e.participant)}}})],1),e._v(" "),i("div",{staticClass:"tui-performActivitySectionRelationship__item-options"},[i("Checkbox",{on:{change:e.toggleCanViewOnParticipant},model:{value:e.participant_can_view,callback:function(t){e.participant_can_view=t},expression:"participant_can_view"}},[e._v("\n        "+e._s(e.$str("activity_participant_can_view","mod_perform"))+"\n      ")])],1)]):i("div",{staticClass:"tui-performActivitySectionRelationship__item"},[i("p",[e._v("\n      "+e._s(e.participant.core_relationship.name)+e._s(e.participant.can_view?"*":"")+"\n    ")])])])};n._withStripped=!0;var a=i("hjaT"),s=i.n(a),r=i("NMGf"),o=i.n(r),d={components:{Checkbox:s.a,DeleteIcon:o.a},props:{participant:{type:Object,required:!0},editable:{type:Boolean,required:!0}},data(){return{participant_can_view:this.getCanView()}},methods:{getCanView(){return this.participant.can_view},toggleCanViewOnParticipant(e){const t=Object.assign({},this.participant,{can_view:e});this.$emit("can-view-changed",t)},removeDisplayedParticipant(e){this.$emit("participant-removed",e)}}},l=i("KHd+"),c=function(e){e.options.__langStrings={mod_perform:["activity_participant_can_view","delete_relationship"]}},m=Object(l.a)(d,n,[],!1,null,null,null);"function"==typeof c&&c(m),m.options.__hasBlocks={script:!0,template:!0},m.options.__file="client/src/mod_perform/components/manage_activity/content/ActivitySectionRelationship.vue";t.default=m.exports},UXJH:function(e,t){e.exports=tui.require("mod_perform/components/icons/RepeatingEnabled")},UgGx:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ActionCard",{staticClass:"tui-instanceInfoCard",scopedSlots:e._u([{key:"card-body",fn:function(){return[i("div",[i("h3",{staticClass:"tui-instanceInfoCard__title"},[e._v("\n        "+e._s(e.title)+"\n      ")]),e._v(" "),i("div",{staticClass:"tui-instanceInfoCard__info-section"},e._l(e.infoLines,(function(t){return i("p",{key:t.label,staticClass:"tui-instanceInfoCard__info-row"},[i("span",{staticClass:"tui-instanceInfoCard__info-label"},[i("strong",[e._v(e._s(t.label))])]),e._v(" "),i("span",{staticClass:"tui-instanceInfoCard__info-value"},[e._v("\n            "+e._s(t.text)+"\n          ")])])})),0)])]},proxy:!0},{key:"card-action",fn:function(){return[i("ActionLink",{attrs:{href:e.showAllLink,text:e.$str("instance_info_card_show_all_button","mod_perform"),styleclass:{small:!0}}})]},proxy:!0}])})};n._withStripped=!0;var a=i("kUb+"),s=i.n(a),r=i("fCWf"),o={components:{ActionLink:i.n(r).a,ActionCard:s.a},props:{title:{type:String,required:!0},infoLines:{type:Array,required:!0},showAllLink:{type:String,required:!0}}},d=i("KHd+"),l=function(e){e.options.__langStrings={mod_perform:["instance_info_card_show_all_button"]}},c=Object(d.a)(o,n,[],!1,null,null,null);"function"==typeof l&&l(c),c.options.__hasBlocks={script:!0,template:!0},c.options.__file="client/src/mod_perform/components/manage_activity/participation/InstanceInfoCard.vue";t.default=c.exports},Uj5i:function(e,t){e.exports=tui.require("tui/components/icons/common/Calendar")},VHu6:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this.$createElement;return(this._self._c||e)("div")};n._withStripped=!0;var a=i("vyVp"),s=i("KxNG"),r={props:{message:String},mounted(){this.message&&Object(a.notify)({message:this.message,duration:s.NOTIFICATION_DURATION,type:"success"})}},o=i("KHd+"),d=Object(o.a)(r,n,[],!1,null,null,null);d.options.__hasBlocks={script:!0,template:!0},d.options.__file="client/src/mod_perform/components/manage_activity/participation/Toasts.vue";t.default=d.exports},VOnF:function(e,t){e.exports=tui.require("tui/components/form/InputNumber")},VX2K:function(e,t){e.exports=tui.require("tui/components/form/Radio")},W2cn:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/participation/SelectActivityModal")},W86B:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performElementEditDisplay"},[e.error?i("div",[e._v(e._s(e.error))]):e._e(),e._v(" "),i("div",{staticClass:"tui-performElementEditDisplay__action"},[e.identifier&&!e.isActive?i("Popover",{staticClass:"tui-performElementEditDisplay__reportingId",scopedSlots:e._u([{key:"trigger",fn:function(){return[i("ButtonIcon",{attrs:{"aria-label":e.$str("reporting_identifier","mod_perform"),styleclass:{transparentNoPadding:!0}}},[[i("ReportingIdentifierIcon",{attrs:{alt:e.$str("reporting_identifier","mod_perform"),title:e.$str("reporting_identifier","mod_perform"),size:"200"}})]],2)]},proxy:!0}],null,!1,3098414383)},[i("h2",{staticClass:"tui-performElementEditDisplay__reportingId-header"},[e._v("\n        "+e._s(e.$str("reporting_identifier","mod_perform"))+"\n      ")]),e._v(" "),i("div",{staticClass:"tui-performElementEditDisplay__reportingId-content"},[e._v("\n        "+e._s(e.identifier)+"\n      ")])]):e._e(),e._v(" "),e.isActive?e._e():i("EditIcon",{attrs:{"aria-label":e.$str("edit_element","mod_perform")},on:{click:e.edit}}),e._v(" "),e.isActive?e._e():i("DeleteIcon",{attrs:{"aria-label":e.$str("delete_element","mod_perform")},on:{click:e.remove}}),e._v(" "),e.isActive?i("ButtonIcon",{staticClass:"tui-performElementEditDisplay__action-settings",attrs:{"aria-label":e.$str("setting_element","mod_perform"),styleclass:{transparentNoPadding:!0}},on:{click:function(t){return t.preventDefault(),e.displayRead()}}},[i("SettingsIcon",{attrs:{size:"200"}})],1):e._e()],1),e._v(" "),e.title?i("div",{staticClass:"tui-performElementEditDisplay__title"},[e._v("\n    "+e._s(e.title)+"\n\n    "),e.isRequired?i("span",{staticClass:"tui-performElementEditDisplay__title-response-required"},[e._v("*")]):e._e()]):e._e(),e._v(" "),i("div",{staticClass:"tui-performElementEditDisplay__content"},[e._t("content")],2)])};n._withStripped=!0;var a=i("bF0+"),s=i.n(a),r=i("5h9J"),o=i.n(r),d=i("ttA2"),l=i.n(d),c=i("9G+f"),m=i.n(c),u=i("DUw4"),_=i.n(u),p=i("NMGf"),v=i.n(p),f={components:{ButtonIcon:o.a,DeleteIcon:v.a,EditIcon:s.a,SettingsIcon:l.a,Popover:m.a,ReportingIdentifierIcon:_.a},props:{title:{type:String,required:!0},activityState:{type:Object,required:!0},type:{type:Object,required:!0},error:{type:String},isRequired:{type:Boolean},identifier:String},computed:{isActive(){return"ACTIVE"===this.activityState.name}},methods:{edit(){this.$emit("edit")},remove(){this.$emit("remove")},displayRead(){this.$emit("display-read")}}},g=i("KHd+"),h=function(e){e.options.__langStrings={mod_perform:["delete_element","edit_element","reporting_identifier","setting_element","section_element_tag_required","section_element_tag_optional"]}},k=Object(g.a)(f,n,[],!1,null,null,null);"function"==typeof h&&h(k),k.options.__hasBlocks={script:!0,template:!0},k.options.__file="client/src/mod_perform/components/element/ElementAdminDisplay.vue";t.default=k.exports},WBvU:function(e,t){e.exports=tui.require("tui/components/uniform")},WDyM:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/assignment/schedule/AdditionalScheduleSettings")},"Wn/X":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Modal",{attrs:{"aria-labelledby":e.$id("select-relationship-title")}},[e.participantSections.length>0?i("ModalContent",{attrs:{title:e.$str("select_relationship_to_respond_as_title","mod_perform"),"title-id":e.$id("select-relationship-title"),"close-button":!1},scopedSlots:e._u([{key:"buttons",fn:function(){return[i("Button",{attrs:{styleclass:{primary:!0},text:e.$str("continue","moodle"),disabled:!e.relationshipToRespondAs||e.relationshipConfirmed},on:{click:e.confirmRelationshipSelection}}),e._v(" "),i("CancelButton",{attrs:{disabled:e.relationshipConfirmed},on:{click:function(t){return e.$emit("input",!1)}}})]},proxy:!0}],null,!1,769036794)},[i("p",{attrs:{id:e.$id("select-relationship-explanation")}},[e._v("\n      "+e._s(e.$str("select_relationship_to_respond_as_explanation","mod_perform",e.subjectUser.fullname))+"\n    ")]),e._v(" "),i("RadioGroup",{attrs:{required:"","aria-labelledby":e.$id("select-relationship-explanation")},model:{value:e.relationshipToRespondAs,callback:function(t){e.relationshipToRespondAs=t},expression:"relationshipToRespondAs"}},e._l(e.respondAsOptions,(function(t){return i("Radio",{key:t.participant_instance.core_relationship.id,attrs:{value:t.participant_instance.core_relationship.id,name:"relationshipToRespondAs"}},[e._v("\n        "+e._s(e.$str("select_relationship_to_respond_as_option","mod_perform",{relationship_name:t.participant_instance.core_relationship.name,progress_status:e.getStatusText(t)}))+"\n      ")])})),1)],1):e._e()],1)};n._withStripped=!0;var a=i("vF5l"),s=i.n(a),r=i("nXMa"),o=i.n(r),d=i("tkAW"),l=i.n(d),c=i("u5iS"),m=i.n(c),u=i("VX2K"),_=i.n(u),p=i("G6cq"),v=i.n(p),f={components:{Button:s.a,CancelButton:o.a,Modal:l.a,ModalContent:m.a,Radio:_.a,RadioGroup:v.a},props:{currentUserId:{required:!0,type:Number},participantSections:{type:Array,required:!0},isForSection:{type:Boolean,required:!0},subjectUser:{type:Object,required:!0},viewUrl:{type:String,required:!0},value:{type:Boolean,required:!0}},data:()=>({relationshipToRespondAs:null,relationshipConfirmed:!1}),computed:{respondAsOptions(){return 0===this.participantSections.length?[]:this.filterToCurrentUser(this.participantSections)},selectedParticipantSection(){return this.getFirstSectionToParticipate(this.participantSections,this.relationshipToRespondAs)}},mounted(){this.relationshipToRespondAs=this.respondAsOptions.length>0?this.respondAsOptions[0].participant_instance.core_relationship.id:null},methods:{getFirstSectionToParticipate(e,t){t=void 0!==t?t:null;let i=null;return e.forEach(e=>{const n=e.participant_instance;if(!n.is_for_current_user)return;const a=n.core_relationship.id;null!==i||null!==t&&t!==a||(i=e)}),i},confirmRelationshipSelection(){if(this.relationshipConfirmed=!0,!this.selectedParticipantSection)throw"Selected section not found";window.location=this.$url(this.viewUrl,{participant_section_id:this.selectedParticipantSection.id})},getStatusText(e){switch(this.isForSection?e.progress_status:e.participant_instance.progress_status){case"NOT_STARTED":return this.$str("user_activities_status_not_started","mod_perform");case"IN_PROGRESS":return this.$str("user_activities_status_in_progress","mod_perform");case"COMPLETE":return this.$str("user_activities_status_complete","mod_perform");default:return""}},filterToCurrentUser(e){let t=[];return e.filter(e=>{if(!e.participant_instance.is_for_current_user)return!1;const i=e.participant_instance.core_relationship.name;return-1===t.indexOf(i)&&(t.push(i),!0)})}}},g=i("KHd+"),h=function(e){e.options.__langStrings={mod_perform:["select_relationship_to_respond_as_explanation","select_relationship_to_respond_as_option","select_relationship_to_respond_as_title","user_activities_status_complete","user_activities_status_in_progress","user_activities_status_not_started"],moodle:["continue"]}},k=Object(g.a)(f,n,[],!1,null,null,null);"function"==typeof h&&h(k),k.options.__hasBlocks={script:!0,template:!0},k.options.__file="client/src/mod_perform/components/user_activities/list/RelationshipSelector.vue";t.default=k.exports},X1gS:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/notification/NotificationSection")},XDjs:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/notification/TriggersTable")},XFt3:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performActivityWorkflowSettings"},[i("h3",{staticClass:"tui-performActivityWorkflowSettings__heading"},[e._v("\n    "+e._s(e.$str("workflow_settings","mod_perform"))+"\n  ")]),e._v(" "),i("Form",[i("FormRow",{attrs:{label:e.$str("workflow_automatic_closure_label","mod_perform"),helpmsg:e.$str("workflow_automatic_closure_label_help","mod_perform")}},[i("div",[i("ToggleSwitch",{attrs:{disabled:e.isSaving,"toggle-first":!0,text:e.$str("workflow_automatic_closure_on_completion","mod_perform")},on:{input:e.valueChanged},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}}),e._v(" "),i("FormRowDetails",{attrs:{id:e.$id("aria-describedby")}},[e._v("\n          "+e._s(e.$str("workflow_automatic_closure_on_completion_help","mod_perform"))+"\n        ")])],1)])],1),e._v(" "),i("ConfirmationModal",{attrs:{open:e.modalOpen,title:e.$str("workflow_automatic_closure_confirmation_title","mod_perform"),"confirm-button-text":e.$str("modal_confirm","mod_perform")},on:{confirm:e.modalConfirmed,cancel:e.modalCancelled}},[e._v("\n    "+e._s(e.$str(e.value?"workflow_automatic_closure_enabled_confirmation_text":"workflow_automatic_closure_disabled_confirmation_text","mod_perform"))+"\n  ")])],1)};n._withStripped=!0;var a=i("C+/B"),s=i.n(a),r=i("nEm4"),o=i.n(r),d=i("i/kK"),l=i.n(d),c=i("vGF0"),m=i.n(c),u=i("lOlL"),_=i.n(u),p=i("vyVp"),v=i("KxNG"),f={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_toggle_activity_close_on_completion_setting"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"toggle_activity_setting"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_toggle_activity_close_on_completion_setting"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"settings"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"close_on_completion"},arguments:[],directives:[]}]}}]}}]}}]},g={components:{ConfirmationModal:s.a,Form:o.a,FormRow:l.a,FormRowDetails:m.a,ToggleSwitch:_.a},props:{activity:{type:Object,required:!0}},data(){return{isSaving:!1,value:this.activity.settings.close_on_completion,modalOpen:!1}},computed:{isDraft(){return this.activity.state_details.name===v.ACTIVITY_STATUS_DRAFT}},methods:{valueChanged(){this.isDraft?this.save():this.modalOpen=!0},modalCancelled(){this.modalOpen=!1,this.value=!this.value},modalConfirmed(){this.modalOpen=!1,this.isSaving=!0,this.save()},save(){this.isSaving=!0,this.$apollo.mutate({mutation:f,variables:{input:{activity_id:this.activity.id,setting:this.value}},refetchAll:!1}).then(()=>{Object(p.notify)({duration:v.NOTIFICATION_DURATION,message:this.$str("toast_success_activity_update","mod_perform"),type:"success"}),this.isSaving=!1}).catch(()=>{this.value=this.activity.settings.close_on_completion,Object(p.notify)({duration:v.NOTIFICATION_DURATION,message:this.$str("toast_error_generic_update","mod_perform"),type:"error"}),this.isSaving=!1})}}},h=i("KHd+"),k=function(e){e.options.__langStrings={mod_perform:["modal_confirm","workflow_automatic_closure_confirmation_title","workflow_automatic_closure_disabled_confirmation_text","workflow_automatic_closure_enabled_confirmation_text","workflow_automatic_closure_label","workflow_automatic_closure_label_help","workflow_automatic_closure_on_completion","workflow_automatic_closure_on_completion_help","workflow_settings","toast_error_generic_update","toast_success_activity_update"],moodle:["help"]}},y=Object(h.a)(g,n,[],!1,null,null,null);"function"==typeof k&&k(y),y.options.__hasBlocks={script:!0,template:!0},y.options.__file="client/src/mod_perform/components/manage_activity/content/WorkflowSettings.vue";t.default=y.exports},Xgbh:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performManageActivityAssignmentsForm"},[i("Grid",{staticClass:"tui-performManageActivityAssignmentsForm__heading",attrs:{"stack-at":600,"use-vertical-gap":!1}},[i("GridItem",{attrs:{grows:""}},[i("h3",{staticClass:"tui-performManageActivityAssignmentsForm__heading-title"},[e._v("\n        "+e._s(e.$str("user_group_assignment_title","mod_perform"))+"\n      ")])]),e._v(" "),i("GridItem",{staticClass:"tui-performManageActivityAssignmentsForm__heading-buttons",attrs:{grows:"",units:1}},[i("Dropdown",{staticClass:"tui-performManageActivityAssignmentsForm__heading-dropdown",attrs:{separator:!0,position:e.dropdownPosition},scopedSlots:e._u([{key:"trigger",fn:function(t){var n=t.toggle,a=t.isOpen;return[i("Button",{attrs:{"aria-expanded":a?"true":"false",text:e.$str("user_group_assignment_add_group","mod_perform"),caret:!0,styleclass:{primary:!0}},on:{click:n}})]}}])},[e._v(" "),i("DropdownItem",{on:{click:e.openAdder}},[e._v("\n          "+e._s(e.$str("user_group_assignment_group_cohort","mod_perform"))+"\n        ")])],1)],1)],1),e._v(" "),i("Table",{staticClass:"tui-performManageActivityAssignmentsForm__table",attrs:{data:e.assignments.length>0?e.assignments:e.noAssignments},scopedSlots:e._u([{key:"header-row",fn:function(){return[i("HeaderCell",{attrs:{size:"8",valign:"center"}},[e._v("\n        "+e._s(e.$str("user_group_assignment_name","mod_perform"))+"\n      ")]),e._v(" "),i("HeaderCell",{attrs:{size:"4",valign:"center"}},[e._v("\n        "+e._s(e.$str("user_group_assignment_type","mod_perform"))+"\n      ")]),e._v(" "),i("HeaderCell",{attrs:{size:"2",valign:"center"}},[e._v("\n        "+e._s(e.$str("user_group_assignment_usercount","mod_perform"))+"\n      ")]),e._v(" "),i("HeaderCell",{attrs:{size:"2",valign:"center"}})]},proxy:!0},{key:"row",fn:function(t){var n=t.row;return[[i("Cell",{attrs:{size:"8",valign:"center","column-header":e.$str("user_group_assignment_name","mod_perform")}},[e._v("\n          "+e._s(n.group.name)+"\n        ")]),e._v(" "),i("Cell",{attrs:{size:"4",valign:"center","column-header":e.$str("user_group_assignment_type","mod_perform")}},[e._v("\n          "+e._s(n.group.type_label)+"\n        ")]),e._v(" "),i("Cell",{attrs:{size:"2",valign:"center","column-header":e.$str("user_group_assignment_usercount","mod_perform")}},[e._v("\n          "+e._s(n.group.size)+"\n        ")]),e._v(" "),i("Cell",{attrs:{size:"2",valign:"center",align:"end"}},[n.group.id?i("ButtonIcon",{attrs:{"aria-label":e.$str("delete"),styleclass:{small:!0,transparent:!0}},on:{click:function(t){return e.showRemoveConfirmationModal(n.type,n.group.id,n.group.type)}}},[i("DeleteIcon")],1):e._e()],1)]]}}])}),e._v(" "),i("div",{staticClass:"tui-performManageActivityAssignmentsForm__summary"},[e.track?i("Schedule",{attrs:{track:e.track,"dynamic-date-sources":e.dynamicDateSources,"default-fixed-date":e.defaultFixedDateSetting,"activity-id":e.activityId,"activity-state":e.activityState}}):e._e()],1),e._v(" "),i("AudienceAdder",{attrs:{open:e.isAdderOpen,"existing-items":e.addedIds},on:{added:e.updateSelectionFromAdder,cancel:e.closeAdder}}),e._v(" "),i("ConfirmationModal",{attrs:{title:e.$str("user_group_assignment_confirm_remove_title","mod_perform"),"confirm-button-text":e.$str("user_group_assignment_confirm_modal_remove","mod_perform"),open:e.confirmationModalOpen},on:{confirm:e.removeAssignment,cancel:e.hideRemoveConfirmationModal}},[e.isActive?i("p",[e._v("\n      "+e._s(e.$str("user_group_assignment_confirm_remove_active","mod_perform"))+"\n    ")]):i("p",[e._v("\n      "+e._s(e.$str("user_group_assignment_confirm_remove_draft","mod_perform"))+"\n    ")])])],1)};n._withStripped=!0;var a=i("D3AF"),s=i.n(a),r=i("vF5l"),o=i.n(r),d=i("5h9J"),l=i.n(d),c=i("KGot"),m=i.n(c),u=i("C+/B"),_=i.n(u),p=i("DHpr"),v=i.n(p),f=i("gLvT"),g=i.n(f),h=i("KGcv"),k=i.n(h),y=i("NAOU"),S=i.n(y),b=i("D9If"),N=i.n(b),F=i("5qAA"),A=i.n(F),T=i("yikf"),C=i.n(T),I=i("icJw"),E=i.n(I),O=i("KxNG"),$={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_default_track_settings"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"activity_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_default_track"},arguments:[{kind:"Argument",name:{kind:"Name",value:"activity_id"},value:{kind:"Variable",name:{kind:"Name",value:"activity_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"description"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject_instance_generation"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_is_open"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_is_fixed"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_fixed_from"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"iso"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"timezone"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"schedule_fixed_to"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"iso"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"timezone"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"schedule_dynamic_from"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"unit"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"direction"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"schedule_dynamic_to"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"unit"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"direction"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"schedule_dynamic_source"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"resolver_class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"option_key"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_available"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"custom_setting_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"custom_data"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_base"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"schedule_use_anniversary"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"due_date_is_enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"due_date_is_fixed"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"due_date_fixed"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"iso"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"timezone"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"due_date_offset"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"unit"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"repeating_is_enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"repeating_type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"repeating_offset"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"unit"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"repeating_is_limited"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"repeating_limit"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject_instance_generation"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"assignments"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"group"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type_label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"size"},arguments:[],directives:[]}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"mod_perform_available_dynamic_date_sources"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"resolver_class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"option_key"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_available"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"custom_setting_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"custom_data"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_base"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"mod_perform_default_fixed_date_setting"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"iso"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"timezone"},arguments:[],directives:[]}]}}]}}]},D={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_add_track_assignments"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"assignments"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_track_assignments_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_add_track_assignments"},arguments:[{kind:"Argument",name:{kind:"Name",value:"assignments"},value:{kind:"Variable",name:{kind:"Name",value:"assignments"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"assignments"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"group"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type_label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"size"},arguments:[],directives:[]}]}}]}}]}}]}}]},x={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_remove_track_assignments"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"assignments"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_track_assignments_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_remove_track_assignments"},arguments:[{kind:"Argument",name:{kind:"Name",value:"assignments"},value:{kind:"Variable",name:{kind:"Name",value:"assignments"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"assignments"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"group"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type_label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}}]}}]},w={components:{AudienceAdder:s.a,Button:o.a,ButtonIcon:l.a,Cell:m.a,ConfirmationModal:_.a,DeleteIcon:v.a,Dropdown:g.a,DropdownItem:k.a,Grid:S.a,GridItem:N.a,HeaderCell:A.a,Table:C.a,Schedule:E.a},props:{activityId:{type:Number,required:!0},activityState:{type:String,required:!0}},data(){return{track:null,dynamicDateSources:[],defaultFixedDateSetting:null,trackSettings:null,assignments:[],noAssignments:[{group:{name:this.$str("user_group_assignment_no_users","mod_perform")}}],addedIds:[],isAdderOpen:!1,confirmationModalOpen:!1,assignmentToRemove:null,adminEnum:1,cohortEnum:1}},computed:{dropdownPosition:()=>screen.width>600?"bottom-right":"bottom-left",isActive(){return this.activityState==O.ACTIVITY_STATUS_ACTIVE}},watch:{track(){this.track&&(this.assignments=this.track.assignments,this.addedIds=this.assignments.filter(e=>e.group.type===this.cohortEnum).map(e=>e.group.id)),this.assignments},trackSettings(e){this.track=e.track,this.defaultFixedDateSetting=e.defaultFixedDateSetting,this.track.schedule_dynamic_source&&!1===this.track.schedule_dynamic_source.is_available?this.dynamicDateSources=this.addedDeletedDateSourceToList(e.dynamicDateSources):this.dynamicDateSources=e.dynamicDateSources}},methods:{openAdder(){this.isAdderOpen=!0},closeAdder(){this.isAdderOpen=!1},updateSelectionFromAdder(e){const t=e.data.filter(e=>-1==this.addedIds.indexOf(e.id)).map(e=>({id:e.id,type:this.cohortEnum})),i={track_id:this.track.id,type:this.adminEnum,groups:t};this.updateAssignmentsInRepository(D,"mod_perform_add_track_assignments",i),this.addedIds=e.ids,this.isAdderOpen=!1},removeAssignment(){if(!this.assignmentToRemove)return;const e={track_id:this.track.id,type:this.assignmentToRemove.assignmentType,groups:[{id:this.assignmentToRemove.groupId,type:this.assignmentToRemove.groupType}]};this.updateAssignmentsInRepository(x,"mod_perform_remove_track_assignments",e)},addedDeletedDateSourceToList(e){const t=this.$str("deleted_dynamic_source_label","mod_perform",this.track.schedule_dynamic_source.display_name),i=[Object.assign({},this.track.schedule_dynamic_source,{display_name:t})];return i.push.apply(i,e),i},async updateAssignmentsInRepository(e,t,i){const n={assignments:i};try{const{data:i}=await this.$apollo.mutate({mutation:e,variables:n,refetchAll:!1}),a=i[t];this.hideRemoveConfirmationModal(),a?(this.track=a,this.$emit("mutation-success")):this.$emit("mutation-error")}catch(e){console.log("update track assignments error",e),this.$emit("mutation-error")}},showRemoveConfirmationModal(e,t,i){this.assignmentToRemove={assignmentType:e,groupId:t,groupType:i},this.confirmationModalOpen=!0},hideRemoveConfirmationModal(){this.assignmentToRemove=null,this.confirmationModalOpen=!1}},apollo:{trackSettings:{query:$,fetchPolicy:"network-only",variables(){return{activity_id:this.activityId}},update:e=>({track:e.mod_perform_default_track,dynamicDateSources:e.mod_perform_available_dynamic_date_sources,defaultFixedDateSetting:e.mod_perform_default_fixed_date_setting})}}},R=i("KHd+"),j=function(e){e.options.__langStrings={mod_perform:["deleted_dynamic_source_label","user_group_assignment_add_group","user_group_assignment_confirm_modal_remove","user_group_assignment_confirm_remove_active","user_group_assignment_confirm_remove_draft","user_group_assignment_confirm_remove_title","user_group_assignment_group_cohort","user_group_assignment_name","user_group_assignment_no_users","user_group_assignment_title","user_group_assignment_type","user_group_assignment_unique_user_count_title","user_group_assignment_unique_user_count_link","user_group_assignment_usercount"],moodle:["delete"]}},P=Object(R.a)(w,n,[],!1,null,null,null);"function"==typeof j&&j(P),P.options.__hasBlocks={script:!0,template:!0},P.options.__file="client/src/mod_perform/components/manage_activity/assignment/AssignmentsTab.vue";t.default=P.exports},Xi9X:function(e,t){e.exports=tui.require("tui/components/avatar/Avatar")},Xuva:function(e,t){e.exports=tui.require("mod_perform/components/report/manage_participation/ParticipantOpenCloseActionModal")},"Y6+c":function(e,t,i){"use strict";i.r(t),i.d(t,"NOTIFICATION_DURATION",(function(){return n})),i.d(t,"RELATIONSHIP_SUBJECT",(function(){return a})),i.d(t,"ACTIVITY_NAME_MAX_LENGTH",(function(){return s})),i.d(t,"ACTIVITY_STATUS_ACTIVE",(function(){return r})),i.d(t,"ACTIVITY_STATUS_DRAFT",(function(){return o})),i.d(t,"INSTANCE_AVAILABILITY_STATUS_OPEN",(function(){return d})),i.d(t,"INSTANCE_AVAILABILITY_STATUS_CLOSED",(function(){return l})),i.d(t,"RELATIVE_DATE_DIRECTION_AFTER",(function(){return c})),i.d(t,"RELATIVE_DATE_DIRECTION_BEFORE",(function(){return m})),i.d(t,"RELATIVE_DATE_UNIT_DAY",(function(){return u})),i.d(t,"RELATIVE_DATE_UNIT_WEEK",(function(){return _})),i.d(t,"SCHEDULE_REPEATING_TYPE_AFTER_CREATION",(function(){return p})),i.d(t,"SCHEDULE_REPEATING_TYPE_AFTER_CREATION_WHEN_COMPLETE",(function(){return v})),i.d(t,"SCHEDULE_REPEATING_TYPE_AFTER_COMPLETION",(function(){return f})),i.d(t,"SUBJECT_INSTANCE_GENERATION_ONE_PER_SUBJECT",(function(){return g})),i.d(t,"SUBJECT_INSTANCE_GENERATION_ONE_PER_JOB",(function(){return h})),i.d(t,"DATE_RESOLVER_EMPTY_BASE",(function(){return k})),i.d(t,"DATE_RESOLVER_USER_BASED",(function(){return y})),i.d(t,"DATE_RESOLVER_JOB_BASED",(function(){return S}));const n=1e4,a="subject",s=1024,r="ACTIVE",o="DRAFT",d="OPEN",l="CLOSED",c="AFTER",m="BEFORE",u="DAY",_="WEEK",p="AFTER_CREATION",v="AFTER_CREATION_WHEN_COMPLETE",f="AFTER_COMPLETION",g="ONE_PER_SUBJECT",h="ONE_PER_JOB",k="EMPTY_BASE",y="USER_BASED",S="JOB_BASED"},Ytqz:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ScheduleSettingContainer",{staticClass:"tui-performAssignmentDueDateSettings",attrs:{title:e.title}},[e.isEnabled?e.scheduleIsLimitedFixed?[i("span",[e._v(e._s(e.$str("due_date_enabled_description_before","mod_perform")))]),e._v(" "),i("Responsive",{attrs:{breakpoints:[{name:"small",boundaries:[0,700]},{name:null,boundaries:[701,701]}]},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.currentBoundaryName;return[i("FormRadioGroup",{attrs:{name:"dueDateIsFixed"}},[i("Radio",{class:{"tui-performAssignmentDueDateSettings__fixed":!0,"tui-performAssignmentSchedule__radio-disabled":!e.isFixed},attrs:{value:"true"}},[i("span",[e._v(e._s(e.$str("due_date_by","mod_perform")))]),e._v(" "),"small"!==n?i("FormDateSelector",{attrs:{id:e.$id("fixed-date-from"),name:"dueDateFixed",disabled:!e.isFixed,validations:function(e){return[e.required()]},type:"date","has-timezone":""}}):e._e()],1),e._v(" "),"small"===n?i("FormDateSelector",{attrs:{id:e.$id("fixed-date-from"),name:"dueDateFixed",disabled:!e.isFixed,validations:function(e){return[e.required()]},type:"date","has-timezone":""}}):e._e(),e._v(" "),i("Radio",{class:{"tui-performAssignmentSchedule__radio-disabled":e.isFixed},attrs:{value:"false"}},[i("span",[e._v(e._s(e.$str("due_date_within","mod_perform")))]),e._v(" "),i("RelativeDateSelector",{attrs:{path:"dueDateOffset",disabled:e.isFixed}}),e._v(" "),i("span",[e._v(e._s(e.$str("due_date_enabled_description_after","mod_perform")))])],1)],1)]}}])})]:[i("span",[e._v(e._s(e.$str("due_date_enabled_description_before","mod_perform")))]),e._v(" "),i("span",[e._v(e._s(e.$str("due_date_within","mod_perform")))]),e._v(" "),i("RelativeDateSelector",{attrs:{path:"dueDateOffset"}}),e._v(" "),i("span",[e._v(e._s(e.$str("due_date_enabled_description_after","mod_perform")))])]:[e._v(e._s(e.$str("due_date_disabled_description","mod_perform")))]],2)};n._withStripped=!0;var a=i("hzel"),s=i.n(a),r=i("5xBH"),o=i.n(r),d=i("VX2K"),l=i.n(d),c=i("dtfu"),m=i.n(c),u=i("dk0v"),_=i.n(u),p=i("K2XK"),v=i.n(p),f={components:{Responsive:m.a,FormDateSelector:s.a,FormRadioGroup:o.a,Radio:l.a,RelativeDateSelector:_.a,ScheduleSettingContainer:v.a},props:{isEnabled:{type:Boolean,required:!0},isFixed:{type:Boolean,required:!0},scheduleIsLimitedFixed:{type:Boolean,required:!0}},computed:{title(){return this.isEnabled?this.$str("due_date_enabled","mod_perform"):this.$str("due_date_disabled","mod_perform")}}},g=i("KHd+"),h=function(e){e.options.__langStrings={mod_perform:["due_date_by","due_date_disabled","due_date_disabled_description","due_date_enabled","due_date_enabled_description_after","due_date_enabled_description_before","due_date_within"]}},k=Object(g.a)(f,n,[],!1,null,null,null);"function"==typeof h&&h(k),k.options.__hasBlocks={script:!0,template:!0},k.options.__file="client/src/mod_perform/components/manage_activity/assignment/schedule/DueDateSettings.vue";t.default=k.exports},a0Gz:function(e,t){e.exports=tui.require("mod_perform/components/user_activities/ManualParticipantsSelectionBanner")},"bF0+":function(e,t){e.exports=tui.require("tui/components/buttons/EditIcon")},"bOP/":function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/ActivateActivityModal")},c0TB:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performUserActivitiesSelectParticipants__instance"},[i("h3",{staticClass:"tui-performUserActivitiesSelectParticipants__instance-title"},[e._v("\n    "+e._s(e.instanceTitle)+"\n  ")]),e._v(" "),i("div",{staticClass:"tui-performUserActivitiesSelectParticipants__instance-meta"},[i("p",[e._v("\n      "+e._s(e.$str("user_activities_created_at","mod_perform",e.subjectInstance.created_at))+"\n    ")])]),e._v(" "),i("Uniform",{staticClass:"tui-performUserActivitiesSelectParticipants__instance-form",attrs:{"initial-values":e.initialValues,validate:e.validate,"validation-mode":"submit","input-width":"full"},on:{change:e.updateHasChanges,submit:e.submit}},[e._l(e.relationships,(function(t){return i("FormRow",{key:t.id,attrs:{label:t.name,required:!0}},[i("FormUserSelector",{attrs:{name:t.id,users:e.userList}})],1)})),e._v(" "),i("FormRow",[i("ButtonGroup",[i("Button",{attrs:{styleclass:{primary:"true"},text:e.$str("save","totara_core"),disabled:e.isSaving,type:"submit"}})],1)],1)],2)],1)};n._withStripped=!0;var a=i("vF5l"),s=i.n(a),r=i("BN8m"),o=i.n(r),d=i("WBvU"),l=i("IC59"),c=i.n(l),m={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_set_manual_participants"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subject_instance_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"participants"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_update_manual_participants_input"}}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_set_manual_participants"},arguments:[{kind:"Argument",name:{kind:"Name",value:"subject_instance_id"},value:{kind:"Variable",name:{kind:"Name",value:"subject_instance_id"}}},{kind:"Argument",name:{kind:"Name",value:"participants"},value:{kind:"Variable",name:{kind:"Name",value:"participants"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}}]}}]},u={components:{Button:s.a,ButtonGroup:o.a,FormRow:d.FormRow,FormUserSelector:c.a,Uniform:d.Uniform},props:{subjectInstance:{required:!0,type:Object},relationships:{required:!0,type:Array},users:{required:!0,type:Array},currentUserId:{required:!0,type:Number}},data(){return{initialValues:this.getInitialValues(),hasChanges:!1,isSaving:!1}},computed:{instanceTitle(){return this.$str("user_activities_select_participants_subject_instance_title","mod_perform",{activity:this.subjectInstance.activity.name,user:this.subjectInstance.subject_user.fullname})},userList(){return this.subjectInstance.subject_user.id==this.currentUserId&&this.users.length<2?this.users:this.users.filter(e=>e.id!==this.subjectInstance.subject_user.id)}},mounted(){window.addEventListener("beforeunload",this.unloadHandler)},beforeDestroy(){window.removeEventListener("beforeunload",this.unloadHandler)},methods:{async submit(e){this.isSaving=!0;const t=Object.keys(e).map(t=>({manual_relationship_id:t,user_ids:e[t].map(e=>e.id)}));try{await this.$apollo.mutate({mutation:m,variables:{subject_instance_id:this.subjectInstance.id,participants:t}}),this.hasChanges=!1,this.$emit("submit")}catch(e){this.hasChanges=!1,this.$emit("error")}this.isSaving=!1},validate(e){const t={};return Object.keys(e).forEach(i=>{0===e[i].length&&(t[i]=this.$str("error_no_participants_selected","mod_perform"))}),t},getInitialValues(){let e={};return this.relationships.forEach(t=>{e[t.id]=[]}),e},updateHasChanges(e){this.hasChanges=Object.keys(e).some(t=>e[t].length>0)},unloadHandler(e){if(!this.hasChanges)return;const t=this.$str("unsaved_changes_warning","mod_perform");return e.preventDefault(),e.returnValue=t,t}}},_=i("KHd+"),p=function(e){e.options.__langStrings={mod_perform:["error_no_participants_selected","unsaved_changes_warning","user_activities_created_at","user_activities_select_participants_subject_instance_title"],totara_core:["save"]}},v=Object(_.a)(u,n,[],!1,null,null,null);"function"==typeof p&&p(v),v.options.__hasBlocks={script:!0,template:!0},v.options.__file="client/src/mod_perform/components/user_activities/participant_selector/ActivityParticipants.vue";t.default=v.exports},cZWK:function(e,t){e.exports=tui.require("tui/components/icons/common/Unlock")},crm9:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performUserActivityListSections"},[e._l(e.subjectSectionsSubset,(function(t){return i("div",{key:t.section.id,staticClass:"tui-performUserActivityListSection"},[e.isMultiSectionActive?i("h3",{staticClass:"tui-performUserActivityListSection__header"},[t.canParticipate&&e.currentUserHasMultipleRelationships(t)?i("Button",{attrs:{styleclass:{transparent:!0},text:t.section.display_title},on:{click:function(i){return i.preventDefault(),e.showRelationshipSelector(t)}}}):t.canParticipate?i("a",{attrs:{href:e.$url(e.viewUrl,{participant_section_id:e.getFirstSectionIdToParticipate(t)})}},[e._v("\n        "+e._s(t.section.display_title)+"\n      ")]):[e._v("\n        "+e._s(t.section.display_title)+"\n      ")]],2):e._e(),e._v(" "),!e.anonymousResponses||t.participation.length>0?i("Table",{staticClass:"tui-performUserActivityListSection__data",attrs:{data:t.participation,"border-bottom-hidden":!0,"border-separator-hidden":!0,"border-top-hidden":!e.isMultiSectionActive},scopedSlots:e._u([{key:"row",fn:function(t){var n=t.row;return[i("Cell",{attrs:{size:"4","column-header":e.$str("user_activities_status_header_relationship","mod_perform"),heavy:n.isForCurrentUser,valign:"center"}},[e._v("\n          "+e._s(n.relationship)+"\n        ")]),e._v(" "),i("Cell",{attrs:{size:"4","column-header":e.$str("user_activities_subject_header","mod_perform"),heavy:n.isForCurrentUser,valign:"center"}},[i("Avatar",{staticClass:"tui-bulkManualRatingRateUsersList__avatar",attrs:{src:n.participant.profileimageurlsmall,alt:n.participant.fullname,size:"xsmall"}}),e._v(" "),n.isForCurrentUser?[e._v("\n            "+e._s(e.$str("user_activities_you","mod_perform"))+"\n          ")]:[e._v("\n            "+e._s(n.participant.fullname)+"\n          ")]],2),e._v(" "),i("Cell",{attrs:{size:"4","column-header":e.$str("user_activities_status_header_section_progress","mod_perform"),heavy:n.isForCurrentUser,valign:"center"}},[e._v("\n          "+e._s(e.getStatusText(n.progressStatus))+"\n          "),"CLOSED"===n.availabilityStatus?i("Lock",{attrs:{alt:e.$str("user_activities_closed","mod_perform"),title:e.$str("user_activities_closed","mod_perform")}}):e._e(),e._v(" "),n.isOverdue?i("Lozenge",{attrs:{type:"alert",text:e.$str("is_overdue","mod_perform")}}):e._e()],1)]}}],null,!0)}):e._e(),e._v(" "),e.anonymousResponses?[i("hr"),e._v(" "),i("div",{staticClass:"tui-performUserActivityListSection__summary"},[i("p",[e._v("\n          "+e._s(e.$str("user_activities_total_respondents","mod_perform",t.summary.totalRespondents))+"\n        ")]),e._v(" "),i("p",[e._v("\n          "+e._s(e.$str("user_activities_total_completed","mod_perform",t.summary.totalCompleted))+"\n        ")])])]:e._e()],2)})),e._v(" "),i("ModalPresenter",{attrs:{open:e.isRelationshipSelectorShown},on:{"request-close":e.hideRelationshipSelector}},[i("RelationshipSelector",{attrs:{"current-user-id":e.currentUserId,"participant-sections":e.selectedParticipantSections,"is-for-section":!0,"subject-user":e.subjectUser,"view-url":e.viewUrl},model:{value:e.isRelationshipSelectorShown,callback:function(t){e.isRelationshipSelectorShown=t},expression:"isRelationshipSelectorShown"}})],1)],2)};n._withStripped=!0;var a=i("Xi9X"),s=i.n(a),r=i("vF5l"),o=i.n(r),d=i("KGot"),l=i.n(d),c=i("cytP"),m=i.n(c),u=i("PNtU"),_=i.n(u),p=i("Mnur"),v=i.n(p),f=i("7tcR"),g=i.n(f),h=i("yikf"),k=i.n(h),y={components:{Avatar:s.a,Button:o.a,Cell:l.a,Lock:m.a,Lozenge:_.a,ModalPresenter:v.a,RelationshipSelector:g.a,Table:k.a},props:{currentUserId:{required:!0,type:Number},isMultiSectionActive:{required:!0,type:Boolean},subjectSections:{required:!0,type:Array},viewUrl:{required:!0,type:String},subjectUser:{required:!0,type:Object},anonymousResponses:{required:!0,type:Boolean}},data:()=>({isRelationshipSelectorShown:!1,selectedParticipantSections:[]}),computed:{subjectSectionsSubset(){return this.subjectSections.map(e=>{const t=e.participant_sections.map(e=>{let t,i,n={};const a=e.participant_instance.is_for_current_user;return!a&&this.anonymousResponses||(t=e.participant_instance.core_relationship.name,i=e.participant_instance.core_relationship.id,n=e.participant_instance.participant),{id:e.id,isForCurrentUser:a,progressStatus:e.progress_status,availabilityStatus:e.availability_status,isOverdue:e.is_overdue,participant:n,relationship:t,relationship_id:i}}),i=t.filter(e=>!this.anonymousResponses||e.isForCurrentUser);return{canParticipate:e.can_participate,participation:i,summary:this.getParticipantSummary(t),participant_sections:e.participant_sections,section:e.section}})}},methods:{getStatusText(e){switch(e){case"NOT_STARTED":return this.$str("user_activities_status_not_started","mod_perform");case"IN_PROGRESS":return this.$str("user_activities_status_in_progress","mod_perform");case"COMPLETE":return this.$str("user_activities_status_complete","mod_perform");default:return""}},getFirstSectionIdToParticipate(e){let t=e.participation.find(e=>e.isForCurrentUser);if(!t)throw"Section for user not found.";return t.id},currentUserHasMultipleRelationships(e){return this.filterToCurrentUser(e.participation).length>1},showRelationshipSelector(e){this.selectedParticipantSections=[],e.participant_sections.forEach(e=>{this.selectedParticipantSections.push(e)}),this.isRelationshipSelectorShown=!0},hideRelationshipSelector(){this.isRelationshipSelectorShown=!1},filterToCurrentUser:e=>e.filter(e=>e.isForCurrentUser),getParticipantSummary:e=>({totalRespondents:e.length,totalCompleted:e.filter(e=>"COMPLETE"===e.progressStatus).length})}},S=i("KHd+"),b=function(e){e.options.__langStrings={mod_perform:["is_overdue","user_activities_closed","user_activities_status_complete","user_activities_status_header_relationship","user_activities_status_header_section_progress","user_activities_status_in_progress","user_activities_status_not_started","user_activities_subject_header","user_activities_total_completed","user_activities_total_respondents","user_activities_you"]}},N=Object(S.a)(y,n,[],!1,null,null,null);"function"==typeof b&&b(N),N.options.__hasBlocks={script:!0,template:!0},N.options.__file="client/src/mod_perform/components/user_activities/list/Sections.vue";t.default=N.exports},cytP:function(e,t){e.exports=tui.require("tui/components/icons/common/Lock")},dUjM:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/ActivityStatusBanner")},dk0v:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/assignment/schedule/RelativeDateSelector")},dpEn:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this.$createElement,t=this._self._c||e;return t("Loader",{attrs:{loading:this.$apollo.loading}},[t("InstanceInfoCard",{attrs:{title:this.$str("subject_instance_card_title","mod_perform"),"info-lines":this.infoLines,"show-all-link":this.showAllLink}})],1)};n._withStripped=!0;var a=i("KcPf"),s=i("/Ngp"),r=i.n(s),o=i("AdjL"),d=i.n(o),l={components:{InstanceInfoCard:r.a,Loader:d.a},props:{subjectInstanceId:{type:Number,required:!0},showAllLink:{type:String,required:!0}},data:()=>({subjectInstance:null}),computed:{infoLines(){if(null===this.subjectInstance)return[];let e="";return this.subjectInstance.job_assignment&&(e=this.subjectInstance.job_assignment.fullname),[{label:this.$str("instance_info_card_subject_full_name","mod_perform"),text:this.subjectInstance.subject_user.fullname},{label:this.$str("subject_instance_card_job_assignment","mod_perform"),text:e},{label:this.$str("subject_instance_card_instance_count","mod_perform"),text:this.subjectInstance.instance_count},{label:this.$str("instance_info_card_creation_date","mod_perform"),text:this.subjectInstance.created_at}]}},apollo:{subjectInstance:{query:a.a,variables(){return{subject_instance_id:this.subjectInstanceId}},update:e=>e.mod_perform_subject_instance}}},c=i("KHd+"),m=function(e){e.options.__langStrings={mod_perform:["instance_info_card_creation_date","instance_info_card_show_all_button","instance_info_card_subject_full_name","subject_instance_card_instance_count","subject_instance_card_job_assignment","subject_instance_card_title"]}},u=Object(c.a)(l,n,[],!1,null,null,null);"function"==typeof m&&m(u),u.options.__hasBlocks={script:!0,template:!0},u.options.__file="client/src/mod_perform/components/manage_activity/participation/SubjectInstanceInfoCard.vue";t.default=u.exports},dtfu:function(e,t){e.exports=tui.require("tui/components/responsive/Responsive")},eABU:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-activityNotifications"},[i("h3",{staticClass:"tui-activityNotifications__header"},[i("span",{staticClass:"tui-activityNotifications__title"},[e._v(e._s(e.$str("manage_activities_tabs_notifications","mod_perform")))]),e._v(" "),i("span",{staticClass:"tui-activityNotifications__active",attrs:{"aria-hidden":"true"}},[e._v(e._s(e.$str("notification_active","mod_perform")))])]),e._v(" "),e._l(e.notifications,(function(t){return i("NotificationSection",{key:t.class_key,attrs:{data:t},on:{toggleNotification:e.onToggleNotification,toggleRecipient:e.onToggleRecipient,updateTriggers:e.onUpdateTriggers}})}))],2)};n._withStripped=!0;var a=i("vyVp"),s=i("KxNG"),r=i("X1gS"),o=i.n(r),d={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_notifications"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"activity_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_notifications"},arguments:[{kind:"Argument",name:{kind:"Name",value:"activity_id"},value:{kind:"Variable",name:{kind:"Name",value:"activity_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"class_key"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"active"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"recipients"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"relationship_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"active"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"trigger_label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"triggers"},arguments:[],directives:[]}]}}]}}]},l={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_create_notification"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_create_notification_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_create_notification"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"notification"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"active"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"recipients"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"relationship_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"active"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"triggers"},arguments:[],directives:[]}]}}]}}]}}]},c={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_toggle_notification"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_toggle_notification_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_toggle_notification"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"notification"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"class_key"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"active"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"recipients"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"relationship_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"active"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"triggers"},arguments:[],directives:[]}]}}]}}]}}]},m={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_toggle_notification_recipient"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_toggle_notification_recipient_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_toggle_notification_recipient"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"notification"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"active"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"recipients"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"relationship_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"active"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"triggers"},arguments:[],directives:[]}]}}]}}]}}]},u={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_update_notification_triggers"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_update_notification_triggers_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_update_notification_triggers"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"notification"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"active"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"recipients"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"relationship_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"active"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"triggers"},arguments:[],directives:[]}]}}]}}]}}]},_=i("TXEh"),p={components:{NotificationSection:o.a},props:{value:{type:Object,required:!0}},data:()=>({notifications:[]}),apollo:{notifications:{query:d,variables(){return{activity_id:this.value.id}},update:e=>e.mod_perform_notifications}},watch:{value(){this.$apollo.queries.notifications.refetch()}},beforeCreate(){this.updateTriggers=Object(_.debounce)(async(e,t)=>{const i=await this.createNotificationIfNotExists(e);try{await this.$apollo.mutate({mutation:u,variables:{input:{notification_id:i,values:t}},refetchAll:!1}),Object(a.notify)({duration:s.NOTIFICATION_DURATION,message:this.$str("toast_success_activity_update","mod_perform"),type:"success"})}catch(e){throw Object(a.notify)({duration:s.NOTIFICATION_DURATION,message:this.$str("toast_error_generic_update","mod_perform"),type:"error"}),e}},500,{leading:!0,trailing:!0})},methods:{async onToggleNotification(e,t){e.id?await this.$apollo.mutate({mutation:c,variables:{input:{notification_id:e.id,active:t}},refetchAll:!0}):await this.$apollo.mutate({mutation:l,variables:{input:{activity_id:this.value.id,class_key:e.class_key,active:t}},refetchAll:!0})},async createNotificationIfNotExists(e){let t;if(e.id)t=e.id;else{t=(await this.$apollo.mutate({mutation:l,variables:{input:{activity_id:this.value.id,class_key:e.class_key,active:e.active}}})).data.mod_perform_create_notification.notification.id}return t},async onToggleRecipient(e,t){const i=await this.createNotificationIfNotExists(e);await this.$apollo.mutate({mutation:m,variables:{input:{notification_id:i,relationship_id:t.id,active:t.active}},refetchAll:!0})},onUpdateTriggers(e,t){this.updateTriggers(e,t)}}},v=i("KHd+"),f=function(e){e.options.__langStrings={mod_perform:["notification_active","manage_activities_tabs_notifications","toast_error_generic_update","toast_success_activity_update"]}},g=Object(v.a)(p,n,[],!1,null,null,null);"function"==typeof f&&f(g),g.options.__hasBlocks={script:!0,template:!0},g.options.__file="client/src/mod_perform/components/manage_activity/notification/NotificationsTab.vue";t.default=g.exports},fCWf:function(e,t){e.exports=tui.require("tui/components/links/ActionLink")},fD1q:function(e,t,i){var n={"./Activities":"hzZE","./Activities.vue":"hzZE","./AddParticipants":"9aSr","./AddParticipants.vue":"9aSr","./ManageActivity":"lL3B","./ManageActivity.vue":"lL3B","./UserActivities":"Ksqd","./UserActivities.vue":"Ksqd","./UserActivitiesSelectParticipants":"Q4hb","./UserActivitiesSelectParticipants.vue":"Q4hb","./UserActivity":"S790","./UserActivity.vue":"S790"};function a(e){var t=s(e);return i(t)}function s(e){if(!i.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=s,e.exports=a,a.id="fD1q"},fFSS:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ActionCard",{scopedSlots:e._u([{key:"card-body",fn:function(){return[e.state===e.ACTIVITY_STATUS_DRAFT?[i("span",{domProps:{innerHTML:e._s(e.$str("activity_status_banner_draft","mod_perform"))}}),e._v(" "),i("HelpIcon",{attrs:{position:"bottom","icon-label":e.$str("activity_status_banner_help_title","mod_perform"),"desc-id":e.$id("activation-help")}},[i("p",[e._v(e._s(e.$str("activity_status_banner_help_intro","mod_perform")))]),e._v(" "),i("ul",[i("li",[e._v("\n            "+e._s(e.$str("activation_criteria_assignments","mod_perform"))+"\n          ")]),e._v(" "),i("li",[e._v(e._s(e.$str("activation_criteria_elements","mod_perform")))]),e._v(" "),i("li",[e._v("\n            "+e._s(e.$str("activation_criteria_relationships","mod_perform"))+"\n          ")]),e._v(" "),i("li",[e._v(e._s(e.$str("activation_criteria_schedule","mod_perform")))])])])]:e.state===e.ACTIVITY_STATUS_ACTIVE?i("span",{domProps:{innerHTML:e._s(e.$str("activity_status_banner_active","mod_perform"))}}):e._e()]},proxy:!0},e.activity.can_potentially_activate?{key:"card-action",fn:function(){return[i("ActivateActivityModal",{attrs:{activity:e.activity},on:{refetch:function(t){return e.$emit("refetch")}},scopedSlots:e._u([{key:"trigger",fn:function(t){var n=t.open,a=t.loading;return[i("Button",{attrs:{text:e.$str("activity_action_activate","mod_perform"),disabled:a},on:{click:n}})]}}],null,!1,500609164)})]},proxy:!0}:null],null,!0)})};n._withStripped=!0;var a=i("kUb+"),s=i.n(a),r=i("bOP/"),o=i.n(r),d=i("vF5l"),l=i.n(d),c=i("MAAM"),m=i.n(c),u=i("KxNG"),_={components:{ActionCard:s.a,ActivateActivityModal:o.a,Button:l.a,HelpIcon:m.a},props:{activity:{required:!0,type:Object}},data:()=>({ACTIVITY_STATUS_ACTIVE:u.ACTIVITY_STATUS_ACTIVE,ACTIVITY_STATUS_DRAFT:u.ACTIVITY_STATUS_DRAFT}),computed:{state(){return this.activity.state_details.name}}},p=i("KHd+"),v=function(e){e.options.__langStrings={mod_perform:["activation_criteria_assignments","activation_criteria_elements","activation_criteria_relationships","activation_criteria_schedule","activity_action_activate","activity_status_banner_active","activity_status_banner_draft","activity_status_banner_help_intro","activity_status_banner_help_title"]}},f=Object(p.a)(_,n,[],!1,null,null,null);"function"==typeof v&&v(f),f.options.__hasBlocks={script:!0,template:!0},f.options.__file="client/src/mod_perform/components/manage_activity/ActivityStatusBanner.vue";t.default=f.exports},fkPW:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/notification/RecipientsTable")},fqqR:function(e,t){e.exports=tui.require("mod_perform/components/report/manage_participation/SubjectInstanceOpenCloseActionModal")},fw38:function(e,t){e.exports=tui.require("tui/components/form/Select")},gLnO:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ModalPresenter",{attrs:{open:e.modalOpen},on:{"request-close":e.modalClose}},[i("Modal",{attrs:{size:"normal","aria-labelledby":e.$id("report_open_close")}},[i("ModalContent",{attrs:{title:e.$str(e.isOpen?"subject_instance_closed_title":"subject_instance_reopen_title","mod_perform"),"title-id":e.$id("report_open_close")},scopedSlots:e._u([{key:"buttons",fn:function(){return[i("ButtonGroup",[i("Button",{attrs:{styleclass:{primary:!0},text:e.$str(e.isOpen?"button_close":"button_reopen","mod_perform")},on:{click:function(t){return e.changeAvailability()}}}),e._v(" "),i("Button",{attrs:{text:e.$str("button_cancel","mod_perform")},on:{click:function(t){return e.modalClose()}}})],1)]},proxy:!0}])},[e.isOpen?[i("p",[e._v("\n          "+e._s(e.$str("subject_instance_closed_message_line1","mod_perform"))+"\n        ")]),e._v(" "),i("p",[e._v("\n          "+e._s(e.$str("subject_instance_closed_message_line2","mod_perform"))+"\n        ")])]:[i("p",[e._v("\n          "+e._s(e.$str("subject_instance_reopen_message_line1","mod_perform"))+"\n        ")]),e._v(" "),i("p",[e._v("\n          "+e._s(e.$str("subject_instance_reopen_message_line2","mod_perform"))+"\n        ")]),e._v(" "),i("p",[e._v("\n          "+e._s(e.$str("subject_instance_reopen_message_line3","mod_perform"))+"\n        ")])]],2)],1)],1)};n._withStripped=!0;var a=i("vF5l"),s=i.n(a),r=i("BN8m"),o=i.n(r),d=i("tkAW"),l=i.n(d),c=i("u5iS"),m=i.n(c),u=i("Mnur"),_=i.n(u),p={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_manually_change_subject_instance"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_manually_change_subject_instance_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_manually_change_subject_instance"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"subject_instance"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}]}}]},v=i("vyVp"),f=i("E7bt"),g=i("KxNG"),h={components:{Button:s.a,ButtonGroup:o.a,Modal:l.a,ModalContent:m.a,ModalPresenter:_.a},props:{modalOpen:{type:Boolean},subjectInstanceId:{type:String},isOpen:{type:Boolean},reportType:{type:String}},methods:{modalClose(){this.$emit("modal-close")},showErrorNotification(){Object(v.notify)({duration:g.NOTIFICATION_DURATION,message:this.$str("toast_error_generic_update","mod_perform"),type:"error"})},async changeAvailability(){try{let e=this.isOpen?g.INSTANCE_AVAILABILITY_STATUS_CLOSED:g.INSTANCE_AVAILABILITY_STATUS_OPEN;await this.$apollo.mutate({mutation:p,variables:{input:{subject_instance_id:this.subjectInstanceId,availability:e}}}),this.$emit("modal-close"),Object(f.redirectWithPost)(window.location,{is_open:!this.isOpen,report_type:this.reportType})}catch(e){this.showErrorNotification()}}}},k=i("KHd+"),y=function(e){e.options.__langStrings={mod_perform:["button_cancel","button_close","button_reopen","subject_instance_closed_message_line1","subject_instance_closed_message_line2","subject_instance_closed_title","subject_instance_reopen_title","subject_instance_reopen_message_line1","subject_instance_reopen_message_line2","subject_instance_reopen_message_line3","toast_error_generic_update"]}},S=Object(k.a)(h,n,[],!1,null,null,null);"function"==typeof y&&y(S),S.options.__hasBlocks={script:!0,template:!0},S.options.__file="client/src/mod_perform/components/report/manage_participation/SubjectInstanceOpenCloseActionModal.vue";t.default=S.exports},gLvT:function(e,t){e.exports=tui.require("tui/components/dropdown/Dropdown")},gNII:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/GeneralInfoTab")},hau1:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"tui-participantUserHeader"},[t("Avatar",{staticClass:"tui-participantUserHeader__avatar",attrs:{src:this.profilePicture,size:this.size,alt:this.userName,"aria-hidden":!0}}),this._v(" "),t("div",{staticClass:"tui-participantUserHeader__name"},[this._v("\n    "+this._s(this.userName)+"\n  ")])],1)};n._withStripped=!0;var a=i("Xi9X"),s={components:{Avatar:i.n(a).a},props:{userName:String,profilePicture:String,size:String}},r=i("KHd+"),o=Object(r.a)(s,n,[],!1,null,null,null);o.options.__hasBlocks={script:!0,template:!0},o.options.__file="client/src/mod_perform/components/user_activities/participant/ParticipantUserHeader.vue";t.default=o.exports},hjaT:function(e,t){e.exports=tui.require("tui/components/form/Checkbox")},hmgb:function(e,t,i){"use strict";i.r(t);var n=i("lBzj"),a=i.n(n),s={functional:!0,components:{FlexIcon:a.a},props:{alt:String,customClass:[String,Object,Array],styleClass:Object,size:[String,Number],title:String},render:(e,{props:t})=>e(a.a,{props:Object.assign({},t,{icon:"notification"})})},r=i("KHd+"),o=Object(r.a)(s,void 0,void 0,!1,null,null,null);o.options.__hasBlocks={script:!0,template:!1},o.options.__file="client/src/mod_perform/components/icons/EndDateEnabled.vue";t.default=o.exports},hzZE:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performManageActivityList"},[i("h2",{domProps:{textContent:e._s(e.$str("perform:manage_activity","mod_perform"))}}),e._v(" "),e.canAdd?i("Button",{attrs:{text:e.$str("add_activity","mod_perform")},on:{click:function(t){return e.showCreateModal()}}}):e._e(),e._v(" "),i("ModalPresenter",{attrs:{open:e.modalOpen},on:{"request-close":e.modalRequestClose}},[i("Modal",{attrs:{"aria-labelledby":e.$id("title")}},[i("ModalContent",{attrs:{title:e.$str("add_activity","mod_perform"),"title-id":e.$id("title"),"close-button":!0}},[i("CreateActivityForm",{on:{"mutation-success":e.redirectToManageActivity,"mutation-error":e.creationError}})],1)],1)],1),e._v(" "),i("loader",{attrs:{loading:e.$apollo.loading}},[e.$apollo.loading?e._e():i("Table",{staticClass:"tui-performManageActivityList__table",attrs:{data:e.activities},scopedSlots:e._u([{key:"header-row",fn:function(){return[i("HeaderCell",{attrs:{size:"9"}},[e._v(e._s(e.$str("view_name","mod_perform")))]),e._v(" "),i("HeaderCell",{attrs:{size:"2"}},[e._v(e._s(e.$str("view_type","mod_perform")))]),e._v(" "),i("HeaderCell",{attrs:{size:"2"}},[e._v(e._s(e.$str("view_status","mod_perform")))]),e._v(" "),i("HeaderCell",{attrs:{size:"1"}})]},proxy:!0},{key:"row",fn:function(t){var n=t.row;return[i("Cell",{attrs:{size:"9","column-header":e.$str("view_name","mod_perform")}},[n.can_manage?i("a",{attrs:{href:e.getEditActivityUrl(n.id)}},[e._v(e._s(n.name))]):i("div",[e._v(e._s(n.name))])]),e._v(" "),i("Cell",{attrs:{size:"2","column-header":e.$str("view_type","mod_perform")}},[e._v("\n          "+e._s(n.type.display_name)+"\n        ")]),e._v(" "),i("Cell",{attrs:{size:"2","column-header":e.$str("view_status","mod_perform")}},[e._v("\n          "+e._s(n.state_details.display_name)+"\n        ")]),e._v(" "),i("Cell",{attrs:{size:"1","column-header":e.$str("view_actions","mod_perform")}},[i("ActivityActions",{attrs:{activity:n},on:{refetch:e.refetchActivities}})],1)]}}],null,!1,397648639)})],1)],1)};n._withStripped=!0;var a=i("2LpK"),s=i.n(a),r=i("vF5l"),o=i.n(r),d=i("KGot"),l=i.n(d),c=i("Awxv"),m=i.n(c),u=i("5qAA"),_=i.n(u),p=i("AdjL"),v=i.n(p),f=i("tkAW"),g=i.n(f),h=i("u5iS"),k=i.n(h),y=i("Mnur"),S=i.n(y),b=i("sicn"),N=i("yikf"),F=i.n(N),A=i("vyVp"),T=i("KxNG"),C={components:{ActivityActions:s.a,Button:o.a,Cell:l.a,CreateActivityForm:m.a,HeaderCell:_.a,Loader:v.a,Modal:g.a,ModalContent:k.a,ModalPresenter:S.a,Table:F.a},props:{editUrl:{required:!0,type:String},canAdd:{required:!0,type:Boolean}},data:()=>({activities:[],modalOpen:!1}),methods:{creationError(){Object(A.notify)({duration:T.NOTIFICATION_DURATION,message:this.$str("toast_error_create_activity","mod_perform"),type:"error"})},showCreateModal(){this.modalOpen=!0},modalRequestClose(){this.modalOpen=!1},redirectToManageActivity({id:e}){window.location=this.getEditActivityUrl(e)},getEditActivityUrl(e){return this.$url(this.editUrl,{activity_id:e})},refetchActivities(){this.$apollo.queries.activities.refetch()}},apollo:{activities:{query:b.a,update:e=>e.mod_perform_activities}}},I=i("KHd+"),E=function(e){e.options.__langStrings={mod_perform:["add_activity","get_started","perform:manage_activity","toast_error_create_activity","view_actions","view_name","view_status","view_type"]}},O=Object(I.a)(C,n,[],!1,null,null,null);"function"==typeof E&&E(O),O.options.__hasBlocks={script:!0,template:!0},O.options.__file="client/src/mod_perform/pages/Activities.vue";t.default=O.exports},hzel:function(e,t){e.exports=tui.require("tui/components/uniform/FormDateSelector")},"i/kK":function(e,t){e.exports=tui.require("tui/components/form/FormRow")},iFIC:function(e,t){e.exports=tui.require("tui/components/form/Repeater")},icJw:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/assignment/Schedule")},j4gZ:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this.$createElement,t=this._self._c||e;return t("FormRow",{attrs:{label:this.$str("reporting_identifier","mod_perform"),helpmsg:this.$str("reporting_id_help_text","performelement_multi_choice_multi")}},[t("div",[t("FormText",{attrs:{name:"identifier",validations:function(e){return[e.maxLength(1024)]}}})],1)])};n._withStripped=!0;var a=i("WBvU"),s={components:{FormRow:a.FormRow,FormText:a.FormText}},r=i("KHd+"),o=function(e){e.options.__langStrings={mod_perform:["reporting_identifier"],performelement_multi_choice_multi:["reporting_id_help_text"]}},d=Object(r.a)(s,n,[],!1,null,null,null);"function"==typeof o&&o(d),d.options.__hasBlocks={script:!0,template:!0},d.options.__file="client/src/mod_perform/components/element/admin_form/IdentifierInput.vue";t.default=d.exports},jJ8l:function(e,t){e.exports=tui.require("tui/components/card/Card")},jU43:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performAssignmentScheduleToggles"},[i("div",{staticClass:"tui-performAssignmentScheduleToggles__setting"},[i("h4",{staticClass:"tui-performAssignmentSchedule__sectionHeading"},[e._v("\n      "+e._s(e.$str("schedule_creation_range_and_date_type","mod_perform"))+"\n    ")]),e._v(" "),i("div",{staticClass:"tui-performAssignmentScheduleToggles__toggle-group"},[i("div",{staticClass:"tui-performAssignmentScheduleToggles__toggle-set"},[i("ToggleSet",{attrs:{value:e.scheduleIsOpen,"aria-label":e.$str("schedule_creation_range","mod_perform"),large:!0},on:{input:function(t){return e.$emit("update:scheduleIsOpen",t)}}},[i("ToggleButton",{attrs:{value:!1,"aria-label":e.$str("schedule_is_limited","mod_perform"),text:e.$str("schedule_is_limited","mod_perform")}},[i("CalendarIcon")],1),e._v(" "),i("ToggleButton",{attrs:{value:!0,"aria-label":e.$str("schedule_is_open","mod_perform"),text:e.$str("schedule_is_open","mod_perform")}},[i("CalendarIcon")],1)],1)],1),e._v(" "),i("div",{staticClass:"tui-performAssignmentScheduleToggles__toggle-set"},[i("ToggleSet",{attrs:{value:e.scheduleIsFixed,"aria-label":e.$str("schedule_creation_date_type","mod_perform"),large:!0},on:{input:function(t){return e.$emit("update:scheduleIsFixed",t)}}},[i("ToggleButton",{attrs:{value:!0,"aria-label":e.$str("schedule_is_fixed","mod_perform"),text:e.$str("schedule_is_fixed","mod_perform")}},[i("CalendarIcon")],1),e._v(" "),i("ToggleButton",{attrs:{value:!1,"aria-label":e.$str("schedule_is_dynamic","mod_perform"),text:e.$str("schedule_is_dynamic","mod_perform")}},[i("CalendarIcon")],1)],1)],1)])]),e._v(" "),i("div",{staticClass:"performAssignmentScheduleToggles__setting"},[i("h4",{staticClass:"tui-performAssignmentSchedule__sectionHeading"},[e._v("\n      "+e._s(e.$str("schedule_creation_frequency","mod_perform"))+"\n    ")]),e._v(" "),i("div",{staticClass:"tui-performAssignmentScheduleToggles__toggle-group"},[i("div",{staticClass:"tui-performAssignmentScheduleToggles__toggle-set"},[i("ToggleSet",{attrs:{value:e.repeatingIsEnabled,"aria-label":e.$str("schedule_creation_frequency","mod_perform"),large:!0},on:{input:function(t){return e.$emit("update:repeatingIsEnabled",t)}}},[i("ToggleButton",{attrs:{value:!1,"aria-label":e.$str("schedule_creation_frequency_once_off","mod_perform"),text:e.$str("schedule_creation_frequency_once_off","mod_perform")}},[i("RepeatingDisabled")],1),e._v(" "),i("ToggleButton",{attrs:{value:!0,"aria-label":e.$str("schedule_creation_frequency_repeating","mod_perform"),text:e.$str("schedule_creation_frequency_repeating","mod_perform")}},[i("RepeatingEnabled")],1)],1)],1)])]),e._v(" "),i("div",{staticClass:"performAssignmentScheduleToggles__setting"},[i("h4",{staticClass:"tui-performAssignmentSchedule__sectionHeading"},[e._v("\n      "+e._s(e.$str("due_date","mod_perform"))+"\n    ")]),e._v(" "),i("div",{staticClass:"tui-performAssignmentScheduleToggles__toggle-group"},[i("div",{staticClass:"tui-performAssignmentScheduleToggles__toggle-set"},[i("ToggleSet",{attrs:{value:e.dueDateIsEnabled,"aria-label":e.$str("due_date","mod_perform"),large:!0},on:{input:function(t){return e.$emit("update:dueDateIsEnabled",t)}}},[i("ToggleButton",{attrs:{value:!0,"aria-label":e.$str("due_date_is_enabled","mod_perform"),text:e.$str("due_date_is_enabled","mod_perform")}},[i("EndDateEnabled")],1),e._v(" "),i("ToggleButton",{attrs:{value:!1,"aria-label":e.$str("due_date_is_disabled","mod_perform"),text:e.$str("due_date_is_disabled","mod_perform")}},[i("EndDateDisabled")],1)],1)],1)])])])};n._withStripped=!0;var a=i("Uj5i"),s=i.n(a),r=i("FL/Z"),o=i.n(r),d=i("H3Bi"),l=i.n(d),c=i("LANY"),m=i.n(c),u=i("UXJH"),_=i.n(u),p=i("kV+/"),v=i.n(p),f=i("/X/1"),g=i.n(f),h={components:{CalendarIcon:s.a,EndDateDisabled:o.a,EndDateEnabled:l.a,RepeatingDisabled:m.a,RepeatingEnabled:_.a,ToggleButton:v.a,ToggleSet:g.a},props:{scheduleIsOpen:{required:!0,type:Boolean},scheduleIsFixed:{required:!0,type:Boolean},repeatingIsEnabled:{required:!0,type:Boolean},dueDateIsEnabled:{required:!0,type:Boolean}}},k=i("KHd+"),y=function(e){e.options.__langStrings={mod_perform:["due_date","due_date_is_disabled","due_date_is_enabled","schedule_creation_range","schedule_creation_date_type","schedule_creation_range_and_date_type","schedule_creation_frequency","schedule_creation_frequency_once_off","schedule_creation_frequency_repeating","schedule_is_dynamic","schedule_is_fixed","schedule_is_limited","schedule_is_open"]}},S=Object(k.a)(h,n,[],!1,null,null,null);"function"==typeof y&&y(S),S.options.__hasBlocks={script:!0,template:!0},S.options.__file="client/src/mod_perform/components/manage_activity/assignment/schedule/ScheduleToggles.vue";t.default=S.exports},"kKx+":function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/content/ContentAddElementButton")},kSbt:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ModalPresenter",{attrs:{open:e.modalOpen},on:{"request-close":e.modalClose}},[i("Modal",{attrs:{size:"normal","aria-labelledby":e.$id("report_open_close")}},[i("ModalContent",{attrs:{title:e.$str(e.isOpen?"participant_instances_close_title":"participant_instances_reopen_title","mod_perform"),"title-id":e.$id("report_open_close")},scopedSlots:e._u([{key:"buttons",fn:function(){return[i("ButtonGroup",[i("Button",{attrs:{styleclass:{primary:!0},text:e.$str(e.isOpen?"button_close":"button_reopen","mod_perform")},on:{click:function(t){return e.changeAvailability()}}}),e._v(" "),i("Button",{attrs:{text:e.$str("button_cancel","mod_perform")},on:{click:function(t){return e.modalClose()}}})],1)]},proxy:!0}])},[e.isOpen?[i("p",[e._v("\n          "+e._s(e.$str("participant_instances_close_message_line1","mod_perform"))+"\n        ")]),e._v(" "),i("p",[e._v("\n          "+e._s(e.$str("participant_instances_close_message_line2","mod_perform"))+"\n        ")])]:[i("p",[e._v("\n          "+e._s(e.$str("participant_instances_reopen_message_line1","mod_perform"))+"\n        ")]),e._v(" "),i("p",[e._v("\n          "+e._s(e.$str("participant_instances_reopen_message_line2","mod_perform"))+"\n        ")])]],2)],1)],1)};n._withStripped=!0;var a=i("vF5l"),s=i.n(a),r=i("BN8m"),o=i.n(r),d=i("tkAW"),l=i.n(d),c=i("u5iS"),m=i.n(c),u=i("Mnur"),_=i.n(u),p={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_manually_change_participant_instance"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_manually_change_participant_instance_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_manually_change_participant_instance"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant_instance"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}]}}]},v=i("vyVp"),f=i("E7bt"),g=i("KxNG"),h={components:{Button:s.a,ButtonGroup:o.a,Modal:l.a,ModalContent:m.a,ModalPresenter:_.a},props:{modalOpen:{type:Boolean},participantInstanceId:{type:String},isOpen:{type:Boolean},reportType:{type:String}},methods:{modalClose(){this.$emit("modal-close")},showErrorNotification(){Object(v.notify)({duration:g.NOTIFICATION_DURATION,message:this.$str("toast_error_generic_update","mod_perform"),type:"error"})},async changeAvailability(){try{let e=this.isOpen?g.INSTANCE_AVAILABILITY_STATUS_CLOSED:g.INSTANCE_AVAILABILITY_STATUS_OPEN;await this.$apollo.mutate({mutation:p,variables:{input:{participant_instance_id:this.participantInstanceId,availability:e}}}),this.$emit("modal-close"),Object(f.redirectWithPost)(window.location,{is_open:!this.isOpen,report_type:this.reportType})}catch(e){this.showErrorNotification()}}}},k=i("KHd+"),y=function(e){e.options.__langStrings={mod_perform:["button_cancel","button_close","button_reopen","participant_instances_close_message_line1","participant_instances_close_message_line2","participant_instances_close_title","participant_instances_reopen_title","participant_instances_reopen_message_line1","participant_instances_reopen_message_line2"]}},S=Object(k.a)(h,n,[],!1,null,null,null);"function"==typeof y&&y(S),S.options.__hasBlocks={script:!0,template:!0},S.options.__file="client/src/mod_perform/components/report/manage_participation/ParticipantOpenCloseActionModal.vue";t.default=S.exports},"kUb+":function(e,t){e.exports=tui.require("tui/components/card/ActionCard")},"kV+/":function(e,t){e.exports=tui.require("tui/components/toggle/ToggleButton")},kXIj:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",[e._t("trigger",null,{open:e.open,loading:e.loading}),e._v(" "),i("ConfirmationModal",{attrs:{open:e.confirmActivateModalOpen,title:e.$str("modal_activate_title","mod_perform"),"confirm-button-text":e.$str("activity_action_activate","mod_perform"),loading:e.loading},on:{confirm:e.activateActivity,cancel:e.closeConfirmActivationModal}},[i("p",[e._v("\n      "+e._s(e.$str("modal_activate_message","mod_perform"))+"\n    ")]),e._v(" "),i("p",{domProps:{innerHTML:e._s(e.$str("modal_activate_message_users","mod_perform",e.usersToAssignCount))}}),e._v(" "),i("p",[e._v("\n      "+e._s(e.$str("modal_activate_message_question","mod_perform"))+"\n    ")])]),e._v(" "),i("InformationModal",{attrs:{open:e.draftNotReadyModalOpen,title:e.$str("modal_can_not_activate_title","mod_perform")},on:{close:e.closeDraftNotReadyModal}},[i("p",[e._v(e._s(e.$str("modal_can_not_activate_message","mod_perform")))]),e._v(" "),i("ul",[i("li",[e._v(e._s(e.$str("activation_criteria_assignments","mod_perform")))]),e._v(" "),i("li",[e._v(e._s(e.$str("activation_criteria_elements","mod_perform")))]),e._v(" "),i("li",[e._v(e._s(e.$str("activation_criteria_relationships","mod_perform")))]),e._v(" "),i("li",[e._v(e._s(e.$str("activation_criteria_schedule","mod_perform")))])])])],2)};n._withStripped=!0;var a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_activate_activity"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_activate_activity_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_activate_activity"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activity"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"state_details"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"code"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_name"},arguments:[],directives:[]}]}}]}}]}}]}}]},s={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_activity_users_to_assign_count"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"activity_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_activity_users_to_assign_count"},arguments:[{kind:"Argument",name:{kind:"Name",value:"activity_id"},value:{kind:"Variable",name:{kind:"Name",value:"activity_id"}}}],directives:[]}]}}]},r=i("C+/B"),o=i.n(r),d=i("D31S"),l=i.n(d),c=i("KxNG"),m=i("vyVp"),u={components:{ConfirmationModal:o.a,InformationModal:l.a},props:{activity:{required:!0,type:Object}},data:()=>({confirmActivateModalOpen:!1,draftNotReadyModalOpen:!1,usersToAssignCount:0,loading:!1}),methods:{async open(){this.loading=!0;try{const{data:e}=await this.$apollo.query({query:s,variables:{activity_id:this.activity.id},fetchPolicy:"no-cache"});this.usersToAssignCount=e.mod_perform_activity_users_to_assign_count,null!=this.usersToAssignCount?this.openConfirmActivationModal():this.openDraftNotReadyModal()}catch(e){this.showErrorNotification(),this.$emit("refetch")}this.loading=!1},openConfirmActivationModal(){this.confirmActivateModalOpen=!0},closeConfirmActivationModal(){this.confirmActivateModalOpen=!1},openDraftNotReadyModal(){this.draftNotReadyModalOpen=!0},closeDraftNotReadyModal(){this.draftNotReadyModalOpen=!1},async activateActivity(){this.loading=!0;try{await this.$apollo.mutate({mutation:a,variables:{input:{activity_id:this.activity.id}}}),this.showSuccessNotification()}catch(e){this.showErrorNotification()}this.$emit("refetch"),this.closeConfirmActivationModal(),this.loading=!1},showSuccessNotification(){Object(m.notify)({duration:c.NOTIFICATION_DURATION,message:this.$str("toast_success_activity_activated","mod_perform",this.activity.name),type:"success"})},showErrorNotification(){Object(m.notify)({duration:c.NOTIFICATION_DURATION,message:this.$str("toast_error_generic_update","mod_perform",this.activity.name),type:"error"})}}},_=i("KHd+"),p=function(e){e.options.__langStrings={mod_perform:["activation_criteria_assignments","activation_criteria_elements","activation_criteria_relationships","activation_criteria_schedule","activity_action_activate","button_close","modal_activate_message","modal_activate_message_question","modal_activate_message_users","modal_activate_title","modal_can_not_activate_message","modal_can_not_activate_title","participation_reporting","toast_error_generic_update","toast_success_activity_activated"]}},v=Object(_.a)(u,n,[],!1,null,null,null);"function"==typeof p&&p(v),v.options.__hasBlocks={script:!0,template:!0},v.options.__file="client/src/mod_perform/components/manage_activity/ActivateActivityModal.vue";t.default=v.exports},lBzj:function(e,t){e.exports=tui.require("tui/components/icons/FlexIcon")},lL3B:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performManageActivity"},[i("a",{attrs:{href:e.goBackLink}},[e._v(e._s(e.$str("back_to_all_activities","mod_perform")))]),e._v(" "),i("Loader",{attrs:{loading:e.$apollo.loading}},[e.activity?i("Grid",{staticClass:"tui-performManageActivity__topBar",attrs:{"stack-at":768}},[i("GridItem",{attrs:{units:6}},[i("h2",{staticClass:"tui-performManageActivity__title"},[e._v(e._s(e.activity.name))])])],1):e._e(),e._v(" "),e.activity?i("ActivityStatusBanner",{attrs:{activity:e.activity},on:{refetch:e.refetch}}):e._e(),e._v(" "),e.activity?i("Tabs",{attrs:{selected:e.initialTabId}},e._l(e.tabs,(function(t,n){var a=t.component,s=t.name,r=t.id;return i("Tab",{key:n,attrs:{id:r,name:s}},[i(a,{tag:"component",attrs:{"activity-id":e.activityId,"activity-state":e.activityState},on:{"mutation-error":e.showMutationErrorNotification,"mutation-success":e.showMutationSuccessNotification},model:{value:e.activity,callback:function(t){e.activity=t},expression:"activity"}})],1)})),1):e._e()],1)],1)};n._withStripped=!0;var a=i("dUjM"),s=i.n(a),r=i("6Mwu"),o=i.n(r),d=i("58sl"),l=i.n(d),c=i("lBzj"),m=i.n(c),u=i("gNII"),_=i.n(u),p=i("90VL"),v=i.n(p),f=i("NAOU"),g=i.n(f),h=i("D9If"),k=i.n(h),y=i("AdjL"),S=i.n(y),b=i("1i2V"),N=i.n(b),F=i("txsu"),A=i.n(F),T={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_activity"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"activity_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_activity"},arguments:[{kind:"Argument",name:{kind:"Name",value:"activity_id"},value:{kind:"Variable",name:{kind:"Name",value:"activity_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_name"},arguments:[],directives:[]}]}},{kind:"Field",alias:{kind:"Name",value:"edit_name"},name:{kind:"Name",value:"name"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"description"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"edit_description"},name:{kind:"Name",value:"description"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"anonymous_responses"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"state_details"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"can_potentially_activate"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sections"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sort_order"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"section_relationships"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_view"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_answer"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"core_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sort_order"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"section_elements_summary"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"required_question_count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"optional_question_count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"other_element_count"},arguments:[],directives:[]}]}},{kind:"Field",alias:{kind:"Name",value:"raw_created_at"},name:{kind:"Name",value:"created_at"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"TIMESTAMP"}}],directives:[]},{kind:"Field",alias:{kind:"Name",value:"raw_updated_at"},name:{kind:"Name",value:"updated_at"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"TIMESTAMP"}}],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"settings"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"close_on_completion"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"multisection"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"manual_relationships"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"manual_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"idnumber"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"selector_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"idnumber"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}}]}}]},C=i("vyVp"),I=i("KxNG"),E={components:{ActivityStatusBanner:s.a,AssignmentsTab:o.a,ActivityContentTab:l.a,FlexIcon:m.a,Tab:N.a,Tabs:A.a,Loader:S.a,GeneralInfoTab:_.a,NotificationsTab:v.a,Grid:g.a,GridItem:k.a},props:{activityId:{required:!0,type:Number},goBackLink:{required:!0,type:String}},data(){const e=this.$id("genral-info-tab"),t=this.$id("content-tab"),i=this.$id("assignments-tab"),n=this.$id("notifications-tab");return{activity:null,initialTabId:t,tabs:[{id:e,component:"GeneralInfoTab",name:this.$str("manage_activities_tabs_general","mod_perform")},{id:t,component:"ActivityContentTab",name:this.$str("manage_activities_tabs_content","mod_perform")},{id:i,component:"AssignmentsTab",name:this.$str("manage_activities_tabs_assignment","mod_perform")},{id:n,component:"NotificationsTab",name:this.$str("manage_activities_tabs_notifications","mod_perform")}]}},apollo:{activity:{query:T,variables(){return{activity_id:this.activityId}},update:e=>e.mod_perform_activity}},computed:{activityState(){return this.activity?this.activity.state_details.name:null}},methods:{refetch(){this.$apollo.queries.activity.refetch()},showMutationSuccessNotification(){Object(C.notify)({duration:I.NOTIFICATION_DURATION,message:this.$str("toast_success_activity_update","mod_perform"),type:"success"})},showMutationErrorNotification(){Object(C.notify)({duration:I.NOTIFICATION_DURATION,message:this.$str("toast_error_generic_update","mod_perform"),type:"error"})}}},O=i("KHd+"),$=function(e){e.options.__langStrings={mod_perform:["back_to_all_activities","manage_activities_tabs_assignment","manage_activities_tabs_content","manage_activities_tabs_general","manage_activities_tabs_notifications","toast_error_generic_update","toast_success_activity_update"]}},D=Object(O.a)(E,n,[],!1,null,null,null);"function"==typeof $&&$(D),D.options.__hasBlocks={script:!0,template:!0},D.options.__file="client/src/mod_perform/pages/ManageActivity.vue";t.default=D.exports},lOlL:function(e,t){e.exports=tui.require("tui/components/toggle/ToggleSwitch")},lWyS:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/content/ActivityMultipleSectionToggle")},lgQG:function(e,t){e.exports=tui.require("tui/components/reform/FormScope")},llDw:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performElementResponse"},[e.error?i("div",[e._v(e._s(e.error))]):e._e(),e._v(" "),i("FormRow",{attrs:{label:e.$str("your_response","mod_perform")}},[e._t("content")],2)],1)};n._withStripped=!0;var a=i("i/kK"),s={components:{FormRow:i.n(a).a},props:{name:String,type:Object,error:String}},r=i("KHd+"),o=function(e){e.options.__langStrings={mod_perform:["your_response"]}},d=Object(r.a)(s,n,[],!1,null,null,null);"function"==typeof o&&o(d),d.options.__hasBlocks={script:!0,template:!0},d.options.__file="client/src/mod_perform/components/element/ElementParticipantForm.vue";t.default=d.exports},mawr:function(e,t){e.exports=tui.require("mod_perform/components/report/manage_participation/SectionOpenCloseActionModal")},mjJ1:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-activityNotificationsTriggersTable"},[i("Repeater",{staticClass:"tui-activityNotificationsTriggers",attrs:{rows:e.values,"min-rows":1,"delete-icon":!0,"allow-deleting-first-items":!0},on:{add:e.onAdd,remove:e.onRemove},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row,a=t.index;return[i("div",{staticClass:"tui-activityNotificationsTrigger"},[i("div",{staticClass:"tui-activityNotificationsTrigger__field"},[i("div",{staticClass:"tui-activityNotificationsTrigger__value"},[i("InputNumber",{staticClass:"tui-activityNotificationsTrigger__input",attrs:{value:n,min:1,max:365,placeholder:e.$str("trigger_set","mod_perform"),"aria-labelledby":e.$id(a),name:"trigger-"+e.classKey+"["+a+"]",autocomplete:"off"},on:{input:function(t){return e.onInput(a,t)}}})],1),e._v(" "),i("span",{staticClass:"tui-activityNotificationsTrigger__format",attrs:{id:e.$id(a)}},[e._v(e._s(e.label))])]),e._v(" "),i("FieldError",{staticClass:"tui-activityNotificationsTrigger__error",attrs:{error:e.errors[a]?e.$str(e.errors[a],"mod_perform"):""}})],1)]}}])})],1)};n._withStripped=!0;var a=i("VOnF"),s=i.n(a),r=i("iFIC"),o=i.n(r),d=i("nBTD"),l=i.n(d);function c(e){return e.length?e.map((t,i)=>(t*=1,isNaN(t)||t<1||t>365?"trigger_out_of_range":(e.indexOf(t)!==i||-1!==e.indexOf(t,i+1))&&"trigger_duplicates")):[]}var m={components:{InputNumber:s.a,Repeater:o.a,FieldError:l.a},props:{data:{type:Array,required:!0},classKey:{type:String,required:!0},label:String},data(){let e=this.data.slice();return{values:e.map(e=>1*e),errors:c(e)}},watch:{data(e){e=e.slice(),this.values=e.map(e=>1*e),this.update()}},methods:{onInput(e,t){this.values[e]=1*t,this.update()},async onAdd(){this.values.push(""),this.errors.push(!1),await this.$nextTick();let e=this.$el.querySelectorAll(".tui-activityNotificationsTrigger__input");e.length&&e[e.length-1].focus()},onRemove(e,t){this.values.length>0&&(this.values.splice(t,1),this.update())},update(){this.errors=c(this.values),this.errors.filter(e=>!1!==e).length||this.$emit("input",this.values.slice())}}},u=i("KHd+"),_=function(e){e.options.__langStrings={mod_perform:["trigger_duplicates","trigger_out_of_range","trigger_set"]}},p=Object(u.a)(m,n,[],!1,null,null,null);"function"==typeof _&&_(p),p.options.__hasBlocks={script:!0,template:!0},p.options.__file="client/src/mod_perform/components/manage_activity/notification/TriggersTable.vue";t.default=p.exports},nBTD:function(e,t){e.exports=tui.require("tui/components/form/FieldError")},nEm4:function(e,t){e.exports=tui.require("tui/components/form/Form")},nXMa:function(e,t){e.exports=tui.require("tui/components/buttons/Cancel")},"nu/z":function(e,t){e.exports=tui.require("mod_perform/components/user_activities/ActivityContent")},o01z:function(e,t){e.exports=tui.require("tui/components/sidepanel/SidePanelNav")},oMuj:function(e,t){e.exports=tui.require("tui/components/form/InputText")},pD8U:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/content/EditSectionContentModal")},q1ca:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("FormScope",{attrs:{validate:e.fixedDateRangeValidator,path:e.path}},[i("div",{class:{"tui-performAssignmentScheduleFixedDateSelector":!0,"tui-performAssignmentScheduleFixedDateSelector--has-range":e.hasRange}},[i("div",{staticClass:"tui-performAssignmentScheduleFixedDateSelector__input"},[i("Label",{staticClass:"tui-performAssignmentScheduleFixedDateSelector__label",attrs:{for:e.$id("fixed-date-from"),label:this.$str("fixed_date_selector_from","mod_perform"),hidden:!e.hasRange}}),e._v(" "),i("FormDateSelector",{attrs:{id:e.$id("fixed-date-from"),name:"from",disabled:e.disabled,validations:function(e){return[e.required()]},type:"date","has-timezone":""}})],1),e._v(" "),e.hasRange?[i("div",{staticClass:"tui-performAssignmentScheduleFixedDateSelector__input"},[i("Label",{staticClass:"tui-performAssignmentScheduleFixedDateSelector__label",attrs:{for:e.$id("fixed-date-to"),label:this.$str("fixed_date_selector_to","mod_perform")}}),e._v(" "),i("FormDateSelector",{attrs:{id:e.$id("fixed-date-to"),name:"to",disabled:e.disabled,validations:function(e){return[e.required()]},type:"date"}})],1)]:e._e()],2)])};n._withStripped=!0;var a=i("PRN7"),s=i.n(a),r=i("sVqh"),o=i("WBvU"),d={components:{FormDateSelector:o.FormDateSelector,FormScope:o.FormScope,Label:s.a},props:{initialStartDate:{type:String,required:!1},path:{type:String,required:!0},disabled:{type:Boolean,default:!1},hasRange:{type:Boolean,default:!1}},methods:{fixedDateRangeValidator(e){if(this.disabled||!this.hasRange)return{};const t={};return Object(r.isIsoAfter)(e.to.iso,e.from.iso)||(t.to=this.$str("fixed_date_selector_error_range","mod_perform")),t}}},l=i("KHd+"),c=function(e){e.options.__langStrings={mod_perform:["fixed_date_selector_date","fixed_date_selector_error_range","fixed_date_selector_error_required","fixed_date_selector_to","fixed_date_selector_from"]}},m=Object(l.a)(d,n,[],!1,null,null,null);"function"==typeof c&&c(m),m.options.__hasBlocks={script:!0,template:!0},m.options.__file="client/src/mod_perform/components/manage_activity/assignment/schedule/FixedScheduleRangeSelector.vue";t.default=m.exports},qHhm:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Loader",{attrs:{loading:e.$apollo.loading}},[i("div",{staticClass:"tui-participantContent"},[i("ConfirmationModal",{attrs:{open:e.modalOpen,"confirm-button-text":e.$str("submit","moodle"),title:e.$str("user_activities_submit_confirmation_title","mod_perform")},on:{confirm:e.confirmModal,cancel:e.cancelModal}},[i("p",[e._v("\n        "+e._s(e.$str("user_activities_submit_confirmation_message","mod_perform"))+"\n      ")]),e._v(" "),e.activity.settings.close_on_completion?i("p",[e._v("\n        "+e._s(e.$str("user_activities_close_on_completion_submit_confirmation_message","mod_perform"))+"\n      ")]):e._e()]),e._v(" "),i("div",{staticClass:"tui-participantContent__user"},[i("ParticipantUserHeader",{staticClass:"tui-participantContent__user-info",attrs:{"user-name":e.subjectUser.fullname,"profile-picture":e.subjectUser.profileimageurlsmall,size:"small"}}),e._v(" "),i("div",{staticClass:"tui-participantContent__user-relationship"},[e._v("\n        "+e._s(e.$str("user_activities_your_relationship_to_user","mod_perform"))+"\n        "),i("h4",{staticClass:"tui-participantContent__user-relationshipValue"},[e._v("\n          "+e._s(e.relationshipToUser)+"\n        ")])])],1),e._v(" "),i("h2",{staticClass:"tui-participantContent__header",attrs:{id:"tui-participantContentHeader"}},[e._v("\n      "+e._s(e.activity.name)+"\n    ")]),e._v(" "),i("Grid",{class:e.showSidePanel?"tui-participantContent__layout":""},[i("GridItem",{directives:[{name:"show",rawName:"v-show",value:e.showSidePanel,expression:"showSidePanel"}],staticClass:"tui-participantContent__sidePanel",attrs:{units:2}},[i("SidePanel",{attrs:{"initially-open":!0,"limit-height":!1,"show-button-control":!1,sticky:!1}},[i("SidePanelNav",{attrs:{"aria-label":!1},on:{change:function(t){return e.navChange(t)}},model:{value:e.selectedParticipantSectionId,callback:function(t){e.selectedParticipantSectionId=t},expression:"selectedParticipantSectionId"}},[i("SidePanelNavGroup",e._l(e.participantSections,(function(e){return i("SidePanelNavButtonItem",{key:e.id,attrs:{id:e.id,text:e.section.display_title}})})),1)],1)],1)],1),e._v(" "),i("GridItem",{attrs:{units:e.showSidePanel?10:12}},[e.initialValues?i("Uniform",{key:e.activeParticipantSection.id,attrs:{"initial-values":e.initialValues},on:{submit:e.openModal,change:e.handleChange},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.getSubmitting;return[i("div",{staticClass:"tui-participantContent__section"},[i("div",{staticClass:"tui-participantContent__sectionHeading"},[e.activity.settings.multisection?i("h3",{staticClass:"tui-participantContent__sectionHeading-title"},[e._v("\n                "+e._s(e.section.display_title)+"\n              ")]):e._e(),e._v(" "),i("div",{staticClass:"tui-participantContent__sectionHeadingOtherResponsesBar"},[i("ResponsesAreVisibleToDescription",{staticClass:"tui-participantContent__sectionHeadingOtherResponsesDescription",attrs:{"current-user-is-subject":e.currentUserIsSubject,"visible-to-relationships":e.responsesAreVisibleTo,"anonymous-responses":e.activity.anonymous_responses}}),e._v(" "),i("div",{staticClass:"tui-participantContent__sectionHeading-other-response-switch"},[e.hasOtherResponse?i("ToggleSwitch",{attrs:{text:e.$str("user_activities_other_response_show","mod_perform")},model:{value:e.showOtherResponse,callback:function(t){e.showOtherResponse=t},expression:"showOtherResponse"}}):e._e()],1)],1)]),e._v(" "),i("div",{staticClass:"tui-participantContent__section-required-container"},[i("span",{staticClass:"tui-participantContent__section-response-required",domProps:{textContent:e._s("*")}}),e._v("\n              "+e._s(e.$str("section_element_response_required","mod_perform"))+"\n            ")]),e._v(" "),e._l(e.sectionElements,(function(t){return i("div",{key:t.id,staticClass:"tui-participantContent__sectionItem"},[t.element.title?i("h3",{staticClass:"tui-participantContent__sectionItem-contentHeader",attrs:{id:e.$id("title")}},[e._v("\n                "+e._s(t.element.title)+"\n              ")]):e._e(),e._v(" "),t.element.is_required?i("span",{staticClass:"tui-participantContent__section-response-required"},[e._v("\n                *\n              ")]):e._e(),e._v(" "),!t.element.is_required&&t.is_respondable?i("span",{staticClass:"tui-participantContent__section-response-optional"},[e._v("\n                ("+e._s(e.$str("section_element_response_optional","mod_perform"))+")\n              ")]):e._e(),e._v(" "),i("div",{staticClass:"tui-participantContent__sectionItem-content"},[t.is_respondable?i("ElementParticipantForm",{scopedSlots:e._u([{key:"content",fn:function(){return[i(t.component,e._b({tag:"component"},"component",e.loadUserSectionElementProps(t),!1))]},proxy:!0}],null,!0)}):i("div",{staticClass:"tui-participantContent__staticElement"},[i(t.component,e._b({tag:"component"},"component",e.loadUserSectionElementProps(t),!1))],1),e._v(" "),i("OtherParticipantResponses",{directives:[{name:"show",rawName:"v-show",value:e.showOtherResponse,expression:"showOtherResponse"}],attrs:{"section-element":t,"anonymous-responses":e.activity.anonymous_responses}})],1)])}))],2),e._v(" "),e.activeSectionIsClosed?e._e():i("ButtonGroup",{staticClass:"tui-participantContent__buttons"},[i("ButtonSubmit",{attrs:{submitting:n()}}),e._v(" "),i("ButtonCancel",{on:{click:e.goBackToListCancel}})],1),e._v(" "),i("div",{staticClass:"tui-participantContent__navigation"},[e.activeSectionIsClosed?i("Grid",[i("GridItem",{attrs:{units:6}},[e.hasPreviousSection?i("Button",{attrs:{text:e.$str("previous_section","mod_perform")},on:{click:e.loadPreviousParticipantSection}}):e._e()],1),e._v(" "),i("GridItem",{attrs:{units:6}},[i("div",{staticClass:"tui-participantContent__navigation-buttons"},[e.hasNextSection?i("Button",{attrs:{styleclass:{primary:"true"},text:e.$str("next_section","mod_perform")},on:{click:e.loadNextParticipantSection}}):e._e(),e._v(" "),i("Button",{attrs:{text:e.$str("button_close","mod_perform")},on:{click:e.goBackToListCancel}})],1)])],1):e._e()],1)]}}],null,!1,3432448290)}):e._e()],1)],1)],1)])};n._withStripped=!0;var a=i("TXEh"),s=i("KxNG"),r=i("E7bt"),o=i("vyVp"),d=i("vF5l"),l=i.n(d),c=i("nXMa"),m=i.n(c),u=i("BN8m"),_=i.n(u),p=i("KRvX"),v=i.n(p),f=i("hjaT"),g=i.n(f),h=i("IqB1"),k=i.n(h),y=i("C+/B"),S=i.n(y),b=i("Aka+"),N=i.n(b),F=i("NAOU"),A=i.n(F),T=i("D9If"),C=i.n(T),I=i("AdjL"),E=i.n(I),O=i("zkRv"),$=i.n(O),D=i("s0yi"),x=i.n(D),w=i("JGbd"),R=i.n(w),j=i("BaY1"),P=i.n(j),q=i("o01z"),B=i.n(q),M=i("rjlk"),V=i.n(M),U=i("Oj5a"),L=i.n(U),H=i("lOlL"),G=i.n(H),K=i("WBvU"),z={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_participant_section"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"participant_instance_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"participant_section_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_participant_section"},arguments:[{kind:"Argument",name:{kind:"Name",value:"participant_instance_id"},value:{kind:"Variable",name:{kind:"Name",value:"participant_instance_id"}}},{kind:"Argument",name:{kind:"Name",value:"participant_section_id"},value:{kind:"Variable",name:{kind:"Name",value:"participant_section_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"progress_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"availability_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"section"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"display_title"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"answerable_participant_instances"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"core_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"idnumber"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"section_element_responses"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"section_element_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"element"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"element_plugin"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant_form_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"participant_response_component"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"data"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_required"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_respondable"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"sort_order"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"response_data"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"validation_errors"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"error_code"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"error_message"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"other_responder_groups"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"relationship_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"responses"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant_instance"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurlsmall"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"response_data"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"visible_to"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"participant_instance"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant_sections"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"progress_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"availability_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"section"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sort_order"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_title"},arguments:[],directives:[]}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"responses_are_visible_to"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name_plural"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"idnumber"},arguments:[],directives:[]}]}}]}}]}}]},W={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_update_section_responses"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_update_section_responses_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_update_section_responses"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant_section"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"progress_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"availability_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"section"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"display_title"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"section_element_responses"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"section_element_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"element"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"element_plugin"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant_form_component"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"data"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_respondable"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"sort_order"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"response_data"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"validation_errors"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"error_code"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"error_message"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"other_responder_groups"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"relationship_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"responses"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant_instance"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurlsmall"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"response_data"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"visible_to"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]}]}}]}}]}}]}}]}}]}}]},J={components:{Button:l.a,ButtonCancel:m.a,ButtonGroup:_.a,ButtonSubmit:v.a,Checkbox:g.a,Collapsible:k.a,ConfirmationModal:S.a,ElementParticipantForm:N.a,Grid:A.a,GridItem:C.a,Loader:E.a,OtherParticipantResponses:$.a,ParticipantUserHeader:x.a,ResponsesAreVisibleToDescription:R.a,SidePanel:P.a,SidePanelNav:B.a,SidePanelNavButtonItem:V.a,SidePanelNavGroup:L.a,ToggleSwitch:G.a,Uniform:K.Uniform},props:{activity:{required:!0,type:Object},currentUserId:{required:!0,type:Number},participantInstanceId:{type:Number},participantSectionId:{type:Number},subjectUser:{required:!0,type:Object,validator:e=>["id","profileimageurlsmall","fullname"].every(Object.prototype.hasOwnProperty.bind(e))}},data(){return{answerableParticipantInstances:null,answeringAsParticipantId:this.participantInstanceId,activeParticipantSection:{},completionSaveSuccess:!1,errors:null,hasOtherResponse:!1,hasUnsavedChanges:!1,initialValues:null,isSaving:!1,section:{title:"",section_elements:[]},sectionElements:[],showOtherResponse:!1,modalOpen:!1,formValues:{},participantSections:[],hasChanges:!1,responsesAreVisibleTo:[],selectedParticipantSectionId:this.participantSectionId}},apollo:{section:{query:z,variables(){return{participant_instance_id:this.answeringAsParticipantId,participant_section_id:this.participantSectionId}},update:e=>e.mod_perform_participant_section.section,result({data:e}){this.answerableParticipantInstances=e.mod_perform_participant_section.answerable_participant_instances,this.activeParticipantSection=e.mod_perform_participant_section,this.participantSections=e.mod_perform_participant_section.participant_instance.participant_sections,this.responsesAreVisibleTo=e.mod_perform_participant_section.responses_are_visible_to,this.formValues={},this.initialValues={sectionElements:{}},this.sectionElements=e.mod_perform_participant_section.section_element_responses.map(e=>{let t=this.activeSectionIsClosed?e.element.element_plugin.participant_response_component:e.element.element_plugin.participant_form_component;return{id:e.section_element_id,clientId:Object(a.uniqueId)(),component:tui.asyncComponent(t),element:{type:e.element.element_plugin,title:e.element.title,identifier:e.element.identifier,data:JSON.parse(e.element.data),is_required:e.element.is_required,responseData:null},sort_order:e.sort_order,is_respondable:e.element.is_respondable,response_data:e.response_data,other_responder_groups:e.other_responder_groups}}),e.mod_perform_participant_section.section_element_responses.filter(e=>e.element.is_respondable).forEach(e=>{this.initialValues.sectionElements[e.section_element_id]=JSON.parse(e.response_data),e.other_responder_groups.length>0?this.hasOtherResponse=!0:this.hasOtherResponse=!1,e.other_responder_groups.forEach(t=>{t.responses.length>0&&e.response_data&&(this.showOtherResponse=!0)})})}}},computed:{relationshipToUser(){return this.currentUserIsSubject?this.$str("relation_to_subject_self","mod_perform"):this.answeringAs?this.answeringAs.core_relationship.name:null},respondableSectionElements(){return this.sectionElements.filter(e=>e.is_respondable)},currentUserIsSubject(){return null!=this.answeringAs&&this.answeringAs.core_relationship.idnumber===s.RELATIONSHIP_SUBJECT},activeSectionIsClosed(){return this.activeParticipantSection&&"CLOSED"===this.activeParticipantSection.availability_status},hasNextSection(){return null!==this.getNextParticipantSection(this.activeParticipantSection.id)},hasPreviousSection(){return null!==this.getPreviousParticipantSection(this.activeParticipantSection.id)},answeringAs:{get(){return null===this.answerableParticipantInstances?null:this.answerableParticipantInstances.find(e=>Number(e.id)===Number(this.answeringAsParticipantId))}},showSidePanel(){return this.activity.settings.multisection}},mounted(){window.addEventListener("beforeunload",this.unloadHandler)},methods:{loadUserSectionElementProps(e){let t={element:e.element};return this.activeSectionIsClosed?(t.data=JSON.parse(e.response_data),t.class="tui-participantContent__readonly"):(t.path=["sectionElements",e.id],t.error=this.errors&&this.errors[e.id]),t},showErrorNotification(){Object(o.notify)({duration:s.NOTIFICATION_DURATION,message:this.$str("toast_error_save_response","mod_perform"),type:"error"})},showSuccessNotification(){let e=this.activity.settings.close_on_completion?"toast_success_save_close_on_completion_response":"toast_success_save_response";Object(o.notify)({duration:s.NOTIFICATION_DURATION,message:this.$str(e,"mod_perform"),type:"success"})},openModal(e){this.formValues=e,this.modalOpen=!0},confirmModal(){this.submit(this.formValues),this.modalOpen=!1,this.hasUnsavedChanges=!1},cancelModal(){this.modalOpen=!1},async submit(e){this.errors&&(this.errors=null),this.sectionElements.forEach(t=>{t.element.responseData=e.sectionElements[t.id]}),this.isSaving=!0;try{const e=(await this.save()).mod_perform_update_section_responses.participant_section;this.errors=e.section_element_responses.filter(e=>e.validation_errors).reduce((e,t)=>(t.validation_errors.forEach(i=>{e[t.section_element.id]=i.error_message}),e),null);let t=this.getNextParticipantSection(e.id);this.errors||(t?(this.showSuccessNotification(),await this.loadParticipantSection(t),this.selectedParticipantSectionId=t):this.goBackToListCompletionSuccess())}catch(e){this.showErrorNotification()}this.isSaving=!1},async save(){const e=this.respondableSectionElements.map(e=>({section_element_id:e.id,response_data:JSON.stringify(e.element.responseData)})),{data:t}=await this.$apollo.mutate({mutation:W,variables:{input:{participant_section_id:this.activeParticipantSection.id,update:e}},refetchAll:!1});return t},loadNextParticipantSection(){let e=this.getNextParticipantSection(this.activeParticipantSection.id);e&&this.loadParticipantSection(e)},loadPreviousParticipantSection(){let e=this.getPreviousParticipantSection(this.activeParticipantSection.id);e&&this.loadParticipantSection(e)},async loadParticipantSection(e){await this.$apollo.queries.section.refetch({participant_section_id:e})},getNextParticipantSection(e){let t=this.getIndexOfParticipantSection(e)+1;return t<this.participantSections.length?this.participantSections[t].id:null},getPreviousParticipantSection(e){let t=this.getIndexOfParticipantSection(e)-1;return t>=0?this.participantSections[t].id:null},getIndexOfParticipantSection(e){return this.participantSections.findIndex((function(t){return t.id===e}),{participantSectionId:e})},goBackToListCompletionSuccess(){const e=this.$url("/mod/perform/activity/index.php");Object(r.redirectWithPost)(e,{show_about_others_tab:!this.currentUserIsSubject,completion_save_success:!0,closed_on_completion:this.activity.settings.close_on_completion})},goBackToListCancel(){const e=this.$url("/mod/perform/activity/index.php");Object(r.redirectWithPost)(e,{show_about_others_tab:!this.currentUserIsSubject,completion_save_success:!1})},handleChange(e){for(let t in this.initialValues.sectionElements){let i=e.sectionElements[t],n=JSON.stringify(this.initialValues.sectionElements[t]);if((null===i||0===Object.values(i)[0].length)&&(i=null),i=JSON.stringify(i),n!==i){this.hasUnsavedChanges=!0;break}this.hasUnsavedChanges=!1}},navChange(e){if(this.hasUnsavedChanges){let e=this.$str("unsaved_changes_warning","mod_perform");if(!window.confirm(e))return void(this.selectedParticipantSectionId=this.activeParticipantSection.id);this.hasUnsavedChanges=!1}this.updateUrlParam(e.id),this.loadParticipantSection(e.id)},updateUrlParam(e){let t=new URL(window.location.href),i=t.searchParams;i.delete("participant_instance_id"),i.set("participant_section_id",e),t.search=i.toString();let n=t.toString();window.history.replaceState({},"",n)},unloadHandler(e){if(!this.hasUnsavedChanges)return;const t=this.$str("unsaved_changes_warning","mod_perform");return e.preventDefault(),e.returnValue=t,t}}},Y=i("KHd+"),X=function(e){e.options.__langStrings={mod_perform:["button_close","next_section","previous_section","relation_to_subject_self","section_element_response_optional","section_element_response_required","toast_error_save_response","toast_success_save_close_on_completion_response","toast_success_save_response","unsaved_changes_warning","user_activities_close_on_completion_submit_confirmation_message","user_activities_other_response_show","user_activities_submit_confirmation_message","user_activities_submit_confirmation_title","user_activities_your_relationship_to_user"],moodle:["submit"]}},Q=Object(Y.a)(J,n,[],!1,null,null,null);"function"==typeof X&&X(Q),Q.options.__hasBlocks={script:!0,template:!0},Q.options.__file="client/src/mod_perform/components/user_activities/ActivityContent.vue";t.default=Q.exports},qrY1:function(e,t,i){var n={"./constants":"Y6+c","./constants.js":"Y6+c","./redirect":"9hJx","./redirect.js":"9hJx"};function a(e){var t=s(e);return i(t)}function s(e){if(!i.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=s,e.exports=a,a.id="qrY1"},rjlk:function(e,t){e.exports=tui.require("tui/components/sidepanel/SidePanelNavButtonItem")},rsf9:function(e,t){e.exports=tui.require("tui/components/datatable/ExpandCell")},ruKP:function(e,t){e.exports=tui.require("tui/components/form/Textarea")},s0yi:function(e,t){e.exports=tui.require("mod_perform/components/user_activities/participant/ParticipantUserHeader")},s6s7:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Form",[i("FormRow",{attrs:{label:e.$str("general_info_label_activity_title","mod_perform"),required:""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.id;return[i("InputText",{attrs:{id:n,maxlength:e.ACTIVITY_NAME_MAX_LENGTH},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})]}}])}),e._v(" "),i("FormRow",{attrs:{label:e.$str("general_info_label_activity_description","mod_perform")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.id;return[i("Textarea",{attrs:{id:n},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})]}}])}),e._v(" "),i("FormRow",{attrs:{label:e.$str("general_info_label_activity_type","mod_perform"),required:!0},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.id;return[i("div",[i("Select",{attrs:{id:n,"aria-labelledby":n,"aria-describedby":e.$id("aria-describedby"),options:e.activityTypes},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}}),e._v(" "),i("FormRowDetails",{attrs:{id:e.$id("aria-describedby")}},[e._v("\n        "+e._s(e.$str("activity_type_help_text","mod_perform"))+"\n      ")])],1)]}}])}),e._v(" "),i("FormRow",[i("ButtonGroup",[i("Button",{attrs:{styleclass:{primary:!0},text:e.$str("get_started","mod_perform"),disabled:e.isSaving||e.hasNoTitle||e.hasNoType,type:"submit"},on:{click:function(t){return t.preventDefault(),e.trySave(t)}}})],1)],1)],1)};n._withStripped=!0;var a=i("vF5l"),s=i.n(a),r=i("BN8m"),o=i.n(r),d=i("nEm4"),l=i.n(d),c=i("i/kK"),m=i.n(c),u=i("vGF0"),_=i.n(u),p=i("oMuj"),v=i.n(p),f=i("fw38"),g=i.n(f),h=i("ruKP"),k=i.n(h),y=i("KxNG"),S=i("+kGl"),b={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_create_activity"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"description"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"status"}},type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_activity_state_enums"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"type"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_create_activity"},arguments:[{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"description"},value:{kind:"Variable",name:{kind:"Name",value:"description"}}},{kind:"Argument",name:{kind:"Name",value:"status"},value:{kind:"Variable",name:{kind:"Name",value:"status"}}},{kind:"Argument",name:{kind:"Name",value:"type"},value:{kind:"Variable",name:{kind:"Name",value:"type"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activity"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"description"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_name"},arguments:[],directives:[]}]}}]}}]}}]}}]},N={components:{Button:s.a,ButtonGroup:o.a,Form:l.a,FormRow:m.a,FormRowDetails:_.a,InputText:v.a,Select:g.a,Textarea:k.a},data(){return{form:{name:"",description:"",type:0},activityTypes:[{id:0,label:this.$str("general_info_select_activity_type","mod_perform")}],isSaving:!1,mutationError:null}},computed:{hasNoTitle(){return!this.form.name||0===this.form.name.trim().length},hasNoType(){return 0===this.form.type}},created(){this.ACTIVITY_NAME_MAX_LENGTH=y.ACTIVITY_NAME_MAX_LENGTH},apollo:{activityTypes:{query:S.a,variables:()=>[],update({mod_perform_activity_types:e}){const t=e.map(e=>({id:e.id,label:e.display_name})).sort((e,t)=>e.label.localeCompare(t.label));return t.unshift({id:0,label:this.$str("general_info_select_activity_type","mod_perform")}),t}}},methods:{async trySave(){this.isSaving=!0;try{const e=await this.save();this.$emit("mutation-success",e)}catch(e){this.$emit("mutation-error",e),this.isSaving=!1}},async save(){const{data:e}=await this.$apollo.mutate({mutation:b,variables:this.form,refetchAll:!1});return e.mod_perform_create_activity.activity}}},F=i("KHd+"),A=function(e){e.options.__langStrings={mod_perform:["activity_type_help_text","general_info_label_activity_description","general_info_label_activity_title","general_info_label_activity_type","general_info_select_activity_type","get_started"]}},T=Object(F.a)(N,n,[],!1,null,null,null);"function"==typeof A&&A(T),T.options.__hasBlocks={script:!0,template:!0},T.options.__file="client/src/mod_perform/components/manage_activity/CreateActivityForm.vue";t.default=T.exports},sVqh:function(e,t){e.exports=tui.require("tui/date")},sicn:function(e,t,i){"use strict";t.a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_activities"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_activities"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"display_name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"updated_at"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_view_participation_reporting"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_potentially_activate"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_activate"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_manage"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_clone"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"state_details"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"display_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}}]}},tKZN:function(e,t){e.exports=tui.require("mod_perform/components/user_activities/list/Sections")},tNJr:function(e,t){e.exports=tui.require("tui/components/buttons/MoreIcon")},tW8v:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement;return(e._self._c||t)("TagList",{attrs:{tags:e.value,items:e.userList},on:{select:e.select,remove:e.remove,filter:function(t){e.filter=t}},scopedSlots:e._u([{key:"item",fn:function(t){var i=t.item;return[e._v(e._s(i.text))]}}])})};n._withStripped=!0;var a=i("Aros"),s={components:{TagList:i.n(a).a},props:{value:{type:Array,default:()=>[]},users:{required:!0,type:Array}},data:()=>({filter:""}),computed:{userList(){let e=this.users.filter(e=>!this.value.some(t=>t.id===e.id));return this.filter&&(e=e.filter(e=>e.fullname.toLowerCase().includes(this.filter.toLowerCase()))),e.map(e=>({id:e.id,text:e.fullname}))}},methods:{select(e){this.$emit("input",this.value.concat([e]))},remove(e){this.$emit("input",this.value.filter(t=>t.id!==e.id))}}},r=i("KHd+"),o=Object(r.a)(s,n,[],!1,null,null,null);o.options.__hasBlocks={script:!0,template:!0},o.options.__file="client/src/mod_perform/components/user_activities/participant_selector/UserSelector.vue";t.default=o.exports},tXLW:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/content/ParticipantsPopover")},tkAW:function(e,t){e.exports=tui.require("tui/components/modal/Modal")},ttA2:function(e,t){e.exports=tui.require("tui/components/icons/common/Settings")},txsu:function(e,t){e.exports=tui.require("tui/components/tabs/Tabs")},u5iS:function(e,t){e.exports=tui.require("tui/components/modal/ModalContent")},uFy6:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("FormScope",{attrs:{validate:e.relativeDateValidator,path:e.path}},[i("div",{staticClass:"tui-performAssignmentScheduleRelativeDateSelector"},[i("div",{staticClass:"tui-performAssignmentScheduleRelativeDateSelector__count"},[i("Label",{attrs:{for:e.$id("relative-date-from-count"),label:e.$str("relative_date_selector_count","mod_perform"),hidden:""}}),e._v(" "),i("FormNumber",{attrs:{id:e.$id("relative-date-from-count"),name:"from_count",disabled:e.disabled,validations:e.countValidator,min:0}})],1),e._v(" "),i("div",{staticClass:"tui-performAssignmentScheduleRelativeDateSelector__unit"},[i("Label",{attrs:{for:e.$id("relative-date-from-unit"),label:e.$str("relative_date_selector_unit","mod_perform"),hidden:""}}),e._v(" "),i("FormSelect",{attrs:{id:e.$id("relative-date-from-unit"),name:"from_unit",options:e.unitOptions,disabled:e.disabled}})],1),e._v(" "),e.hasDirection?i("div",{staticClass:"tui-performAssignmentScheduleRelativeDateSelector__direction"},[i("Label",{attrs:{for:e.$id("relative-date-from-direction"),label:e.$str("relative_date_selector_direction","mod_perform"),hidden:""}}),e._v(" "),i("FormSelect",{attrs:{id:e.$id("relative-date-from-direction"),name:"from_direction",options:e.directionOptions,disabled:e.disabled}})],1):e._e(),e._v(" "),e.hasRange?[i("span",[e._v(e._s(e.untilText))]),e._v(" "),i("div",{staticClass:"tui-performAssignmentScheduleRelativeDateSelector__count"},[i("Label",{attrs:{for:e.$id("relative-date-to-count"),label:e.$str("relative_date_selector_count","mod_perform"),hidden:""}}),e._v(" "),i("FormNumber",{attrs:{id:e.$id("relative-date-to-count"),name:"to_count",disabled:e.disabled,validations:e.countValidator,min:0}})],1),e._v(" "),i("div",{staticClass:"tui-performAssignmentScheduleRelativeDateSelector__unit"},[i("Label",{attrs:{for:e.$id("relative-date-to-unit"),label:e.$str("relative_date_selector_unit","mod_perform"),hidden:""}}),e._v(" "),i("FormSelect",{attrs:{id:e.$id("relative-date-to-unit"),name:"to_unit",options:e.unitOptions,disabled:e.disabled}})],1),e._v(" "),e.hasDirection?i("div",{staticClass:"tui-performAssignmentScheduleRelativeDateSelector__direction"},[i("Label",{attrs:{for:e.$id("relative-date-to-direction"),label:e.$str("relative_date_selector_direction","mod_perform"),hidden:""}}),e._v(" "),i("FormSelect",{attrs:{id:e.$id("relative-date-to-direction"),name:"to_direction",options:e.directionOptions,disabled:e.disabled}})],1):e._e()]:e._e(),e._v(" "),i("div",{staticClass:"tui-performAssignmentScheduleRelativeDateSelector__reference-date"},[i("Label",{attrs:{for:e.$id("relative-date-reference-date"),label:e.$str("relative_date_selector_reference_date","mod_perform"),hidden:""}}),e._v(" "),e.dynamicDateSources?i("FormSelect",{attrs:{id:e.$id("relative-date-reference-date"),name:"dynamic_source",options:e.dynamicSourcesForSelect,disabled:e.disabled}}):e._e(),e._v(" "),e.showCustomDynamicSetting?i("div",{staticClass:"tui-performAssignmentScheduleRelativeDateSelector__reference-date-customSettings"},[i(e.dynamicSettingComponentFor(),{tag:"component",attrs:{data:e.dynamicDateSettingComponent.data,"config-data":e.dynamicDateSettingComponent.configData}})],1):e._e()],1)],2)])};n._withStripped=!0;var a=i("PRN7"),s=i.n(a),r=i("WBvU"),o=i("KxNG"),d={components:{FormSelect:r.FormSelect,FormNumber:r.FormNumber,FormScope:r.FormScope,Label:s.a},props:{path:{type:[String,Array],required:!0},disabled:{type:Boolean,default:!1},hasDirection:{type:Boolean,default:!1},hasRange:{type:Boolean,default:!1},untilText:{type:String,default(){return this.$str("relative_date_selector_until","mod_perform")}},dynamicDateSources:{type:Array,required:!1},dynamicDateSettingComponent:{type:Object}},computed:{unitOptions(){return[{label:this.$str("relative_date_selector_days","mod_perform"),id:o.RELATIVE_DATE_UNIT_DAY},{label:this.$str("relative_date_selector_weeks","mod_perform"),id:o.RELATIVE_DATE_UNIT_WEEK}]},directionOptions(){return[{label:this.$str("relative_date_selector_before","mod_perform"),id:o.RELATIVE_DATE_DIRECTION_BEFORE},{label:this.$str("relative_date_selector_after","mod_perform"),id:o.RELATIVE_DATE_DIRECTION_AFTER}]},dynamicSourcesForSelect(){return this.dynamicDateSources?this.dynamicDateSources.map(e=>({label:e.display_name,id:`${e.resolver_class_name}--${e.option_key}`})):[]},showCustomDynamicSetting(){return!(!this.dynamicDateSettingComponent||!this.dynamicDateSettingComponent.name)}},methods:{countValidator(e){return this.disabled?[]:[e.min(0),e.integer(),e.required()]},relativeDateValidator(e){if(!this.hasRange||!this.hasDirection||this.disabled)return{};let t=Number(e.from_count);const i=e.from_direction;let n=Number(e.to_count);const a=e.to_direction;e.from_unit==o.RELATIVE_DATE_UNIT_WEEK&&(t*=7),e.to_unit==o.RELATIVE_DATE_UNIT_WEEK&&(n*=7);const s=this.$str("relative_date_selector_error_range","mod_perform");return i===o.RELATIVE_DATE_DIRECTION_AFTER&&a===o.RELATIVE_DATE_DIRECTION_BEFORE?{to_direction:s}:i===o.RELATIVE_DATE_DIRECTION_AFTER&&a===o.RELATIVE_DATE_DIRECTION_AFTER&&t>n||i===o.RELATIVE_DATE_DIRECTION_BEFORE&&a===o.RELATIVE_DATE_DIRECTION_BEFORE&&t<n?{to_count:s}:{}},dynamicSettingComponentFor(){return tui.asyncComponent(this.dynamicDateSettingComponent.name)}}},l=i("KHd+"),c=function(e){e.options.__langStrings={mod_perform:["relative_date_selector_after","relative_date_selector_before","relative_date_selector_count","relative_date_selector_days","relative_date_selector_direction","relative_date_selector_reference_date","relative_date_selector_error_range","relative_date_selector_from","relative_date_selector_unit","relative_date_selector_until","relative_date_selector_weeks"]}},m=Object(l.a)(d,n,[],!1,null,null,null);"function"==typeof c&&c(m),m.options.__hasBlocks={script:!0,template:!0},m.options.__file="client/src/mod_perform/components/manage_activity/assignment/schedule/RelativeDateSelector.vue";t.default=m.exports},vBwk:function(e,t){e.exports=tui.require("mod_perform/components/icons/ParticipationReporting")},vF5l:function(e,t){e.exports=tui.require("tui/components/buttons/Button")},vGF0:function(e,t){e.exports=tui.require("tui/components/form/FormRowDetails")},vgT7:function(e,t){e.exports=tui.require("tui/components/icons/common/Add")},vyVp:function(e,t){e.exports=tui.require("tui/notifications")},"w+5x":function(e,t,i){"use strict";i.r(t);var n=i("lBzj"),a=i.n(n),s={functional:!0,components:{FlexIcon:a.a},props:{alt:String,customClass:[String,Object,Array],styleClass:Object,size:[String,Number],title:String},render:(e,{props:t})=>e(a.a,{props:Object.assign({},t,{icon:"mod_perform|notification-slash"})})},r=i("KHd+"),o=Object(r.a)(s,void 0,void 0,!1,null,null,null);o.options.__hasBlocks={script:!0,template:!1},o.options.__file="client/src/mod_perform/components/icons/EndDateDisabled.vue";t.default=o.exports},w31e:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/assignment/schedule/ScheduleToggles")},y62M:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ScheduleSettingContainer",{attrs:{title:e.title}},[i("div",{staticClass:"tui-performAssignmentScheduleFrequencySettings"},[e.isRepeating?[i("span",{attrs:{id:e.$id("schedule_repeating_type")}},[e._v("\n        "+e._s(e.$str("schedule_repeating_enabled_description","mod_perform"))+"\n      ")]),e._v(" "),i("div",{staticClass:"tui-performAssignmentScheduleFrequencySettings__option"},[i("FormRadioGroup",{attrs:{name:"repeatingType","aria-labelledby":e.$id("schedule_repeating_type")}},[i("Label",{attrs:{for:e.$id("schedule_repeating_type_after_creation"),label:e.$str("schedule_repeating_type_after_creation_label","mod_perform"),hidden:""}}),e._v(" "),i("Radio",{class:{"tui-performAssignmentSchedule__radio-disabled":!e.typeIsAfterCreation},attrs:{id:e.$id("schedule_repeating_type_after_creation"),value:e.typeOptions.afterCreation}},[i("div",{staticClass:"tui_performAssignmentSchedule__singleLine"},[i("span",{domProps:{innerHTML:e._s(e.$str("schedule_repeating_every","mod_perform"))}}),e._v(" "),i("RelativeDateSelector",{attrs:{path:["repeatingOffset",e.typeOptions.afterCreation],disabled:!e.typeIsAfterCreation}}),e._v(" "),i("span",{domProps:{innerHTML:e._s(e.$str("schedule_repeating_after_creation","mod_perform"))}})],1)]),e._v(" "),i("Label",{attrs:{for:e.$id("schedule_repeating_type_after_creation_when_complete"),label:e.$str("schedule_repeating_type_after_creation_when_complete_label","mod_perform"),hidden:""}}),e._v(" "),i("Radio",{class:{"tui-performAssignmentSchedule__radio-disabled":!e.typeIsAfterCreationWhenComplete},attrs:{id:e.$id("schedule_repeating_type_after_creation_when_complete"),value:e.typeOptions.afterCreationWhenComplete}},[i("div",{staticClass:"tui_performAssignmentSchedule__singleLine"},[i("span",{domProps:{innerHTML:e._s(e.$str("schedule_repeating_after_creation_when_complete","mod_perform"))}}),e._v(" "),i("RelativeDateSelector",{attrs:{path:["repeatingOffset",e.typeOptions.afterCreationWhenComplete],disabled:!e.typeIsAfterCreationWhenComplete}}),e._v(" "),i("span",{domProps:{innerHTML:e._s(e.$str("schedule_repeating_ago","mod_perform"))}})],1)]),e._v(" "),i("Label",{attrs:{for:e.$id("schedule_repeating_type_after_completion"),label:e.$str("schedule_repeating_type_after_creation_when_complete_label","mod_perform"),hidden:""}}),e._v(" "),i("Radio",{class:{"tui-performAssignmentSchedule__radio-disabled":!e.typeIsAfterCompletion},attrs:{id:e.$id("schedule_repeating_type_after_completion"),value:e.typeOptions.afterCompletion}},[i("div",{staticClass:"tui_performAssignmentSchedule__singleLine"},[i("span",{domProps:{innerHTML:e._s(e.$str("schedule_repeating_every","mod_perform"))}}),e._v(" "),i("RelativeDateSelector",{attrs:{path:["repeatingOffset",e.typeOptions.afterCompletion],disabled:!e.typeIsAfterCompletion}}),e._v(" "),i("span",{domProps:{innerHTML:e._s(e.$str("schedule_repeating_after_completion","mod_perform"))}})],1)])],1)],1),e._v(" "),i("div",{staticClass:"tui-performAssignmentScheduleFrequencySettings__repeating_limit"},[i("span",[e._v(e._s(e.limitTitle))]),e._v(" "),i("div",{staticClass:"tui-performAssignmentScheduleFrequencySettings__option"},[i("Label",{attrs:{for:e.$id("schedule_repeating_limit_group"),label:e.$str("schedule_repeating_limit_label","mod_perform"),hidden:""}}),e._v(" "),i("FormRadioGroup",{attrs:{id:e.$id("schedule_repeating_limit_group"),name:"repeatingIsLimited"}},[i("Label",{attrs:{for:e.$id("schedule_repeating_limit_none"),label:e.$str("schedule_repeating_limit_none_label","mod_perform"),hidden:""}}),e._v(" "),i("Radio",{attrs:{id:e.$id("schedule_repeating_limit_none"),value:!1}},[i("span",[e._v(e._s(e.noLimitLabel))])]),e._v(" "),i("Label",{attrs:{for:e.$id("schedule_repeating_limit_maximized"),label:e.$str("schedule_repeating_limit_maximized_label","mod_perform"),hidden:""}}),e._v(" "),i("Radio",{attrs:{id:e.$id("schedule_repeating_limit_maximized"),value:!0}},[i("div",{staticClass:"tui_performAssignmentSchedule__singleLine"},[i("span",[e._v(e._s(e.$str("schedule_repeating_limit_maximum_of","mod_perform")))]),e._v(" "),i("div",{staticClass:" tui-performAssignmentScheduleFrequencySettings__limit"},[i("FormNumber",{attrs:{name:"repeatingLimit","aria-label":e.$str("schedule_repeating_limit_count_label","mod_perform"),min:1}})],1),e._v(" "),i("span",[e._v(e._s(e.$str("schedule_repeating_limit_instances_per_user","mod_perform")))])])])],1)],1)])]:[i("span",[e._v("\n        "+e._s(e.$str("schedule_repeating_disabled_description","mod_perform"))+"\n      ")])]],2)])};n._withStripped=!0;var a=i("WBvU"),s=i("VX2K"),r=i.n(s),o=i("dk0v"),d=i.n(o),l=i("K2XK"),c=i.n(l),m=i("KxNG"),u={components:{FormNumber:a.FormNumber,FormRadioGroup:a.FormRadioGroup,Radio:r.a,RelativeDateSelector:d.a,ScheduleSettingContainer:c.a},props:{isOpen:{type:Boolean,required:!0},isRepeating:{type:Boolean,required:!0},repeatingType:{type:String,required:!0}},data:()=>({typeOptions:{afterCreation:m.SCHEDULE_REPEATING_TYPE_AFTER_CREATION,afterCreationWhenComplete:m.SCHEDULE_REPEATING_TYPE_AFTER_CREATION_WHEN_COMPLETE,afterCompletion:m.SCHEDULE_REPEATING_TYPE_AFTER_COMPLETION}}),computed:{title(){return this.isRepeating?this.$str("schedule_repeating_enabled","mod_perform"):this.$str("schedule_repeating_disabled","mod_perform")},typeIsAfterCreation(){return this.repeatingType===m.SCHEDULE_REPEATING_TYPE_AFTER_CREATION},typeIsAfterCreationWhenComplete(){return this.repeatingType===m.SCHEDULE_REPEATING_TYPE_AFTER_CREATION_WHEN_COMPLETE},typeIsAfterCompletion(){return this.repeatingType===m.SCHEDULE_REPEATING_TYPE_AFTER_COMPLETION},limitTitle(){return this.isOpen?this.$str("schedule_repeating_with","mod_perform"):this.$str("schedule_repeating_limited_until","mod_perform")},noLimitLabel(){return this.isOpen?this.$str("schedule_repeating_limit_none_open_ended","mod_perform"):this.$str("schedule_repeating_limit_none","mod_perform")}}},_=i("KHd+"),p=function(e){e.options.__langStrings={mod_perform:["schedule_repeating_after_completion","schedule_repeating_after_creation","schedule_repeating_after_creation_when_complete","schedule_repeating_ago","schedule_repeating_disabled","schedule_repeating_disabled_description","schedule_repeating_enabled","schedule_repeating_enabled_description","schedule_repeating_every","schedule_repeating_limit_count_label","schedule_repeating_limit_instances_per_user","schedule_repeating_limit_label","schedule_repeating_limit_maximized_label","schedule_repeating_limit_maximum_of","schedule_repeating_limit_none","schedule_repeating_limit_none_label","schedule_repeating_limit_none_open_ended","schedule_repeating_limited_until","schedule_repeating_type_after_completion_label","schedule_repeating_type_after_creation_label","schedule_repeating_type_after_creation_when_complete_label","schedule_repeating_with"]}},v=Object(_.a)(u,n,[],!1,null,null,null);"function"==typeof p&&p(v),v.options.__hasBlocks={script:!0,template:!0},v.options.__file="client/src/mod_perform/components/manage_activity/assignment/schedule/FrequencySettings.vue";t.default=v.exports},yFnJ:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("FormScope",{attrs:{path:"additionalSettings"}},[i("FormRow",{attrs:{label:e.$str("schedule_job_assignment_based_instances","mod_perform")}},[i("FormRadioGroup",{attrs:{validate:e.jobBasedCanDisableValidator,name:"subject_instance_generation"}},[i("Radio",{attrs:{value:e.SUBJECT_INSTANCE_GENERATION_ONE_PER_SUBJECT,"aria-describedby":e.$id("aria-describedby")}},[e._v(e._s(e.$str("schedule_job_assignment_based_instances_disabled","mod_perform")))]),e._v(" "),i("FormRowDetails",[i("span",{staticClass:"tui-performAssignmentScheduleAdditionalSettings__radio_description"},[e._v("\n            "+e._s(e.$str("schedule_job_assignment_based_instances_disabled_description","mod_perform"))+"\n          ")])]),e._v(" "),i("Radio",{staticClass:"tui-performAssignmentSchedule__radio",attrs:{value:e.SUBJECT_INSTANCE_GENERATION_ONE_PER_JOB,"aria-describedby":e.$id("aria-describedby")}},[e._v(e._s(e.$str("schedule_job_assignment_based_instances_enabled","mod_perform")))]),e._v(" "),i("FormRowDetails",[i("span",{staticClass:"tui-performAssignmentScheduleAdditionalSettings__radio_description"},[e._v("\n            "+e._s(e.$str("schedule_job_assignment_based_instances_enabled_description","mod_perform"))+"\n          ")])])],1)],1)],1)],1)};n._withStripped=!0;var a=i("WBvU"),s=i("vGF0"),r=i.n(s),o=i("VX2K"),d=i.n(o),l=i("KxNG"),c={components:{FormRadioGroup:a.FormRadioGroup,FormRow:a.FormRow,FormRowDetails:r.a,FormScope:a.FormScope,Radio:d.a},props:{usesJobBasedDynamicSource:{type:Boolean},dynamicSourceName:{type:String}},data:()=>({SUBJECT_INSTANCE_GENERATION_ONE_PER_SUBJECT:l.SUBJECT_INSTANCE_GENERATION_ONE_PER_SUBJECT,SUBJECT_INSTANCE_GENERATION_ONE_PER_JOB:l.SUBJECT_INSTANCE_GENERATION_ONE_PER_JOB}),methods:{jobBasedCanDisableValidator(e){return this.usesJobBasedDynamicSource&&e==l.SUBJECT_INSTANCE_GENERATION_ONE_PER_SUBJECT?this.$str("schedule_job_assignment_based_disable_error","mod_perform",this.dynamicSourceName):null}}},m=i("KHd+"),u=function(e){e.options.__langStrings={mod_perform:["schedule_job_assignment_based_disable_error","schedule_job_assignment_based_instances","schedule_job_assignment_based_instances_disabled","schedule_job_assignment_based_instances_disabled_description","schedule_job_assignment_based_instances_enabled","schedule_job_assignment_based_instances_enabled_description"]}},_=Object(m.a)(c,n,[],!1,null,null,null);"function"==typeof u&&u(_),_.options.__hasBlocks={script:!0,template:!0},_.options.__file="client/src/mod_perform/components/manage_activity/assignment/schedule/AdditionalScheduleSettings.vue";t.default=_.exports},yikf:function(e,t){e.exports=tui.require("tui/components/datatable/Table")},zPJE:function(e,t,i){var n={"./activities_list/ActivityActions":"9Mux","./activities_list/ActivityActions.vue":"9Mux","./element/ElementAdminDisplay":"W86B","./element/ElementAdminDisplay.vue":"W86B","./element/ElementAdminForm":"9u29","./element/ElementAdminForm.vue":"9u29","./element/ElementAdminReadOnlyDisplay":"6T8K","./element/ElementAdminReadOnlyDisplay.vue":"6T8K","./element/ElementParticipantForm":"llDw","./element/ElementParticipantForm.vue":"llDw","./element/ElementParticipantResponse":"8dSb","./element/ElementParticipantResponse.vue":"8dSb","./element/admin_form/ActionButtons":"Joh7","./element/admin_form/ActionButtons.vue":"Joh7","./element/admin_form/AdminFormMixin":"SB6c","./element/admin_form/AdminFormMixin.js":"SB6c","./element/admin_form/IdentifierInput":"j4gZ","./element/admin_form/IdentifierInput.vue":"j4gZ","./icons/EndDateDisabled":"w+5x","./icons/EndDateDisabled.vue":"w+5x","./icons/EndDateEnabled":"hmgb","./icons/EndDateEnabled.vue":"hmgb","./icons/ParticipationReporting":"DFGH","./icons/ParticipationReporting.vue":"DFGH","./icons/RepeatingDisabled":"KWP4","./icons/RepeatingDisabled.vue":"KWP4","./icons/RepeatingEnabled":"6XB6","./icons/RepeatingEnabled.vue":"6XB6","./icons/ReportingIdentifier":"T5Kz","./icons/ReportingIdentifier.vue":"T5Kz","./manage_activity/ActivateActivityModal":"kXIj","./manage_activity/ActivateActivityModal.vue":"kXIj","./manage_activity/ActivityStatusBanner":"fFSS","./manage_activity/ActivityStatusBanner.vue":"fFSS","./manage_activity/CreateActivityForm":"s6s7","./manage_activity/CreateActivityForm.vue":"s6s7","./manage_activity/GeneralInfoTab":"E+p/","./manage_activity/GeneralInfoTab.vue":"E+p/","./manage_activity/assignment/AssignmentsTab":"Xgbh","./manage_activity/assignment/AssignmentsTab.vue":"Xgbh","./manage_activity/assignment/Schedule":"CW/P","./manage_activity/assignment/Schedule.vue":"CW/P","./manage_activity/assignment/schedule/AdditionalScheduleSettings":"yFnJ","./manage_activity/assignment/schedule/AdditionalScheduleSettings.vue":"yFnJ","./manage_activity/assignment/schedule/DueDateSettings":"Ytqz","./manage_activity/assignment/schedule/DueDateSettings.vue":"Ytqz","./manage_activity/assignment/schedule/FixedScheduleRangeSelector":"q1ca","./manage_activity/assignment/schedule/FixedScheduleRangeSelector.vue":"q1ca","./manage_activity/assignment/schedule/FrequencySettings":"y62M","./manage_activity/assignment/schedule/FrequencySettings.vue":"y62M","./manage_activity/assignment/schedule/RelativeDateSelector":"uFy6","./manage_activity/assignment/schedule/RelativeDateSelector.vue":"uFy6","./manage_activity/assignment/schedule/ScheduleSettingContainer":"4Nja","./manage_activity/assignment/schedule/ScheduleSettingContainer.vue":"4Nja","./manage_activity/assignment/schedule/ScheduleSettings":"CHlV","./manage_activity/assignment/schedule/ScheduleSettings.vue":"CHlV","./manage_activity/assignment/schedule/ScheduleToggles":"jU43","./manage_activity/assignment/schedule/ScheduleToggles.vue":"jU43","./manage_activity/assignment/schedule/custom_settings/ActivitySelector":"Hu2q","./manage_activity/assignment/schedule/custom_settings/ActivitySelector.vue":"Hu2q","./manage_activity/content/ActivityContentTab":"HSlS","./manage_activity/content/ActivityContentTab.vue":"HSlS","./manage_activity/content/ActivityMultipleSectionToggle":"QFNw","./manage_activity/content/ActivityMultipleSectionToggle.vue":"QFNw","./manage_activity/content/ActivitySection":"COfJ","./manage_activity/content/ActivitySection.vue":"COfJ","./manage_activity/content/ActivitySectionElementSummary":"T0p/","./manage_activity/content/ActivitySectionElementSummary.vue":"T0p/","./manage_activity/content/ActivitySectionRelationship":"Ts/T","./manage_activity/content/ActivitySectionRelationship.vue":"Ts/T","./manage_activity/content/ContentAddElementButton":"EpBX","./manage_activity/content/ContentAddElementButton.vue":"EpBX","./manage_activity/content/EditSectionContentModal":"zecW","./manage_activity/content/EditSectionContentModal.vue":"zecW","./manage_activity/content/ParticipantsPopover":"JHnp","./manage_activity/content/ParticipantsPopover.vue":"JHnp","./manage_activity/content/WorkflowSettings":"XFt3","./manage_activity/content/WorkflowSettings.vue":"XFt3","./manage_activity/notification/NotificationSection":"3vGC","./manage_activity/notification/NotificationSection.vue":"3vGC","./manage_activity/notification/NotificationsTab":"eABU","./manage_activity/notification/NotificationsTab.vue":"eABU","./manage_activity/notification/RecipientsTable":"RM6z","./manage_activity/notification/RecipientsTable.vue":"RM6z","./manage_activity/notification/TriggersTable":"mjJ1","./manage_activity/notification/TriggersTable.vue":"mjJ1","./manage_activity/participation/InstanceInfoCard":"UgGx","./manage_activity/participation/InstanceInfoCard.vue":"UgGx","./manage_activity/participation/ParticipantInstanceInfoCard":"Bh5B","./manage_activity/participation/ParticipantInstanceInfoCard.vue":"Bh5B","./manage_activity/participation/SelectActivityModal":"7vnN","./manage_activity/participation/SelectActivityModal.vue":"7vnN","./manage_activity/participation/SubjectInstanceInfoCard":"dpEn","./manage_activity/participation/SubjectInstanceInfoCard.vue":"dpEn","./manage_activity/participation/Toasts":"VHu6","./manage_activity/participation/Toasts.vue":"VHu6","./report/manage_participation/Actions":"BRmP","./report/manage_participation/Actions.vue":"BRmP","./report/manage_participation/ParticipantOpenCloseActionModal":"kSbt","./report/manage_participation/ParticipantOpenCloseActionModal.vue":"kSbt","./report/manage_participation/SectionOpenCloseActionModal":"PJBr","./report/manage_participation/SectionOpenCloseActionModal.vue":"PJBr","./report/manage_participation/SubjectInstanceOpenCloseActionModal":"gLnO","./report/manage_participation/SubjectInstanceOpenCloseActionModal.vue":"gLnO","./user_activities/ActivityContent":"qHhm","./user_activities/ActivityContent.vue":"qHhm","./user_activities/ManualParticipantsSelectionBanner":"2nWl","./user_activities/ManualParticipantsSelectionBanner.vue":"2nWl","./user_activities/list/Activities":"77RH","./user_activities/list/Activities.vue":"77RH","./user_activities/list/RelationshipSelector":"Wn/X","./user_activities/list/RelationshipSelector.vue":"Wn/X","./user_activities/list/Sections":"crm9","./user_activities/list/Sections.vue":"crm9","./user_activities/participant/OtherParticipantResponses":"RlWc","./user_activities/participant/OtherParticipantResponses.vue":"RlWc","./user_activities/participant/ParticipantUserHeader":"hau1","./user_activities/participant/ParticipantUserHeader.vue":"hau1","./user_activities/participant/ResponsesAreVisibleToDescription":"Fja8","./user_activities/participant/ResponsesAreVisibleToDescription.vue":"Fja8","./user_activities/participant_selector/ActivityParticipants":"c0TB","./user_activities/participant_selector/ActivityParticipants.vue":"c0TB","./user_activities/participant_selector/FormUserSelector":"4Xyi","./user_activities/participant_selector/FormUserSelector.vue":"4Xyi","./user_activities/participant_selector/UserSelector":"tW8v","./user_activities/participant_selector/UserSelector.vue":"tW8v"};function a(e){var t=s(e);return i(t)}function s(e){if(!i.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=s,e.exports=a,a.id="zPJE"},zdti:function(e,t){e.exports=tui.require("tui/components/notifications/NotificationBanner")},zecW:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",[e._t("trigger",null,{open:e.openThis}),e._v(" "),i("ModalPresenter",{attrs:{open:e.isOpen},on:{"request-close":e.tryCloseThis}},[i("Modal",{attrs:{size:"sheet","aria-labelledby":e.$id("title"),dismissable:{backdropClick:!1}}},[i("ModalContent",{scopedSlots:e._u([{key:"title",fn:function(){return[i("h2",{staticClass:"tui-performEditSectionContentModal__title"},[e._v("\n            "+e._s(e.title)+"\n          ")]),e._v(" "),e.requiredText?i("p",{attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"tui-performEditSectionContentModal__required"},[e._v("*")]),e._v("\n            "+e._s(e.$str("required_fields","mod_perform"))+"\n          ")]):e._e()]},proxy:!0},{key:"buttons",fn:function(){return[i("Button",{attrs:{id:e.$id("edit-content-close"),text:e.$str("button_close","mod_perform")},on:{click:e.tryCloseThis}})]},proxy:!0}])},[e._v(" "),i("Loader",{attrs:{loading:e.isLoading}},[i("div",{staticClass:"tui-performEditSectionContentModal__form"},[e._l(e.sectionElements,(function(t,n){return i(e.componentFor(t),{key:t.clientId,ref:"sectionElements",refInFor:!0,tag:"component",attrs:{data:t.element.data,"raw-data":t.element.raw_data,title:t.element.title,"raw-title":t.element.raw_title,identifier:t.element.identifier,"is-required":t.element.is_required,type:t.element.type,error:e.errors[t.clientId],"activity-state":e.activityState},on:{update:function(i){return e.update(t,i,n)},edit:function(i){return e.edit(t)},display:function(i){return e.display(t)},"display-read":function(i){return e.displayReadOnly(t)},remove:function(i){return e.tryDelete(t)}}})})),e._v(" "),e.isActive?e._e():i("ContentAddElementButton",{on:{"add-element-item":e.add}})],2)])],1)],1)],1),e._v(" "),i("ConfirmationModal",{attrs:{open:e.deleteModalOpen,title:e.$str("modal_element_delete_title","mod_perform"),"confirm-button-text":e.$str("delete"),loading:e.isSaving},on:{confirm:e.deleteSelectedElement,cancel:e.closeDeleteModal}},[i("p",[e._v(e._s(e.$str("modal_element_delete_message","mod_perform")))])]),e._v(" "),i("ConfirmationModal",{attrs:{open:e.unsavedChangesModalOpen,title:e.$str("modal_element_unsaved_changes_title","mod_perform"),"confirm-button-text":e.$str("button_close","mod_perform")},on:{confirm:e.closeThis,cancel:function(t){e.unsavedChangesModalOpen=!1}}},[i("p",[e._v(e._s(e.$str("modal_element_unsaved_changes_message","mod_perform")))])])],2)};n._withStripped=!0;var a=i("vF5l"),s=i.n(a),r=i("nXMa"),o=i.n(r),d=i("BN8m"),l=i.n(d),c=i("KRvX"),m=i.n(c),u=i("C+/B"),_=i.n(u),p=i("kKx+"),v=i.n(p),f=i("AdjL"),g=i.n(f),h=i("tkAW"),k=i.n(h),y=i("u5iS"),S=i.n(y),b=i("Mnur"),N=i.n(b),F={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_section_admin"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"section_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_section_admin"},arguments:[{kind:"Argument",name:{kind:"Name",value:"section_id"},value:{kind:"Variable",name:{kind:"Name",value:"section_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"display_title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"section_elements"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"element"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"element_plugin"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"plugin_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"admin_form_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"admin_display_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"admin_read_only_display_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"participant_form_component"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"raw_title"},name:{kind:"Name",value:"title"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"identifier"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"data"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"raw_data"},name:{kind:"Name",value:"data"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_required"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"sort_order"},arguments:[],directives:[]}]}}]}}]}}]},A={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_update_section_elements"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_update_section_elements_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_update_section_elements"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"section"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"section_elements"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"element"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"element_plugin"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"plugin_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"admin_form_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"admin_display_component"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"raw_title"},name:{kind:"Name",value:"title"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"identifier"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"data"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"raw_data"},name:{kind:"Name",value:"data"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_required"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"sort_order"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"section_elements_summary"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"required_question_count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"optional_question_count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"other_element_count"},arguments:[],directives:[]}]}}]}}]}}]}}]},T=i("vyVp"),C=i("TXEh"),I=i("KxNG"),E={components:{Button:s.a,ButtonCancel:o.a,ButtonGroup:l.a,ButtonSubmit:m.a,ConfirmationModal:_.a,ContentAddElementButton:v.a,Loader:g.a,Modal:k.a,ModalContent:S.a,ModalPresenter:N.a},props:{activityState:{type:Object,required:!0},sectionId:{type:String,required:!0},title:{type:String,required:!0},requiredText:Boolean},data:()=>({isOpen:!1,section:{title:"",section_elements:[]},sectionElements:[],editingIds:[],readOnlyIds:[],removeIds:[],errors:{},isSaving:!1,deleteModalOpen:!1,elementToDelete:null,unsavedChangesModalOpen:!1,skipQuery:!0}),apollo:{section:{query:F,variables(){return{section_id:this.sectionId}},update:e=>e.mod_perform_section_admin,fetchPolicy:"network-only",result({data:e}){this.updateSectionElementData(e.mod_perform_section_admin.section_elements)},skip(){return this.skipQuery}}},computed:{isLoading(){return this.$apollo.loading||this.isSaving},hasUnsavedChanges(){return this.editingIds.length>0},isActive(){return"ACTIVE"===this.activityState.name}},mounted(){window.addEventListener("beforeunload",this.unloadHandler)},beforeDestroy(){window.removeEventListener("beforeunload",this.unloadHandler)},methods:{openThis(){this.skipQuery=!1,this.$apollo.queries.section.refresh(),this.isOpen=!0},tryCloseThis(){this.hasUnsavedChanges?this.unsavedChangesModalOpen=!0:this.closeThis()},closeThis(){this.skipQuery=!0,this.editingIds=[],this.unsavedChangesModalOpen=!1,this.isOpen=!1},add(e){const t={id:this.sectionId,clientId:Object(C.uniqueId)(),element:{id:null,type:e,title:"",raw_title:"",identifier:"",data:{},raw_data:{}},sort_order:this.sectionElements.length+1,creating:!0};this.sectionElements.push(t),this.edit(t)},update(e,t,i){e.element=Object.assign(e.element,t,{raw_title:t.title,raw_data:t.data});const n={title:e.element.raw_title,data:JSON.stringify(e.element.raw_data)};null!=e.element.identifier&&(n.identifier=e.element.identifier),null!=e.element.is_required&&(n.is_required=e.element.is_required);const a={};e.creating?(delete e.creating,a.create_new=[Object.assign(n,{plugin_name:e.element.type.plugin_name,sort_order:i+1})]):a.update=[Object.assign(n,{element_id:e.element.id})],this.save(a),this.display(e)},edit(e){this.editingIds.push(e.clientId)},stopEditing(e){Object(C.pull)(this.editingIds,e.clientId)},display(e){this.isElementEditable()?(this.stopEditing(e),e.creating&&this.remove(e)):Object(C.pull)(this.readOnlyIds,e.clientId)},displayReadOnly(e){this.readOnlyIds.push(e.clientId)},remove(e){this.stopEditing(e),Object(C.pull)(this.sectionElements,e)},tryDelete(e){e.element.id?(this.deleteModalOpen=!0,this.elementToDelete=e):this.remove(e)},async deleteSelectedElement(){this.isSaving=!0;const e=this.sectionElements.filter(e=>e.id!==this.elementToDelete.id).map((e,t)=>({section_element_id:e.id,sort_order:t+1}));await this.save({move:e,delete:[{section_element_id:this.elementToDelete.id}]},this.$str("toast_success_delete_element","mod_perform")),this.remove(this.elementToDelete),this.closeDeleteModal()},closeDeleteModal(){this.deleteModalOpen=!1,this.elementToDelete=null},componentFor(e){const{type:t}=e.element,i=this.editingIds.includes(e.clientId),n=this.readOnlyIds.includes(e.clientId);let a=i?t.admin_form_component:t.admin_display_component;return n&&(a=t.admin_read_only_display_component),tui.asyncComponent(a)},async save(e,t){this.isSaving=!0;try{const{data:i}=await this.$apollo.mutate({mutation:A,variables:{input:Object.assign(e,{section_id:this.sectionId})},refetchAll:!1}),n=i.mod_perform_update_section_elements.section;this.updateSectionElementData(n.section_elements),this.$emit("update-summary",n),this.showSuccessNotification(t),this.isSaving=!1}catch(e){this.showErrorNotification(),this.isSaving=!1}},unloadHandler(e){if(!this.hasUnsavedChanges)return;const t=this.$str("unsaved_changes_warning","mod_perform");return e.preventDefault(),e.returnValue=t,t},updateSectionElementData(e){this.sectionElements=e.map(e=>Object.assign({},e,{clientId:Object(C.uniqueId)(),element:Object.assign({},e.element,{type:e.element.element_plugin,data:JSON.parse(e.element.data),raw_data:JSON.parse(e.element.raw_data)})}))},showSuccessNotification(e){Object(T.notify)({duration:I.NOTIFICATION_DURATION,message:e||this.$str("toast_success_save_element","mod_perform"),type:"success"})},showErrorNotification(){Object(T.notify)({duration:I.NOTIFICATION_DURATION,message:this.$str("toast_error_generic_update","mod_perform"),type:"error"})},isElementEditable(){return"ACTIVE"!==this.activityState.name}}},O=i("KHd+"),$=function(e){e.options.__langStrings={mod_perform:["button_close","modal_element_delete_message","modal_element_delete_title","modal_element_unsaved_changes_message","modal_element_unsaved_changes_title","required_fields","toast_error_generic_update","toast_success_delete_element","toast_success_save_element","unsaved_changes_warning"],moodle:["delete"]}},D=Object(O.a)(E,n,[],!1,null,null,null);"function"==typeof $&&$(D),D.options.__hasBlocks={script:!0,template:!0},D.options.__file="client/src/mod_perform/components/manage_activity/content/EditSectionContentModal.vue";t.default=D.exports},zkRv:function(e,t){e.exports=tui.require("mod_perform/components/user_activities/participant/OtherParticipantResponses")}});