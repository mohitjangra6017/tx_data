!function(e){function t(t){for(var a,s,o=t[0],l=t[1],d=t[2],u=0,m=[];u<o.length;u++)s=o[u],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&m.push(n[s][0]),n[s]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);for(c&&c(t);m.length;)m.shift()();return r.push.apply(r,d||[]),i()}function i(){for(var e,t=0;t<r.length;t++){for(var i=r[t],a=!0,o=1;o<i.length;o++){var l=i[o];0!==n[l]&&(a=!1)}a&&(r.splice(t--,1),e=s(s.s=i[0]))}return e}var a={},n={3:0},r=[];function s(t){if(a[t])return a[t].exports;var i=a[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=e,s.c=a,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(i,a,function(t){return e[t]}.bind(null,a));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var o=window.webpackJsonp=window.webpackJsonp||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var d=0;d<o.length;d++)t(o[d]);var c=l;r.push(["N/hZ",0]),i()}({"+1Jo":function(e,t){e.exports=tui.require("totara_engage/components/icons/access/computed/AccessIcon")},"/w+c":function(e,t){e.exports=tui.require("engage_article/components/form/EditArticleContentForm")},"0viy":function(e,t){e.exports=tui.require("tui/components/icons/common/Spinner")},"2qtY":function(e,t,i){var a={"./ArticleView":"e4cB","./ArticleView.vue":"e4cB"};function n(e){var t=r(e);return i(t)}function r(e){if(!i.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}n.keys=function(){return Object.keys(a)},n.resolve=r,e.exports=n,n.id="2qtY"},"2wx7":function(e,t){e.exports=tui.require("editor_weka/components/Weka")},"3HPz":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-articlePlaylistBox"},[e.show?[i("p",{staticClass:"tui-articlePlaylistBox__label"},[i("span",[e._v("\n        "+e._s(e.$str("appears_in","engage_article"))+"\n      ")]),e._v(" "),e.loading?i("Spinner"):e._e()],1),e._v(" "),i("ResourcePlaylistBox",{staticClass:"tui-articlePlaylistBox__playlistsBox",attrs:{"resource-id":e.resourceId},on:{"update-has-playlists":function(t){e.show=t},"load-records":function(t){e.loading=t}}})]:e._e()],2)};a._withStripped=!0;var n=i("W9ne"),r=i.n(n),s=i("0viy"),o=i.n(s),l={components:{ResourcePlaylistBox:r.a,Spinner:o.a},props:{resourceId:{type:[String,Number],required:!0}},data:()=>({loading:!1,show:!0})},d=i("KHd+"),c=function(e){e.options.__langStrings={engage_article:["appears_in"]}},u=Object(d.a)(l,a,[],!1,null,null,null);"function"==typeof c&&c(u),u.options.__hasBlocks={script:!0,template:!0},u.options.__file="client/src/engage_article/components/sidepanel/content/ArticlePlaylistBox.vue";t.default=u.exports},"4Lp8":function(e,t){e.exports=tui.require("totara_engage/mixins/container_mixin")},"5h9J":function(e,t){e.exports=tui.require("tui/components/buttons/ButtonIcon")},"5v9U":function(e,t){e.exports=tui.require("totara_comment/components/box/SidePanelCommentBox")},"6wqy":function(e,t){e.exports=tui.require("totara_engage/components/icons/Share")},"9G+f":function(e,t){e.exports=tui.require("tui/components/popover/Popover")},"9mdZ":function(e,t){e.exports=tui.require("totara_engage/components/icons/More")},AdjL:function(e,t){e.exports=tui.require("tui/components/loader/Loader")},BN8m:function(e,t){e.exports=tui.require("tui/components/buttons/ButtonGroup")},BaY1:function(e,t){e.exports=tui.require("tui/components/sidepanel/SidePanel")},D9If:function(e,t){e.exports=tui.require("tui/components/grid/GridItem")},Eivh:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-engageArticle-createArticle"},[i("ArticleForm",{directives:[{name:"show",rawName:"v-show",value:0===e.stage,expression:"stage === 0"}],attrs:{"article-name":e.article.name,"article-content":e.article.content},on:{next:e.next,cancel:function(t){return e.$emit("cancel")}}}),e._v(" "),i("AccessForm",{directives:[{name:"show",rawName:"v-show",value:1===e.stage,expression:"stage === 1"}],attrs:{"item-id":"0",component:"engage_article","show-back":!0,submitting:e.submitting,"selected-access":e.containerValues.access,"private-disabled":e.privateDisabled,"restricted-disabled":e.restrictedDisabled,container:e.container,"enable-time-view":!0},on:{done:e.done,back:e.back,cancel:function(t){return e.$emit("cancel")}}})],1)};a._withStripped=!0;var n=i("ZYet"),r=i.n(n),s=i("K59g"),o=i.n(s),l={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"engage_article_create_article"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"content"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"format"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"access"}},type:{kind:"NamedType",name:{kind:"Name",value:"totara_engage_access"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"topics"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"timeview"}},type:{kind:"NamedType",name:{kind:"Name",value:"totara_engage_timeview"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shares"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"totara_engage_recipient_in"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"draft_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"article"},name:{kind:"Name",value:"engage_article_create"},arguments:[{kind:"Argument",name:{kind:"Name",value:"content"},value:{kind:"Variable",name:{kind:"Name",value:"content"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"Variable",name:{kind:"Name",value:"format"}}},{kind:"Argument",name:{kind:"Name",value:"access"},value:{kind:"Variable",name:{kind:"Name",value:"access"}}},{kind:"Argument",name:{kind:"Name",value:"topics"},value:{kind:"Variable",name:{kind:"Name",value:"topics"}}},{kind:"Argument",name:{kind:"Name",value:"timeview"},value:{kind:"Variable",name:{kind:"Name",value:"timeview"}}},{kind:"Argument",name:{kind:"Name",value:"shares"},value:{kind:"Variable",name:{kind:"Name",value:"shares"}}},{kind:"Argument",name:{kind:"Name",value:"draft_id"},value:{kind:"Variable",name:{kind:"Name",value:"draft_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resource"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"PLAIN"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"access"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"time"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimagealt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurl"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"image"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"owned"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"timeview"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"topics"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"PLAIN"}}],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"sharedbycount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reacted"},arguments:[],directives:[]}]}}]}}]},d=i("tyu8"),c=i("4Lp8"),u=i.n(c),m={components:{ArticleForm:r.a,AccessForm:o.a},mixins:[u.a],data:()=>({stage:0,maxStage:1,article:{name:"",content:null,itemId:null},submitting:!1}),computed:{privateDisabled(){return!!this.containerValues.access&&!d.AccessManager.isPrivate(this.containerValues.access)},restrictedDisabled(){return!!this.containerValues.access&&d.AccessManager.isPublic(this.containerValues.access)}},methods:{next({content:e,name:t,itemId:i}){this.stage<this.maxStage&&(this.stage+=1),this.article.content=e,this.article.name=t,this.article.itemId=i,this.$emit("hide-tabs",!0)},back(){this.stage>0&&(this.stage-=1),this.$emit("hide-tabs",!1)},done({access:e,topics:t,timeView:i,shares:a}){this.submitting=!0;let n={content:this.article.content,name:this.article.name,access:e,topics:t.map(e=>e.id),shares:a,draft_id:this.article.itemId};i&&(n.timeview=i),this.$apollo.mutate({mutation:l,variables:n,update:(e,{data:{article:{resource:{id:t}}}})=>{this.$emit("done",{resourceId:t})}}).then(()=>{this.$emit("cancel")}).finally(()=>{this.submitting=!1})}}},k=i("KHd+"),p=Object(k.a)(m,a,[],!1,null,null,null);p.options.__hasBlocks={script:!0,template:!0},p.options.__file="client/src/engage_article/components/CreateArticle.vue";t.default=p.exports},FhEx:function(e,t){e.exports=tui.require("totara_engage/components/sidepanel/media/MediaSetting")},GOzR:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Form",{staticClass:"tui-editArticleTitleForm"},[i("InputText",{staticClass:"tui-editArticleTitleForm__input",attrs:{name:"title",disabled:e.submitting,maxlength:60,placeholder:e.$str("entertitle","engage_article"),"aria-label":e.$str("articletitle","engage_article")},on:{submit:function(t){return e.$emit("submit",e.innerTitle)}},model:{value:e.innerTitle,callback:function(t){e.innerTitle=t},expression:"innerTitle"}}),e._v(" "),i("DoneCancelGroup",{attrs:{loading:e.submitting,disabled:e.submitting||!e.innerTitle},on:{done:function(t){return e.$emit("submit",e.innerTitle)},cancel:function(t){return e.$emit("cancel")}}})],1)};a._withStripped=!0;var n=i("nEm4"),r=i.n(n),s=i("oMuj"),o=i.n(s),l=i("QGXx"),d={components:{DoneCancelGroup:i.n(l).a,Form:r.a,InputText:o.a},props:{submitting:{type:Boolean,default:!1},title:{type:String,required:!0}},data(){return{innerTitle:this.title}}},c=i("KHd+"),u=function(e){e.options.__langStrings={engage_article:["articletitle","entertitle"]}},m=Object(c.a)(d,a,[],!1,null,null,null);"function"==typeof u&&u(m),m.options.__hasBlocks={script:!0,template:!0},m.options.__file="client/src/engage_article/components/form/EditArticleTitleForm.vue";t.default=m.exports},"H/tB":function(e,t){e.exports=tui.require("tui/tui")},I3CO:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-articleTitle"},[i("div",{staticClass:"tui-articleTitle__head"},[i("InlineEditing",{directives:[{name:"show",rawName:"v-show",value:!e.editing,expression:"!editing"}],attrs:{"update-able":e.updateAble,"full-width":!0},on:{click:function(t){e.editing=!0}}},[i("h3",{staticClass:"tui-articleTitle__head__title",attrs:{slot:"content"},slot:"content"},[e._v("\n        "+e._s(e.title)+"\n      ")])]),e._v(" "),e.editing?i("EditArticleTitleForm",{attrs:{title:e.title,submitting:e.submitting},on:{cancel:function(t){e.editing=!1},submit:e.updateTitle}}):e._e(),e._v(" "),e.owned?e._e():i("BookmarkButton",{attrs:{primary:!1,circle:!0,bookmarked:e.bookmarked,size:"300"},on:{click:function(t){return e.$emit("bookmark",t)}}})],1),e._v(" "),i("ArticleSeparator")],1)};a._withStripped=!0;var n=i("g0Fk"),r=i.n(n),s=i("bxuo"),o=i.n(s),l=i("wBfT"),d=i.n(l),c=i("kZ6F"),u=i.n(c),m=i("dkcK"),k=i("d4pu"),p={components:{EditArticleTitleForm:d.a,InlineEditing:r.a,BookmarkButton:o.a,ArticleSeparator:u.a},props:{title:{type:String,required:!0},updateAble:{type:Boolean,required:!0},bookmarked:{type:Boolean,required:!0},resourceId:{type:[Number,String],required:!0},owned:{type:Boolean,required:!0}},data:()=>({editing:!1,submitting:!1}),methods:{updateTitle(e){this.submitting=!0,this.$apollo.mutate({mutation:m.a,refetchAll:!1,variables:{resourceid:this.resourceId,name:e},updateQuery:(e,t)=>{e.writeQuery({query:k.a,variables:{resourceid:this.resourceId},data:t})}}).finally(()=>{this.submitting=!1,this.editing=!1})}}},v=i("KHd+"),g=Object(v.a)(p,a,[],!1,null,null,null);g.options.__hasBlocks={script:!0,template:!0},g.options.__file="client/src/engage_article/components/content/ArticleTitle.vue";t.default=g.exports},I9Nn:function(e,t){e.exports=tui.require("engage_article/components/content/ArticleTitle")},K59g:function(e,t){e.exports=tui.require("totara_engage/components/form/AccessForm")},KN7I:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Form",{staticClass:"tui-editArticleContentForm"},[i("Loader",{attrs:{fullpage:!0,loading:!e.editorMounted}}),e._v(" "),e.$apollo.loading?e._e():i("Weka",{staticClass:"tui-editArticleContentForm__editor",attrs:{component:"engage_article",area:"content","instance-id":e.resourceId,doc:e.content.doc},on:{"editor-mounted":function(t){e.editorMounted=!0},update:e.handleUpdate}}),e._v(" "),i("DoneCancelGroup",{attrs:{loading:e.submitting,disabled:e.content.empty||e.submitting},on:{done:e.submit,cancel:function(t){return e.$emit("cancel")}}})],1)};a._withStripped=!0;var n=i("nEm4"),r=i.n(n),s=i("2wx7"),o=i.n(s),l=i("TXEh"),d=i("QGXx"),c=i.n(d),u=i("AdjL"),m=i.n(u),k={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"engage_article_draft_item"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resourceid"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"draft"},name:{kind:"Name",value:"engage_article_draft_item"},arguments:[{kind:"Argument",name:{kind:"Name",value:"resourceid"},value:{kind:"Variable",name:{kind:"Name",value:"resourceid"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resourceid"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"format"},arguments:[],directives:[]}]}}]}}]},p={components:{Form:r.a,Weka:o.a,DoneCancelGroup:c.a,Loader:m.a},props:{resourceId:{type:[String,Number],required:!0},submitting:Boolean},apollo:{draft:{query:k,fetchPolicy:"network-only",variables(){return{resourceid:this.resourceId}},result({data:{draft:{content:e}}}){e&&(this.content.doc=JSON.parse(e),this.content.empty=!1)}}},data:()=>({draft:{},editorMounted:!1,content:{doc:null,empty:!0,itemId:null}}),methods:{$_readJSON:Object(l.debounce)((function(e){this.content.doc=e.getJSON(),this.content.empty=e.isEmpty(),this.content.itemId=e.getFileStorageItemId()}),100),handleUpdate(e){this.$_readJSON(e)},submit(){const e={resourceId:this.resourceId,content:JSON.stringify(this.content.doc),format:this.draft.format,itemId:this.content.itemId};this.$emit("submit",e)}}},v=i("KHd+"),g=Object(v.a)(p,a,[],!1,null,null,null);g.options.__hasBlocks={script:!0,template:!0},g.options.__file="client/src/engage_article/components/form/EditArticleContentForm.vue";t.default=g.exports},KRWT:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Form",{staticClass:"tui-articleForm",attrs:{vertical:!0,"input-width":"full"}},[i("FormRow",{staticClass:"tui-articleForm__title",attrs:{hidden:!0,label:e.$str("articletitle","engage_article"),required:!0},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.id;return[i("InputText",{attrs:{id:a,name:"article-title",maxlength:75,placeholder:e.$str("entertitle","engage_article"),disabled:e.submitting,required:!0},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})]}}])}),e._v(" "),i("div",{staticClass:"tui-articleForm__description"},[i("FormRow",{staticClass:"tui-articleForm__description__formRow",attrs:{hidden:!0,label:e.$str("content","engage_article"),required:!0},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.id;return[i("Weka",{attrs:{id:a,component:"engage_article",area:"content",doc:e.content.doc,placeholder:e.$str("entercontent","engage_article")},on:{update:e.handleUpdate}})]}}])}),e._v(" "),i("div",{staticClass:"tui-articleForm__description__tip"},[i("p",[e._v(e._s(e.$str("contributetip","totara_engage")))]),e._v(" "),i("Popover",{attrs:{position:"right"},scopedSlots:e._u([{key:"trigger",fn:function(){return[i("InfoIcon",{attrs:{alt:e.$str("info","moodle")}})]},proxy:!0}])},[e._v(" "),i("p",{staticClass:"tui-articleForm__description__tip__content"},[e._v("\n          "+e._s(e.$str("contributetip_help","totara_engage"))+"\n        ")])])],1)],1),e._v(" "),i("ButtonGroup",{staticClass:"tui-articleForm__buttons"},[i("Button",{attrs:{loading:e.submitting,styleclass:{primary:"true"},disabled:e.disabled,"aria-label":e.$str("createarticleshort","engage_article"),text:e.$str("next","moodle")},on:{click:e.submit}}),e._v(" "),i("CancelButton",{attrs:{disabled:e.submitting},on:{click:function(t){return e.$emit("cancel")}}})],1)],1)};a._withStripped=!0;var n=i("oMuj"),r=i.n(n),s=i("BN8m"),o=i.n(s),l=i("nXMa"),d=i.n(l),c=i("vF5l"),u=i.n(c),m=i("9G+f"),k=i.n(m),p=i("TXEh"),v=i("2wx7"),g=i.n(v),_=i("nEm4"),f=i.n(_),h=i("i/kK"),N=i.n(h),b=i("jAnA"),y=i.n(b),F={components:{InputText:r.a,ButtonGroup:o.a,Button:u.a,CancelButton:d.a,Popover:k.a,Weka:g.a,Form:f.a,FormRow:N.a,InfoIcon:y.a},props:{articleContent:{type:String,default:""},articleName:{type:String,required:!0}},data(){return{name:this.articleName,content:{doc:null,isEmpty:!0,itemId:null},submitting:!1}},computed:{disabled(){return 0===this.name.length||this.content.isEmpty}},watch:{articleContent:{immediate:!0,handler(e){if(e)try{this.content.doc=JSON.parse(e)}catch(e){this.content.doc=null}}}},methods:{handleUpdate(e){this.$_readJson(e)},$_readJson:Object(p.debounce)((function(e){this.content.doc=e.getJSON(),this.content.isEmpty=e.isEmpty(),this.content.itemId=e.getFileStorageItemId()}),250,{perArgs:!1}),submit(){const e={name:this.name,content:JSON.stringify(this.content.doc),itemId:this.content.itemId};this.$emit("next",e)}}},S=i("KHd+"),A=function(e){e.options.__langStrings={moodle:["next","info"],totara_core:["save"],engage_article:["entertitle","entercontent","articletitle","content","createarticleshort"],totara_engage:["contributetip","contributetip_help"]}},x=Object(S.a)(F,a,[],!1,null,null,null);"function"==typeof A&&A(x),x.options.__hasBlocks={script:!0,template:!0},x.options.__file="client/src/engage_article/components/form/ArticleForm.vue";t.default=x.exports},LJiL:function(e,t){e.exports=tui.require("totara_engage/components/sidepanel/access/AccessDisplay")},Mnur:function(e,t){e.exports=tui.require("tui/components/modal/ModalPresenter")},"N/hZ":function(e,t,i){!function(){"use strict";"undefined"!=typeof tui&&tui._bundle.isLoaded("engage_article")?console.warn('[tui bundle] The bundle "engage_article" is already loaded, skipping initialisation.'):(tui._bundle.register("engage_article"),tui._bundle.addModulesFromContext("engage_article/components",i("QH+6")),tui._bundle.addModulesFromContext("engage_article/pages",i("2qtY")))}()},NAOU:function(e,t){e.exports=tui.require("tui/components/grid/Grid")},NAVv:function(e,t){e.exports=tui.require("tui/components/icons/common/Clock")},OhEh:function(e,t){e.exports=tui.require("engage_article/components/sidepanel/content/ArticlePlaylistBox")},"Q/wm":function(e,t){e.exports=tui.require("totara_engage/components/page/BaseLayout")},QGXx:function(e,t){e.exports=tui.require("totara_engage/components/buttons/DoneCancelGroup")},"QH+6":function(e,t,i){var a={"./CreateArticle":"Eivh","./CreateArticle.vue":"Eivh","./card/ArticleCard":"jCpl","./card/ArticleCard.vue":"jCpl","./card/RelatedCard":"ZcP/","./card/RelatedCard.vue":"ZcP/","./content/ArticleContent":"bHkV","./content/ArticleContent.vue":"bHkV","./content/ArticleTitle":"I3CO","./content/ArticleTitle.vue":"I3CO","./form/ArticleForm":"KRWT","./form/ArticleForm.vue":"KRWT","./form/EditArticleContentForm":"KN7I","./form/EditArticleContentForm.vue":"KN7I","./form/EditArticleTitleForm":"GOzR","./form/EditArticleTitleForm.vue":"GOzR","./separator/ArticleSeparator":"q2w6","./separator/ArticleSeparator.vue":"q2w6","./sidepanel/ArticleSidePanel":"qq4O","./sidepanel/ArticleSidePanel.vue":"qq4O","./sidepanel/Related":"mUE/","./sidepanel/Related.vue":"mUE/","./sidepanel/content/ArticlePlaylistBox":"3HPz","./sidepanel/content/ArticlePlaylistBox.vue":"3HPz"};function n(e){var t=r(e);return i(t)}function r(e){if(!i.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}n.keys=function(){return Object.keys(a)},n.resolve=r,e.exports=n,n.id="QH+6"},TXEh:function(e,t){e.exports=tui.require("tui/util")},UpZR:function(e,t){e.exports=tui.require("tui/apollo_client")},W27q:function(e,t){e.exports=tui.require("totara_engage/components/sidepanel/EngageSidePanel")},W9ne:function(e,t){e.exports=tui.require("totara_playlist/components/box/ResourcePlaylistBox")},Xpd9:function(e,t){e.exports=tui.require("totara_engage/components/icons/StatIcon")},ZYet:function(e,t){e.exports=tui.require("engage_article/components/form/ArticleForm")},"ZcP/":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Card",{staticClass:"tui-articleRelatedCard",attrs:{clickable:!0},on:{click:e.handleClickCard}},[i("img",{staticClass:"tui-articleRelatedCard__img",attrs:{src:e.image,alt:e.name}}),e._v(" "),i("section",{staticClass:"tui-articleRelatedCard__content"},[i("a",{attrs:{href:e.$url("/totara/engage/resources/article/index.php",{id:e.resourceId})}},[e._v("\n      "+e._s(e.name)+"\n    ")]),e._v(" "),i("p",[e.timeviewString?i("span",{staticClass:"tui-articleRelatedCard__timeview"},[i("Clock",{attrs:{size:"200",alt:e.$str("clock","totara_engage"),"custom-class":"tui-articleRelatedCard--dimmed"}}),e._v("\n        "+e._s(e.timeviewString)+"\n      ")],1):e._e(),e._v(" "),i("Like",{attrs:{size:"200",alt:e.$str("like","totara_engage"),"custom-class":"tui-articleRelatedCard--dimmed"}}),e._v(" "),i("span",[e._v(e._s(e.reactions))])],1)]),e._v(" "),i("BookmarkButton",{staticClass:"tui-articleRelatedCard__bookmark",attrs:{size:"300",bookmarked:e.innerBookmarked,primary:!1,circle:!1,small:!0,transparent:!0},on:{click:e.handleClickBookmark}})],1)};a._withStripped=!0;var n=i("jJ8l"),r=i.n(n),s=i("NAVv"),o=i.n(s),l=i("oZCW"),d=i.n(l),c=i("tyu8"),u=i("bxuo"),m={components:{BookmarkButton:i.n(u).a,Card:r.a,Clock:o.a,Like:d.a},props:{resourceId:{type:[Number,String],required:!0},name:{type:String,required:!0},bookmarked:{type:Boolean,default:!1},image:{type:String,required:!0},reactions:{type:[Number,String],required:!0},timeview:{type:String,default:""}},data(){return{innerBookmarked:this.bookmarked}},computed:{timeviewString(){return c.TimeViewType.isLessThanFive(this.timeview)?this.$str("timelessthanfive","engage_article"):c.TimeViewType.isFiveToTen(this.timeview)?this.$str("timefivetoten","engage_article"):c.TimeViewType.isMoreThanTen(this.timeview)?this.$str("timemorethanten","engage_article"):""}},methods:{handleClickBookmark(){this.innerBookmarked=!this.innerBookmarked,this.$emit("update",this.resourceId,this.innerBookmarked)},handleClickCard(){window.location.href=this.$url("/totara/engage/resources/article/index.php",{id:this.resourceId})}}},k=i("KHd+"),p=function(e){e.options.__langStrings={totara_engage:["clock","like"],engage_article:["timelessthanfive","timefivetoten","timemorethanten"]}},v=Object(k.a)(m,a,[],!1,null,null,null);"function"==typeof p&&p(v),v.options.__hasBlocks={script:!0,template:!0},v.options.__file="client/src/engage_article/components/card/RelatedCard.vue";t.default=v.exports},bHkV:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-articleContent"},[i("InlineEditing",{directives:[{name:"show",rawName:"v-show",value:!e.editing,expression:"!editing"}],attrs:{"full-width":!0,"absolute-button":!0,"update-able":e.updateAble},on:{click:function(t){e.editing=!0}}},[i("div",{ref:"content",staticClass:"tui-articleContent__content",attrs:{slot:"content"},domProps:{innerHTML:e._s(e.content)},slot:"content"})]),e._v(" "),e.editing?i("EditArticleForm",{attrs:{"resource-id":e.resourceId,submitting:e.submitting},on:{submit:e.updateArticle,cancel:function(t){e.editing=!1}}}):e._e()],1)};a._withStripped=!0;var n=i("g0Fk"),r=i.n(n),s=i("/w+c"),o=i.n(s),l=i("H/tB"),d=i.n(l),c=i("dkcK"),u=i("d4pu"),m={components:{InlineEditing:r.a,EditArticleForm:o.a},props:{resourceId:{type:[String,Number],required:!0},content:{type:String,required:!0},updateAble:{type:Boolean,required:!0}},data:()=>({editing:!1,submitting:!1}),mounted(){this.$_scan()},updated(){this.$_scan()},methods:{$_scan(){this.$nextTick().then(()=>{let e=this.$refs.content;e&&d.a.scan(e)})},updateArticle({content:e,format:t,itemId:i}){this.submitting=!0,this.$apollo.mutate({mutation:c.a,variables:{resourceid:this.resourceId,content:e,format:t,draft_id:i},updateQuery:(e,t)=>{e.writeQuery({query:u.a,variables:{resourceid:this.resourceId},data:t})}}).finally(()=>{this.editing=!1,this.submitting=!1})}}},k=i("KHd+"),p=Object(k.a)(m,a,[],!1,null,null,null);p.options.__hasBlocks={script:!0,template:!0},p.options.__file="client/src/engage_article/components/content/ArticleContent.vue";t.default=p.exports},bxuo:function(e,t){e.exports=tui.require("totara_engage/components/buttons/BookmarkButton")},cBYx:function(e,t){e.exports=tui.require("engage_article/components/content/ArticleContent")},ccUt:function(e,t){e.exports=tui.require("totara_engage/components/card/CardHeader")},d4pu:function(e,t,i){"use strict";t.a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"engage_article_get_article"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"article"},name:{kind:"Name",value:"engage_article_get_article"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resource"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"PLAIN"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"access"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"time"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimagealt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurl"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"email"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"image"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updateable"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"owned"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"topics"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"PLAIN"}}],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"timedescription"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"timeview"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sharedbycount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"bookmarked"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reacted"},arguments:[],directives:[]}]}}]}}]}},dkcK:function(e,t,i){"use strict";t.a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"engage_article_update_article"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resourceid"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"content"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"access"}},type:{kind:"NamedType",name:{kind:"Name",value:"totara_engage_access"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"topics"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"format"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"timeview"}},type:{kind:"NamedType",name:{kind:"Name",value:"totara_engage_timeview"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shares"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"totara_engage_recipient_in"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"draft_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"article"},name:{kind:"Name",value:"engage_article_update"},arguments:[{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"resourceid"},value:{kind:"Variable",name:{kind:"Name",value:"resourceid"}}},{kind:"Argument",name:{kind:"Name",value:"content"},value:{kind:"Variable",name:{kind:"Name",value:"content"}}},{kind:"Argument",name:{kind:"Name",value:"access"},value:{kind:"Variable",name:{kind:"Name",value:"access"}}},{kind:"Argument",name:{kind:"Name",value:"topics"},value:{kind:"Variable",name:{kind:"Name",value:"topics"}}},{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"Variable",name:{kind:"Name",value:"format"}}},{kind:"Argument",name:{kind:"Name",value:"timeview"},value:{kind:"Variable",name:{kind:"Name",value:"timeview"}}},{kind:"Argument",name:{kind:"Name",value:"shares"},value:{kind:"Variable",name:{kind:"Name",value:"shares"}}},{kind:"Argument",name:{kind:"Name",value:"draft_id"},value:{kind:"Variable",name:{kind:"Name",value:"draft_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resource"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"PLAIN"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"access"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"time"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"email"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimagealt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurl"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"image"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"owned"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updateable"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"topics"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"PLAIN"}}],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"timedescription"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"timeview"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sharedbycount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reacted"},arguments:[],directives:[]}]}}]}}]}},dtfu:function(e,t){e.exports=tui.require("tui/components/responsive/Responsive")},dyvz:function(e,t){e.exports=tui.require("totara_engage/components/icons/AddToPlaylist")},e4cB:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Responsive",{staticClass:"tui-articleView"},[e.$apollo.loading?e._e():i("BaseLayout",{staticClass:"tui-articleView__layout",attrs:{"max-page-units":e.units.page,"content-units":e.units.content,"side-panel-units":e.units.sidePanel},scopedSlots:e._u([{key:"content",fn:function(){return[i("CoreGrid",{staticClass:"tui-articleView__headerWrapper",attrs:{"max-units":e.units.content}},[i("GridItem",{attrs:{units:e.units.article}},[i("ArticleTitle",{attrs:{title:e.articleName,"resource-id":e.resourceId,owned:e.article.owned,bookmarked:e.bookmarked,"update-able":e.article.updateable},on:{bookmark:e.updateBookmark}})],1)],1),e._v(" "),i("CoreGrid",{staticClass:"tui-articleView__body",attrs:{"max-units":e.units.content}},[i("GridItem",{attrs:{units:e.units.article}},[i("ArticleContent",{attrs:{"update-able":e.article.updateable,content:e.article.content,"resource-id":e.resourceId}})],1)],1)]},proxy:!0},{key:"sidepanel",fn:function(){return[i("SidePanel",{staticClass:"tui-articleView__sidePanel",attrs:{direction:"rtl","initially-open":!0,instance:e.article,owner:e.article.user,"read-only":e.article.readonly},on:{"sidepanel-expanded":function(t){e.showSidePanel=!0},"sidepanel-collapsed":function(t){e.showSidePanel=!1}}},[i("ArticleSidePanel",{attrs:{"resource-id":e.resourceId}})],1)]},proxy:!0}],null,!1,585273715)})],1)};a._withStripped=!0;var n=i("NAOU"),r=i.n(n),s=i("dtfu"),o=i.n(s),l=i("Q/wm"),d=i.n(l),c=i("D9If"),u=i.n(c),m=i("vLZY"),k=i.n(m),p=i("BaY1"),v=i.n(p),g=i("cBYx"),_=i.n(g),f=i("I9Nn"),h=i.n(f),N=i("d4pu"),b=i("vN5C"),y={components:{ArticleTitle:h.a,SidePanel:v.a,GridItem:u.a,BaseLayout:d.a,Responsive:o.a,CoreGrid:r.a,ArticleSidePanel:k.a,ArticleContent:_.a},props:{resourceId:{type:Number,required:!0}},data:()=>({units:{page:12,content:7,sidePanel:5,article:5},showSidePanel:!0,bookmarked:!1,article:{}}),computed:{articleName(){return this.article.resource&&this.article.resource.name?this.article.resource.name:""}},watch:{showSidePanel(e){e?(this.units.content=7,this.units.sidePanel=5,this.units.article=5):(this.units.content=this.units.page-1,this.units.sidePanel=1,this.units.article=6)}},apollo:{article:{query:N.a,variables(){return{id:this.resourceId}},result({data:{article:e}}){this.bookmarked=e.bookmarked}}},methods:{updateBookmark(){this.bookmarked=!this.bookmarked,this.$apollo.mutate({mutation:b.a,refetchAll:!1,variables:{itemid:this.resourceId,component:"engage_article",bookmarked:this.bookmarked}})}}},F=i("KHd+"),S=function(e){e.options.__langStrings={engage_article:["entercontent","entertitle"]}},A=Object(F.a)(y,a,[],!1,null,null,null);"function"==typeof S&&S(A),A.options.__hasBlocks={script:!0,template:!0},A.options.__file="client/src/engage_article/pages/ArticleView.vue";t.default=A.exports},eE7E:function(e,t){e.exports=tui.require("engage_article/components/card/RelatedCard")},f1n6:function(e,t){e.exports=tui.require("totara_engage/components/modal/EngageWarningModal")},g0Fk:function(e,t){e.exports=tui.require("totara_engage/components/form/InlineEditing")},"i/kK":function(e,t){e.exports=tui.require("tui/components/form/FormRow")},jAnA:function(e,t){e.exports=tui.require("tui/components/icons/common/Info")},jCpl:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("BaseCard",{staticClass:"tui-engageArticle-articleCard",attrs:{"data-card-unique":e.instanceId,href:e.$url("/totara/engage/resources/article/index.php",{id:e.instanceId}),"show-footnotes":e.showFootnotes,footnotes:e.footnotes},on:{mouseover:function(t){return e.$_handleHovered(!0)},mouseleave:function(t){return e.$_handleHovered(!1)}}},[i("ImageHeader",{staticClass:"tui-engageArticle-articleCard__imageheader",attrs:{slot:"header-image","show-cover":e.hovered},slot:"header-image"},[i("img",{staticClass:"tui-engageArticle-articleCard__image",attrs:{slot:"image",alt:e.name,src:e.extraData.image},slot:"image"}),e._v(" "),i("div",{staticClass:"tui-engageArticle-articleCard__icons",attrs:{slot:"actions"},slot:"actions"},e._l(e.actions,(function(e,t){return i("ButtonIcon",{key:t,attrs:{"aria-label":e.alt,styleclass:{primary:!1,circle:!0}}},[i(e.component,{tag:"component"})],1)})),1)]),e._v(" "),i("CardHeader",{staticClass:"tui-engageArticle-articleCard__header",attrs:{slot:"header"},slot:"header"},[i("BookmarkButton",{directives:[{name:"show",rawName:"v-show",value:!e.owned,expression:"!owned"}],staticClass:"tui-engageArticle-articleCard__bookmark",attrs:{slot:"first",size:"300",bookmarked:e.innerBookmarked,primary:!1,circle:!1,small:!0,transparent:!0},on:{click:e.updateBookmark},slot:"first"}),e._v(" "),i("h4",{staticClass:"tui-engageArticle-articleCard__title",attrs:{slot:"second",id:e.labelId},slot:"second"},[e._v("\n      "+e._s(e.name)+"\n    ")]),e._v(" "),e.extraData.timeview?i("div",{staticClass:"tui-engageArticle-articleCard__subTitle",attrs:{slot:"third"},slot:"third"},[i("Clock",{attrs:{size:"200",alt:e.$str("clock","totara_engage"),"custom-class":"tui-icon--dimmed"}}),e._v(" "),i("span",[e._v(e._s(e.getTimeView))])],1):e._e()],1),e._v(" "),i("div",{staticClass:"tui-engageArticle-articleCard__footer",attrs:{slot:"footer"},slot:"footer"},[e._l(e.statIcons,(function(e){return i("StatIcon",{key:e.type,attrs:{icon:e.icon,title:e.title,"stat-number":e.statNumber}})})),e._v(" "),i("AccessIcon",{attrs:{access:e.access,size:"300","custom-class":"tui-engageArticle-articleCard__visibilityIcon"}})],2)],1)};a._withStripped=!0;var n=i("kQ5c"),r=i.n(n),s=i("qyfC"),o=i.n(s),l=i("Xpd9"),d=i.n(l),c=i("ccUt"),u=i.n(c),m=i("5h9J"),k=i.n(m),p=i("6wqy"),v=i.n(p),g=i("dyvz"),_=i.n(g),f=i("9mdZ"),h=i.n(f),N=i("tyu8"),b=i("+1Jo"),y=i.n(b),F=i("NAVv"),S=i.n(F),A=i("bxuo"),x=i.n(A),w=i("vN5C"),C={components:{ButtonIcon:k.a,BaseCard:r.a,ImageHeader:o.a,StatIcon:d.a,CardHeader:u.a,ShareIcon:v.a,AddToPlaylistIcon:_.a,MoreIcon:h.a,AccessIcon:y.a,Clock:S.a,BookmarkButton:x.a},mixins:[N.cardMixin],data(){return{innerBookmarked:this.bookmarked,hovered:!1,statIcons:[{type:"reaction",title:this.$str("numberoflikes","totara_engage",this.totalReactions),icon:"totara_core|like",statNumber:this.totalReactions},{type:"comment",title:this.$str("numberofcomments","totara_engage",this.totalComments),icon:"totara_engage|comment",statNumber:this.totalComments}],actions:[{alt:this.$str("addtoplaylist","engage_article"),component:"AddToPlaylistIcon"},{alt:this.$str("share","totara_engage"),component:"ShareIcon"},{alt:this.$str("more","totara_engage"),component:"MoreIcon"}],extraData:JSON.parse(this.extra)}},computed:{getTimeView(){return N.TimeViewType.isLessThanFive(this.extraData.timeview)?this.$str("timelessthanfive","engage_article"):N.TimeViewType.isFiveToTen(this.extraData.timeview)?this.$str("timefivetoten","engage_article"):N.TimeViewType.isMoreThanTen(this.extraData.timeview)?this.$str("timemorethanten","engage_article"):null}},created(){N.AccessManager.isPublic(this.access)&&(this.statIcons=this.statIcons.concat([{type:"share",title:this.$str("numberofshares","totara_engage",this.sharedbycount),icon:"totara_engage|share",statNumber:this.sharedbycount},{type:"playlistUsage",title:this.$str("numberwithinplaylist","engage_article",this.extraData.usage),icon:"totara_engage|add-to-playlist",statNumber:this.extraData.usage}]))},methods:{$_handleHovered(e){this.hovered=e},updateBookmark(){this.innerBookmarked=!this.innerBookmarked,this.$apollo.mutate({mutation:w.a,refetchAll:!1,refetchQueries:["totara_engage_contribution_cards"],variables:{itemid:this.instanceId,component:"engage_article",bookmarked:this.innerBookmarked}})}}},I=i("KHd+"),T=function(e){e.options.__langStrings={engage_article:["addtoplaylist","numberwithinplaylist","timelessthanfive","timefivetoten","timemorethanten"],totara_engage:["more","share","numberofcomments","numberoflikes","numberofshares","clock"]}},V=Object(I.a)(C,a,[],!1,null,null,null);"function"==typeof T&&T(V),V.options.__hasBlocks={script:!0,template:!0},V.options.__file="client/src/engage_article/components/card/ArticleCard.vue";t.default=V.exports},jJ8l:function(e,t){e.exports=tui.require("tui/components/card/Card")},kQ5c:function(e,t){e.exports=tui.require("totara_engage/components/card/BaseCard")},kZ6F:function(e,t){e.exports=tui.require("engage_article/components/separator/ArticleSeparator")},"mUE/":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-articleRelated"},e._l(e.articles,(function(t){var a=t.bookmarked,n=t.instanceid,r=t.image,s=t.name,o=t.reactions,l=t.timeview;return i("article",{key:n},[i("RelatedCard",{attrs:{"resource-id":n,bookmarked:a,image:r,name:s,reactions:o,timeview:l},on:{update:e.update}})],1)})),0)};a._withStripped=!0;var n=i("eE7E"),r=i.n(n),s={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ml_recommender_get_recommended_articles"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"article_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"cursor"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"cursor"},name:{kind:"Name",value:"ml_recommender_recommended_articles_cursor"},arguments:[{kind:"Argument",name:{kind:"Name",value:"article_id"},value:{kind:"Variable",name:{kind:"Name",value:"article_id"}}},{kind:"Argument",name:{kind:"Name",value:"cursor"},value:{kind:"Variable",name:{kind:"Name",value:"cursor"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"total"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"next"},arguments:[],directives:[]}]}},{kind:"Field",alias:{kind:"Name",value:"articles"},name:{kind:"Name",value:"ml_recommender_recommended_articles"},arguments:[{kind:"Argument",name:{kind:"Name",value:"article_id"},value:{kind:"Variable",name:{kind:"Name",value:"article_id"}}},{kind:"Argument",name:{kind:"Name",value:"cursor"},value:{kind:"Variable",name:{kind:"Name",value:"cursor"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"instanceid"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"PLAIN"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"summary"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tuicomponent"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"access"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"comments"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reactions"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"timecreated"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sharedbycount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"bookmarked"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"extra"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"owned"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurl"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimagealt"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"topics"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"PLAIN"}}],directives:[]}]}}]}}]}}]},o=i("vN5C"),l={components:{RelatedCard:r.a},props:{resourceId:{type:[Number,String],required:!0}},data:()=>({articles:[]}),mounted(){this.getRecommendations()},methods:{getRecommendations(){this.$apollo.mutate({mutation:s,refetchAll:!1,variables:{article_id:this.resourceId}}).then(({data:e})=>{this.articles=e.articles.map(e=>{const{bookmarked:t,extra:i,name:a,instanceid:n,reactions:r}=e,{image:s,timeview:o}=JSON.parse(i);return{bookmarked:t,instanceid:n,image:s,name:a,reactions:r,timeview:o}})})},update(e,t){this.$apollo.mutate({mutation:o.a,refetchAll:!1,variables:{itemid:e,component:"engage_article",bookmarked:t}})}}},d=i("KHd+"),c=Object(d.a)(l,a,[],!1,null,null,null);c.options.__hasBlocks={script:!0,template:!0},c.options.__file="client/src/engage_article/components/sidepanel/Related.vue";t.default=c.exports},nEm4:function(e,t){e.exports=tui.require("tui/components/form/Form")},nWV2:function(e,t){e.exports=tui.require("engage_article/components/sidepanel/Related")},nXMa:function(e,t){e.exports=tui.require("tui/components/buttons/Cancel")},oMuj:function(e,t){e.exports=tui.require("tui/components/form/InputText")},oZCW:function(e,t){e.exports=tui.require("tui/components/icons/common/Like")},q2w6:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"tui-articleSeparator"})};a._withStripped=!0;var n=i("KHd+"),r=Object(n.a)({},a,[],!1,null,null,null);r.options.__hasBlocks={script:!1,template:!0},r.options.__file="client/src/engage_article/components/separator/ArticleSeparator.vue";t.default=r.exports},qq4O:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.$apollo.loading?e._e():i("EngageSidePanel",{staticClass:"tui-articleSidePanel",attrs:{"user-full-name":e.user.fullname,"user-email":e.userEmail,"user-id":e.user.id,owned:e.article.owned,"user-profile-image-alt":e.user.profileimagealt||"","user-profile-image-url":e.user.profileimageurl,actions:e.actions},scopedSlots:e._u([{key:"modal",fn:function(){return[i("ModalPresenter",{attrs:{open:e.openModalFromAction},on:{"request-close":function(t){e.openModalFromAction=!1}}},[i("EngageWarningModal",{attrs:{title:e.$str("deletewarningtitle","engage_article"),"message-content":e.$str("deletewarningmsg","engage_article")},on:{delete:e.handleDelete}})],1)]},proxy:!0},{key:"overview",fn:function(){return[i("Loader",{attrs:{fullpage:!0,loading:e.submitting}}),e._v(" "),i("p",{staticClass:"tui-articleSidePanel__timeDescription"},[e._v("\n      "+e._s(e.article.timedescription)+"\n    ")]),e._v(" "),e.article.owned?i("AccessSetting",{attrs:{"item-id":e.resourceId,component:"engage_article","access-value":e.article.resource.access,topics:e.article.topics,submitting:!1,"open-modal":e.openModalFromButtonLabel,"selected-time-view":e.article.timeview,"enable-time-view":!0},on:{"access-update":e.updateAccess,"close-modal":function(t){e.openModalFromButtonLabel=!1}}}):i("AccessDisplay",{attrs:{"access-value":e.article.resource.access,"time-view":e.article.timeview,topics:e.article.topics,"show-button":!1}}),e._v(" "),i("MediaSetting",{attrs:{owned:e.article.owned,"access-value":e.article.resource.access,"instance-id":e.resourceId,"shared-by-count":e.article.sharedbycount,"like-button-aria-label":e.likeButtonLabel,liked:e.article.reacted,"component-name":"engage_article"},on:{"access-update":e.updateAccess,"access-modal":function(t){e.openModalFromButtonLabel=!0},"update-like-status":e.updateLikeStatus}}),e._v(" "),i("ArticlePlaylistBox",{staticClass:"tui-articleSidePanel__playlistBox",attrs:{"resource-id":e.resourceId}})]},proxy:!0},{key:"comments",fn:function(){return[i("SidePanelCommentBox",{attrs:{component:"engage_article",area:"comment","instance-id":e.resourceId}})]},proxy:!0},{key:"related",fn:function(){return[i("Related",{attrs:{component:"engage_article",area:"related","resource-id":e.resourceId}})]},proxy:!0}],null,!1,2772993086)})};a._withStripped=!0;var n=i("UpZR"),r=i.n(n),s=i("AdjL"),o=i.n(s),l=i("Mnur"),d=i.n(l),c=i("5v9U"),u=i.n(c),m=i("LJiL"),k=i.n(m),p=i("sy3s"),v=i.n(p),g=i("W27q"),_=i.n(g),f=i("f1n6"),h=i.n(f),N=i("FhEx"),b=i.n(N),y=i("OhEh"),F=i.n(y),S=i("nWV2"),A=i.n(S),x=i("d4pu"),w=i("dkcK"),C={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"engage_article_delete_article"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resourceid"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"result"},name:{kind:"Name",value:"engage_article_delete"},arguments:[{kind:"Argument",name:{kind:"Name",value:"resourceid"},value:{kind:"Variable",name:{kind:"Name",value:"resourceid"}}}],directives:[]}]}}]},I={components:{AccessDisplay:k.a,AccessSetting:v.a,ArticlePlaylistBox:F.a,EngageSidePanel:_.a,EngageWarningModal:h.a,Loader:o.a,MediaSetting:b.a,ModalPresenter:d.a,Related:A.a,SidePanelCommentBox:u.a},props:{resourceId:{type:[Number,String],required:!0}},apollo:{article:{query:x.a,variables(){return{id:this.resourceId}}}},data:()=>({article:{},submitting:!1,openModalFromButtonLabel:!1,openModalFromAction:!1}),computed:{user(){return this.article.resource&&this.article.resource.user?this.article.resource.user:{}},userEmail(){return this.user.email||""},actions(){return[{label:this.$str("delete","moodle"),action:this.$_requestConfirm.bind(this)}]},sharedByCount(){return this.article.sharedByCount},likeButtonLabel(){return this.article.reacted?this.$str("removelikearticle","engage_article",this.article.resource.name):this.$str("likearticle","engage_article",this.article.resource.name)}},methods:{$_requestConfirm(){this.openModalFromAction=!0},updateAccess({access:e,topics:t,shares:i,timeView:a}){this.submitting=!0,this.$apollo.mutate({mutation:w.a,refetchAll:!1,variables:{resourceid:this.resourceId,access:e,topics:t.map(({id:e})=>e),shares:i,timeview:a},update:(e,{data:t})=>{e.writeQuery({query:x.a,variables:{id:this.resourceId},data:t})}}).finally(()=>{this.submitting=!1})},handleDelete(){this.$apollo.mutate({mutation:C,variables:{resourceid:this.resourceId},refetchAll:!1}).then(({data:e})=>{e.result&&(this.$children.openModal=!1,window.location.href=this.$url("/totara/engage/your_resources.php"))})},updateLikeStatus(e){let{article:t}=r.a.readQuery({query:x.a,variables:{id:this.resourceId}});t=Object.assign({},t),t.reacted=e,r.a.writeQuery({query:x.a,variables:{id:this.resourceId},data:{article:t}})}}},T=i("KHd+"),V=function(e){e.options.__langStrings={engage_article:["deletewarningmsg","deletewarningtitle","timelessthanfive","timefivetoten","timemorethanten","likearticle","removelikearticle"],moodle:["delete"]}},q=Object(T.a)(I,a,[],!1,null,null,null);"function"==typeof V&&V(q),q.options.__hasBlocks={script:!0,template:!0},q.options.__file="client/src/engage_article/components/sidepanel/ArticleSidePanel.vue";t.default=q.exports},qyfC:function(e,t){e.exports=tui.require("totara_engage/components/card/ImageHeader")},sy3s:function(e,t){e.exports=tui.require("totara_engage/components/sidepanel/access/AccessSetting")},tyu8:function(e,t){e.exports=tui.require("totara_engage/index")},vF5l:function(e,t){e.exports=tui.require("tui/components/buttons/Button")},vLZY:function(e,t){e.exports=tui.require("engage_article/components/sidepanel/ArticleSidePanel")},vN5C:function(e,t,i){"use strict";t.a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_engage_update_bookmark"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"itemid"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"component"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_component"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bookmarked"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_boolean"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"result"},name:{kind:"Name",value:"totara_engage_update_bookmark"},arguments:[{kind:"Argument",name:{kind:"Name",value:"itemid"},value:{kind:"Variable",name:{kind:"Name",value:"itemid"}}},{kind:"Argument",name:{kind:"Name",value:"component"},value:{kind:"Variable",name:{kind:"Name",value:"component"}}},{kind:"Argument",name:{kind:"Name",value:"bookmarked"},value:{kind:"Variable",name:{kind:"Name",value:"bookmarked"}}}],directives:[]}]}}]}},wBfT:function(e,t){e.exports=tui.require("engage_article/components/form/EditArticleTitleForm")}});