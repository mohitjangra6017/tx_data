!function(e){function t(t){for(var i,o,l=t[0],m=t[1],d=t[2],u=0,c=[];u<l.length;u++)o=l[u],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&c.push(a[o][0]),a[o]=0;for(i in m)Object.prototype.hasOwnProperty.call(m,i)&&(e[i]=m[i]);for(s&&s(t);c.length;)c.shift()();return r.push.apply(r,d||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],i=!0,l=1;l<n.length;l++){var m=n[l];0!==a[m]&&(i=!1)}i&&(r.splice(t--,1),e=o(o.s=n[0]))}return e}var i={},a={8:0},r=[];function o(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=i,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(n,i,function(t){return e[t]}.bind(null,i));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var l=window.webpackJsonp=window.webpackJsonp||[],m=l.push.bind(l);l.push=t,l=l.slice();for(var d=0;d<l.length;d++)t(l[d]);var s=m;r.push(["VhP1",0]),n()}({"088a":function(e,t){e.exports=tui.require("totara_comment/components/buttons/ReplyButtonIcon")},"0VQe":function(e,t){e.exports=tui.require("totara_comment/components/reply/Reply")},"0viy":function(e,t){e.exports=tui.require("tui/components/icons/common/Spinner")},"1R7l":function(e,t){e.exports=tui.require("totara_reaction/components/SimpleLike")},"2rKr":function(e,t){e.exports=tui.require("totara_comment/components/form/EditCommentReplyForm")},"2wx7":function(e,t){e.exports=tui.require("editor_weka/components/Weka")},"3wZ/":function(e,t){e.exports=tui.require("tui/components/icons/common/Warning")},"5Dry":function(e,t,n){"use strict";t.a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"totara_comment_get_comments"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"component"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_component"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"area"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_area"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"instanceid"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"cursor"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"cursor"},name:{kind:"Name",value:"totara_comment_comment_cursor"},arguments:[{kind:"Argument",name:{kind:"Name",value:"component"},value:{kind:"Variable",name:{kind:"Name",value:"component"}}},{kind:"Argument",name:{kind:"Name",value:"area"},value:{kind:"Variable",name:{kind:"Name",value:"area"}}},{kind:"Argument",name:{kind:"Name",value:"instance_id"},value:{kind:"Variable",name:{kind:"Name",value:"instanceid"}}},{kind:"Argument",name:{kind:"Name",value:"cursor"},value:{kind:"Variable",name:{kind:"Name",value:"cursor"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"total"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"next"},arguments:[],directives:[]}]}},{kind:"Field",alias:{kind:"Name",value:"comments"},name:{kind:"Name",value:"totara_comment_comments"},arguments:[{kind:"Argument",name:{kind:"Name",value:"component"},value:{kind:"Variable",name:{kind:"Name",value:"component"}}},{kind:"Argument",name:{kind:"Name",value:"area"},value:{kind:"Variable",name:{kind:"Name",value:"area"}}},{kind:"Argument",name:{kind:"Name",value:"instanceid"},value:{kind:"Variable",name:{kind:"Name",value:"instanceid"}}},{kind:"Argument",name:{kind:"Name",value:"cursor"},value:{kind:"Variable",name:{kind:"Name",value:"cursor"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimagealt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurl"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"timedescription"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"totalreplies"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"totalreactions"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"edited"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"deleted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reasondeleted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"interactor"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_delete"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_report"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_update"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_reply"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_react"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reacted"},arguments:[],directives:[]}]}}]}}]}}]}},"5G/C":function(e,t){e.exports=tui.require("totara_comment/components/content/CommentReplyContent")},"5h9J":function(e,t){e.exports=tui.require("tui/components/buttons/ButtonIcon")},"7oeD":function(e,t,n){"use strict";t.a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"totara_comment_get_editor_weka"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"component"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_component"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"area"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_area"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"comment_area"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"totara_comment_area"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"editor"},name:{kind:"Name",value:"totara_comment_editor_weka"},arguments:[{kind:"Argument",name:{kind:"Name",value:"component"},value:{kind:"Variable",name:{kind:"Name",value:"component"}}},{kind:"Argument",name:{kind:"Name",value:"area"},value:{kind:"Variable",name:{kind:"Name",value:"area"}}},{kind:"Argument",name:{kind:"Name",value:"comment_area"},value:{kind:"Variable",name:{kind:"Name",value:"comment_area"}}},{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"showtoolbar"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"extensions"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tuicomponent"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"options"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"instance_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"context_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"area"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"repository_data"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"item_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"repository_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"files"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"file_size"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"filename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[{kind:"Argument",name:{kind:"Name",value:"force_download"},value:{kind:"BooleanValue",value:!0}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"mime_type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"media_type"},arguments:[],directives:[]}]}}]}}]}}]}},"9Lfe":function(e,t,n){"use strict";n.r(t);var i=n("n41h");n.d(t,"SIZE_LARGE",(function(){return i.SIZE_LARGE})),n.d(t,"SIZE_SMALL",(function(){return i.SIZE_SMALL})),n.d(t,"isValid",(function(){return i.isValid}))},AfSn:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tui-commentActionLink"},[e.linkText?n("a",{staticClass:"tui-commentActionLink__link",class:{"tui-commentActionLink__link--small":e.isSmall,"tui-commentActionLink__link--disabled":e.loading||!e.showLoadMore},attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.handleClick(t)}}},[n("span",[e._v(e._s(e.linkText))])]):e._e()])};i._withStripped=!0;var a=n("CKzT"),r={props:{loading:{type:Boolean,default:!1},showLoadMore:{type:Boolean,default:!1},size:{type:String,default:function(){return a.SIZE_SMALL},validator:function(e){return Object(a.isValid)(e)}}},computed:{isSmall:function(){return a.SIZE_SMALL===this.size},linkText:function(){return this.showLoadMore?this.$str("loadmorecomments","totara_comment"):""}},methods:{handleClick:function(){this.loading||this.showLoadMore&&this.$emit("load-more")}}},o=n("KHd+"),l=function(e){e.options.__langStrings={totara_comment:["loadmorecomments"]}},m=Object(o.a)(r,i,[],!1,null,null,null);"function"==typeof l&&l(m),m.options.__hasBlocks={script:!0,template:!0},m.options.__file="client/src/totara_comment/components/action/CommentActionLink.vue";t.default=m.exports},BN8m:function(e,t){e.exports=tui.require("tui/components/buttons/ButtonGroup")},CKzT:function(e,t){e.exports=tui.require("totara_comment/index")},E75b:function(e,t){e.exports=tui.require("totara_comment/components/form/CommentForm")},Edwj:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tui-commentBox",class:{"tui-commentBox--withBorder":e.withBorder,"tui-commentBox--noForm":!e.commentAble||!e.showCommentForm}},[n("CommentThread",{ref:"comment-thread",staticClass:"tui-commentBox__comments",attrs:{size:e.size,component:e.component,area:e.area,"instance-id":e.instanceId,submitting:e.innerSubmitting,"show-like-button-text":e.showLikeButtonText,"show-reply-button-text":e.showReplyButtonText,"with-border":e.withBorder,"first-cursor":e.firstCursor,"comment-inline-head":e.commentInlineHead},on:{"update-submitting":function(t){return e.$emit("update-submitting",t)},"fetch-comments":function(t){return e.$emit("fetch-comments",t)}}}),e._v(" "),e.commentAble?[n("CommentForm",{directives:[{name:"show",rawName:"v-show",value:!e.$apollo.queries.totalComments.loading&&e.showCommentForm,expression:"!$apollo.queries.totalComments.loading && showCommentForm"}],ref:"comment-form",staticClass:"tui-commentBox__commentForm",class:{"tui-commentBox__commentForm--withBorder":e.withBorder},attrs:{area:e.area,component:e.component,"instance-id":e.instanceId,size:e.size,"submit-button-text":e.submitFormButtonText},on:{"form-ready":e.formReady,submit:e.createComment}})]:e._e()],2)};i._withStripped=!0;var a=n("o0o1"),r=n.n(a),o=n("yXPU"),l=n.n(o),m=n("E75b"),d=n.n(m),s=n("yAFK"),u=n("Xkrd"),c=n.n(u),p=n("5Dry"),v={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_comment_create_comment"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"content"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"component"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_component"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"area"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_area"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"instanceid"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"format"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"draft_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"comment"},name:{kind:"Name",value:"totara_comment_create_comment"},arguments:[{kind:"Argument",name:{kind:"Name",value:"content"},value:{kind:"Variable",name:{kind:"Name",value:"content"}}},{kind:"Argument",name:{kind:"Name",value:"component"},value:{kind:"Variable",name:{kind:"Name",value:"component"}}},{kind:"Argument",name:{kind:"Name",value:"area"},value:{kind:"Variable",name:{kind:"Name",value:"area"}}},{kind:"Argument",name:{kind:"Name",value:"instanceid"},value:{kind:"Variable",name:{kind:"Name",value:"instanceid"}}},{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"Variable",name:{kind:"Name",value:"format"}}},{kind:"Argument",name:{kind:"Name",value:"draft_id"},value:{kind:"Variable",name:{kind:"Name",value:"draft_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimagealt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurl"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"timedescription"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"totalreplies"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"totalreactions"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"edited"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"deleted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reasondeleted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"interactor"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_delete"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_report"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_update"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_reply"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_react"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reacted"},arguments:[],directives:[]}]}}]}}]}}]},k={components:{CommentThread:c.a,CommentForm:d.a},apollo:{totalComments:{query:p.a,watchLoading:function(e){this.$emit("fetch-comments",e)},variables:function(){return{component:this.component,area:this.area,instanceid:this.instanceId,cursor:this.firstCursor}},update:function(e){var t=e.cursor.total;return parseInt(t,10)},result:function(e){var t=e.data.cursor.total;this.$emit("update-total-comments",t)}}},props:{firstCursor:{type:String,default:null},size:{type:String,required:!0,validator:function(e){return Object(s.isValid)(e)}},component:{type:String,required:!0},area:{type:String,required:!0},instanceId:{type:[String,Number],required:!0},submitting:Boolean,showLikeButtonText:Boolean,showReplyButtonText:Boolean,submitFormButtonText:String,withBorder:Boolean,showCommentForm:{type:Boolean,default:!0},commentAble:{type:Boolean,default:!0},commentInlineHead:Boolean},data:function(){return{totalComments:0,innerSubmitting:this.Boolean,commentsLoaded:!1}},watch:{submitting:function(e){e!==this.innerSubmitting&&(this.innerSubmitting=e)},innerSubmitting:function(e){e!==this.submitting&&this.$emit("update-submitting",e)}},methods:{$_scrollCollectionToBottom:function(){var e=this;this.$nextTick().then((function(){var t=e.$refs["comment-thread"];t&&(t.$el.scrollTop=t.$el.scrollHeight)}))},formReady:function(){var e=this;return l()(r.a.mark((function t(){var n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$nextTick();case 2:if(n=e.$refs["comment-form"]){t.next=5;break}return t.abrupt("return");case 5:n.$el&&(n=n.$el),e.$emit("form-ready",n);case 7:case"end":return t.stop()}}),t)})))()},createComment:function(e){var t=this,n=e.content,i=e.format,a=e.itemId;return l()(r.a.mark((function e(){var o,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.innerSubmitting){e.next=2;break}return e.abrupt("return");case 2:return t.innerSubmitting=!0,e.prev=3,e.next=6,t.$apollo.mutate({mutation:v,refetchAll:!1,variables:{content:n,format:i,component:t.component,area:t.area,instanceid:t.instanceId,draft_id:a},update:function(e,n){var i=n.data.comment,a={component:t.component,area:t.area,instanceid:t.instanceId,cursor:t.firstCursor},r=e.readQuery({query:p.a,variables:a}),o=r.cursor,l=r.comments;(o=Object.assign({},o)).total+=1,e.writeQuery({query:p.a,variables:a,data:{cursor:o,comments:Array.prototype.concat.call(l,[i])}})}});case 6:o=e.sent,l=o.data.comment,t.$_scrollCollectionToBottom(),t.$emit("create-comment",l);case 10:return e.prev=10,t.innerSubmitting=!1,e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[3,,10,13]])})))()}}},f=n("KHd+"),_=function(e){e.options.__langStrings={totara_comment:["comments"]}},y=Object(f.a)(k,i,[],!1,null,null,null);"function"==typeof _&&_(y),y.options.__hasBlocks={script:!0,template:!0},y.options.__file="client/src/totara_comment/components/box/CommentBox.vue";t.default=y.exports},FoZm:function(e,t){e.exports=tui.require("tui/format")},GoPO:function(e,t){e.exports=tui.require("totara_comment/components/modal/ConfirmDeleteCommentReplyModal")},"H/tB":function(e,t){e.exports=tui.require("tui/tui")},HNaS:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this.$createElement;return(this._self._c||e)("a",{staticClass:"tui-commentUserLink",class:{"tui-commentUserLink--small":this.isSmall,"tui-commentUserLink--large":this.isLarge},attrs:{href:this.profileUrl}},[this._v("\n  "+this._s(this.userFullName)+"\n")])};i._withStripped=!0;var a=n("yAFK"),r={props:{userFullName:{type:String,required:!0},profileUrl:{type:String,required:!0},size:{type:String,default:function(){return a.SIZE_SMALL},validator:function(e){return Object(a.isValid)(e)}}},computed:{isSmall:function(){return a.SIZE_SMALL===this.size},isLarge:function(){return a.SIZE_LARGE===this.size}}},o=n("KHd+"),l=Object(o.a)(r,i,[],!1,null,null,null);l.options.__hasBlocks={script:!0,template:!0},l.options.__file="client/src/totara_comment/components/profile/CommentUserLink.vue";t.default=l.exports},IKdh:function(e,t){e.exports=tui.require("totara_comment/components/profile/CommentUserLink")},JeSu:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this.$createElement,t=this._self._c||e;return t("a",{attrs:{href:this.profileUrl}},[t("CoreAvatar",{attrs:{src:this.imageSrc,alt:this.imageAlt,size:"xxsmall"}})],1)};i._withStripped=!0;var a=n("Xi9X"),r={components:{CoreAvatar:n.n(a).a},props:{imageSrc:{required:!0,type:String},imageAlt:{required:!0,type:String},profileUrl:{required:!0,type:String}}},o=n("KHd+"),l=Object(o.a)(r,i,[],!1,null,null,null);l.options.__hasBlocks={script:!0,template:!0},l.options.__file="client/src/totara_comment/components/profile/CommentAvatar.vue";t.default=l.exports},"K9M+":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ResponseBox",{staticClass:"tui-commentForm"},[n("Form",{staticClass:"tui-commentForm__form"},[e.$apollo.queries.editorOption.loading?e._e():n("Weka",{key:e.editorKey,staticClass:"tui-commentForm__form__editor",attrs:{"data-key":e.editorKey,area:"comment",component:"totara_comment",option:e.editorOption,doc:e.content.doc,placeholder:e.$str("entercomment","totara_comment")},on:{"editor-mounted":function(t){return e.$emit("form-ready")},update:e.onUpdate}}),e._v(" "),n("ButtonGroup",{staticClass:"tui-commentForm__form__buttonGroup"},[n("Button",{staticClass:"tui-commentForm__form__buttonGroup__button",attrs:{text:e.submitButtonText,"aria-label":e.submitButtonText,disabled:e.content.empty||e.submitting,styleclass:{primary:!0,small:e.isSmall}},on:{click:e.submit}})],1)],1)],1)};i._withStripped=!0;var a=n("o0o1"),r=n.n(a),o=n("yXPU"),l=n.n(o),m=n("2wx7"),d=n.n(m),s=n("nEm4"),u=n.n(s),c=n("TXEh"),p=n("BN8m"),v=n.n(p),k=n("vF5l"),f=n.n(k),_=n("FoZm"),y=n("yAFK"),g=n("nGKo"),b=n.n(g),N=n("7oeD"),h={components:{Weka:d.a,Form:u.a,ButtonGroup:v.a,Button:f.a,ResponseBox:b.a},props:{size:{type:String,default:function(){return y.SIZE_SMALL},validator:function(e){return Object(y.isValid)(e)}},component:{type:String,required:!0},area:{type:String,required:!0},instanceId:{type:[String,Number],required:!0},submitting:Boolean,submitButtonText:{type:String,default:function(){return this.$str("post","totara_comment")}}},apollo:{editorOption:{query:N.a,variables:function(){return{component:this.component,area:this.area,comment_area:"COMMENT"}},update:function(e){return e.editor}}},data:function(){return{editorKey:"totara_comment_editor_weka_".concat(Object(c.uniqueId)()),editorOption:null,content:{doc:null,empty:!0,itemId:null}}},computed:{isSmall:function(){return y.SIZE_SMALL===this.size}},methods:{$_readJson:Object(c.debounce)((function(e){this.content.doc=e.getJSON(),this.content.empty=e.isEmpty(),this.content.itemId=e.getFileStorageItemId()}),100,{}),onUpdate:function(e){this.$_readJson(e)},submit:function(){var e=this;return l()(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.submitting){t.next=2;break}return t.abrupt("return");case 2:return e.$emit("submit",{content:JSON.stringify(e.content.doc),format:_.FORMAT_JSON_EDITOR,itemId:e.content.itemId}),e.content.doc=null,e.content.empty=!0,e.content.itemId=null,t.next=8,e.$apollo.queries.editorOption.refetch();case 8:e.editorKey="totara_comment_editor_weka_".concat(Object(c.uniqueId)()),e.$forceUpdate();case 10:case"end":return t.stop()}}),t)})))()}}},S=n("KHd+"),F=function(e){e.options.__langStrings={totara_comment:["post","entercomment"]}},x=Object(S.a)(h,i,[],!1,null,null,null);"function"==typeof F&&F(x),x.options.__hasBlocks={script:!0,template:!0},x.options.__file="client/src/totara_comment/components/form/CommentForm.vue";t.default=x.exports},KGcv:function(e,t){e.exports=tui.require("tui/components/dropdown/DropdownItem")},Mbwj:function(e,t,n){var i={".":"9Lfe","./":"9Lfe","./index":"9Lfe","./index.js":"9Lfe","./size":"n41h","./size.js":"n41h"};function a(e){var t=r(e);return n(t)}function r(e){if(!n.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}a.keys=function(){return Object.keys(i)},a.resolve=r,e.exports=a,a.id="Mbwj"},Mnur:function(e,t){e.exports=tui.require("tui/components/modal/ModalPresenter")},NnhT:function(e,t){e.exports=tui.require("totara_comment/components/profile/CommentAvatar")},NroB:function(e,t,n){var i={"./action/CommentAction":"brKu","./action/CommentAction.vue":"brKu","./action/CommentActionDropDown":"pktG","./action/CommentActionDropDown.vue":"pktG","./action/CommentActionLink":"AfSn","./action/CommentActionLink.vue":"AfSn","./box/CommentBox":"Edwj","./box/CommentBox.vue":"Edwj","./box/CommentThread":"WOGm","./box/CommentThread.vue":"WOGm","./box/ReplyBox":"oiZQ","./box/ReplyBox.vue":"oiZQ","./box/SidePanelCommentBox":"WmQn","./box/SidePanelCommentBox.vue":"WmQn","./buttons/ReplyButtonIcon":"O0kx","./buttons/ReplyButtonIcon.vue":"O0kx","./card/CommentCard":"gJK8","./card/CommentCard.vue":"gJK8","./card/CommentReplyHeader":"WOGa","./card/CommentReplyHeader.vue":"WOGa","./card/ReplyCard":"xtKj","./card/ReplyCard.vue":"xtKj","./comment/Comment":"iPrX","./comment/Comment.vue":"iPrX","./content/CommentReplyContent":"eHKF","./content/CommentReplyContent.vue":"eHKF","./form/CommentForm":"K9M+","./form/CommentForm.vue":"K9M+","./form/EditCommentReplyForm":"nQzs","./form/EditCommentReplyForm.vue":"nQzs","./form/ReplyForm":"WGWU","./form/ReplyForm.vue":"WGWU","./form/box/ResponseBox":"bJ7b","./form/box/ResponseBox.vue":"bJ7b","./form/group/SubmitCancelButtonsGroup":"YwYG","./form/group/SubmitCancelButtonsGroup.vue":"YwYG","./icons/Menu":"ttGn","./icons/Menu.vue":"ttGn","./modal/ConfirmDeleteCommentReplyModal":"xpT8","./modal/ConfirmDeleteCommentReplyModal.vue":"xpT8","./profile/CommentAvatar":"JeSu","./profile/CommentAvatar.vue":"JeSu","./profile/CommentUserLink":"HNaS","./profile/CommentUserLink.vue":"HNaS","./reply/Reply":"ZEEp","./reply/Reply.vue":"ZEEp"};function a(e){var t=r(e);return n(t)}function r(e){if(!n.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}a.keys=function(){return Object.keys(i)},a.resolve=r,e.exports=a,a.id="NroB"},O0kx:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ButtonIcon",{staticClass:"tui-replyButtonIcon",attrs:{"aria-label":e.$str("reply","totara_comment"),text:e.buttonText,styleclass:e.buttonStyleClass,disabled:e.disabled},on:{click:function(t){return e.$emit("click",t)}}},[n("ReplyIcon",{attrs:{size:e.iconSize}})],1)};i._withStripped=!0;var a=n("5h9J"),r=n.n(a),o=n("ltL4"),l=n.n(o),m={components:{ButtonIcon:r.a,ReplyIcon:l.a},props:{iconSize:[String,Number],showText:Boolean,transparent:{type:Boolean,default:!0},disabled:Boolean,small:{type:Boolean,default:!0}},computed:{buttonText:function(){return this.showText?this.$str("reply","totara_comment"):""},buttonStyleClass:function(){return{transparentNoPadding:this.transparent,small:this.small}}}},d=n("KHd+"),s=function(e){e.options.__langStrings={totara_comment:["reply"]}},u=Object(d.a)(m,i,[],!1,null,null,null);"function"==typeof s&&s(u),u.options.__hasBlocks={script:!0,template:!0},u.options.__file="client/src/totara_comment/components/buttons/ReplyButtonIcon.vue";t.default=u.exports},"TGM/":function(e,t){e.exports=tui.require("tui/pending")},TXEh:function(e,t){e.exports=tui.require("tui/util")},Tqau:function(e,t){e.exports=tui.require("totara_comment/components/card/CommentReplyHeader")},UpZR:function(e,t){e.exports=tui.require("tui/apollo_client")},VhP1:function(e,t,n){!function(){"use strict";"undefined"!=typeof tui&&tui._bundle.isLoaded("totara_comment")?console.warn('[tui bundle] The bundle "totara_comment" is already loaded, skipping initialisation.'):(tui._bundle.register("totara_comment"),tui._bundle.addModulesFromContext("totara_comment",n("Mbwj")),tui._bundle.addModulesFromContext("totara_comment/components",n("NroB")))}()},WGWU:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ResponseBox",{staticClass:"tui-replyForm"},[n("Form",{staticClass:"tui-replyForm__form"},[e.$apollo.queries.editorOption.loading?e._e():n("Weka",{staticClass:"tui-replyForm__form__editor",attrs:{component:"totara_comment",area:"reply",option:e.editorOption,doc:e.content.doc,placeholder:e.$str("enterreply","totara_comment")},on:{update:e.update,"editor-mounted":function(t){return e.$emit("form-ready")}}}),e._v(" "),n("SubmitCancelButtonsGroup",{attrs:{"submit-text":e.$str("reply","totara_comment"),size:e.size,"disable-submit":e.content.empty||e.submitting,"disable-cancel":e.submitting},on:{"click-submit":e.submit,"click-cancel":function(t){return e.$emit("cancel")}}})],1)],1)};i._withStripped=!0;var a=n("2wx7"),r=n.n(a),o=n("nEm4"),l=n.n(o),m=n("p9yr"),d=n.n(m),s=n("FoZm"),u=n("TXEh"),c=n("ibac"),p=n("yAFK"),v=n("nGKo"),k=n.n(v),f=n("7oeD"),_={components:{Weka:r.a,Form:l.a,SubmitCancelButtonsGroup:d.a,ResponseBox:k.a},props:{size:{type:String,default:function(){return p.SIZE_SMALL},validator:function(e){return Object(p.isValid)(e)}},component:{type:String,required:!0},area:{type:String,required:!0},commentId:{type:[String,Number],required:!0},submitting:Boolean,replyTo:{type:Object,default:function(){return null}}},apollo:{editorOption:{query:f.a,variables:function(){return{area:this.area,component:this.component,comment_area:"REPLY"}},update:function(e){return e.editor}}},data:function(){return{editorOption:null,content:{doc:null,empty:!0,itemId:null}}},computed:{isSmall:function(){return p.SIZE_SMALL===this.size}},watch:{replyTo:{deep:!0,immediate:!0,handler:function(e){if(!e)return this.content.doc=null,void(this.content.empty=!0);this.content.doc=Object(c.createMentionContent)(e),this.content.empty=!1}}},methods:{$_readJSON:Object(u.debounce)((function(e){this.content.doc=e.getJSON(),this.content.empty=e.isEmpty(),this.content.itemId=e.getFileStorageItemId()}),100),update:function(e){this.$_readJSON(e)},submit:function(){this.submitting||(this.$emit("submit",{content:JSON.stringify(this.content.doc),format:s.FORMAT_JSON_EDITOR,commentId:this.commentId}),this.content.doc=null,this.content.empty=!0,this.content.itemId=null)}}},y=n("KHd+"),g=function(e){e.options.__langStrings={totara_comment:["enterreply","reply"]}},b=Object(y.a)(_,i,[],!1,null,null,null);"function"==typeof g&&g(b),b.options.__hasBlocks={script:!0,template:!0},b.options.__file="client/src/totara_comment/components/form/ReplyForm.vue";t.default=b.exports},WOGa:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tui-commentReplyHeader"},[n("ModalPresenter",{attrs:{open:e.openModal},on:{"request-close":function(t){e.openModal=!1}}},[n("ConfirmDeleteCommentReplyModal",{on:{"confirm-delete":e.confirmDelete,"request-close":function(t){e.openModal=!1}}})],1),e._v(" "),n("div",{staticClass:"tui-commentReplyHeader__content",class:{"tui-commentReplyHeader__content--inline":e.inlineHead}},[n("CommentUserLink",{staticClass:"tui-commentReplyHeader__content__link",class:{"tui-commentReplyHeader__content__link--inline":e.inlineHead},attrs:{size:e.size,"profile-url":e.profileUrl,"user-full-name":e.userFullName}}),e._v(" "),n("p",{staticClass:"tui-commentReplyHeader__content__timeDescription",class:{"tui-commentReplyHeader__content__timeDescription--inline":e.inlineHead}},[n("span",[e._v(e._s(e.timeDescription))]),e._v(" "),e.edited?n("span",[e._v(e._s(e.$str("edited","totara_comment")))]):e._e()])],1),e._v(" "),n("CommentActionDropDown",{staticClass:"tui-commentReplyHeader__menu",attrs:{"show-delete-action":e.deleteAble,"show-update-action":e.updateAble,"show-report-action":e.reportAble},on:{"click-edit":function(t){return e.$emit("click-edit")},"click-report-content":function(t){return e.$emit("click-report-content")},"click-delete":function(t){e.openModal=!0}}})],1)};i._withStripped=!0;var a=n("IKdh"),r=n.n(a),o=n("jUiv"),l=n.n(o),m=n("yAFK"),d=n("GoPO"),s=n.n(d),u=n("Mnur"),c=n.n(u),p={components:{CommentUserLink:r.a,CommentActionDropDown:l.a,ConfirmDeleteCommentReplyModal:s.a,ModalPresenter:c.a},props:{size:{type:String,default:function(){return m.SIZE_SMALL},validator:function(e){return Object(m.isValid)(e)}},profileUrl:{type:String,required:!0},userFullName:{type:String,required:!0},timeDescription:{type:String,required:!0},deleteAble:{type:Boolean,default:!1},updateAble:{type:Boolean,default:!1},reportAble:{type:Boolean,default:!1},edited:{type:Boolean,required:!0},inlineHead:Boolean},data:function(){return{openModal:!1}},methods:{confirmDelete:function(){this.openModal=!1,this.$emit("confirm-delete")}}},v=n("KHd+"),k=function(e){e.options.__langStrings={totara_comment:["edited"]}},f=Object(v.a)(p,i,[],!1,null,null,null);"function"==typeof k&&k(f),f.options.__hasBlocks={script:!0,template:!0},f.options.__file="client/src/totara_comment/components/card/CommentReplyHeader.vue";t.default=f.exports},WOGm:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"comments",staticClass:"tui-commentThread"},[n("CommentActionLink",{staticClass:"tui-commentThread__actionLink",class:{"tui-commentThread__actionLink--withBorder":e.withBorder},attrs:{size:e.size,"show-load-more":e.hasMoreComments,loading:e.$apollo.queries.thread.loading},on:{"load-more":e.loadMore}}),e._v(" "),n("div",{staticClass:"tui-commentThread__comments"},[e._l(e.thread.comments,(function(t,i){return[n("Comment",{key:t.id,staticClass:"tui-commentThread__comments__comment",class:{"tui-commentThread__comments__comment--large":e.isLarge,"tui-commentThread__comments__comment--withBorderBottom":e.withBorder},attrs:{"data-counter":i,content:t.content,"comment-id":t.id,"user-full-name":t.user.fullname,"user-id":t.user.id,"user-profile-image-url":t.user.profileimageurl,"user-profile-image-alt":t.user.profileimagealt,"time-description":t.timedescription,"total-replies":t.totalreplies,"delete-able":t.interactor.can_delete,"update-able":t.interactor.can_update,"report-able":t.interactor.can_report,"reply-able":t.interactor.can_reply,"react-able":t.interactor.can_react,edited:t.edited,deleted:t.deleted,component:e.component,area:e.area,size:e.size,"instance-id":e.instanceId,submitting:e.submitting,"total-reactions":t.totalreactions,reacted:t.interactor.reacted,"show-like-button-text":e.showLikeButtonText,"show-reply-button-text":e.showReplyButtonText,"inline-head":e.commentInlineHead},on:{"update-submitting":function(t){return e.$emit("update-submitting",t)},"update-comment":e.updateCommentsCache,"delete-comment":e.updateCommentsCache,"add-reply":e.addReplyToComment,"update-react-status":e.updateReactStatus}})]}))],2)],1)};i._withStripped=!0;var a=n("o0o1"),r=n.n(a),o=n("yXPU"),l=n.n(o),m=n("w20f"),d=n.n(m),s=n("yAFK"),u=n("sqa2"),c=n.n(u),p=n("UpZR"),v=n.n(p),k=n("5Dry"),f={components:{Comment:d.a,CommentActionLink:c.a},props:{firstCursor:{type:String,default:null},size:{type:String,required:!0,validator:function(e){return Object(s.isValid)(e)}},component:{type:String,required:!0},area:{type:String,required:!0},instanceId:{type:[String,Number],required:!0},submitting:Boolean,showLikeButtonText:Boolean,showReplyButtonText:Boolean,withBorder:Boolean,commentInlineHead:Boolean},apollo:{thread:{query:k.a,watchLoading:function(e){this.$emit("fetch-comments",e)},variables:function(){return{component:this.component,area:this.area,instanceid:this.instanceId,cursor:this.firstCursor}},update:function(e){return{cursor:e.cursor,comments:e.comments}},result:function(e){var t=e.data,n=t.comments,i=t.cursor;this.hasMoreComments=n.length<i.total,this.$emit("update-total-comments",i.total)}}},data:function(){return{loading:0,hasMoreComments:!1,thread:{comments:[],cursor:null}}},computed:{isLarge:function(){return s.SIZE_LARGE===this.size}},methods:{loadMore:function(){var e=this;return l()(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$apollo.queries.thread.fetchMore({variables:{component:e.component,area:e.area,instanceid:e.instanceId,cursor:e.thread.cursor.next},updateQuery:function(t,n){var i=n.fetchMoreResult,a=i.comments,r=i.cursor,o=Array.prototype.slice.call(t.comments);return a=Array.prototype.filter.call(a,(function(e){return void 0===Array.prototype.find.call(o,(function(t){return e.id==t.id}))})),a=Array.prototype.concat.call(a,o),e.hasMoreComments=a.length<r.total,{comments:a,cursor:r}}});case 2:case"end":return t.stop()}}),t)})))()},updateCommentsCache:function(e){var t={instanceid:this.instanceId,component:this.component,area:this.area,cursor:this.firstCursor},n=v.a.readQuery({query:k.a,variables:t}),i=n.comments,a=n.cursor;v.a.writeQuery({query:k.a,variables:t,data:{count:a,comments:Array.prototype.map.call(i,(function(t){return t.id==e.id?e:t}))}})},addReplyToComment:function(e){var t={instanceid:this.instanceId,component:this.component,area:this.area,cursor:this.firstCursor},n=v.a.readQuery({query:k.a,variables:t}),i=n.comments,a=n.cursor;v.a.writeQuery({query:k.a,variables:t,data:{cursor:a,comments:Array.prototype.map.call(i,(function(t){if(e==t.id){var n=Object.assign({},t);return n.totalreplies+=1,n}return t}))}})},updateReactStatus:function(e){var t=e.id,n=e.status,i={instanceid:this.instanceId,component:this.component,area:this.area,cursor:this.firstCursor},a=v.a.readQuery({query:k.a,variables:i}),r=a.comments,o=a.cursor;v.a.writeQuery({query:k.a,variables:i,data:{cursor:o,comments:Array.prototype.map.call(r,(function(e){if(e.id==t){var i=Object.assign({},e),a=Object.assign({},i.interactor);return a.reacted=n,i.interactor=a,n?i.totalreactions+=1:0!=i.totalreactions&&(i.totalreactions-=1),i}return e}))}})}}},_=n("KHd+"),y=Object(_.a)(f,i,[],!1,null,null,null);y.options.__hasBlocks={script:!0,template:!0},y.options.__file="client/src/totara_comment/components/box/CommentThread.vue";t.default=y.exports},WmQn:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tui-sidePanelCommentBox"},[n("h4",{staticClass:"tui-sidePanelCommentBox__header"},[n("span",[e._v(e._s(e.$str("comments","totara_comment",e.totalComments)))]),e._v(" "),e.submitting?n("Spinner"):e._e()],1),e._v(" "),n("CommentBox",{staticClass:"tui-sidePanelCommentBox__box",attrs:{"instance-id":e.instanceId,component:e.component,area:e.area,size:e.size,submitting:e.submitting},on:{"update-total-comments":function(t){e.totalComments=t},"update-submitting":function(t){e.submitting=t}}})],1)};i._withStripped=!0;var a=n("Z82V"),r=n.n(a),o=n("yAFK"),l=n("0viy"),m=n.n(l),d={components:{CommentBox:r.a,Spinner:m.a},props:{component:{type:String,required:!0},area:{type:String,required:!0},instanceId:{type:[String,Number],required:!0}},data:function(){return{size:o.SIZE_SMALL,totalComments:0,submitting:!1}}},s=n("KHd+"),u=function(e){e.options.__langStrings={totara_comment:["comments"]}},c=Object(s.a)(d,i,[],!1,null,null,null);"function"==typeof u&&u(c),c.options.__hasBlocks={script:!0,template:!0},c.options.__file="client/src/totara_comment/components/box/SidePanelCommentBox.vue";t.default=c.exports},Xi9X:function(e,t){e.exports=tui.require("tui/components/avatar/Avatar")},Xkrd:function(e,t){e.exports=tui.require("totara_comment/components/box/CommentThread")},YwYG:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ButtonGroup",{staticClass:"tui-submitCancelButtonGroup"},[n("Button",{staticClass:"tui-submitCancelButtonGroup__submit",attrs:{text:e.submitText,styleclass:{primary:!0,small:e.isSmall},disabled:e.disableSubmit},on:{click:function(t){return t.preventDefault(),e.$emit("click-submit")}}}),e._v(" "),n("Button",{staticClass:"tui-submitCancelButtonGroup__cancel",attrs:{text:e.$str("cancel","moodle"),styleclass:{small:e.isSmall},disabled:e.disableCancel},on:{click:function(t){return t.preventDefault(),e.$emit("click-cancel")}}})],1)};i._withStripped=!0;var a=n("BN8m"),r=n.n(a),o=n("vF5l"),l=n.n(o),m=n("yAFK"),d={components:{ButtonGroup:r.a,Button:l.a},props:{disableSubmit:{type:Boolean,default:!1},disableCancel:{type:Boolean,default:!1},submitText:{type:String,required:!0},size:{type:String,default:function(){return m.SIZE_SMALL},validator:function(e){return Object(m.isValid)(e)}}},computed:{isSmall:function(){return m.SIZE_SMALL==this.size}}},s=n("KHd+"),u=function(e){e.options.__langStrings={moodle:["cancel"]}},c=Object(s.a)(d,i,[],!1,null,null,null);"function"==typeof u&&u(c),c.options.__hasBlocks={script:!0,template:!0},c.options.__file="client/src/totara_comment/components/form/group/SubmitCancelButtonsGroup.vue";t.default=c.exports},Z82V:function(e,t){e.exports=tui.require("totara_comment/components/box/CommentBox")},ZEEp:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ReplyCard",{staticClass:"tui-reply",attrs:{"data-id":e.replyId}},[n("Avatar",{attrs:{slot:"profile-picture","image-src":e.userProfileImageUrl,"image-alt":e.userProfileImageAlt,"profile-url":e.profileUrl},slot:"profile-picture"}),e._v(" "),n("ReplyHeader",{attrs:{slot:"body-header",size:e.size,"user-full-name":e.userFullName,"profile-url":e.profileUrl,"time-description":e.timeDescription,edited:e.edited,"update-able":e.updateAble,"delete-able":e.deleteAble,"report-able":e.reportAble,"inline-head":e.inlineHead},on:{"confirm-delete":e.deleteReply,"click-report-content":e.reportReply,"click-edit":function(t){e.editting=!0}},slot:"body-header"}),e._v(" "),n("ReplyContent",{attrs:{slot:"body-content","item-id":e.replyId,deleted:e.deleted,"on-edit":e.editting,content:e.content,"is-reply":!0,size:e.size},on:{"cancel-editing":function(t){e.editting=!1},"update-item":e.updateReply},slot:"body-content"}),e._v(" "),e.canInteract?n("CommentAction",{staticClass:"tui-reply__footer",attrs:{slot:"body-footer",size:e.size,"comment-id":e.replyId,"total-reactions":e.totalReactions,reacted:e.reacted,"react-able":e.reactAble,"reply-able":e.replyAble,"show-reply-button-text":e.showReplyButtonText,"show-like-button-text":e.showLikeButtonText,area:"reply"},on:{"click-reply":e.handleReply,"update-react-status":e.updateReactStatus},slot:"body-footer"}):e._e()],1)};i._withStripped=!0;var a=n("o0o1"),r=n.n(a),o=n("yXPU"),l=n.n(o),m=n("NnhT"),d=n.n(m),s=n("kJKs"),u=n.n(s),c=n("p7Bt"),p=n.n(c),v=n("yAFK"),k=n("Tqau"),f=n.n(k),_=n("5G/C"),y=n.n(_),g=n("vyVp"),b={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_comment_update_reply"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"content"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"format"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"draft_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"reply"},name:{kind:"Name",value:"totara_comment_update_reply"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"content"},value:{kind:"Variable",name:{kind:"Name",value:"content"}}},{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"Variable",name:{kind:"Name",value:"format"}}},{kind:"Argument",name:{kind:"Name",value:"draft_id"},value:{kind:"Variable",name:{kind:"Name",value:"draft_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"edited"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"deleted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"commentid"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"timedescription"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimagealt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurl"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"totalreactions"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reasondeleted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"interactor"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_delete"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_report"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_update"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_react"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_follow_reply"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reacted"},arguments:[],directives:[]}]}}]}}]}}]},N={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_comment_delete_reply"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"reply"},name:{kind:"Name",value:"totara_comment_delete_reply"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"edited"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"deleted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"commentid"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"timedescription"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimagealt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurl"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"totalreactions"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reasondeleted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"interactor"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_delete"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_report"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_update"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_react"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_follow_reply"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reacted"},arguments:[],directives:[]}]}}]}}]}}]},h=n("hiKM"),S={components:{ReplyHeader:f.a,CommentAction:p.a,ReplyCard:u.a,Avatar:d.a,ReplyContent:y.a},props:{replyId:{type:[Number,String],required:!0},commentId:{type:[String,Number],required:!0},submitting:Boolean,userFullName:{type:String,required:!0},userId:{type:[String,Number],required:!0},userProfileImageUrl:{type:String,required:!0},userProfileImageAlt:{type:String,default:""},timeDescription:{type:String,required:!0},reportAble:{type:Boolean,required:!0},content:{type:String,required:!0},deleteAble:{type:Boolean,required:!0},updateAble:{type:Boolean,required:!0},size:{type:String,default:function(){return v.SIZE_SMALL},validator:function(e){return Object(v.isValid)(e)}},edited:{type:Boolean,required:!0},deleted:{type:Boolean,required:!0},totalReactions:[Number,String],reacted:Boolean,replyAble:{type:Boolean,default:!0},reactAble:{type:Boolean,default:!0},showLikeButtonText:Boolean,showReplyButtonText:Boolean,inlineHead:Boolean},data:function(){return{editting:!1,innerSubmitting:this.submitting}},computed:{profileUrl:function(){return this.$url("/user/profile.php",{id:this.userId})},canInteract:function(){return this.replyAble||this.reactAble}},watch:{innerSubmitting:function(e){e!==this.submitting&&this.$emit("update-submitting",e)},submitting:function(e){e!==this.innerSubmitting&&(this.innerSubmitting=!0)}},methods:{handleReply:function(){var e={fullname:this.userFullName,userId:this.userId};this.$emit("reply-to",e)},updateReply:function(e){var t=this,n=e.id,i=e.content,a=e.format,o=e.itemId;return l()(r.a.mark((function e(){var l,m;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.innerSubmitting){e.next=2;break}return e.abrupt("return");case 2:return t.innerSubmitting=!0,e.prev=3,e.next=6,t.$apollo.mutate({mutation:b,refetchAll:!1,variables:{id:n,content:i,format:a,draft_id:o}});case 6:l=e.sent,m=l.data.reply,t.editting=!1,t.$emit("update-reply",m);case 10:return e.prev=10,t.innerSubmitting=!1,e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[3,,10,13]])})))()},deleteReply:function(e){var t=this;return l()(r.a.mark((function n(){var i,a;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.innerSubmitting){n.next=2;break}return n.abrupt("return");case 2:return t.innerSubmitting=!0,n.prev=3,n.next=6,t.$apollo.mutate({mutation:N,refetchAll:!1,variables:{id:e}});case 6:i=n.sent,a=i.data.reply,t.$emit("delete-reply",a);case 9:return n.prev=9,t.innerSubmitting=!1,n.finish(9);case 12:case"end":return n.stop()}}),n,null,[[3,,9,12]])})))()},reportReply:function(){var e=this;return l()(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.innerSubmitting){t.next=2;break}return t.abrupt("return");case 2:return e.innerSubmitting=!0,t.prev=3,t.next=6,e.$apollo.mutate({mutation:h.a,refetchAll:!1,variables:{component:e.component,area:e.area,item_id:e.commentId,instance_id:e.instanceId,url:window.location.href}});case 6:return t.next=8,Object(g.notify)({duration:2e3,message:e.$str("reported","totara_reportedcontent"),type:"success"});case 8:t.next=14;break;case 10:return t.prev=10,t.t0=t.catch(3),t.next=14,Object(g.notify)({duration:2e3,message:e.$str("reported_failed","totara_reportedcontent"),type:"error"});case 14:return t.prev=14,e.innerSubmitting=!1,t.finish(14);case 17:case"end":return t.stop()}}),t,null,[[3,10,14,17]])})))()},updateReactStatus:function(e){this.$emit("update-react-status",{id:this.replyId,status:e})}}},F=n("KHd+"),x=function(e){e.options.__langStrings={totara_reportedcontent:["reported","reported_failed"]}},C=Object(F.a)(S,i,[],!1,null,null,null);"function"==typeof x&&x(C),C.options.__hasBlocks={script:!0,template:!0},C.options.__file="client/src/totara_comment/components/reply/Reply.vue";t.default=C.exports},bJ7b:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tui-responseBox"},[e.$apollo.loading?e._e():n("div",{staticClass:"tui-responseBox__profilePicture"},[n("Avatar",{attrs:{"image-alt":e.user.profileimagealt||"","image-src":e.user.profileimageurl,"profile-url":e.$url("/user/profile.php",{id:e.user.id})}})],1),e._v(" "),n("div",{staticClass:"tui-responseBox__formBox"},[e._t("default")],2)])};i._withStripped=!0;var a=n("NnhT"),r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"totara_comment_get_actor"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"user"},name:{kind:"Name",value:"totara_comment_actor"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurl"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimagealt"},arguments:[],directives:[]}]}}]}}]},o={components:{Avatar:n.n(a).a},apollo:{user:{query:r}},data:function(){return{user:{}}}},l=n("KHd+"),m=Object(l.a)(o,i,[],!1,null,null,null);m.options.__hasBlocks={script:!0,template:!0},m.options.__file="client/src/totara_comment/components/form/box/ResponseBox.vue";t.default=m.exports},brKu:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tui-commentAction"},[n("SimpleLike",{attrs:{"instance-id":e.commentId,component:"totara_comment",area:e.area,"total-likes":e.totalReactions,liked:e.reacted,"button-aria-label":e.likeButtonAriaLabel,disabled:!e.reactAble,"show-text":e.showLikeButtonText},on:{"update-like-status":function(t){return e.$emit("update-react-status",t)},"created-like":function(t){return e.$emit("update-react-status",!0)},"removed-like":function(t){return e.$emit("update-react-status",!1)}}}),e._v(" "),n("div",{staticClass:"tui-commentAction__replyBox"},[n("ReplyButtonIcon",{attrs:{"show-text":e.showReplyButtonText,disabled:!e.replyAble},on:{click:function(t){return e.$emit("click-reply")}}}),e._v(" "),e.totalReplies?n("span",{staticClass:"tui-commentAction__replyBox__text",class:{"tui-commentAction__replyBox__text--small":e.isSmall}},[e._v("\n      "+e._s(e.$str("bracketnumber","totara_comment",e.totalReplies))+"\n    ")]):e._e()],1)],1)};i._withStripped=!0;var a=n("088a"),r=n.n(a),o=n("yAFK"),l=n("1R7l"),m=n.n(l),d={components:{ReplyButtonIcon:r.a,SimpleLike:m.a},props:{commentId:{type:[Number,String],required:!0},area:{type:String,required:!0,validator:function(e){return["comment","reply"].includes(e)}},size:{type:String,default:function(){return o.SIZE_SMALL},validator:function(e){return Object(o.isValid)(e)}},totalReplies:{type:[Number,String],default:0},totalReactions:[Number,String],reacted:Boolean,reactAble:{type:Boolean,default:!0},replyAble:{type:Boolean,default:!0},showLikeButtonText:Boolean,showReplyButtonText:Boolean},computed:{isSmall:function(){return o.SIZE_SMALL===this.size},likeButtonAriaLabel:function(){return this.reacted?this.$str("removelikeforcomment","totara_comment"):this.$str("likecomment","totara_comment")}}},s=n("KHd+"),u=function(e){e.options.__langStrings={totara_comment:["bracketnumber","likecomment","removelikeforcomment"]}},c=Object(s.a)(d,i,[],!1,null,null,null);"function"==typeof u&&u(c),c.options.__hasBlocks={script:!0,template:!0},c.options.__file="client/src/totara_comment/components/action/CommentAction.vue";t.default=c.exports},eHKF:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tui-commentReplyContent"},[e.onEdit?n("EditForm",{staticClass:"tui-commentReplyContent__editForm",attrs:{"item-id":e.itemId,size:e.size},on:{cancel:function(t){return e.$emit("cancel-editing")},"update-item":function(t){return e.$emit("update-item",t)}}}):n("div",{ref:"content",staticClass:"tui-commentReplyContent__content",class:{"tui-commentReplyContent__content--reply":e.isReply,"tui-commentReplyContent__content--deleted":e.deleted},domProps:{innerHTML:e._s(e.content)}})],1)};i._withStripped=!0;var a=n("H/tB"),r=n.n(a),o=n("2rKr"),l=n.n(o),m=n("yAFK"),d={components:{EditForm:l.a},props:{content:{type:String,required:!0},onEdit:{type:Boolean,default:!1},itemId:{type:[Number,String],required:!0,validator:function(e){return!isNaN(e)}},isReply:{type:Boolean,default:!1},deleted:{type:Boolean,required:!0},size:{type:String,default:function(){return m.SIZE_SMALL},validator:function(e){return Object(m.isValid)(e)}}},mounted:function(){this.$_scan()},updated:function(){this.$_scan()},methods:{$_scan:function(){var e=this.$refs.content;e&&r.a.scan(e)}}},s=n("KHd+"),u=Object(s.a)(d,i,[],!1,null,null,null);u.options.__hasBlocks={script:!0,template:!0},u.options.__file="client/src/totara_comment/components/content/CommentReplyContent.vue";t.default=u.exports},gJK8:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tui-commentCard"},[n("div",{staticClass:"tui-commentCard__comment"},[n("div",{staticClass:"tui-commentCard__comment__profilePicture"},[e._t("profile-picture")],2),e._v(" "),n("div",{staticClass:"tui-commentCard__comment__body"},[n("div",{staticClass:"tui-commentCard__comment__body__header"},[e._t("body-header")],2),e._v(" "),n("div",{staticClass:"tui-commentCard__comment__body__content"},[e._t("body-content")],2),e._v(" "),n("div",{staticClass:"tui-commentCard__comment__body__footer"},[e._t("body-footer")],2)])]),e._v(" "),n("div",{staticClass:"tui-commentCard__replyBox"},[e._t("reply-box")],2)])};i._withStripped=!0;var a=n("KHd+"),r=Object(a.a)({},i,[],!1,null,null,null);r.options.__hasBlocks={script:!1,template:!0},r.options.__file="client/src/totara_comment/components/card/CommentCard.vue";t.default=r.exports},gLvT:function(e,t){e.exports=tui.require("tui/components/dropdown/Dropdown")},hCGN:function(e,t){e.exports=tui.require("tui/components/icons/common/More")},hiKM:function(e,t,n){"use strict";t.a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_reportedcontent_create_review"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"component"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_component"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"area"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_area"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"instance_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"item_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"url"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_url"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"review"},name:{kind:"Name",value:"totara_reportedcontent_create_review"},arguments:[{kind:"Argument",name:{kind:"Name",value:"component"},value:{kind:"Variable",name:{kind:"Name",value:"component"}}},{kind:"Argument",name:{kind:"Name",value:"area"},value:{kind:"Variable",name:{kind:"Name",value:"area"}}},{kind:"Argument",name:{kind:"Name",value:"instance_id"},value:{kind:"Variable",name:{kind:"Name",value:"instance_id"}}},{kind:"Argument",name:{kind:"Name",value:"item_id"},value:{kind:"Variable",name:{kind:"Name",value:"item_id"}}},{kind:"Argument",name:{kind:"Name",value:"url"},value:{kind:"Variable",name:{kind:"Name",value:"url"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]}]}}]}}]}},iPrX:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("CommentCard",{staticClass:"tui-comment",attrs:{"data-id":e.commentId}},[n("Avatar",{attrs:{slot:"profile-picture","image-src":e.userProfileImageUrl,"image-alt":e.userProfileImageAlt||e.userFullName,"profile-url":e.profileUrl},slot:"profile-picture"}),e._v(" "),n("CommentHeader",{attrs:{slot:"body-header",size:e.size,"profile-url":e.profileUrl,"user-full-name":e.userFullName,"time-description":e.timeDescription,"update-able":e.updateAble,"delete-able":e.deleteAble,"report-able":e.reportAble,edited:e.edited,"inline-head":e.inlineHead},on:{"click-edit":function(t){e.showForm.comment=!0},"confirm-delete":e.deleteComment,"click-report-content":e.reportComment},slot:"body-header"}),e._v(" "),n("CommentContent",{attrs:{slot:"body-content",deleted:e.deleted,"item-id":e.commentId,content:e.content,"on-edit":e.showForm.comment,"is-reply":!1,size:e.size},on:{"cancel-editing":function(t){e.showForm.comment=!1},"update-item":e.updateComment},slot:"body-content"}),e._v(" "),e.canInteract?n("CommentAction",{staticClass:"tui-comment__footer",attrs:{slot:"body-footer","total-replies":e.totalReplies,size:e.size,"comment-id":e.commentId,"total-reactions":e.totalReactions,reacted:e.reacted,"react-able":e.reactAble,"reply-able":e.replyAble,"show-like-button-text":e.showLikeButtonText,"show-reply-button-text":e.showReplyButtonText,area:"comment"},on:{"click-reply":e.handleReply,"update-react-status":e.updateReactStatus},slot:"body-footer"}):e._e(),e._v(" "),n("ReplyBox",{ref:"reply-box",staticClass:"tui-comment__replyBox",attrs:{slot:"reply-box","reply-able":e.replyAble,"comment-id":e.commentId,area:e.area,component:e.component,"show-reply-form":e.showForm.reply,"total-replies":e.totalReplies,submitting:e.innerSubmitting,size:e.size,"show-like-button-text":e.showLikeButtonText,"show-reply-button-text":e.showReplyButtonText,"reply-to":e.replyTo,"reply-head-inline":e.inlineHead},on:{"update-show-reply-form":function(t){e.showForm.reply=t},"create-reply":function(t){return e.$emit("add-reply",e.commentId)},"update-submitting":function(t){return e.$emit("update-submitting",t)},"form-ready":function(t){e.replyForm=t},"update-reply-to":function(t){e.replyTo=t},"scroll-to-reply-form":e.scrollToReplyForm,"fetch-replies":function(t){e.fetchingReplies=t}},slot:"reply-box"})],1)};i._withStripped=!0;var a=n("o0o1"),r=n.n(a),o=n("yXPU"),l=n.n(o),m=n("rkhB"),d=n.n(m),s=n("NnhT"),u=n.n(s),c=n("p7Bt"),p=n.n(c),v=n("yAFK"),k=n("Tqau"),f=n.n(k),_=n("5G/C"),y=n.n(_),g=n("ixux"),b=n.n(g),N=n("vyVp"),h=n("TGM/"),S=n.n(h),F={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_comment_update_comment"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"content"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"format"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"draft_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"comment"},name:{kind:"Name",value:"totara_comment_update_comment"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"content"},value:{kind:"Variable",name:{kind:"Name",value:"content"}}},{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"Variable",name:{kind:"Name",value:"format"}}},{kind:"Argument",name:{kind:"Name",value:"draft_id"},value:{kind:"Variable",name:{kind:"Name",value:"draft_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimagealt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurl"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"timedescription"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"totalreplies"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"totalreactions"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"edited"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"deleted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reasondeleted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"interactor"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_delete"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_report"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_update"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_reply"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_react"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reacted"},arguments:[],directives:[]}]}}]}}]}}]},x={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_comment_delete_comment"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"comment"},name:{kind:"Name",value:"totara_comment_delete_comment"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimagealt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurl"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"timedescription"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"totalreplies"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"totalreactions"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"edited"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"deleted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reasondeleted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"interactor"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_delete"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_report"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_update"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_reply"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_react"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reacted"},arguments:[],directives:[]}]}}]}}]}}]},C=n("hiKM"),w={components:{ReplyBox:b.a,CommentHeader:f.a,CommentAction:p.a,CommentCard:d.a,Avatar:u.a,CommentContent:y.a},props:{commentId:{required:!0,type:[String,Number]},component:{type:String,required:!0},area:{type:String,required:!0},instanceId:{type:[String,Number],required:!0},submitting:Boolean,totalReplies:{type:[Number,String],required:!0},totalReactions:[Number,String],reacted:Boolean,timeDescription:{type:String,required:!0},reportAble:{type:Boolean,required:!0},content:{type:String,required:!0},deleteAble:{type:Boolean,required:!0},updateAble:{type:Boolean,required:!0},replyAble:{type:Boolean,default:!0},reactAble:{type:Boolean,default:!0},userFullName:{type:String,required:!0},userId:{type:[String,Number],required:!0},userProfileImageUrl:{type:String,required:!0},userProfileImageAlt:{type:String},size:{type:String,default:function(){return v.SIZE_SMALL},validator:function(e){return Object(v.isValid)(e)}},edited:{type:Boolean,required:!0},deleted:{type:Boolean,required:!0},showLikeButtonText:Boolean,showReplyButtonText:Boolean,inlineHead:Boolean},data:function(){return{showForm:{reply:!1,comment:!1},innerSubmitting:this.submitting,replyTo:null,replyForm:null,fetchingReplies:!1}},computed:{canInteract:function(){return this.replyAble||this.reactAble},profileUrl:function(){return this.$url("/user/profile.php",{id:this.userId})}},watch:{innerSubmitting:function(e){e!==this.submitting&&this.$emit("update-submitting",e)},submitting:function(e){e!==this.innerSubmitting&&(this.innerSubmitting=e)}},methods:{$_completeFetchingReplies:function(){var e=this;return l()(r.a.mark((function t(){var n,i;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.fetchingReplies){t.next=2;break}return t.abrupt("return");case 2:return n=S()("totara_comment_fetching_replies"),i=function t(i){setTimeout((function(){e.fetchingReplies?t(i):(n(),i())}),100)},t.abrupt("return",new Promise(i));case 4:case"end":return t.stop()}}),t)})))()},updateComment:function(e){var t=this,n=e.content,i=e.id,a=e.format,o=e.itemId;return l()(r.a.mark((function e(){var l,m;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.innerSubmitting){e.next=2;break}return e.abrupt("return");case 2:return t.innerSubmitting=!0,e.prev=3,e.next=6,t.$apollo.mutate({mutation:F,refetchAll:!1,variables:{id:i,content:n,format:a,draft_id:o}});case 6:l=e.sent,m=l.data.comment,t.$emit("update-comment",m),t.showForm.comment=!1;case 10:return e.prev=10,t.innerSubmitting=!1,e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[3,,10,13]])})))()},deleteComment:function(){var e=this;return l()(r.a.mark((function t(){var n,i;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.innerSubmitting){t.next=2;break}return t.abrupt("return");case 2:return e.innerSubmitting=!0,t.prev=3,t.next=6,e.$apollo.mutate({mutation:x,refetchAll:!1,variables:{id:e.commentId}});case 6:n=t.sent,i=n.data.comment,e.$emit("delete-comment",i);case 9:return t.prev=9,e.innerSubmitting=!1,t.finish(9);case 12:case"end":return t.stop()}}),t,null,[[3,,9,12]])})))()},reportComment:function(){var e=this;return l()(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.innerSubmitting){t.next=2;break}return t.abrupt("return");case 2:return e.innerSubmitting=!0,t.prev=3,t.next=6,e.$apollo.mutate({mutation:C.a,refetchAll:!1,variables:{component:e.component,area:e.area,item_id:e.commentId,instance_id:e.instanceId,url:window.location.href}});case 6:return t.next=8,Object(N.notify)({duration:2e3,message:e.$str("reported","totara_reportedcontent"),type:"success"});case 8:t.next=14;break;case 10:return t.prev=10,t.t0=t.catch(3),t.next=14,Object(N.notify)({duration:2e3,message:e.$str("reported_failed","totara_reportedcontent"),type:"error"});case 14:return t.prev=14,e.innerSubmitting=!1,t.finish(14);case 17:case"end":return t.stop()}}),t,null,[[3,10,14,17]])})))()},updateReactStatus:function(e){this.$emit("update-react-status",{status:e,id:this.commentId})},handleReply:function(){var e=this;return l()(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.showForm.reply=!0,null!==e.replyTo&&(e.replyTo=null),t.next=4,e.scrollToReplyForm();case 4:case"end":return t.stop()}}),t)})))()},scrollToReplyForm:function(){var e=this;return l()(r.a.mark((function t(){var n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.$refs["reply-box"]){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,n.$nextTick();case 5:if(!e.fetchingReplies){t.next=10;break}return t.next=8,e.$_completeFetchingReplies();case 8:return t.next=10,n.$nextTick();case 10:e.replyForm&&e.replyForm.scrollIntoView(!1);case 11:case"end":return t.stop()}}),t)})))()}}},B=n("KHd+"),A=function(e){e.options.__langStrings={totara_reportedcontent:["reported","reported_failed"]}},R=Object(B.a)(w,i,[],!1,null,null,null);"function"==typeof A&&A(R),R.options.__hasBlocks={script:!0,template:!0},R.options.__file="client/src/totara_comment/components/comment/Comment.vue";t.default=R.exports},ibac:function(e,t){e.exports=tui.require("editor_weka/helpers/mention")},ixux:function(e,t){e.exports=tui.require("totara_comment/components/box/ReplyBox")},jUiv:function(e,t){e.exports=tui.require("totara_comment/components/action/CommentActionDropDown")},jx0T:function(e,t){e.exports=tui.require("totara_comment/components/form/ReplyForm")},kJKs:function(e,t){e.exports=tui.require("totara_comment/components/card/ReplyCard")},lBzj:function(e,t){e.exports=tui.require("tui/components/icons/FlexIcon")},ltL4:function(e,t){e.exports=tui.require("tui/components/icons/common/Reply")},n41h:function(e,t,n){"use strict";n.r(t),n.d(t,"SIZE_LARGE",(function(){return i})),n.d(t,"SIZE_SMALL",(function(){return a})),n.d(t,"isValid",(function(){return r}));var i="large",a="small";function r(e){return i===e||a===e}},nEm4:function(e,t){e.exports=tui.require("tui/components/form/Form")},nGKo:function(e,t){e.exports=tui.require("totara_comment/components/form/box/ResponseBox")},nQzs:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Form",{staticClass:"tui-editCommentReplyForm"},[e.$apollo.loading?e._e():[e.$apollo.queries.editorOption.loading?e._e():n("Weka",{staticClass:"tui-editCommentReplyForm__editor",attrs:{area:e.item.comment_area,"instance-id":e.itemId,component:"totara_comment",option:e.editorOption,doc:e.content.doc},on:{update:e.update}}),e._v(" "),n("SubmitCancelButtonsGroup",{attrs:{"submit-text":e.$str("done","totara_comment"),"disable-submit":e.content.empty||e.submitting,size:e.size},on:{"click-submit":e.submit,"click-cancel":function(t){return e.$emit("cancel")}}})]],2)};i._withStripped=!0;var a=n("2wx7"),r=n.n(a),o=n("nEm4"),l=n.n(o),m=n("TXEh"),d=n("yAFK"),s=n("p9yr"),u=n.n(s),c={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"totara_comment_get_draft_item"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"draftitem"},name:{kind:"Name",value:"totara_comment_draft_item"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"area"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"comment_area"},arguments:[],directives:[]}]}}]}}]},p=n("7oeD"),v={components:{Weka:r.a,Form:l.a,SubmitCancelButtonsGroup:u.a},apollo:{item:{query:c,fetchPolicy:"network-only",variables:function(){return{id:this.itemId}},result:function(e){var t=e.data.draftitem;this.content.doc=JSON.parse(t.content),this.content.empty=!1},update:function(e){return e.draftitem}},editorOption:{query:p.a,variables:function(){return{component:this.item.component,area:this.item.area,comment_area:this.item.comment_area,id:this.itemId}},update:function(e){return e.editor},skip:function(){return this.$apollo.queries.item.loading}}},props:{size:{type:String,default:function(){return d.SIZE_SMALL},validator:function(e){return Object(d.isValid)(e)}},itemId:{type:[String,Number],required:!0},submitting:Boolean},data:function(){return{editorOption:null,item:{},content:{doc:null,empty:!0,itemId:null}}},methods:{$_readJSON:Object(m.debounce)((function(e){this.content.doc=e.getJSON(),this.content.empty=e.isEmpty(),this.content.itemId=e.getFileStorageItemId()}),100,{}),update:function(e){this.$_readJSON(e)},submit:function(){var e={id:this.itemId,content:JSON.stringify(this.content.doc),format:this.item.format,itemId:this.content.itemId};this.$emit("update-item",e)}}},k=n("KHd+"),f=function(e){e.options.__langStrings={totara_comment:["done"]}},_=Object(k.a)(v,i,[],!1,null,null,null);"function"==typeof f&&f(_),_.options.__hasBlocks={script:!0,template:!0},_.options.__file="client/src/totara_comment/components/form/EditCommentReplyForm.vue";t.default=_.exports},oiZQ:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tui-replyBox"},[e.showLoadRepliesLink||e.loadRepliesStatus&&e.hasMoreReplies?n("div",{staticClass:"tui-replyBox__replyLinkBox",class:{"tui-replyBox__replyLinkBox--withSeparator":e.showLineSeparator,"tui-replyBox__replyLinkBox--withoutSeparator":!e.showLineSeparator}},[n("a",{staticClass:"tui-replyBox__replyLinkBox__link",class:{"tui-replyBox__replyLinkBox__link--disabled":e.$apollo.queries.replies.loading},attrs:{href:"#",role:"button"},on:{click:function(t){return t.preventDefault(),e.loadReplies(t)}}},[n("span",[e._v(e._s(e.$str("viewreplies","totara_comment")))]),e._v(" "),e.$apollo.queries.replies.loading?n("Spinner"):e._e()],1)]):e._e(),e._v(" "),0<e.replies.length?[e._l(e.replies,(function(t,i){return[n("Reply",{key:t.id,staticClass:"tui-replyBox__reply",class:{"tui-replyBox__reply--large":e.isLarge},attrs:{"data-counter":i,"reply-id":t.id,content:t.content,"comment-id":t.commentid,"time-description":t.timedescription,"user-full-name":t.user.fullname,"user-profile-image-url":t.user.profileimageurl,"user-profile-image-alt":t.user.profileimagealt||"","user-id":t.user.id,"update-able":t.interactor.can_update,"delete-able":t.interactor.can_delete,"report-able":t.interactor.can_report,"reply-able":t.interactor.can_follow_reply,"react-able":t.interactor.can_react,"total-reactions":t.totalreactions,reacted:t.interactor.reacted,edited:t.edited,deleted:t.deleted,"reason-deleted":t.reasondeleted,size:e.size,submitting:e.innerSubmitting,"show-reply-button-text":e.showReplyButtonText,"show-like-button-text":e.showLikeButtonText,"inline-head":e.replyHeadInline},on:{"update-submitting":function(t){return e.$emit("update-submitting",t)},"update-reply":e.updateRepliesCache,"delete-reply":e.updateRepliesCache,"reply-to":e.handleReplyTo,"update-react-status":e.updateReactStatus}})]}))]:e._e(),e._v(" "),e.replyAble?[e.innerShowReplyForm?n("ReplyForm",{ref:"reply-form",staticClass:"tui-replyBox__replyForm",attrs:{component:e.component,area:e.area,"comment-id":e.commentId,size:e.size,"reply-to":e.innerReplyTo},on:{cancel:function(t){return e.$emit("update-show-reply-form",!1)},submit:e.createReply,"form-ready":e.handleFormReady}}):e._e()]:e._e()],2)};i._withStripped=!0;var a=n("o0o1"),r=n.n(a),o=n("yXPU"),l=n.n(o),m=n("jx0T"),d=n.n(m),s=n("yAFK"),u=n("0viy"),c=n.n(u),p=n("0VQe"),v=n.n(p),k=n("UpZR"),f=n.n(k),_={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"totara_comment_get_replies"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"commentid"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"page"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"replies"},name:{kind:"Name",value:"totara_comment_replies"},arguments:[{kind:"Argument",name:{kind:"Name",value:"commentid"},value:{kind:"Variable",name:{kind:"Name",value:"commentid"}}},{kind:"Argument",name:{kind:"Name",value:"page"},value:{kind:"Variable",name:{kind:"Name",value:"page"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"edited"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"deleted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"commentid"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"timedescription"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimagealt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurl"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"totalreactions"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reasondeleted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"interactor"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_delete"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_report"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_update"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_react"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_follow_reply"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reacted"},arguments:[],directives:[]}]}}]}}]}}]},y={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"totara_comment_create_reply"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"commentid"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"content"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"format"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"draft_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"reply"},name:{kind:"Name",value:"totara_comment_create_reply"},arguments:[{kind:"Argument",name:{kind:"Name",value:"commentid"},value:{kind:"Variable",name:{kind:"Name",value:"commentid"}}},{kind:"Argument",name:{kind:"Name",value:"content"},value:{kind:"Variable",name:{kind:"Name",value:"content"}}},{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"Variable",name:{kind:"Name",value:"format"}}},{kind:"Argument",name:{kind:"Name",value:"draft_id"},value:{kind:"Variable",name:{kind:"Name",value:"draft_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"edited"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"deleted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"content"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"HTML"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"commentid"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"timedescription"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimagealt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurl"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"totalreactions"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reasondeleted"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"interactor"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_delete"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_report"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_update"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_react"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_follow_reply"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"reacted"},arguments:[],directives:[]}]}}]}}]}}]},g={components:{ReplyForm:d.a,Spinner:c.a,Reply:v.a},props:{component:{type:String,required:!0},area:{type:String,required:!0},commentId:{type:[Number,String],required:!0},totalReplies:{type:[Number,String],required:!0},size:{type:String,default:function(){return s.SIZE_SMALL},validator:function(e){return Object(s.isValid)(e)}},showReplyForm:{type:Boolean,required:!0},replyAble:{type:Boolean,required:!0},submitting:Boolean,showLikeButtonText:Boolean,showReplyButtonText:Boolean,replyTo:null,replyHeadInline:Boolean},apollo:{replies:{query:_,watchLoading:function(e){this.$emit("fetch-replies",e)},variables:function(){return{commentid:this.commentId}},result:function(e){var t=e.data.replies;this.hasMoreReplies=t.length<this.totalReplies},skip:function(){return!this.loadRepliesStatus}}},data:function(){return{replies:[],page:1,loadRepliesStatus:!1,hasMoreReplies:!1,innerSubmitting:this.submitting,innerShowReplyForm:this.showReplyForm,innerReplyTo:this.replyTo}},computed:{isLarge:function(){return s.SIZE_LARGE===this.size},hasReplies:function(){return 0<parseInt(this.totalReplies,10)},showLoadRepliesLink:function(){return!(!this.$apollo.queries.replies.loading||1!=this.page)||this.hasReplies&&!this.loadRepliesStatus},showLineSeparator:function(){return this.showLoadRepliesLink||this.hasMoreReplies}},watch:{innerSubmitting:function(e){e!==this.submitting&&this.$emit("update-submitting",e)},submitting:function(e){e!==this.innerSubmitting&&(this.innerSubmitting=e)},innerShowReplyForm:function(e){e&&(this.loadRepliesStatus||(this.loadRepliesStatus=!0)),e!==this.showReplyForm&&this.$emit("update-show-reply-form",e),e&&this.$_scrollToForm()},showReplyForm:function(e){e!==this.innerShowReplyForm&&(this.innerShowReplyForm=e,this.innerReplyTo=null)},replyTo:function(e){this.innerReplyTo=e},innerReplyTo:function(e){e!==this.replyTo&&this.$emit("update-reply-to",e)}},methods:{handleFormReady:function(){var e=this.$refs["reply-form"];e&&(e.$el&&(e=e.$el),this.$emit("form-ready",e))},$_scrollToForm:function(){this.$emit("scroll-to-reply-form")},loadReplies:function(){var e=this;return l()(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.loadRepliesStatus){t.next=3;break}return e.loadRepliesStatus=!0,t.abrupt("return");case 3:return e.page+=1,t.next=6,e.$apollo.queries.replies.fetchMore({variables:{page:e.page,commentid:e.commentId},updateQuery:function(t,n){var i=n.fetchMoreResult.replies;return i=Array.prototype.concat.call(i,t.replies),e.hasMoreReplies=i.length<e.totalReplies,{replies:i}}});case 6:case"end":return t.stop()}}),t)})))()},updateRepliesCache:function(e){var t={commentid:this.commentId},n=f.a.readQuery({query:_,variables:t}).replies;f.a.writeQuery({query:_,variables:t,data:{replies:Array.prototype.map.call(n,(function(t){return t.id==e.id?e:t}))}}),this.$emit("update-reply",e)},createReply:function(e){var t=this,n=e.content,i=e.format,a=e.commentId,o=e.itemId;return l()(r.a.mark((function e(){var l,m;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.innerSubmitting){e.next=2;break}return e.abrupt("return");case 2:return t.innerSubmitting=!0,e.prev=3,e.next=6,t.$apollo.mutate({mutation:y,refetchAll:!1,variables:{commentid:a,content:n,format:i,draft_id:o},update:function(e,n){var i=n.data,a=e.readQuery({query:_,variables:{commentid:t.commentId}}).replies;e.writeQuery({query:_,variables:{commentid:t.commentId},data:{replies:Array.prototype.concat.call(a,[i.reply])}})}});case 6:l=e.sent,m=l.data.reply,t.innerShowReplyForm=!1,t.$emit("create-reply",m);case 10:return e.prev=10,t.innerSubmitting=!1,e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[3,,10,13]])})))()},handleReplyTo:function(e){this.innerReplyTo=e,this.innerShowReplyForm&&this.$_scrollToForm(),this.innerShowReplyForm=!0},updateReactStatus:function(e){var t=e.id,n=e.status,i=f.a.readQuery({query:_,variables:{commentid:this.commentId}}).replies;f.a.writeQuery({query:_,variables:{commentid:this.commentId},data:{replies:Array.prototype.map.call(i,(function(e){if(e.id==t){var i=Object.assign({},e),a=Object.assign({},e.interactor);return a.reacted=n,i.interactor=a,n?i.totalreactions+=1:0!=i.totalreactions&&(i.totalreactions-=1),i}return e}))}})}}},b=n("KHd+"),N=function(e){e.options.__langStrings={totara_comment:["viewreplies"]}},h=Object(b.a)(g,i,[],!1,null,null,null);"function"==typeof N&&N(h),h.options.__hasBlocks={script:!0,template:!0},h.options.__file="client/src/totara_comment/components/box/ReplyBox.vue";t.default=h.exports},p7Bt:function(e,t){e.exports=tui.require("totara_comment/components/action/CommentAction")},p9yr:function(e,t){e.exports=tui.require("totara_comment/components/form/group/SubmitCancelButtonsGroup")},pktG:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Dropdown",{staticClass:"tui-commentActionDropDown",attrs:{position:"bottom-right"},scopedSlots:e._u([{key:"trigger",fn:function(t){var i=t.toggle,a=t.isOpen;return[e.showActions?n("ButtonIcon",{attrs:{"aria-expanded":a?"true":"false","aria-label":e.$str("triggermenu","totara_comment"),styleclass:{transparentNoPadding:!0}},on:{click:function(e){return e.preventDefault(),i(e)}}},[n("More",{attrs:{size:"300"}})],1):e._e()]}}])},[e._v(" "),e.showUpdateAction?n("DropdownItem",{on:{click:function(t){return e.$emit("click-edit")}}},[e._v("\n    "+e._s(e.$str("edit","moodle"))+"\n  ")]):e._e(),e._v(" "),e.showDeleteAction?n("DropdownItem",{on:{click:function(t){return e.$emit("click-delete")}}},[e._v("\n    "+e._s(e.$str("delete","moodle"))+"\n  ")]):e._e(),e._v(" "),e.showReportAction?n("DropdownItem",{on:{click:function(t){return e.$emit("click-report-content")}}},[e._v("\n    "+e._s(e.$str("reportcontent","totara_comment"))+"\n  ")]):e._e()],1)};i._withStripped=!0;var a=n("gLvT"),r=n.n(a),o=n("hCGN"),l=n.n(o),m=n("KGcv"),d=n.n(m),s=n("5h9J"),u={components:{ButtonIcon:n.n(s).a,Dropdown:r.a,More:l.a,DropdownItem:d.a},props:{showDeleteAction:{type:Boolean,default:!0},showUpdateAction:{type:Boolean,default:!0},showReportAction:{type:Boolean,default:!0}},computed:{showActions:function(){return this.showDeleteAction||this.showUpdateAction||this.showReportAction}}},c=n("KHd+"),p=function(e){e.options.__langStrings={moodle:["delete","edit"],totara_comment:["triggermenu","reportcontent"]}},v=Object(c.a)(u,i,[],!1,null,null,null);"function"==typeof p&&p(v),v.options.__hasBlocks={script:!0,template:!0},v.options.__file="client/src/totara_comment/components/action/CommentActionDropDown.vue";t.default=v.exports},rkhB:function(e,t){e.exports=tui.require("totara_comment/components/card/CommentCard")},sqa2:function(e,t){e.exports=tui.require("totara_comment/components/action/CommentActionLink")},tkAW:function(e,t){e.exports=tui.require("tui/components/modal/Modal")},ttGn:function(e,t,n){"use strict";n.r(t);var i=n("lBzj"),a=n.n(i),r={functional:!0,components:{FlexIcon:a.a},props:{alt:String,customClass:[String,Array,Object],styleClass:Object,size:[String,Number],title:String},render:function(e,t){var n=t.props;return e(a.a,{props:Object.assign({},n,{icon:"totara_comment|menu"})})}},o=n("KHd+"),l=Object(o.a)(r,void 0,void 0,!1,null,null,null);l.options.__hasBlocks={script:!0,template:!1},l.options.__file="client/src/totara_comment/components/icons/Menu.vue";t.default=l.exports},u5iS:function(e,t){e.exports=tui.require("tui/components/modal/ModalContent")},vF5l:function(e,t){e.exports=tui.require("tui/components/buttons/Button")},vyVp:function(e,t){e.exports=tui.require("tui/notifications")},w20f:function(e,t){e.exports=tui.require("totara_comment/components/comment/Comment")},xpT8:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{staticClass:"tui-confirmDeleteCommentReplyModal",attrs:{size:"small","aria-labelledby":e.id}},[n("ModalContent",{staticClass:"tui-confirmDeleteCommentReplyModal__content",attrs:{"close-button":!0,title:e.title,"title-id":e.id},on:{dismiss:function(t){return e.$emit("request-close")}}},[n("div",{staticClass:"tui-confirmDeleteCommentReplyModal__textBox"},[n("Warning",{attrs:{size:700,"custom-class":["tui-icon--warning","tui-confirmDeleteCommentReplyModal__icon"]}}),e._v(" "),n("p",{staticClass:"tui-confirmDeleteCommentReplyModal__textBox__text"},[e._v("\n        "+e._s(e.$str("deletecommentconfirm","totara_comment"))+"\n      ")])],1),e._v(" "),n("ButtonGroup",{staticClass:"tui-confirmDeleteCommentReplyModal__buttons",attrs:{slot:"buttons"},slot:"buttons"},[n("Button",{attrs:{text:e.$str("confirm","moodle"),styleclass:{primary:!0,small:!0}},on:{click:function(t){return t.preventDefault(),e.$emit("confirm-delete")}}}),e._v(" "),n("Button",{attrs:{text:e.$str("cancel","moodle"),styleclass:{small:!0}},on:{click:function(t){return t.preventDefault(),e.$emit("request-close")}}})],1)],1)],1)};i._withStripped=!0;var a=n("tkAW"),r=n.n(a),o=n("u5iS"),l=n.n(o),m=n("BN8m"),d=n.n(m),s=n("vF5l"),u=n.n(s),c=n("3wZ/"),p=n.n(c),v={components:{Modal:r.a,ModalContent:l.a,ButtonGroup:d.a,Button:u.a,Warning:p.a},props:{title:{type:String,default:""}},computed:{id:function(){return this.$id(this.title)}}},k=n("KHd+"),f=function(e){e.options.__langStrings={moodle:["cancel","confirm"],totara_comment:["deletecommentconfirm"]}},_=Object(k.a)(v,i,[],!1,null,null,null);"function"==typeof f&&f(_),_.options.__hasBlocks={script:!0,template:!0},_.options.__file="client/src/totara_comment/components/modal/ConfirmDeleteCommentReplyModal.vue";t.default=_.exports},xtKj:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"tui-replyCard"},[t("div",{staticClass:"tui-replyCard__profilePicture"},[this._t("profile-picture")],2),this._v(" "),t("div",{staticClass:"tui-replyCard__body"},[t("div",{staticClass:"tui-replyCard__body__header"},[this._t("body-header")],2),this._v(" "),t("div",{staticClass:"tui-replyCard__body__content"},[this._t("body-content")],2),this._v(" "),t("div",{staticClass:"tui-replyCard__body__footer"},[this._t("body-footer")],2)])])};i._withStripped=!0;var a=n("KHd+"),r=Object(a.a)({},i,[],!1,null,null,null);r.options.__hasBlocks={script:!1,template:!0},r.options.__file="client/src/totara_comment/components/card/ReplyCard.vue";t.default=r.exports},yAFK:function(e,t){e.exports=tui.require("totara_comment/size")}});