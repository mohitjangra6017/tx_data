define(["core/templates"],function(a){function b(a){if(this.element=a,this.alwaysOpen="false"!==this.element.getAttribute("data-always-open"),this.allowMultiple="true"===this.element.getAttribute("data-allow-multiple"),this.alwaysOpen){var b=this.getOpenChildren();0===b.length&&this.toggleItem(this.getChildren()[0])}}function c(a){return new Promise(function(c){var d=new b(a);d.events(),c(d)})}return b.prototype.events=function(){for(var a=this,b=function(){var b=this.closest(".totara_core__Accordion__item");a.toggleItem(b)},c=this.element.querySelectorAll(".totara_core__Accordion__item__header"),d=0;d<c.length;d++){var e=c.item(d);e.addEventListener("click",b)}this.element.addEventListener("totara_core/accordion:open",function(b){var c=b.target.closest(".totara_core__Accordion__item"),d=b.originalEvent||b;a.toggleItem(c,!0,!!d.suppress)}),this.element.addEventListener("totara_core/accordion:close",function(b){var c=b.target.closest(".totara_core__Accordion__item"),d=b.originalEvent||b;a.toggleItem(c,!1,!!d.suppress)})},b.prototype.getChildren=function(){return this.element.querySelectorAll(".totara_core__Accordion__item")},b.prototype.getOpenChildren=function(){return this.element.querySelectorAll(".totara_core__Accordion__item:not(.collapsed)")},b.prototype.toggleItem=function(b,c,d){var e=!b.classList.contains("collapsed"),f=void 0===c?!e:c;if(!this.alwaysOpen||1!==this.getOpenChildren().length||!e){this.allowMultiple||this.closeAllItems(),b.classList.toggle("collapsed",!f),b.querySelector(".totara_core__Accordion__item__header").setAttribute("aria-expanded",f);var g=f?"totara_core|accordion-expanded":"totara_core|accordion-collapsed";a.renderIcon(g).then(function(a){b.classList.contains("collapsed")!==f&&(b.querySelector(".totara_core__Accordion__item__header__icon").innerHTML=a)}),d||(f?b.dispatchEvent(new CustomEvent("totara_core/accordion:opened",{bubbles:!0,detail:{elem:b}})):b.dispatchEvent(new CustomEvent("totara_core/accordion:closed",{bubbles:!0,detail:{elem:b}})))}},b.prototype.closeAllItems=function(){for(var a=this.getChildren(),b=0;b<a.length;b++){var c=a.item(b);c.classList.toggle("collapsed",!0),c.querySelector(".totara_core__Accordion__item__header").setAttribute("aria-expanded",!1)}},{init:c}});