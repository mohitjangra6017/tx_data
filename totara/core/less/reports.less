
// Base variables
@myReports_base-color_neutral_2: @totara_style-color_neutral_2;
@myReports_base-color_neutral_3: @totara_style-color_neutral_3;
@myReports_base-color_neutral_5: @totara_style-color_neutral_5;
@myReports_base-color_neutral_7: @totara_style-color_neutral_7;
@myReports_base-color_theme_1: @totara_style-color_theme_1;
@myReports_base-border-color: @myReports_base-color_neutral_5;
@myReports_base-image-background: #f0f0f0; // taken from svg

@myReports_base-title_font-size: @totara_style-font_body_medium_size;
@myReports_base-description_font-size: 1.2rem;
@myReports_base-controls_font-size: 1.2em;

@myReports_base-spacing_x_small: @totara_style-spacing_x_small;
@myReports_base-spacing_small: @totara_style-spacing_small;

@myReports_base-screen_xsm_min: 500px;
@myReports_base-screen_sm_min: @totara_style-screen_sm_min;

.totara_core__myreports__container {
    opacity: 0;
    transition: opacity 200ms ease-out;

    &.tw-list-toggle-loaded {
        opacity: 1;
    }
}

.totara_core__myreports__list {
    clear: both;
    padding: 1rem 0;

    &__item {
        position: relative;

        // Hover animation
        transition-property: transform, box-shadow;
        transition-duration: 200ms;
        transition-timing-function: ease-in-out;
        &:hover {
            box-shadow: @totara_style-shadow_1;
            transform: scale(1.01);
        }

        &__title {
            font-weight: 600;
        }

        // This is an trick for accessibility where rather than having the entire card be
        // link, we expand a pseudo-element inside the link to cover the card. This prevents
        // a screen reader trying to read out the whole card
        // https://inclusive-components.design/cards/
        &__link:after {
            position: absolute;
            content: ' ';
            left: 0;
            top: 0;
            bottom: 0;
            right: 0;
        }
    }
}

// ------------------------------
//  GRID VIEW
// ------------------------------

@myReports_grid-card-width: 18em;
@myReports_grid-card-height: 20em;

@myReports_grid-padding: 0.5rem;

@myReports_grid-title_font-size: @myReports_base-title_font-size;
@myReports_grid-description_font-size: @myReports_base-description_font-size;
@myReports_grid-controls_font-size: @myReports_base-controls_font-size;

@myReports_grid-spacing: @totara_style-spacing_medium;
@myReports_grid-border-color: @myReports_base-border-color;

.totara_core__myreports__list--grid {
    &:after {
        display: block;
        content: '';
        clear: both;
    }

    display: flex;
    flex-wrap: wrap;

    @supports (display: grid) {
        & {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(@myReports_grid-card-width, 1fr));
            grid-auto-rows: max-content;

            grid-column-gap: @myReports_grid-spacing;
            grid-row-gap: @myReports_grid-spacing;

            &:after {
                display: none;
            }
        }
    }

    & .totara_core__myreports__list {

        &__item {
            max-height: @myReports_grid-card-height;
            min-height: @myReports_grid-card-height / 2;
            border: 1px solid @myReports_grid-border-color;

            display: flex;
            flex-direction: column;

            flex: 0 0 auto;

            // fallback for when there isn't grid support
            width: @myReports_grid-card-width;
            margin-right: @myReports_grid-spacing;
            margin-bottom: @myReports_grid-spacing;

            @supports (display: grid) {
                & {
                    // This just means fill the grid
                    width: 100%;
                    height: 100%;
                    margin: 0;
                }
            }

            &__image {
                flex: 1 0 50%;
                background-color: @myReports_base-image-background;

                img.icon {
                    display: block;
                    max-width: 100%;
                    max-height: 100%;

                    width: auto;
                    height: 100%;

                    margin: 0 auto;
                }
            }

            &__title {
                padding: @myReports_grid-padding;
                font-size: @myReports_grid-title_font-size;

                overflow: hidden;
                white-space: nowrap;
                text-overflow: ellipsis;

                flex: 0 0 auto;
            }

            &__description {
                flex: 1 1 @myReports_grid-card-height; // start big, and then shrink to available space
                margin: @myReports_grid-padding;

                overflow: hidden;
                display: -webkit-box;
                -webkit-line-clamp: 6;

                /*! autoprefixer: off */
                -webkit-box-orient: vertical;
                /*! autoprefixer: on */

                font-size: @myReports_grid-description_font-size;
            }

            &__controls {
                text-align: right;
                font-size: @myReports_grid-controls_font-size;
                padding: @myReports_grid-padding;

                flex: 0 0 auto;
            }
        }
    }
}

// ------------------------------
//  TABLE VIEW
// ------------------------------

@myReports_table-row-height: 3.5em;
@myReports_table-padding: 0.6rem;

@myReports_table-title_font-size: @myReports_base-title_font-size;
@myReports_table-description_font-size: @myReports_base-description_font-size;
@myReports_table-controls_font-size: @myReports_base-controls_font-size;

@myReports_table-border-color: @myReports_base-border-color;

.totara_core__myreports__list--table {

    & .totara_core__myreports__list {
        &__item {
            display: flex;
            height: @myReports_table-row-height;

            &:first-of-type {
                border-top: 1px solid @myReports_table-border-color;
            }
            border-bottom: 1px solid @myReports_table-border-color;

            &__image {
                max-height: 100%;

                width: auto;
                height: 100%;

                flex: 0 0 auto;

                img.icon {
                    width: auto;
                    height: 100%;

                    max-height: 100%;
                    background-color: @myReports_base-image-background;

                    margin: 0;
                    padding: 0;
                }
            }

            &__title {
                padding: @myReports_table-padding;
                line-height: @myReports_table-row-height - (2 * @myReports_table-padding);
                font-size: @myReports_table-title_font-size;

                overflow: hidden;
                text-overflow: ellipsis;
                white-space: nowrap;

                /* Shorthand flex doesn't work in IE11 with flex-basis being set to 0 */
                flex-grow: 1;
                flex-shrink: 1;
                flex-basis: 0;
            }

            &__description {
                margin: @myReports_table-padding (2*@myReports_table-padding);
                overflow: hidden;
                /* Shorthand flex doesn't work in IE11 with flex-basis being set to 0 */
                flex-grow: 1;
                flex-shrink: 1;
                flex-basis: 0;
                font-size: @myReports_table-description_font-size;

                display: -webkit-box;
                -webkit-line-clamp: 2;

                /*! autoprefixer: off */
                -webkit-box-orient: vertical;
                /*! autoprefixer: on */

            }

            &__controls {
                text-align: right;
                font-size: @myReports_table-controls_font-size;
                padding: @myReports_table-padding;
                line-height: 0.7 * (@myReports_table-row-height - (2 * @myReports_table-padding));
                flex: 0 0 auto;
            }
        }
    }
}

// ------------------------------
//  TITLE BUTTONS
// ------------------------------

@myReports_btns-color_neutral_2: @myReports_base-color_neutral_2;
@myReports_btns-color_neutral_3: @myReports_base-color_neutral_3;
@myReports_btns-color_neutral_5: @myReports_base-color_neutral_5;
@myReports_btns-color_neutral_7: @myReports_base-color_neutral_7;

@myReports_btns_font_size: @totara_style-font_heading_label_small_size;
@myReports_btns_border-radius: 3px;

@myReports_btns-spacing_x_small: @myReports_base-spacing_x_small;
@myReports_btns-spacing_small: @myReports_base-spacing_small;
@myReports_btns-spacing_med: @totara_style-spacing_medium;

.totara_core__myreports__title {
    display: flex;
    justify-content: space-between;

    padding-bottom: @myReports_btns-spacing_med;
    margin-bottom: @myReports_btns-spacing_med;
    border-bottom: 1px solid @myReports_btns-color_neutral_3;

    &__btn {
        border: 1px solid @myReports_btns-color_neutral_5;
        border-radius: @myReports_btns_border-radius;
        color: inherit;
        cursor: pointer;
        display: inline-block;
        font-size: @myReports_btns_font_size;
        margin: @myReports_btns-spacing_x_small;
        padding: @myReports_btns-spacing_small;
        transition: background-color 0.2s ease;

        &:active,
        &:focus,
        &:hover {
            background: @myReports_btns-color_neutral_2;
            color: @myReports_btns-color_neutral_7;
            outline: 0;
            text-decoration: none;
        }
    }
}

// ------------------------------
//  LIST ITEM TOGGLE
// ------------------------------

// Colours
@myReports_Toggle-color_neutral_2: @myReports_base-color_neutral_2;
@myReports_Toggle-color_neutral_3: @myReports_base-color_neutral_3;
@myReports_Toggle-color_neutral_5: @myReports_base-color_neutral_5;
@myReports_Toggle-color_neutral_7: @myReports_base-color_neutral_7;
@myReports_Toggle-color_theme_1: @myReports_base-color_theme_1;
// Spacing
@myReports_Toggle-spacing_x_small: @myReports_base-spacing_x_small;
@myReports_Toggle-spacing_small: @myReports_base-spacing_small;
// Font Size
@myReports_Toggle-btn_font_size: @myReports_btns_font_size;
// Breakpoint
@myReports_Toggle-screen_xsm_min: @myReports_base-screen_xsm_min;
@myReports_Toggle-screen_sm_min: @myReports_base-screen_sm_min;

@myReports_Toggle_border-radius: 3px;

.totara_core__myreports__itemstyletoggle {
    display: flex;
    margin: auto @myReports_Toggle-spacing_x_small @myReports_Toggle-spacing_x_small auto;
    float: right;

    &__btn {
        border: 1px solid @myReports_Toggle-color_neutral_5;
        color: @myReports_Toggle-color_theme_1;
        font-size: @myReports_Toggle-btn_font_size;
        padding: @myReports_Toggle-spacing_small;
        transition: background-color 0.2s ease;

        &--grid {
            border-radius: @myReports_Toggle_border-radius 0 0 @myReports_Toggle_border-radius;
        }

        &--list {
            border-left: 0px;
            border-radius: 0 @myReports_Toggle_border-radius @myReports_Toggle_border-radius 0;
        }

        &:active,
        &:focus,
        &:hover {
            background: @myReports_Toggle-color_neutral_2;
            color: @myReports_Toggle-color_neutral_7;
            outline: 0;
            text-decoration: none;
        }

        &_active {
            background: @myReports_Toggle-color_neutral_3;
            color: @myReports_Toggle-color_neutral_7;
            cursor: default;

            &:active,
            &:focus,
            &:hover {
                background: @myReports_Toggle-color_neutral_3;
                color: @myReports_Toggle-color_neutral_7;
            }
        }
    }

    @media (min-width: @myReports_Toggle-screen_xsm_min) {
        & {
            margin: auto @myReports_Toggle-spacing_x_small @myReports_Toggle-spacing_x_small 0;
        }
    }

    @media (min-width: @myReports_Toggle-screen_sm_min) {
        & {
            margin-right: 0;
        }
    }
}