//
// This file is part of Totara Learn
//
// Copyright (C) 2020 onwards Totara Learning Solutions LTD
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 3 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License
// along with this program.  If not, see <http://www.gnu.org/licenses/>.
//
// @copyright 2020 onwards Totara Learning Solutions LTD
// @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
// @author    Brian Barnes <brian.barnes@totaralearning.com>
// @package   theme_legacy

#region-main div[role='main'] h2.totara_reportbuilder__report_create_title {
  float: left;
  margin-top: var(--tui-gap-1);
}

.totara_reportbuilder__report_create {
  clear: both;
  position: relative;
  z-index: 1;

  &_aside {
    @include make-xs-column(12, 0);
    @include make-sm-column(4, 0);
    @include make-md-column(3, 0);
  }

  &_primaryFilter {
    border-bottom: 1px solid var(--tui-color-neutral-4);
    border-top: 1px solid var(--tui-color-neutral-4);
    font-size: var(--tui-font-size-18);
    margin: var(--tui-gap-4) 0;
    padding: var(--tui-gap-4) 0;
  }

  &_results {
    & {
      @include make-xs-column(12, 0);
      @include make-sm-column(8, 0);
      @include make-md-column(9, 0);
    }

    &_overview {
      display: flex;
      flex-wrap: wrap;
      padding: var(--tui-gap-4) 0;

      &_row {
        display: flex;
        height: 100%;
        margin-bottom: var(--tui-gap-6);
        width: 100%;
      }
    }
  }

  &_hidden {
    display: none;
  }
}

.totara_reportbuilder__createreport_container {
  opacity: 0;
  transition: opacity $reportbuilder-transition ease-out;

  &.tw-list-toggle-loaded {
    opacity: 1;
  }
}

.totara_reportbuilder__createreport_label {
  padding: 0.1em var(--tui-gap-2);
  border-radius: 4px;

  font-size: var(--tui-font-size-13);

  &--primary {
    background-color: $brand-info;
    color: var(--tui-color-neutral-1);
  }

  &--secondary {
    border: 1px solid var(--tui-color-border);
  }
}

.totara_reportbuilder__createreport_list {
  clear: both;
  padding: var(--tui-gap-2) 0;
  margin: 0;

  &_item {
    display: block;

    // Hover animation
    transition-property: transform, box-shadow;
    transition-duration: $reportbuilder-transition;
    transition-timing-function: ease-in-out;

    &,
    &:hover,
    &:focus {
      color: inherit;
      text-decoration: none;
    }

    &:hover,
    &:focus,
    .tw-grid__item_active & {
      box-shadow: var(--tui-shadow-1);
      transform: scale(1.01);
    }

    &_title {
      font-weight: 600;
    }
  }
}

.totara_reportbuilder__createreport_load {
  position: relative;
  height: 3em;

  [data-tw-report-create-disabled]& {
    display: none;
    pointer-events: none;
  }

  button {
    display: none;
    width: 100%;

    [data-tw-report-create-loaded=true] & {
      display: block;
    }
  }
}

// ------------------------------
//  GRID VIEW
// ------------------------------
.totara_reportbuilder__createreport_list--grid {

  .totara_reportbuilder__createreport_label {
    &--primary {
      position: absolute; // Sit over the top of the image
      left: 0.7em;
      top: 0.5em;
    }

    &--container {
      display: none;
    }
  }

  & .totara_reportbuilder__createreport_list {

    &_item {
      border: 1px solid var(--tui-color-border);
      display: flex;
      flex-direction: column;
      max-height: $reportbuilder-create-grid-height;
      min-height: $reportbuilder-create-grid-height / 2;

      &_info {
        flex: 1 1 auto;
        padding: 0 0.5em 0.7em;
      }

      &_image {
        flex: 1 0 50%;
        background-color: $reportbuilder-image-background;

        padding: 0.7em 0.5em 0;
        position: relative;

        img.icon {
          display: block;
          max-width: 100%;
          max-height: 100%;

          width: auto;
          height: 100%;

          margin: 0 auto;
        }
      }

      &_title {
        padding: var(--tui-gap-1);
        font-size: var(--tui-font-size-15);

        overflow: hidden;
        white-space: nowrap;
        text-overflow: ellipsis;

        flex: 0 0 auto;
      }
    }
  }
}

// ------------------------------
//  TABLE VIEW
// ------------------------------
.totara_reportbuilder__createreport_list--table {
  // Override width from grid css
  .tw-grid__item {
    flex-basis: 100%;
    padding-top: 0;
    padding-bottom: 0;
  }

  .totara_reportbuilder__createreport_label {
    &--primary,
    &--secondary {
      display: none;
      margin-left: var(--tui-gap-2);
    }

    &--container {
      padding-top: var(--tui-gap-2);

      .totara_reportbuilder__createreport_label--primary,
      .totara_reportbuilder__createreport_label--secondary {
        display: inline;
      }
    }
  }

  [data-tw-report-create-item-active]:not(:last-child) {
    border-bottom: 1px solid var(--tui-color-border);
  }

  & .totara_reportbuilder__createreport_list {
    &_item {
      box-sizing: content-box;
      height: $reportbuilder-create-table-height;
      clear: both;

      border-bottom: 1px solid var(--tui-color-border);

      &_image {
        max-height: 100%;
        float: left;

        width: auto;
        height: 100%;

        img.icon {
          width: auto;
          height: 100%;

          max-height: 100%;
          background-color: $reportbuilder-image-background;

          margin: 0;
          padding: 0;
        }
      }

      &_title {
        padding: var(--tui-gap-2);
        font-size: var(--tui-font-size-15);

        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;

      }
    }
  }
}

// ------------------------------
//  LIST ITEM TOGGLE
// ------------------------------
.totara_reportbuilder__createreport_itemstyletoggle {
  display: flex;
  margin: auto var(--tui-gap-1) var(--tui-gap-1) auto;
  float: right;

  &_btn {
    border: 1px solid var(--tui-color-neutral-5);
    color: var(--tui-color-state);
    font-size: var(--tui-font-size-13);
    padding: var(--tui-gap-2);

    &:active,
    &:focus,
    &:hover {
      background: var(--tui-color-neutral-2);
      color: var(--tui-color-neutral-7);
      outline: 0;
      text-decoration: none;
    }

    &_active {
      background: var(--tui-color-neutral-3);
      color: var(--tui-color-neutral-7);
      cursor: default;

      &:active,
      &:focus,
      &:hover {
        background: var(--tui-color-neutral-3);
        color: var(--tui-color-neutral-7);
      }
    }
  }

  @media (min-width: $myReports-screen-xsm-min) {
    & {
      margin: auto var(--tui-gap-1) var(--tui-gap-1) 0;
    }
  }

  @media (min-width: $totara-style-screen-sm-min) {
    & {
      margin-right: 0;
    }
  }
}

@import 'theme_legacy/totara/reportbuilder/details';
@import 'theme_legacy/totara/reportbuilder/loading_overlay';